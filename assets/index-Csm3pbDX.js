var jL=Object.defineProperty;var M2=r=>{throw TypeError(r)};var FL=(r,e,t)=>e in r?jL(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t;var T2=(r,e,t)=>FL(r,typeof e!="symbol"?e+"":e,t),o1=(r,e,t)=>e.has(r)||M2("Cannot "+t);var fe=(r,e,t)=>(o1(r,e,"read from private field"),t?t.call(r):e.get(r)),en=(r,e,t)=>e.has(r)?M2("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(r):e.set(r,t),At=(r,e,t,n)=>(o1(r,e,"write to private field"),n?n.call(r,t):e.set(r,t),t),Nn=(r,e,t)=>(o1(r,e,"access private method"),t);var Xv=(r,e,t,n)=>({set _(s){At(r,e,s,t)},get _(){return fe(r,e,n)}});function UL(r,e){for(var t=0;t<e.length;t++){const n=e[t];if(typeof n!="string"&&!Array.isArray(n)){for(const s in n)if(s!=="default"&&!(s in r)){const i=Object.getOwnPropertyDescriptor(n,s);i&&Object.defineProperty(r,s,i.get?i:{enumerable:!0,get:()=>n[s]})}}}return Object.freeze(Object.defineProperty(r,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))n(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&n(o)}).observe(document,{childList:!0,subtree:!0});function t(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerPolicy&&(i.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?i.credentials="include":s.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function n(s){if(s.ep)return;s.ep=!0;const i=t(s);fetch(s.href,i)}})();function y_(r){return r&&r.__esModule&&Object.prototype.hasOwnProperty.call(r,"default")?r.default:r}function BL(r){if(Object.prototype.hasOwnProperty.call(r,"__esModule"))return r;var e=r.default;if(typeof e=="function"){var t=function n(){return this instanceof n?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};t.prototype=e.prototype}else t={};return Object.defineProperty(t,"__esModule",{value:!0}),Object.keys(r).forEach(function(n){var s=Object.getOwnPropertyDescriptor(r,n);Object.defineProperty(t,n,s.get?s:{enumerable:!0,get:function(){return r[n]}})}),t}var a1={exports:{}},dg={},l1={exports:{}},bn={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var C2;function zL(){if(C2)return bn;C2=1;var r=Symbol.for("react.element"),e=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),n=Symbol.for("react.strict_mode"),s=Symbol.for("react.profiler"),i=Symbol.for("react.provider"),o=Symbol.for("react.context"),a=Symbol.for("react.forward_ref"),c=Symbol.for("react.suspense"),d=Symbol.for("react.memo"),f=Symbol.for("react.lazy"),m=Symbol.iterator;function v(X){return X===null||typeof X!="object"?null:(X=m&&X[m]||X["@@iterator"],typeof X=="function"?X:null)}var x={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},_=Object.assign,b={};function w(X,ie,be){this.props=X,this.context=ie,this.refs=b,this.updater=be||x}w.prototype.isReactComponent={},w.prototype.setState=function(X,ie){if(typeof X!="object"&&typeof X!="function"&&X!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,X,ie,"setState")},w.prototype.forceUpdate=function(X){this.updater.enqueueForceUpdate(this,X,"forceUpdate")};function S(){}S.prototype=w.prototype;function C(X,ie,be){this.props=X,this.context=ie,this.refs=b,this.updater=be||x}var T=C.prototype=new S;T.constructor=C,_(T,w.prototype),T.isPureReactComponent=!0;var A=Array.isArray,k=Object.prototype.hasOwnProperty,j={current:null},D={key:!0,ref:!0,__self:!0,__source:!0};function L(X,ie,be){var ue,Ee={},Fe=null,me=null;if(ie!=null)for(ue in ie.ref!==void 0&&(me=ie.ref),ie.key!==void 0&&(Fe=""+ie.key),ie)k.call(ie,ue)&&!D.hasOwnProperty(ue)&&(Ee[ue]=ie[ue]);var je=arguments.length-2;if(je===1)Ee.children=be;else if(1<je){for(var Xe=Array(je),$e=0;$e<je;$e++)Xe[$e]=arguments[$e+2];Ee.children=Xe}if(X&&X.defaultProps)for(ue in je=X.defaultProps,je)Ee[ue]===void 0&&(Ee[ue]=je[ue]);return{$$typeof:r,type:X,key:Fe,ref:me,props:Ee,_owner:j.current}}function O(X,ie){return{$$typeof:r,type:X.type,key:ie,ref:X.ref,props:X.props,_owner:X._owner}}function I(X){return typeof X=="object"&&X!==null&&X.$$typeof===r}function B(X){var ie={"=":"=0",":":"=2"};return"$"+X.replace(/[=:]/g,function(be){return ie[be]})}var W=/\/+/g;function K(X,ie){return typeof X=="object"&&X!==null&&X.key!=null?B(""+X.key):ie.toString(36)}function ee(X,ie,be,ue,Ee){var Fe=typeof X;(Fe==="undefined"||Fe==="boolean")&&(X=null);var me=!1;if(X===null)me=!0;else switch(Fe){case"string":case"number":me=!0;break;case"object":switch(X.$$typeof){case r:case e:me=!0}}if(me)return me=X,Ee=Ee(me),X=ue===""?"."+K(me,0):ue,A(Ee)?(be="",X!=null&&(be=X.replace(W,"$&/")+"/"),ee(Ee,ie,be,"",function($e){return $e})):Ee!=null&&(I(Ee)&&(Ee=O(Ee,be+(!Ee.key||me&&me.key===Ee.key?"":(""+Ee.key).replace(W,"$&/")+"/")+X)),ie.push(Ee)),1;if(me=0,ue=ue===""?".":ue+":",A(X))for(var je=0;je<X.length;je++){Fe=X[je];var Xe=ue+K(Fe,je);me+=ee(Fe,ie,be,Xe,Ee)}else if(Xe=v(X),typeof Xe=="function")for(X=Xe.call(X),je=0;!(Fe=X.next()).done;)Fe=Fe.value,Xe=ue+K(Fe,je++),me+=ee(Fe,ie,be,Xe,Ee);else if(Fe==="object")throw ie=String(X),Error("Objects are not valid as a React child (found: "+(ie==="[object Object]"?"object with keys {"+Object.keys(X).join(", ")+"}":ie)+"). If you meant to render a collection of children, use an array instead.");return me}function oe(X,ie,be){if(X==null)return X;var ue=[],Ee=0;return ee(X,ue,"","",function(Fe){return ie.call(be,Fe,Ee++)}),ue}function ne(X){if(X._status===-1){var ie=X._result;ie=ie(),ie.then(function(be){(X._status===0||X._status===-1)&&(X._status=1,X._result=be)},function(be){(X._status===0||X._status===-1)&&(X._status=2,X._result=be)}),X._status===-1&&(X._status=0,X._result=ie)}if(X._status===1)return X._result.default;throw X._result}var ce={current:null},V={transition:null},q={ReactCurrentDispatcher:ce,ReactCurrentBatchConfig:V,ReactCurrentOwner:j};function Z(){throw Error("act(...) is not supported in production builds of React.")}return bn.Children={map:oe,forEach:function(X,ie,be){oe(X,function(){ie.apply(this,arguments)},be)},count:function(X){var ie=0;return oe(X,function(){ie++}),ie},toArray:function(X){return oe(X,function(ie){return ie})||[]},only:function(X){if(!I(X))throw Error("React.Children.only expected to receive a single React element child.");return X}},bn.Component=w,bn.Fragment=t,bn.Profiler=s,bn.PureComponent=C,bn.StrictMode=n,bn.Suspense=c,bn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=q,bn.act=Z,bn.cloneElement=function(X,ie,be){if(X==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+X+".");var ue=_({},X.props),Ee=X.key,Fe=X.ref,me=X._owner;if(ie!=null){if(ie.ref!==void 0&&(Fe=ie.ref,me=j.current),ie.key!==void 0&&(Ee=""+ie.key),X.type&&X.type.defaultProps)var je=X.type.defaultProps;for(Xe in ie)k.call(ie,Xe)&&!D.hasOwnProperty(Xe)&&(ue[Xe]=ie[Xe]===void 0&&je!==void 0?je[Xe]:ie[Xe])}var Xe=arguments.length-2;if(Xe===1)ue.children=be;else if(1<Xe){je=Array(Xe);for(var $e=0;$e<Xe;$e++)je[$e]=arguments[$e+2];ue.children=je}return{$$typeof:r,type:X.type,key:Ee,ref:Fe,props:ue,_owner:me}},bn.createContext=function(X){return X={$$typeof:o,_currentValue:X,_currentValue2:X,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},X.Provider={$$typeof:i,_context:X},X.Consumer=X},bn.createElement=L,bn.createFactory=function(X){var ie=L.bind(null,X);return ie.type=X,ie},bn.createRef=function(){return{current:null}},bn.forwardRef=function(X){return{$$typeof:a,render:X}},bn.isValidElement=I,bn.lazy=function(X){return{$$typeof:f,_payload:{_status:-1,_result:X},_init:ne}},bn.memo=function(X,ie){return{$$typeof:d,type:X,compare:ie===void 0?null:ie}},bn.startTransition=function(X){var ie=V.transition;V.transition={};try{X()}finally{V.transition=ie}},bn.unstable_act=Z,bn.useCallback=function(X,ie){return ce.current.useCallback(X,ie)},bn.useContext=function(X){return ce.current.useContext(X)},bn.useDebugValue=function(){},bn.useDeferredValue=function(X){return ce.current.useDeferredValue(X)},bn.useEffect=function(X,ie){return ce.current.useEffect(X,ie)},bn.useId=function(){return ce.current.useId()},bn.useImperativeHandle=function(X,ie,be){return ce.current.useImperativeHandle(X,ie,be)},bn.useInsertionEffect=function(X,ie){return ce.current.useInsertionEffect(X,ie)},bn.useLayoutEffect=function(X,ie){return ce.current.useLayoutEffect(X,ie)},bn.useMemo=function(X,ie){return ce.current.useMemo(X,ie)},bn.useReducer=function(X,ie,be){return ce.current.useReducer(X,ie,be)},bn.useRef=function(X){return ce.current.useRef(X)},bn.useState=function(X){return ce.current.useState(X)},bn.useSyncExternalStore=function(X,ie,be){return ce.current.useSyncExternalStore(X,ie,be)},bn.useTransition=function(){return ce.current.useTransition()},bn.version="18.3.1",bn}var A2;function __(){return A2||(A2=1,l1.exports=zL()),l1.exports}/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var R2;function VL(){if(R2)return dg;R2=1;var r=__(),e=Symbol.for("react.element"),t=Symbol.for("react.fragment"),n=Object.prototype.hasOwnProperty,s=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,i={key:!0,ref:!0,__self:!0,__source:!0};function o(a,c,d){var f,m={},v=null,x=null;d!==void 0&&(v=""+d),c.key!==void 0&&(v=""+c.key),c.ref!==void 0&&(x=c.ref);for(f in c)n.call(c,f)&&!i.hasOwnProperty(f)&&(m[f]=c[f]);if(a&&a.defaultProps)for(f in c=a.defaultProps,c)m[f]===void 0&&(m[f]=c[f]);return{$$typeof:e,type:a,key:v,ref:x,props:m,_owner:s.current}}return dg.Fragment=t,dg.jsx=o,dg.jsxs=o,dg}var N2;function HL(){return N2||(N2=1,a1.exports=VL()),a1.exports}var h=HL(),Yv={},c1={exports:{}},bi={},u1={exports:{}},d1={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var P2;function GL(){return P2||(P2=1,function(r){function e(V,q){var Z=V.length;V.push(q);e:for(;0<Z;){var X=Z-1>>>1,ie=V[X];if(0<s(ie,q))V[X]=q,V[Z]=ie,Z=X;else break e}}function t(V){return V.length===0?null:V[0]}function n(V){if(V.length===0)return null;var q=V[0],Z=V.pop();if(Z!==q){V[0]=Z;e:for(var X=0,ie=V.length,be=ie>>>1;X<be;){var ue=2*(X+1)-1,Ee=V[ue],Fe=ue+1,me=V[Fe];if(0>s(Ee,Z))Fe<ie&&0>s(me,Ee)?(V[X]=me,V[Fe]=Z,X=Fe):(V[X]=Ee,V[ue]=Z,X=ue);else if(Fe<ie&&0>s(me,Z))V[X]=me,V[Fe]=Z,X=Fe;else break e}}return q}function s(V,q){var Z=V.sortIndex-q.sortIndex;return Z!==0?Z:V.id-q.id}if(typeof performance=="object"&&typeof performance.now=="function"){var i=performance;r.unstable_now=function(){return i.now()}}else{var o=Date,a=o.now();r.unstable_now=function(){return o.now()-a}}var c=[],d=[],f=1,m=null,v=3,x=!1,_=!1,b=!1,w=typeof setTimeout=="function"?setTimeout:null,S=typeof clearTimeout=="function"?clearTimeout:null,C=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function T(V){for(var q=t(d);q!==null;){if(q.callback===null)n(d);else if(q.startTime<=V)n(d),q.sortIndex=q.expirationTime,e(c,q);else break;q=t(d)}}function A(V){if(b=!1,T(V),!_)if(t(c)!==null)_=!0,ne(k);else{var q=t(d);q!==null&&ce(A,q.startTime-V)}}function k(V,q){_=!1,b&&(b=!1,S(L),L=-1),x=!0;var Z=v;try{for(T(q),m=t(c);m!==null&&(!(m.expirationTime>q)||V&&!B());){var X=m.callback;if(typeof X=="function"){m.callback=null,v=m.priorityLevel;var ie=X(m.expirationTime<=q);q=r.unstable_now(),typeof ie=="function"?m.callback=ie:m===t(c)&&n(c),T(q)}else n(c);m=t(c)}if(m!==null)var be=!0;else{var ue=t(d);ue!==null&&ce(A,ue.startTime-q),be=!1}return be}finally{m=null,v=Z,x=!1}}var j=!1,D=null,L=-1,O=5,I=-1;function B(){return!(r.unstable_now()-I<O)}function W(){if(D!==null){var V=r.unstable_now();I=V;var q=!0;try{q=D(!0,V)}finally{q?K():(j=!1,D=null)}}else j=!1}var K;if(typeof C=="function")K=function(){C(W)};else if(typeof MessageChannel<"u"){var ee=new MessageChannel,oe=ee.port2;ee.port1.onmessage=W,K=function(){oe.postMessage(null)}}else K=function(){w(W,0)};function ne(V){D=V,j||(j=!0,K())}function ce(V,q){L=w(function(){V(r.unstable_now())},q)}r.unstable_IdlePriority=5,r.unstable_ImmediatePriority=1,r.unstable_LowPriority=4,r.unstable_NormalPriority=3,r.unstable_Profiling=null,r.unstable_UserBlockingPriority=2,r.unstable_cancelCallback=function(V){V.callback=null},r.unstable_continueExecution=function(){_||x||(_=!0,ne(k))},r.unstable_forceFrameRate=function(V){0>V||125<V?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):O=0<V?Math.floor(1e3/V):5},r.unstable_getCurrentPriorityLevel=function(){return v},r.unstable_getFirstCallbackNode=function(){return t(c)},r.unstable_next=function(V){switch(v){case 1:case 2:case 3:var q=3;break;default:q=v}var Z=v;v=q;try{return V()}finally{v=Z}},r.unstable_pauseExecution=function(){},r.unstable_requestPaint=function(){},r.unstable_runWithPriority=function(V,q){switch(V){case 1:case 2:case 3:case 4:case 5:break;default:V=3}var Z=v;v=V;try{return q()}finally{v=Z}},r.unstable_scheduleCallback=function(V,q,Z){var X=r.unstable_now();switch(typeof Z=="object"&&Z!==null?(Z=Z.delay,Z=typeof Z=="number"&&0<Z?X+Z:X):Z=X,V){case 1:var ie=-1;break;case 2:ie=250;break;case 5:ie=1073741823;break;case 4:ie=1e4;break;default:ie=5e3}return ie=Z+ie,V={id:f++,callback:q,priorityLevel:V,startTime:Z,expirationTime:ie,sortIndex:-1},Z>X?(V.sortIndex=Z,e(d,V),t(c)===null&&V===t(d)&&(b?(S(L),L=-1):b=!0,ce(A,Z-X))):(V.sortIndex=ie,e(c,V),_||x||(_=!0,ne(k))),V},r.unstable_shouldYield=B,r.unstable_wrapCallback=function(V){var q=v;return function(){var Z=v;v=q;try{return V.apply(this,arguments)}finally{v=Z}}}}(d1)),d1}var I2;function WL(){return I2||(I2=1,u1.exports=GL()),u1.exports}/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var k2;function $L(){if(k2)return bi;k2=1;var r=__(),e=WL();function t(l){for(var u="https://reactjs.org/docs/error-decoder.html?invariant="+l,y=1;y<arguments.length;y++)u+="&args[]="+encodeURIComponent(arguments[y]);return"Minified React error #"+l+"; visit "+u+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var n=new Set,s={};function i(l,u){o(l,u),o(l+"Capture",u)}function o(l,u){for(s[l]=u,l=0;l<u.length;l++)n.add(u[l])}var a=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),c=Object.prototype.hasOwnProperty,d=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,f={},m={};function v(l){return c.call(m,l)?!0:c.call(f,l)?!1:d.test(l)?m[l]=!0:(f[l]=!0,!1)}function x(l,u,y,M){if(y!==null&&y.type===0)return!1;switch(typeof u){case"function":case"symbol":return!0;case"boolean":return M?!1:y!==null?!y.acceptsBooleans:(l=l.toLowerCase().slice(0,5),l!=="data-"&&l!=="aria-");default:return!1}}function _(l,u,y,M){if(u===null||typeof u>"u"||x(l,u,y,M))return!0;if(M)return!1;if(y!==null)switch(y.type){case 3:return!u;case 4:return u===!1;case 5:return isNaN(u);case 6:return isNaN(u)||1>u}return!1}function b(l,u,y,M,P,U,G){this.acceptsBooleans=u===2||u===3||u===4,this.attributeName=M,this.attributeNamespace=P,this.mustUseProperty=y,this.propertyName=l,this.type=u,this.sanitizeURL=U,this.removeEmptyString=G}var w={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(l){w[l]=new b(l,0,!1,l,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(l){var u=l[0];w[u]=new b(u,1,!1,l[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(l){w[l]=new b(l,2,!1,l.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(l){w[l]=new b(l,2,!1,l,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(l){w[l]=new b(l,3,!1,l.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(l){w[l]=new b(l,3,!0,l,null,!1,!1)}),["capture","download"].forEach(function(l){w[l]=new b(l,4,!1,l,null,!1,!1)}),["cols","rows","size","span"].forEach(function(l){w[l]=new b(l,6,!1,l,null,!1,!1)}),["rowSpan","start"].forEach(function(l){w[l]=new b(l,5,!1,l.toLowerCase(),null,!1,!1)});var S=/[\-:]([a-z])/g;function C(l){return l[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(l){var u=l.replace(S,C);w[u]=new b(u,1,!1,l,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(l){var u=l.replace(S,C);w[u]=new b(u,1,!1,l,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(l){var u=l.replace(S,C);w[u]=new b(u,1,!1,l,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(l){w[l]=new b(l,1,!1,l.toLowerCase(),null,!1,!1)}),w.xlinkHref=new b("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(l){w[l]=new b(l,1,!1,l.toLowerCase(),null,!0,!0)});function T(l,u,y,M){var P=w.hasOwnProperty(u)?w[u]:null;(P!==null?P.type!==0:M||!(2<u.length)||u[0]!=="o"&&u[0]!=="O"||u[1]!=="n"&&u[1]!=="N")&&(_(u,y,P,M)&&(y=null),M||P===null?v(u)&&(y===null?l.removeAttribute(u):l.setAttribute(u,""+y)):P.mustUseProperty?l[P.propertyName]=y===null?P.type===3?!1:"":y:(u=P.attributeName,M=P.attributeNamespace,y===null?l.removeAttribute(u):(P=P.type,y=P===3||P===4&&y===!0?"":""+y,M?l.setAttributeNS(M,u,y):l.setAttribute(u,y))))}var A=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,k=Symbol.for("react.element"),j=Symbol.for("react.portal"),D=Symbol.for("react.fragment"),L=Symbol.for("react.strict_mode"),O=Symbol.for("react.profiler"),I=Symbol.for("react.provider"),B=Symbol.for("react.context"),W=Symbol.for("react.forward_ref"),K=Symbol.for("react.suspense"),ee=Symbol.for("react.suspense_list"),oe=Symbol.for("react.memo"),ne=Symbol.for("react.lazy"),ce=Symbol.for("react.offscreen"),V=Symbol.iterator;function q(l){return l===null||typeof l!="object"?null:(l=V&&l[V]||l["@@iterator"],typeof l=="function"?l:null)}var Z=Object.assign,X;function ie(l){if(X===void 0)try{throw Error()}catch(y){var u=y.stack.trim().match(/\n( *(at )?)/);X=u&&u[1]||""}return`
`+X+l}var be=!1;function ue(l,u){if(!l||be)return"";be=!0;var y=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(u)if(u=function(){throw Error()},Object.defineProperty(u.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(u,[])}catch(Pe){var M=Pe}Reflect.construct(l,[],u)}else{try{u.call()}catch(Pe){M=Pe}l.call(u.prototype)}else{try{throw Error()}catch(Pe){M=Pe}l()}}catch(Pe){if(Pe&&M&&typeof Pe.stack=="string"){for(var P=Pe.stack.split(`
`),U=M.stack.split(`
`),G=P.length-1,se=U.length-1;1<=G&&0<=se&&P[G]!==U[se];)se--;for(;1<=G&&0<=se;G--,se--)if(P[G]!==U[se]){if(G!==1||se!==1)do if(G--,se--,0>se||P[G]!==U[se]){var de=`
`+P[G].replace(" at new "," at ");return l.displayName&&de.includes("<anonymous>")&&(de=de.replace("<anonymous>",l.displayName)),de}while(1<=G&&0<=se);break}}}finally{be=!1,Error.prepareStackTrace=y}return(l=l?l.displayName||l.name:"")?ie(l):""}function Ee(l){switch(l.tag){case 5:return ie(l.type);case 16:return ie("Lazy");case 13:return ie("Suspense");case 19:return ie("SuspenseList");case 0:case 2:case 15:return l=ue(l.type,!1),l;case 11:return l=ue(l.type.render,!1),l;case 1:return l=ue(l.type,!0),l;default:return""}}function Fe(l){if(l==null)return null;if(typeof l=="function")return l.displayName||l.name||null;if(typeof l=="string")return l;switch(l){case D:return"Fragment";case j:return"Portal";case O:return"Profiler";case L:return"StrictMode";case K:return"Suspense";case ee:return"SuspenseList"}if(typeof l=="object")switch(l.$$typeof){case B:return(l.displayName||"Context")+".Consumer";case I:return(l._context.displayName||"Context")+".Provider";case W:var u=l.render;return l=l.displayName,l||(l=u.displayName||u.name||"",l=l!==""?"ForwardRef("+l+")":"ForwardRef"),l;case oe:return u=l.displayName||null,u!==null?u:Fe(l.type)||"Memo";case ne:u=l._payload,l=l._init;try{return Fe(l(u))}catch{}}return null}function me(l){var u=l.type;switch(l.tag){case 24:return"Cache";case 9:return(u.displayName||"Context")+".Consumer";case 10:return(u._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return l=u.render,l=l.displayName||l.name||"",u.displayName||(l!==""?"ForwardRef("+l+")":"ForwardRef");case 7:return"Fragment";case 5:return u;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Fe(u);case 8:return u===L?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof u=="function")return u.displayName||u.name||null;if(typeof u=="string")return u}return null}function je(l){switch(typeof l){case"boolean":case"number":case"string":case"undefined":return l;case"object":return l;default:return""}}function Xe(l){var u=l.type;return(l=l.nodeName)&&l.toLowerCase()==="input"&&(u==="checkbox"||u==="radio")}function $e(l){var u=Xe(l)?"checked":"value",y=Object.getOwnPropertyDescriptor(l.constructor.prototype,u),M=""+l[u];if(!l.hasOwnProperty(u)&&typeof y<"u"&&typeof y.get=="function"&&typeof y.set=="function"){var P=y.get,U=y.set;return Object.defineProperty(l,u,{configurable:!0,get:function(){return P.call(this)},set:function(G){M=""+G,U.call(this,G)}}),Object.defineProperty(l,u,{enumerable:y.enumerable}),{getValue:function(){return M},setValue:function(G){M=""+G},stopTracking:function(){l._valueTracker=null,delete l[u]}}}}function dt(l){l._valueTracker||(l._valueTracker=$e(l))}function ht(l){if(!l)return!1;var u=l._valueTracker;if(!u)return!0;var y=u.getValue(),M="";return l&&(M=Xe(l)?l.checked?"true":"false":l.value),l=M,l!==y?(u.setValue(l),!0):!1}function Ie(l){if(l=l||(typeof document<"u"?document:void 0),typeof l>"u")return null;try{return l.activeElement||l.body}catch{return l.body}}function $(l,u){var y=u.checked;return Z({},u,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:y??l._wrapperState.initialChecked})}function Ce(l,u){var y=u.defaultValue==null?"":u.defaultValue,M=u.checked!=null?u.checked:u.defaultChecked;y=je(u.value!=null?u.value:y),l._wrapperState={initialChecked:M,initialValue:y,controlled:u.type==="checkbox"||u.type==="radio"?u.checked!=null:u.value!=null}}function ke(l,u){u=u.checked,u!=null&&T(l,"checked",u,!1)}function Ge(l,u){ke(l,u);var y=je(u.value),M=u.type;if(y!=null)M==="number"?(y===0&&l.value===""||l.value!=y)&&(l.value=""+y):l.value!==""+y&&(l.value=""+y);else if(M==="submit"||M==="reset"){l.removeAttribute("value");return}u.hasOwnProperty("value")?rt(l,u.type,y):u.hasOwnProperty("defaultValue")&&rt(l,u.type,je(u.defaultValue)),u.checked==null&&u.defaultChecked!=null&&(l.defaultChecked=!!u.defaultChecked)}function Ae(l,u,y){if(u.hasOwnProperty("value")||u.hasOwnProperty("defaultValue")){var M=u.type;if(!(M!=="submit"&&M!=="reset"||u.value!==void 0&&u.value!==null))return;u=""+l._wrapperState.initialValue,y||u===l.value||(l.value=u),l.defaultValue=u}y=l.name,y!==""&&(l.name=""),l.defaultChecked=!!l._wrapperState.initialChecked,y!==""&&(l.name=y)}function rt(l,u,y){(u!=="number"||Ie(l.ownerDocument)!==l)&&(y==null?l.defaultValue=""+l._wrapperState.initialValue:l.defaultValue!==""+y&&(l.defaultValue=""+y))}var qe=Array.isArray;function nt(l,u,y,M){if(l=l.options,u){u={};for(var P=0;P<y.length;P++)u["$"+y[P]]=!0;for(y=0;y<l.length;y++)P=u.hasOwnProperty("$"+l[y].value),l[y].selected!==P&&(l[y].selected=P),P&&M&&(l[y].defaultSelected=!0)}else{for(y=""+je(y),u=null,P=0;P<l.length;P++){if(l[P].value===y){l[P].selected=!0,M&&(l[P].defaultSelected=!0);return}u!==null||l[P].disabled||(u=l[P])}u!==null&&(u.selected=!0)}}function jt(l,u){if(u.dangerouslySetInnerHTML!=null)throw Error(t(91));return Z({},u,{value:void 0,defaultValue:void 0,children:""+l._wrapperState.initialValue})}function Q(l,u){var y=u.value;if(y==null){if(y=u.children,u=u.defaultValue,y!=null){if(u!=null)throw Error(t(92));if(qe(y)){if(1<y.length)throw Error(t(93));y=y[0]}u=y}u==null&&(u=""),y=u}l._wrapperState={initialValue:je(y)}}function H(l,u){var y=je(u.value),M=je(u.defaultValue);y!=null&&(y=""+y,y!==l.value&&(l.value=y),u.defaultValue==null&&l.defaultValue!==y&&(l.defaultValue=y)),M!=null&&(l.defaultValue=""+M)}function ye(l){var u=l.textContent;u===l._wrapperState.initialValue&&u!==""&&u!==null&&(l.value=u)}function Re(l){switch(l){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Ue(l,u){return l==null||l==="http://www.w3.org/1999/xhtml"?Re(u):l==="http://www.w3.org/2000/svg"&&u==="foreignObject"?"http://www.w3.org/1999/xhtml":l}var Le,bt=function(l){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(u,y,M,P){MSApp.execUnsafeLocalFunction(function(){return l(u,y,M,P)})}:l}(function(l,u){if(l.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in l)l.innerHTML=u;else{for(Le=Le||document.createElement("div"),Le.innerHTML="<svg>"+u.valueOf().toString()+"</svg>",u=Le.firstChild;l.firstChild;)l.removeChild(l.firstChild);for(;u.firstChild;)l.appendChild(u.firstChild)}});function st(l,u){if(u){var y=l.firstChild;if(y&&y===l.lastChild&&y.nodeType===3){y.nodeValue=u;return}}l.textContent=u}var xt={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Et=["Webkit","ms","Moz","O"];Object.keys(xt).forEach(function(l){Et.forEach(function(u){u=u+l.charAt(0).toUpperCase()+l.substring(1),xt[u]=xt[l]})});function We(l,u,y){return u==null||typeof u=="boolean"||u===""?"":y||typeof u!="number"||u===0||xt.hasOwnProperty(l)&&xt[l]?(""+u).trim():u+"px"}function ft(l,u){l=l.style;for(var y in u)if(u.hasOwnProperty(y)){var M=y.indexOf("--")===0,P=We(y,u[y],M);y==="float"&&(y="cssFloat"),M?l.setProperty(y,P):l[y]=P}}var Bt=Z({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function le(l,u){if(u){if(Bt[l]&&(u.children!=null||u.dangerouslySetInnerHTML!=null))throw Error(t(137,l));if(u.dangerouslySetInnerHTML!=null){if(u.children!=null)throw Error(t(60));if(typeof u.dangerouslySetInnerHTML!="object"||!("__html"in u.dangerouslySetInnerHTML))throw Error(t(61))}if(u.style!=null&&typeof u.style!="object")throw Error(t(62))}}function Se(l,u){if(l.indexOf("-")===-1)return typeof u.is=="string";switch(l){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Ze=null;function ae(l){return l=l.target||l.srcElement||window,l.correspondingUseElement&&(l=l.correspondingUseElement),l.nodeType===3?l.parentNode:l}var Je=null,He=null,ct=null;function Ye(l){if(l=Io(l)){if(typeof Je!="function")throw Error(t(280));var u=l.stateNode;u&&(u=hf(u),Je(l.stateNode,l.type,u))}}function ze(l){He?ct?ct.push(l):ct=[l]:He=l}function Be(){if(He){var l=He,u=ct;if(ct=He=null,Ye(l),u)for(l=0;l<u.length;l++)Ye(u[l])}}function lt(l,u){return l(u)}function Dt(){}var Ht=!1;function An(l,u,y){if(Ht)return l(u,y);Ht=!0;try{return lt(l,u,y)}finally{Ht=!1,(He!==null||ct!==null)&&(Dt(),Be())}}function Bn(l,u){var y=l.stateNode;if(y===null)return null;var M=hf(y);if(M===null)return null;y=M[u];e:switch(u){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(M=!M.disabled)||(l=l.type,M=!(l==="button"||l==="input"||l==="select"||l==="textarea")),l=!M;break e;default:l=!1}if(l)return null;if(y&&typeof y!="function")throw Error(t(231,u,typeof y));return y}var Ts=!1;if(a)try{var pr={};Object.defineProperty(pr,"passive",{get:function(){Ts=!0}}),window.addEventListener("test",pr,pr),window.removeEventListener("test",pr,pr)}catch{Ts=!1}function wr(l,u,y,M,P,U,G,se,de){var Pe=Array.prototype.slice.call(arguments,3);try{u.apply(y,Pe)}catch(Qe){this.onError(Qe)}}var Oi=!1,Ka=null,ji=!1,ha=null,Mh={onError:function(l){Oi=!0,Ka=l}};function ic(l,u,y,M,P,U,G,se,de){Oi=!1,Ka=null,wr.apply(Mh,arguments)}function Th(l,u,y,M,P,U,G,se,de){if(ic.apply(this,arguments),Oi){if(Oi){var Pe=Ka;Oi=!1,Ka=null}else throw Error(t(198));ji||(ji=!0,ha=Pe)}}function no(l){var u=l,y=l;if(l.alternate)for(;u.return;)u=u.return;else{l=u;do u=l,(u.flags&4098)!==0&&(y=u.return),l=u.return;while(l)}return u.tag===3?y:null}function Ch(l){if(l.tag===13){var u=l.memoizedState;if(u===null&&(l=l.alternate,l!==null&&(u=l.memoizedState)),u!==null)return u.dehydrated}return null}function Ah(l){if(no(l)!==l)throw Error(t(188))}function Rh(l){var u=l.alternate;if(!u){if(u=no(l),u===null)throw Error(t(188));return u!==l?null:l}for(var y=l,M=u;;){var P=y.return;if(P===null)break;var U=P.alternate;if(U===null){if(M=P.return,M!==null){y=M;continue}break}if(P.child===U.child){for(U=P.child;U;){if(U===y)return Ah(P),l;if(U===M)return Ah(P),u;U=U.sibling}throw Error(t(188))}if(y.return!==M.return)y=P,M=U;else{for(var G=!1,se=P.child;se;){if(se===y){G=!0,y=P,M=U;break}if(se===M){G=!0,M=P,y=U;break}se=se.sibling}if(!G){for(se=U.child;se;){if(se===y){G=!0,y=U,M=P;break}if(se===M){G=!0,M=U,y=P;break}se=se.sibling}if(!G)throw Error(t(189))}}if(y.alternate!==M)throw Error(t(190))}if(y.tag!==3)throw Error(t(188));return y.stateNode.current===y?l:u}function Nh(l){return l=Rh(l),l!==null?Ph(l):null}function Ph(l){if(l.tag===5||l.tag===6)return l;for(l=l.child;l!==null;){var u=Ph(l);if(u!==null)return u;l=l.sibling}return null}var Ih=e.unstable_scheduleCallback,Y=e.unstable_cancelCallback,xe=e.unstable_shouldYield,Ne=e.unstable_requestPaint,_e=e.unstable_now,ve=e.unstable_getCurrentPriorityLevel,et=e.unstable_ImmediatePriority,pt=e.unstable_UserBlockingPriority,Mt=e.unstable_NormalPriority,_t=e.unstable_LowPriority,Vt=e.unstable_IdlePriority,Ft=null,it=null;function Nt(l){if(it&&typeof it.onCommitFiberRoot=="function")try{it.onCommitFiberRoot(Ft,l,void 0,(l.current.flags&128)===128)}catch{}}var Kt=Math.clz32?Math.clz32:dn,un=Math.log,_n=Math.LN2;function dn(l){return l>>>=0,l===0?32:31-(un(l)/_n|0)|0}var kt=64,En=4194304;function gn(l){switch(l&-l){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return l&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return l&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return l}}function Br(l,u){var y=l.pendingLanes;if(y===0)return 0;var M=0,P=l.suspendedLanes,U=l.pingedLanes,G=y&268435455;if(G!==0){var se=G&~P;se!==0?M=gn(se):(U&=G,U!==0&&(M=gn(U)))}else G=y&~P,G!==0?M=gn(G):U!==0&&(M=gn(U));if(M===0)return 0;if(u!==0&&u!==M&&(u&P)===0&&(P=M&-M,U=u&-u,P>=U||P===16&&(U&4194240)!==0))return u;if((M&4)!==0&&(M|=y&16),u=l.entangledLanes,u!==0)for(l=l.entanglements,u&=M;0<u;)y=31-Kt(u),P=1<<y,M|=l[y],u&=~P;return M}function bo(l,u){switch(l){case 1:case 2:case 4:return u+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return u+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Nr(l,u){for(var y=l.suspendedLanes,M=l.pingedLanes,P=l.expirationTimes,U=l.pendingLanes;0<U;){var G=31-Kt(U),se=1<<G,de=P[G];de===-1?((se&y)===0||(se&M)!==0)&&(P[G]=bo(se,u)):de<=u&&(l.expiredLanes|=se),U&=~se}}function ro(l){return l=l.pendingLanes&-1073741825,l!==0?l:l&1073741824?1073741824:0}function wn(){var l=kt;return kt<<=1,(kt&4194240)===0&&(kt=64),l}function es(l){for(var u=[],y=0;31>y;y++)u.push(l);return u}function Pr(l,u,y){l.pendingLanes|=u,u!==536870912&&(l.suspendedLanes=0,l.pingedLanes=0),l=l.eventTimes,u=31-Kt(u),l[u]=y}function zr(l,u){var y=l.pendingLanes&~u;l.pendingLanes=u,l.suspendedLanes=0,l.pingedLanes=0,l.expiredLanes&=u,l.mutableReadLanes&=u,l.entangledLanes&=u,u=l.entanglements;var M=l.eventTimes;for(l=l.expirationTimes;0<y;){var P=31-Kt(y),U=1<<P;u[P]=0,M[P]=-1,l[P]=-1,y&=~U}}function ur(l,u){var y=l.entangledLanes|=u;for(l=l.entanglements;y;){var M=31-Kt(y),P=1<<M;P&u|l[M]&u&&(l[M]|=u),y&=~P}}var Sn=0;function Cs(l){return l&=-l,1<l?4<l?(l&268435455)!==0?16:536870912:4:1}var Ru,vm,nv,kh,Dh,Qa=!1,Lh=[],so=null,vn=null,Eo=null,Ja=new Map,oc=new Map,fa=[],Pw="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Sr(l,u){switch(l){case"focusin":case"focusout":so=null;break;case"dragenter":case"dragleave":vn=null;break;case"mouseover":case"mouseout":Eo=null;break;case"pointerover":case"pointerout":Ja.delete(u.pointerId);break;case"gotpointercapture":case"lostpointercapture":oc.delete(u.pointerId)}}function Za(l,u,y,M,P,U){return l===null||l.nativeEvent!==U?(l={blockedOn:u,domEventName:y,eventSystemFlags:M,nativeEvent:U,targetContainers:[P]},u!==null&&(u=Io(u),u!==null&&vm(u)),l):(l.eventSystemFlags|=M,u=l.targetContainers,P!==null&&u.indexOf(P)===-1&&u.push(P),l)}function Iw(l,u,y,M,P){switch(u){case"focusin":return so=Za(so,l,u,y,M,P),!0;case"dragenter":return vn=Za(vn,l,u,y,M,P),!0;case"mouseover":return Eo=Za(Eo,l,u,y,M,P),!0;case"pointerover":var U=P.pointerId;return Ja.set(U,Za(Ja.get(U)||null,l,u,y,M,P)),!0;case"gotpointercapture":return U=P.pointerId,oc.set(U,Za(oc.get(U)||null,l,u,y,M,P)),!0}return!1}function Oh(l){var u=_a(l.target);if(u!==null){var y=no(u);if(y!==null){if(u=y.tag,u===13){if(u=Ch(y),u!==null){l.blockedOn=u,Dh(l.priority,function(){nv(y)});return}}else if(u===3&&y.stateNode.current.memoizedState.isDehydrated){l.blockedOn=y.tag===3?y.stateNode.containerInfo:null;return}}}l.blockedOn=null}function jh(l){if(l.blockedOn!==null)return!1;for(var u=l.targetContainers;0<u.length;){var y=fi(l.domEventName,l.eventSystemFlags,u[0],l.nativeEvent);if(y===null){y=l.nativeEvent;var M=new y.constructor(y.type,y);Ze=M,y.target.dispatchEvent(M),Ze=null}else return u=Io(y),u!==null&&vm(u),l.blockedOn=y,!1;u.shift()}return!0}function Nu(l,u,y){jh(l)&&y.delete(u)}function io(){Qa=!1,so!==null&&jh(so)&&(so=null),vn!==null&&jh(vn)&&(vn=null),Eo!==null&&jh(Eo)&&(Eo=null),Ja.forEach(Nu),oc.forEach(Nu)}function Pu(l,u){l.blockedOn===u&&(l.blockedOn=null,Qa||(Qa=!0,e.unstable_scheduleCallback(e.unstable_NormalPriority,io)))}function Iu(l){function u(P){return Pu(P,l)}if(0<Lh.length){Pu(Lh[0],l);for(var y=1;y<Lh.length;y++){var M=Lh[y];M.blockedOn===l&&(M.blockedOn=null)}}for(so!==null&&Pu(so,l),vn!==null&&Pu(vn,l),Eo!==null&&Pu(Eo,l),Ja.forEach(u),oc.forEach(u),y=0;y<fa.length;y++)M=fa[y],M.blockedOn===l&&(M.blockedOn=null);for(;0<fa.length&&(y=fa[0],y.blockedOn===null);)Oh(y),y.blockedOn===null&&fa.shift()}var cs=A.ReactCurrentBatchConfig,hi=!0;function Fh(l,u,y,M){var P=Sn,U=cs.transition;cs.transition=null;try{Sn=1,Uh(l,u,y,M)}finally{Sn=P,cs.transition=U}}function xm(l,u,y,M){var P=Sn,U=cs.transition;cs.transition=null;try{Sn=4,Uh(l,u,y,M)}finally{Sn=P,cs.transition=U}}function Uh(l,u,y,M){if(hi){var P=fi(l,u,y,M);if(P===null)of(l,u,M,Bh,y),Sr(l,M);else if(Iw(P,l,u,y,M))M.stopPropagation();else if(Sr(l,M),u&4&&-1<Pw.indexOf(l)){for(;P!==null;){var U=Io(P);if(U!==null&&Ru(U),U=fi(l,u,y,M),U===null&&of(l,u,M,Bh,y),U===P)break;P=U}P!==null&&M.stopPropagation()}else of(l,u,M,null,y)}}var Bh=null;function fi(l,u,y,M){if(Bh=null,l=ae(M),l=_a(l),l!==null)if(u=no(l),u===null)l=null;else if(y=u.tag,y===13){if(l=Ch(u),l!==null)return l;l=null}else if(y===3){if(u.stateNode.current.memoizedState.isDehydrated)return u.tag===3?u.stateNode.containerInfo:null;l=null}else u!==l&&(l=null);return Bh=l,null}function rv(l){switch(l){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(ve()){case et:return 1;case pt:return 4;case Mt:case _t:return 16;case Vt:return 536870912;default:return 16}default:return 16}}var Fi=null,ym=null,As=null;function ku(){if(As)return As;var l,u=ym,y=u.length,M,P="value"in Fi?Fi.value:Fi.textContent,U=P.length;for(l=0;l<y&&u[l]===P[l];l++);var G=y-l;for(M=1;M<=G&&u[y-M]===P[U-M];M++);return As=P.slice(l,1<M?1-M:void 0)}function el(l){var u=l.keyCode;return"charCode"in l?(l=l.charCode,l===0&&u===13&&(l=13)):l=u,l===10&&(l=13),32<=l||l===13?l:0}function Mo(){return!0}function zh(){return!1}function us(l){function u(y,M,P,U,G){this._reactName=y,this._targetInst=P,this.type=M,this.nativeEvent=U,this.target=G,this.currentTarget=null;for(var se in l)l.hasOwnProperty(se)&&(y=l[se],this[se]=y?y(U):U[se]);return this.isDefaultPrevented=(U.defaultPrevented!=null?U.defaultPrevented:U.returnValue===!1)?Mo:zh,this.isPropagationStopped=zh,this}return Z(u.prototype,{preventDefault:function(){this.defaultPrevented=!0;var y=this.nativeEvent;y&&(y.preventDefault?y.preventDefault():typeof y.returnValue!="unknown"&&(y.returnValue=!1),this.isDefaultPrevented=Mo)},stopPropagation:function(){var y=this.nativeEvent;y&&(y.stopPropagation?y.stopPropagation():typeof y.cancelBubble!="unknown"&&(y.cancelBubble=!0),this.isPropagationStopped=Mo)},persist:function(){},isPersistent:Mo}),u}var tl={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(l){return l.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Du=us(tl),nl=Z({},tl,{view:0,detail:0}),ac=us(nl),Rs,pi,mi,lc=Z({},nl,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:ma,button:0,buttons:0,relatedTarget:function(l){return l.relatedTarget===void 0?l.fromElement===l.srcElement?l.toElement:l.fromElement:l.relatedTarget},movementX:function(l){return"movementX"in l?l.movementX:(l!==mi&&(mi&&l.type==="mousemove"?(Rs=l.screenX-mi.screenX,pi=l.screenY-mi.screenY):pi=Rs=0,mi=l),Rs)},movementY:function(l){return"movementY"in l?l.movementY:pi}}),_m=us(lc),To=Z({},lc,{dataTransfer:0}),pa=us(To),Vh=Z({},nl,{relatedTarget:0}),Hh=us(Vh),Gh=Z({},tl,{animationName:0,elapsedTime:0,pseudoElement:0}),sv=us(Gh),iv=Z({},tl,{clipboardData:function(l){return"clipboardData"in l?l.clipboardData:window.clipboardData}}),wm=us(iv),Wh=Z({},tl,{data:0}),Sm=us(Wh),ov={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},av={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},bm={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function cc(l){var u=this.nativeEvent;return u.getModifierState?u.getModifierState(l):(l=bm[l])?!!u[l]:!1}function ma(){return cc}var $h=Z({},nl,{key:function(l){if(l.key){var u=ov[l.key]||l.key;if(u!=="Unidentified")return u}return l.type==="keypress"?(l=el(l),l===13?"Enter":String.fromCharCode(l)):l.type==="keydown"||l.type==="keyup"?av[l.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:ma,charCode:function(l){return l.type==="keypress"?el(l):0},keyCode:function(l){return l.type==="keydown"||l.type==="keyup"?l.keyCode:0},which:function(l){return l.type==="keypress"?el(l):l.type==="keydown"||l.type==="keyup"?l.keyCode:0}}),qh=us($h),gi=Z({},lc,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),qs=us(gi),rl=Z({},nl,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:ma}),Co=us(rl),Ao=Z({},tl,{propertyName:0,elapsedTime:0,pseudoElement:0}),sl=us(Ao),lv=Z({},lc,{deltaX:function(l){return"deltaX"in l?l.deltaX:"wheelDeltaX"in l?-l.wheelDeltaX:0},deltaY:function(l){return"deltaY"in l?l.deltaY:"wheelDeltaY"in l?-l.wheelDeltaY:"wheelDelta"in l?-l.wheelDelta:0},deltaZ:0,deltaMode:0}),Em=us(lv),Mm=[9,13,27,32],ds=a&&"CompositionEvent"in window,Vr=null;a&&"documentMode"in document&&(Vr=document.documentMode);var Zn=a&&"TextEvent"in window&&!Vr,uc=a&&(!ds||Vr&&8<Vr&&11>=Vr),vi=" ",Tm=!1;function Cm(l,u){switch(l){case"keyup":return Mm.indexOf(u.keyCode)!==-1;case"keydown":return u.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Xh(l){return l=l.detail,typeof l=="object"&&"data"in l?l.data:null}var ga=!1;function cv(l,u){switch(l){case"compositionend":return Xh(u);case"keypress":return u.which!==32?null:(Tm=!0,vi);case"textInput":return l=u.data,l===vi&&Tm?null:l;default:return null}}function Lu(l,u){if(ga)return l==="compositionend"||!ds&&Cm(l,u)?(l=ku(),As=ym=Fi=null,ga=!1,l):null;switch(l){case"paste":return null;case"keypress":if(!(u.ctrlKey||u.altKey||u.metaKey)||u.ctrlKey&&u.altKey){if(u.char&&1<u.char.length)return u.char;if(u.which)return String.fromCharCode(u.which)}return null;case"compositionend":return uc&&u.locale!=="ko"?null:u.data;default:return null}}var dc={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Yh(l){var u=l&&l.nodeName&&l.nodeName.toLowerCase();return u==="input"?!!dc[l.type]:u==="textarea"}function hc(l,u,y,M){ze(M),u=af(u,"onChange"),0<u.length&&(y=new Du("onChange","change",null,y,M),l.push({event:y,listeners:u}))}var va=null,fc=null;function uv(l){vc(l,0)}function Ro(l){var u=dr(l);if(ht(u))return l}function dv(l,u){if(l==="change")return u}var pc=!1;if(a){var Ns;if(a){var il="oninput"in document;if(!il){var ol=document.createElement("div");ol.setAttribute("oninput","return;"),il=typeof ol.oninput=="function"}Ns=il}else Ns=!1;pc=Ns&&(!document.documentMode||9<document.documentMode)}function Ui(){va&&(va.detachEvent("onpropertychange",Kh),fc=va=null)}function Kh(l){if(l.propertyName==="value"&&Ro(fc)){var u=[];hc(u,fc,l,ae(l)),An(uv,u)}}function mc(l,u,y){l==="focusin"?(Ui(),va=u,fc=y,va.attachEvent("onpropertychange",Kh)):l==="focusout"&&Ui()}function hv(l){if(l==="selectionchange"||l==="keyup"||l==="keydown")return Ro(fc)}function Am(l,u){if(l==="click")return Ro(u)}function nr(l,u){if(l==="input"||l==="change")return Ro(u)}function Qh(l,u){return l===u&&(l!==0||1/l===1/u)||l!==l&&u!==u}var Xs=typeof Object.is=="function"?Object.is:Qh;function al(l,u){if(Xs(l,u))return!0;if(typeof l!="object"||l===null||typeof u!="object"||u===null)return!1;var y=Object.keys(l),M=Object.keys(u);if(y.length!==M.length)return!1;for(M=0;M<y.length;M++){var P=y[M];if(!c.call(u,P)||!Xs(l[P],u[P]))return!1}return!0}function Ou(l){for(;l&&l.firstChild;)l=l.firstChild;return l}function Ys(l,u){var y=Ou(l);l=0;for(var M;y;){if(y.nodeType===3){if(M=l+y.textContent.length,l<=u&&M>=u)return{node:y,offset:u-l};l=M}e:{for(;y;){if(y.nextSibling){y=y.nextSibling;break e}y=y.parentNode}y=void 0}y=Ou(y)}}function ll(l,u){return l&&u?l===u?!0:l&&l.nodeType===3?!1:u&&u.nodeType===3?ll(l,u.parentNode):"contains"in l?l.contains(u):l.compareDocumentPosition?!!(l.compareDocumentPosition(u)&16):!1:!1}function rr(){for(var l=window,u=Ie();u instanceof l.HTMLIFrameElement;){try{var y=typeof u.contentWindow.location.href=="string"}catch{y=!1}if(y)l=u.contentWindow;else break;u=Ie(l.document)}return u}function Ir(l){var u=l&&l.nodeName&&l.nodeName.toLowerCase();return u&&(u==="input"&&(l.type==="text"||l.type==="search"||l.type==="tel"||l.type==="url"||l.type==="password")||u==="textarea"||l.contentEditable==="true")}function kr(l){var u=rr(),y=l.focusedElem,M=l.selectionRange;if(u!==y&&y&&y.ownerDocument&&ll(y.ownerDocument.documentElement,y)){if(M!==null&&Ir(y)){if(u=M.start,l=M.end,l===void 0&&(l=u),"selectionStart"in y)y.selectionStart=u,y.selectionEnd=Math.min(l,y.value.length);else if(l=(u=y.ownerDocument||document)&&u.defaultView||window,l.getSelection){l=l.getSelection();var P=y.textContent.length,U=Math.min(M.start,P);M=M.end===void 0?U:Math.min(M.end,P),!l.extend&&U>M&&(P=M,M=U,U=P),P=Ys(y,U);var G=Ys(y,M);P&&G&&(l.rangeCount!==1||l.anchorNode!==P.node||l.anchorOffset!==P.offset||l.focusNode!==G.node||l.focusOffset!==G.offset)&&(u=u.createRange(),u.setStart(P.node,P.offset),l.removeAllRanges(),U>M?(l.addRange(u),l.extend(G.node,G.offset)):(u.setEnd(G.node,G.offset),l.addRange(u)))}}for(u=[],l=y;l=l.parentNode;)l.nodeType===1&&u.push({element:l,left:l.scrollLeft,top:l.scrollTop});for(typeof y.focus=="function"&&y.focus(),y=0;y<u.length;y++)l=u[y],l.element.scrollLeft=l.left,l.element.scrollTop=l.top}}var Jh=a&&"documentMode"in document&&11>=document.documentMode,oo=null,cl=null,ju=null,Dr=!1;function Zh(l,u,y){var M=y.window===y?y.document:y.nodeType===9?y:y.ownerDocument;Dr||oo==null||oo!==Ie(M)||(M=oo,"selectionStart"in M&&Ir(M)?M={start:M.selectionStart,end:M.selectionEnd}:(M=(M.ownerDocument&&M.ownerDocument.defaultView||window).getSelection(),M={anchorNode:M.anchorNode,anchorOffset:M.anchorOffset,focusNode:M.focusNode,focusOffset:M.focusOffset}),ju&&al(ju,M)||(ju=M,M=af(cl,"onSelect"),0<M.length&&(u=new Du("onSelect","select",null,u,y),l.push({event:u,listeners:M}),u.target=oo)))}function gc(l,u){var y={};return y[l.toLowerCase()]=u.toLowerCase(),y["Webkit"+l]="webkit"+u,y["Moz"+l]="moz"+u,y}var xa={animationend:gc("Animation","AnimationEnd"),animationiteration:gc("Animation","AnimationIteration"),animationstart:gc("Animation","AnimationStart"),transitionend:gc("Transition","TransitionEnd")},Bi={},zi={};a&&(zi=document.createElement("div").style,"AnimationEvent"in window||(delete xa.animationend.animation,delete xa.animationiteration.animation,delete xa.animationstart.animation),"TransitionEvent"in window||delete xa.transitionend.transition);function ao(l){if(Bi[l])return Bi[l];if(!xa[l])return l;var u=xa[l],y;for(y in u)if(u.hasOwnProperty(y)&&y in zi)return Bi[l]=u[y];return l}var Fu=ao("animationend"),Uu=ao("animationiteration"),Rm=ao("animationstart"),Nm=ao("transitionend"),Pm=new Map,Im="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function No(l,u){Pm.set(l,u),i(u,[l])}for(var ef=0;ef<Im.length;ef++){var Bu=Im[ef],zu=Bu.toLowerCase(),fv=Bu[0].toUpperCase()+Bu.slice(1);No(zu,"on"+fv)}No(Fu,"onAnimationEnd"),No(Uu,"onAnimationIteration"),No(Rm,"onAnimationStart"),No("dblclick","onDoubleClick"),No("focusin","onFocus"),No("focusout","onBlur"),No(Nm,"onTransitionEnd"),o("onMouseEnter",["mouseout","mouseover"]),o("onMouseLeave",["mouseout","mouseover"]),o("onPointerEnter",["pointerout","pointerover"]),o("onPointerLeave",["pointerout","pointerover"]),i("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),i("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),i("onBeforeInput",["compositionend","keypress","textInput","paste"]),i("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),i("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),i("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var ya="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),tf=new Set("cancel close invalid load scroll toggle".split(" ").concat(ya));function nf(l,u,y){var M=l.type||"unknown-event";l.currentTarget=y,Th(M,u,void 0,l),l.currentTarget=null}function vc(l,u){u=(u&4)!==0;for(var y=0;y<l.length;y++){var M=l[y],P=M.event;M=M.listeners;e:{var U=void 0;if(u)for(var G=M.length-1;0<=G;G--){var se=M[G],de=se.instance,Pe=se.currentTarget;if(se=se.listener,de!==U&&P.isPropagationStopped())break e;nf(P,se,Pe),U=de}else for(G=0;G<M.length;G++){if(se=M[G],de=se.instance,Pe=se.currentTarget,se=se.listener,de!==U&&P.isPropagationStopped())break e;nf(P,se,Pe),U=de}}}if(ji)throw l=ha,ji=!1,ha=null,l}function $n(l,u){var y=u[hl];y===void 0&&(y=u[hl]=new Set);var M=l+"__bubble";y.has(M)||(sf(u,l,2,!1),y.add(M))}function rf(l,u,y){var M=0;u&&(M|=4),sf(y,l,M,u)}var Vu="_reactListening"+Math.random().toString(36).slice(2);function xc(l){if(!l[Vu]){l[Vu]=!0,n.forEach(function(y){y!=="selectionchange"&&(tf.has(y)||rf(y,!1,l),rf(y,!0,l))});var u=l.nodeType===9?l:l.ownerDocument;u===null||u[Vu]||(u[Vu]=!0,rf("selectionchange",!1,u))}}function sf(l,u,y,M){switch(rv(u)){case 1:var P=Fh;break;case 4:P=xm;break;default:P=Uh}y=P.bind(null,u,y,l),P=void 0,!Ts||u!=="touchstart"&&u!=="touchmove"&&u!=="wheel"||(P=!0),M?P!==void 0?l.addEventListener(u,y,{capture:!0,passive:P}):l.addEventListener(u,y,!0):P!==void 0?l.addEventListener(u,y,{passive:P}):l.addEventListener(u,y,!1)}function of(l,u,y,M,P){var U=M;if((u&1)===0&&(u&2)===0&&M!==null)e:for(;;){if(M===null)return;var G=M.tag;if(G===3||G===4){var se=M.stateNode.containerInfo;if(se===P||se.nodeType===8&&se.parentNode===P)break;if(G===4)for(G=M.return;G!==null;){var de=G.tag;if((de===3||de===4)&&(de=G.stateNode.containerInfo,de===P||de.nodeType===8&&de.parentNode===P))return;G=G.return}for(;se!==null;){if(G=_a(se),G===null)return;if(de=G.tag,de===5||de===6){M=U=G;continue e}se=se.parentNode}}M=M.return}An(function(){var Pe=U,Qe=ae(y),tt=[];e:{var Ke=Pm.get(l);if(Ke!==void 0){var wt=Du,Pt=l;switch(l){case"keypress":if(el(y)===0)break e;case"keydown":case"keyup":wt=qh;break;case"focusin":Pt="focus",wt=Hh;break;case"focusout":Pt="blur",wt=Hh;break;case"beforeblur":case"afterblur":wt=Hh;break;case"click":if(y.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":wt=_m;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":wt=pa;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":wt=Co;break;case Fu:case Uu:case Rm:wt=sv;break;case Nm:wt=sl;break;case"scroll":wt=ac;break;case"wheel":wt=Em;break;case"copy":case"cut":case"paste":wt=wm;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":wt=qs}var Lt=(u&4)!==0,Er=!Lt&&l==="scroll",we=Lt?Ke!==null?Ke+"Capture":null:Ke;Lt=[];for(var he=Pe,Me;he!==null;){Me=he;var at=Me.stateNode;if(Me.tag===5&&at!==null&&(Me=at,we!==null&&(at=Bn(he,we),at!=null&&Lt.push(yc(he,at,Me)))),Er)break;he=he.return}0<Lt.length&&(Ke=new wt(Ke,Pt,null,y,Qe),tt.push({event:Ke,listeners:Lt}))}}if((u&7)===0){e:{if(Ke=l==="mouseover"||l==="pointerover",wt=l==="mouseout"||l==="pointerout",Ke&&y!==Ze&&(Pt=y.relatedTarget||y.fromElement)&&(_a(Pt)||Pt[Ks]))break e;if((wt||Ke)&&(Ke=Qe.window===Qe?Qe:(Ke=Qe.ownerDocument)?Ke.defaultView||Ke.parentWindow:window,wt?(Pt=y.relatedTarget||y.toElement,wt=Pe,Pt=Pt?_a(Pt):null,Pt!==null&&(Er=no(Pt),Pt!==Er||Pt.tag!==5&&Pt.tag!==6)&&(Pt=null)):(wt=null,Pt=Pe),wt!==Pt)){if(Lt=_m,at="onMouseLeave",we="onMouseEnter",he="mouse",(l==="pointerout"||l==="pointerover")&&(Lt=qs,at="onPointerLeave",we="onPointerEnter",he="pointer"),Er=wt==null?Ke:dr(wt),Me=Pt==null?Ke:dr(Pt),Ke=new Lt(at,he+"leave",wt,y,Qe),Ke.target=Er,Ke.relatedTarget=Me,at=null,_a(Qe)===Pe&&(Lt=new Lt(we,he+"enter",Pt,y,Qe),Lt.target=Me,Lt.relatedTarget=Er,at=Lt),Er=at,wt&&Pt)t:{for(Lt=wt,we=Pt,he=0,Me=Lt;Me;Me=ul(Me))he++;for(Me=0,at=we;at;at=ul(at))Me++;for(;0<he-Me;)Lt=ul(Lt),he--;for(;0<Me-he;)we=ul(we),Me--;for(;he--;){if(Lt===we||we!==null&&Lt===we.alternate)break t;Lt=ul(Lt),we=ul(we)}Lt=null}else Lt=null;wt!==null&&pv(tt,Ke,wt,Lt,!1),Pt!==null&&Er!==null&&pv(tt,Er,Pt,Lt,!0)}}e:{if(Ke=Pe?dr(Pe):window,wt=Ke.nodeName&&Ke.nodeName.toLowerCase(),wt==="select"||wt==="input"&&Ke.type==="file")var Ut=dv;else if(Yh(Ke))if(pc)Ut=nr;else{Ut=hv;var qt=mc}else(wt=Ke.nodeName)&&wt.toLowerCase()==="input"&&(Ke.type==="checkbox"||Ke.type==="radio")&&(Ut=Am);if(Ut&&(Ut=Ut(l,Pe))){hc(tt,Ut,y,Qe);break e}qt&&qt(l,Ke,Pe),l==="focusout"&&(qt=Ke._wrapperState)&&qt.controlled&&Ke.type==="number"&&rt(Ke,"number",Ke.value)}switch(qt=Pe?dr(Pe):window,l){case"focusin":(Yh(qt)||qt.contentEditable==="true")&&(oo=qt,cl=Pe,ju=null);break;case"focusout":ju=cl=oo=null;break;case"mousedown":Dr=!0;break;case"contextmenu":case"mouseup":case"dragend":Dr=!1,Zh(tt,y,Qe);break;case"selectionchange":if(Jh)break;case"keydown":case"keyup":Zh(tt,y,Qe)}var Xt;if(ds)e:{switch(l){case"compositionstart":var tn="onCompositionStart";break e;case"compositionend":tn="onCompositionEnd";break e;case"compositionupdate":tn="onCompositionUpdate";break e}tn=void 0}else ga?Cm(l,y)&&(tn="onCompositionEnd"):l==="keydown"&&y.keyCode===229&&(tn="onCompositionStart");tn&&(uc&&y.locale!=="ko"&&(ga||tn!=="onCompositionStart"?tn==="onCompositionEnd"&&ga&&(Xt=ku()):(Fi=Qe,ym="value"in Fi?Fi.value:Fi.textContent,ga=!0)),qt=af(Pe,tn),0<qt.length&&(tn=new Sm(tn,l,null,y,Qe),tt.push({event:tn,listeners:qt}),Xt?tn.data=Xt:(Xt=Xh(y),Xt!==null&&(tn.data=Xt)))),(Xt=Zn?cv(l,y):Lu(l,y))&&(Pe=af(Pe,"onBeforeInput"),0<Pe.length&&(Qe=new Sm("onBeforeInput","beforeinput",null,y,Qe),tt.push({event:Qe,listeners:Pe}),Qe.data=Xt))}vc(tt,u)})}function yc(l,u,y){return{instance:l,listener:u,currentTarget:y}}function af(l,u){for(var y=u+"Capture",M=[];l!==null;){var P=l,U=P.stateNode;P.tag===5&&U!==null&&(P=U,U=Bn(l,y),U!=null&&M.unshift(yc(l,U,P)),U=Bn(l,u),U!=null&&M.push(yc(l,U,P))),l=l.return}return M}function ul(l){if(l===null)return null;do l=l.return;while(l&&l.tag!==5);return l||null}function pv(l,u,y,M,P){for(var U=u._reactName,G=[];y!==null&&y!==M;){var se=y,de=se.alternate,Pe=se.stateNode;if(de!==null&&de===M)break;se.tag===5&&Pe!==null&&(se=Pe,P?(de=Bn(y,U),de!=null&&G.unshift(yc(y,de,se))):P||(de=Bn(y,U),de!=null&&G.push(yc(y,de,se)))),y=y.return}G.length!==0&&l.push({event:u,listeners:G})}var kw=/\r\n?/g,mv=/\u0000|\uFFFD/g;function km(l){return(typeof l=="string"?l:""+l).replace(kw,`
`).replace(mv,"")}function Hu(l,u,y){if(u=km(u),km(l)!==u&&y)throw Error(t(425))}function Gu(){}var _c=null,Dm=null;function Lm(l,u){return l==="textarea"||l==="noscript"||typeof u.children=="string"||typeof u.children=="number"||typeof u.dangerouslySetInnerHTML=="object"&&u.dangerouslySetInnerHTML!==null&&u.dangerouslySetInnerHTML.__html!=null}var Om=typeof setTimeout=="function"?setTimeout:void 0,jm=typeof clearTimeout=="function"?clearTimeout:void 0,lf=typeof Promise=="function"?Promise:void 0,Dw=typeof queueMicrotask=="function"?queueMicrotask:typeof lf<"u"?function(l){return lf.resolve(null).then(l).catch(gv)}:Om;function gv(l){setTimeout(function(){throw l})}function cf(l,u){var y=u,M=0;do{var P=y.nextSibling;if(l.removeChild(y),P&&P.nodeType===8)if(y=P.data,y==="/$"){if(M===0){l.removeChild(P),Iu(u);return}M--}else y!=="$"&&y!=="$?"&&y!=="$!"||M++;y=P}while(y);Iu(u)}function Po(l){for(;l!=null;l=l.nextSibling){var u=l.nodeType;if(u===1||u===3)break;if(u===8){if(u=l.data,u==="$"||u==="$!"||u==="$?")break;if(u==="/$")return null}}return l}function Fm(l){l=l.previousSibling;for(var u=0;l;){if(l.nodeType===8){var y=l.data;if(y==="$"||y==="$!"||y==="$?"){if(u===0)return l;u--}else y==="/$"&&u++}l=l.previousSibling}return null}var dl=Math.random().toString(36).slice(2),br="__reactFiber$"+dl,wc="__reactProps$"+dl,Ks="__reactContainer$"+dl,hl="__reactEvents$"+dl,uf="__reactListeners$"+dl,df="__reactHandles$"+dl;function _a(l){var u=l[br];if(u)return u;for(var y=l.parentNode;y;){if(u=y[Ks]||y[br]){if(y=u.alternate,u.child!==null||y!==null&&y.child!==null)for(l=Fm(l);l!==null;){if(y=l[br])return y;l=Fm(l)}return u}l=y,y=l.parentNode}return null}function Io(l){return l=l[br]||l[Ks],!l||l.tag!==5&&l.tag!==6&&l.tag!==13&&l.tag!==3?null:l}function dr(l){if(l.tag===5||l.tag===6)return l.stateNode;throw Error(t(33))}function hf(l){return l[wc]||null}var Um=[],Lr=-1;function ar(l){return{current:l}}function qn(l){0>Lr||(l.current=Um[Lr],Um[Lr]=null,Lr--)}function Gn(l,u){Lr++,Um[Lr]=l.current,l.current=u}var ko={},Hr=ar(ko),hs=ar(!1),Do=ko;function fl(l,u){var y=l.type.contextTypes;if(!y)return ko;var M=l.stateNode;if(M&&M.__reactInternalMemoizedUnmaskedChildContext===u)return M.__reactInternalMemoizedMaskedChildContext;var P={},U;for(U in y)P[U]=u[U];return M&&(l=l.stateNode,l.__reactInternalMemoizedUnmaskedChildContext=u,l.__reactInternalMemoizedMaskedChildContext=P),P}function ts(l){return l=l.childContextTypes,l!=null}function Wu(){qn(hs),qn(Hr)}function Bm(l,u,y){if(Hr.current!==ko)throw Error(t(168));Gn(Hr,u),Gn(hs,y)}function $u(l,u,y){var M=l.stateNode;if(u=u.childContextTypes,typeof M.getChildContext!="function")return y;M=M.getChildContext();for(var P in M)if(!(P in u))throw Error(t(108,me(l)||"Unknown",P));return Z({},y,M)}function pl(l){return l=(l=l.stateNode)&&l.__reactInternalMemoizedMergedChildContext||ko,Do=Hr.current,Gn(Hr,l),Gn(hs,hs.current),!0}function zm(l,u,y){var M=l.stateNode;if(!M)throw Error(t(169));y?(l=$u(l,u,Do),M.__reactInternalMemoizedMergedChildContext=l,qn(hs),qn(Hr),Gn(Hr,l)):qn(hs),Gn(hs,y)}var Vi=null,qu=!1,ff=!1;function Xu(l){Vi===null?Vi=[l]:Vi.push(l)}function vv(l){qu=!0,Xu(l)}function lo(){if(!ff&&Vi!==null){ff=!0;var l=0,u=Sn;try{var y=Vi;for(Sn=1;l<y.length;l++){var M=y[l];do M=M(!0);while(M!==null)}Vi=null,qu=!1}catch(P){throw Vi!==null&&(Vi=Vi.slice(l+1)),Ih(et,lo),P}finally{Sn=u,ff=!1}}return null}var ml=[],Ps=0,pf=null,mf=0,fs=[],Or=0,gl=null,ut=1,xi="";function Lo(l,u){ml[Ps++]=mf,ml[Ps++]=pf,pf=l,mf=u}function Vm(l,u,y){fs[Or++]=ut,fs[Or++]=xi,fs[Or++]=gl,gl=l;var M=ut;l=xi;var P=32-Kt(M)-1;M&=~(1<<P),y+=1;var U=32-Kt(u)+P;if(30<U){var G=P-P%5;U=(M&(1<<G)-1).toString(32),M>>=G,P-=G,ut=1<<32-Kt(u)+P|y<<P|M,xi=U+l}else ut=1<<U|y<<P|M,xi=l}function Hm(l){l.return!==null&&(Lo(l,1),Vm(l,1,0))}function Oo(l){for(;l===pf;)pf=ml[--Ps],ml[Ps]=null,mf=ml[--Ps],ml[Ps]=null;for(;l===gl;)gl=fs[--Or],fs[Or]=null,xi=fs[--Or],fs[Or]=null,ut=fs[--Or],fs[Or]=null}var Gr=null,ps=null,Qn=!1,yi=null;function Gm(l,u){var y=po(5,null,null,0);y.elementType="DELETED",y.stateNode=u,y.return=l,u=l.deletions,u===null?(l.deletions=[y],l.flags|=16):u.push(y)}function Wm(l,u){switch(l.tag){case 5:var y=l.type;return u=u.nodeType!==1||y.toLowerCase()!==u.nodeName.toLowerCase()?null:u,u!==null?(l.stateNode=u,Gr=l,ps=Po(u.firstChild),!0):!1;case 6:return u=l.pendingProps===""||u.nodeType!==3?null:u,u!==null?(l.stateNode=u,Gr=l,ps=null,!0):!1;case 13:return u=u.nodeType!==8?null:u,u!==null?(y=gl!==null?{id:ut,overflow:xi}:null,l.memoizedState={dehydrated:u,treeContext:y,retryLane:1073741824},y=po(18,null,null,0),y.stateNode=u,y.return=l,l.child=y,Gr=l,ps=null,!0):!1;default:return!1}}function gf(l){return(l.mode&1)!==0&&(l.flags&128)===0}function vf(l){if(Qn){var u=ps;if(u){var y=u;if(!Wm(l,u)){if(gf(l))throw Error(t(418));u=Po(y.nextSibling);var M=Gr;u&&Wm(l,u)?Gm(M,y):(l.flags=l.flags&-4097|2,Qn=!1,Gr=l)}}else{if(gf(l))throw Error(t(418));l.flags=l.flags&-4097|2,Qn=!1,Gr=l}}}function xf(l){for(l=l.return;l!==null&&l.tag!==5&&l.tag!==3&&l.tag!==13;)l=l.return;Gr=l}function Sc(l){if(l!==Gr)return!1;if(!Qn)return xf(l),Qn=!0,!1;var u;if((u=l.tag!==3)&&!(u=l.tag!==5)&&(u=l.type,u=u!=="head"&&u!=="body"&&!Lm(l.type,l.memoizedProps)),u&&(u=ps)){if(gf(l))throw $m(),Error(t(418));for(;u;)Gm(l,u),u=Po(u.nextSibling)}if(xf(l),l.tag===13){if(l=l.memoizedState,l=l!==null?l.dehydrated:null,!l)throw Error(t(317));e:{for(l=l.nextSibling,u=0;l;){if(l.nodeType===8){var y=l.data;if(y==="/$"){if(u===0){ps=Po(l.nextSibling);break e}u--}else y!=="$"&&y!=="$!"&&y!=="$?"||u++}l=l.nextSibling}ps=null}}else ps=Gr?Po(l.stateNode.nextSibling):null;return!0}function $m(){for(var l=ps;l;)l=Po(l.nextSibling)}function wa(){ps=Gr=null,Qn=!1}function bc(l){yi===null?yi=[l]:yi.push(l)}var Lw=A.ReactCurrentBatchConfig;function Yu(l,u,y){if(l=y.ref,l!==null&&typeof l!="function"&&typeof l!="object"){if(y._owner){if(y=y._owner,y){if(y.tag!==1)throw Error(t(309));var M=y.stateNode}if(!M)throw Error(t(147,l));var P=M,U=""+l;return u!==null&&u.ref!==null&&typeof u.ref=="function"&&u.ref._stringRef===U?u.ref:(u=function(G){var se=P.refs;G===null?delete se[U]:se[U]=G},u._stringRef=U,u)}if(typeof l!="string")throw Error(t(284));if(!y._owner)throw Error(t(290,l))}return l}function Ku(l,u){throw l=Object.prototype.toString.call(u),Error(t(31,l==="[object Object]"?"object with keys {"+Object.keys(u).join(", ")+"}":l))}function qm(l){var u=l._init;return u(l._payload)}function Xm(l){function u(we,he){if(l){var Me=we.deletions;Me===null?(we.deletions=[he],we.flags|=16):Me.push(he)}}function y(we,he){if(!l)return null;for(;he!==null;)u(we,he),he=he.sibling;return null}function M(we,he){for(we=new Map;he!==null;)he.key!==null?we.set(he.key,he):we.set(he.index,he),he=he.sibling;return we}function P(we,he){return we=Dc(we,he),we.index=0,we.sibling=null,we}function U(we,he,Me){return we.index=Me,l?(Me=we.alternate,Me!==null?(Me=Me.index,Me<he?(we.flags|=2,he):Me):(we.flags|=2,he)):(we.flags|=1048576,he)}function G(we){return l&&we.alternate===null&&(we.flags|=2),we}function se(we,he,Me,at){return he===null||he.tag!==6?(he=e1(Me,we.mode,at),he.return=we,he):(he=P(he,Me),he.return=we,he)}function de(we,he,Me,at){var Ut=Me.type;return Ut===D?Qe(we,he,Me.props.children,at,Me.key):he!==null&&(he.elementType===Ut||typeof Ut=="object"&&Ut!==null&&Ut.$$typeof===ne&&qm(Ut)===he.type)?(at=P(he,Me.props),at.ref=Yu(we,he,Me),at.return=we,at):(at=Bv(Me.type,Me.key,Me.props,null,we.mode,at),at.ref=Yu(we,he,Me),at.return=we,at)}function Pe(we,he,Me,at){return he===null||he.tag!==4||he.stateNode.containerInfo!==Me.containerInfo||he.stateNode.implementation!==Me.implementation?(he=t1(Me,we.mode,at),he.return=we,he):(he=P(he,Me.children||[]),he.return=we,he)}function Qe(we,he,Me,at,Ut){return he===null||he.tag!==7?(he=fd(Me,we.mode,at,Ut),he.return=we,he):(he=P(he,Me),he.return=we,he)}function tt(we,he,Me){if(typeof he=="string"&&he!==""||typeof he=="number")return he=e1(""+he,we.mode,Me),he.return=we,he;if(typeof he=="object"&&he!==null){switch(he.$$typeof){case k:return Me=Bv(he.type,he.key,he.props,null,we.mode,Me),Me.ref=Yu(we,null,he),Me.return=we,Me;case j:return he=t1(he,we.mode,Me),he.return=we,he;case ne:var at=he._init;return tt(we,at(he._payload),Me)}if(qe(he)||q(he))return he=fd(he,we.mode,Me,null),he.return=we,he;Ku(we,he)}return null}function Ke(we,he,Me,at){var Ut=he!==null?he.key:null;if(typeof Me=="string"&&Me!==""||typeof Me=="number")return Ut!==null?null:se(we,he,""+Me,at);if(typeof Me=="object"&&Me!==null){switch(Me.$$typeof){case k:return Me.key===Ut?de(we,he,Me,at):null;case j:return Me.key===Ut?Pe(we,he,Me,at):null;case ne:return Ut=Me._init,Ke(we,he,Ut(Me._payload),at)}if(qe(Me)||q(Me))return Ut!==null?null:Qe(we,he,Me,at,null);Ku(we,Me)}return null}function wt(we,he,Me,at,Ut){if(typeof at=="string"&&at!==""||typeof at=="number")return we=we.get(Me)||null,se(he,we,""+at,Ut);if(typeof at=="object"&&at!==null){switch(at.$$typeof){case k:return we=we.get(at.key===null?Me:at.key)||null,de(he,we,at,Ut);case j:return we=we.get(at.key===null?Me:at.key)||null,Pe(he,we,at,Ut);case ne:var qt=at._init;return wt(we,he,Me,qt(at._payload),Ut)}if(qe(at)||q(at))return we=we.get(Me)||null,Qe(he,we,at,Ut,null);Ku(he,at)}return null}function Pt(we,he,Me,at){for(var Ut=null,qt=null,Xt=he,tn=he=0,is=null;Xt!==null&&tn<Me.length;tn++){Xt.index>tn?(is=Xt,Xt=null):is=Xt.sibling;var Fn=Ke(we,Xt,Me[tn],at);if(Fn===null){Xt===null&&(Xt=is);break}l&&Xt&&Fn.alternate===null&&u(we,Xt),he=U(Fn,he,tn),qt===null?Ut=Fn:qt.sibling=Fn,qt=Fn,Xt=is}if(tn===Me.length)return y(we,Xt),Qn&&Lo(we,tn),Ut;if(Xt===null){for(;tn<Me.length;tn++)Xt=tt(we,Me[tn],at),Xt!==null&&(he=U(Xt,he,tn),qt===null?Ut=Xt:qt.sibling=Xt,qt=Xt);return Qn&&Lo(we,tn),Ut}for(Xt=M(we,Xt);tn<Me.length;tn++)is=wt(Xt,we,tn,Me[tn],at),is!==null&&(l&&is.alternate!==null&&Xt.delete(is.key===null?tn:is.key),he=U(is,he,tn),qt===null?Ut=is:qt.sibling=is,qt=is);return l&&Xt.forEach(function(Lc){return u(we,Lc)}),Qn&&Lo(we,tn),Ut}function Lt(we,he,Me,at){var Ut=q(Me);if(typeof Ut!="function")throw Error(t(150));if(Me=Ut.call(Me),Me==null)throw Error(t(151));for(var qt=Ut=null,Xt=he,tn=he=0,is=null,Fn=Me.next();Xt!==null&&!Fn.done;tn++,Fn=Me.next()){Xt.index>tn?(is=Xt,Xt=null):is=Xt.sibling;var Lc=Ke(we,Xt,Fn.value,at);if(Lc===null){Xt===null&&(Xt=is);break}l&&Xt&&Lc.alternate===null&&u(we,Xt),he=U(Lc,he,tn),qt===null?Ut=Lc:qt.sibling=Lc,qt=Lc,Xt=is}if(Fn.done)return y(we,Xt),Qn&&Lo(we,tn),Ut;if(Xt===null){for(;!Fn.done;tn++,Fn=Me.next())Fn=tt(we,Fn.value,at),Fn!==null&&(he=U(Fn,he,tn),qt===null?Ut=Fn:qt.sibling=Fn,qt=Fn);return Qn&&Lo(we,tn),Ut}for(Xt=M(we,Xt);!Fn.done;tn++,Fn=Me.next())Fn=wt(Xt,we,tn,Fn.value,at),Fn!==null&&(l&&Fn.alternate!==null&&Xt.delete(Fn.key===null?tn:Fn.key),he=U(Fn,he,tn),qt===null?Ut=Fn:qt.sibling=Fn,qt=Fn);return l&&Xt.forEach(function(OL){return u(we,OL)}),Qn&&Lo(we,tn),Ut}function Er(we,he,Me,at){if(typeof Me=="object"&&Me!==null&&Me.type===D&&Me.key===null&&(Me=Me.props.children),typeof Me=="object"&&Me!==null){switch(Me.$$typeof){case k:e:{for(var Ut=Me.key,qt=he;qt!==null;){if(qt.key===Ut){if(Ut=Me.type,Ut===D){if(qt.tag===7){y(we,qt.sibling),he=P(qt,Me.props.children),he.return=we,we=he;break e}}else if(qt.elementType===Ut||typeof Ut=="object"&&Ut!==null&&Ut.$$typeof===ne&&qm(Ut)===qt.type){y(we,qt.sibling),he=P(qt,Me.props),he.ref=Yu(we,qt,Me),he.return=we,we=he;break e}y(we,qt);break}else u(we,qt);qt=qt.sibling}Me.type===D?(he=fd(Me.props.children,we.mode,at,Me.key),he.return=we,we=he):(at=Bv(Me.type,Me.key,Me.props,null,we.mode,at),at.ref=Yu(we,he,Me),at.return=we,we=at)}return G(we);case j:e:{for(qt=Me.key;he!==null;){if(he.key===qt)if(he.tag===4&&he.stateNode.containerInfo===Me.containerInfo&&he.stateNode.implementation===Me.implementation){y(we,he.sibling),he=P(he,Me.children||[]),he.return=we,we=he;break e}else{y(we,he);break}else u(we,he);he=he.sibling}he=t1(Me,we.mode,at),he.return=we,we=he}return G(we);case ne:return qt=Me._init,Er(we,he,qt(Me._payload),at)}if(qe(Me))return Pt(we,he,Me,at);if(q(Me))return Lt(we,he,Me,at);Ku(we,Me)}return typeof Me=="string"&&Me!==""||typeof Me=="number"?(Me=""+Me,he!==null&&he.tag===6?(y(we,he.sibling),he=P(he,Me),he.return=we,we=he):(y(we,he),he=e1(Me,we.mode,at),he.return=we,we=he),G(we)):y(we,he)}return Er}var vl=Xm(!0),Qu=Xm(!1),xl=ar(null),yl=null,jo=null,Ec=null;function _l(){Ec=jo=yl=null}function Ju(l){var u=xl.current;qn(xl),l._currentValue=u}function Zu(l,u,y){for(;l!==null;){var M=l.alternate;if((l.childLanes&u)!==u?(l.childLanes|=u,M!==null&&(M.childLanes|=u)):M!==null&&(M.childLanes&u)!==u&&(M.childLanes|=u),l===y)break;l=l.return}}function Sa(l,u){yl=l,Ec=jo=null,l=l.dependencies,l!==null&&l.firstContext!==null&&((l.lanes&u)!==0&&(hn=!0),l.firstContext=null)}function Qs(l){var u=l._currentValue;if(Ec!==l)if(l={context:l,memoizedValue:u,next:null},jo===null){if(yl===null)throw Error(t(308));jo=l,yl.dependencies={lanes:0,firstContext:l}}else jo=jo.next=l;return u}var Fo=null;function Ym(l){Fo===null?Fo=[l]:Fo.push(l)}function ed(l,u,y,M){var P=u.interleaved;return P===null?(y.next=y,Ym(u)):(y.next=P.next,P.next=y),u.interleaved=y,Hi(l,M)}function Hi(l,u){l.lanes|=u;var y=l.alternate;for(y!==null&&(y.lanes|=u),y=l,l=l.return;l!==null;)l.childLanes|=u,y=l.alternate,y!==null&&(y.childLanes|=u),y=l,l=l.return;return y.tag===3?y.stateNode:null}var zn=!1;function ln(l){l.updateQueue={baseState:l.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function hr(l,u){l=l.updateQueue,u.updateQueue===l&&(u.updateQueue={baseState:l.baseState,firstBaseUpdate:l.firstBaseUpdate,lastBaseUpdate:l.lastBaseUpdate,shared:l.shared,effects:l.effects})}function Vn(l,u){return{eventTime:l,lane:u,tag:0,payload:null,callback:null,next:null}}function er(l,u,y){var M=l.updateQueue;if(M===null)return null;if(M=M.shared,(Dn&2)!==0){var P=M.pending;return P===null?u.next=u:(u.next=P.next,P.next=u),M.pending=u,Hi(l,y)}return P=M.interleaved,P===null?(u.next=u,Ym(M)):(u.next=P.next,P.next=u),M.interleaved=u,Hi(l,y)}function ns(l,u,y){if(u=u.updateQueue,u!==null&&(u=u.shared,(y&4194240)!==0)){var M=u.lanes;M&=l.pendingLanes,y|=M,u.lanes=y,ur(l,y)}}function wl(l,u){var y=l.updateQueue,M=l.alternate;if(M!==null&&(M=M.updateQueue,y===M)){var P=null,U=null;if(y=y.firstBaseUpdate,y!==null){do{var G={eventTime:y.eventTime,lane:y.lane,tag:y.tag,payload:y.payload,callback:y.callback,next:null};U===null?P=U=G:U=U.next=G,y=y.next}while(y!==null);U===null?P=U=u:U=U.next=u}else P=U=u;y={baseState:M.baseState,firstBaseUpdate:P,lastBaseUpdate:U,shared:M.shared,effects:M.effects},l.updateQueue=y;return}l=y.lastBaseUpdate,l===null?y.firstBaseUpdate=u:l.next=u,y.lastBaseUpdate=u}function lr(l,u,y,M){var P=l.updateQueue;zn=!1;var U=P.firstBaseUpdate,G=P.lastBaseUpdate,se=P.shared.pending;if(se!==null){P.shared.pending=null;var de=se,Pe=de.next;de.next=null,G===null?U=Pe:G.next=Pe,G=de;var Qe=l.alternate;Qe!==null&&(Qe=Qe.updateQueue,se=Qe.lastBaseUpdate,se!==G&&(se===null?Qe.firstBaseUpdate=Pe:se.next=Pe,Qe.lastBaseUpdate=de))}if(U!==null){var tt=P.baseState;G=0,Qe=Pe=de=null,se=U;do{var Ke=se.lane,wt=se.eventTime;if((M&Ke)===Ke){Qe!==null&&(Qe=Qe.next={eventTime:wt,lane:0,tag:se.tag,payload:se.payload,callback:se.callback,next:null});e:{var Pt=l,Lt=se;switch(Ke=u,wt=y,Lt.tag){case 1:if(Pt=Lt.payload,typeof Pt=="function"){tt=Pt.call(wt,tt,Ke);break e}tt=Pt;break e;case 3:Pt.flags=Pt.flags&-65537|128;case 0:if(Pt=Lt.payload,Ke=typeof Pt=="function"?Pt.call(wt,tt,Ke):Pt,Ke==null)break e;tt=Z({},tt,Ke);break e;case 2:zn=!0}}se.callback!==null&&se.lane!==0&&(l.flags|=64,Ke=P.effects,Ke===null?P.effects=[se]:Ke.push(se))}else wt={eventTime:wt,lane:Ke,tag:se.tag,payload:se.payload,callback:se.callback,next:null},Qe===null?(Pe=Qe=wt,de=tt):Qe=Qe.next=wt,G|=Ke;if(se=se.next,se===null){if(se=P.shared.pending,se===null)break;Ke=se,se=Ke.next,Ke.next=null,P.lastBaseUpdate=Ke,P.shared.pending=null}}while(!0);if(Qe===null&&(de=tt),P.baseState=de,P.firstBaseUpdate=Pe,P.lastBaseUpdate=Qe,u=P.shared.interleaved,u!==null){P=u;do G|=P.lane,P=P.next;while(P!==u)}else U===null&&(P.shared.lanes=0);cd|=G,l.lanes=G,l.memoizedState=tt}}function Mc(l,u,y){if(l=u.effects,u.effects=null,l!==null)for(u=0;u<l.length;u++){var M=l[u],P=M.callback;if(P!==null){if(M.callback=null,M=y,typeof P!="function")throw Error(t(191,P));P.call(M)}}}var co={},Js=ar(co),Sl=ar(co),Uo=ar(co);function mr(l){if(l===co)throw Error(t(174));return l}function td(l,u){switch(Gn(Uo,u),Gn(Sl,l),Gn(Js,co),l=u.nodeType,l){case 9:case 11:u=(u=u.documentElement)?u.namespaceURI:Ue(null,"");break;default:l=l===8?u.parentNode:u,u=l.namespaceURI||null,l=l.tagName,u=Ue(u,l)}qn(Js),Gn(Js,u)}function ba(){qn(Js),qn(Sl),qn(Uo)}function bl(l){mr(Uo.current);var u=mr(Js.current),y=Ue(u,l.type);u!==y&&(Gn(Sl,l),Gn(Js,y))}function Tc(l){Sl.current===l&&(qn(Js),qn(Sl))}var Jn=ar(0);function Gi(l){for(var u=l;u!==null;){if(u.tag===13){var y=u.memoizedState;if(y!==null&&(y=y.dehydrated,y===null||y.data==="$?"||y.data==="$!"))return u}else if(u.tag===19&&u.memoizedProps.revealOrder!==void 0){if((u.flags&128)!==0)return u}else if(u.child!==null){u.child.return=u,u=u.child;continue}if(u===l)break;for(;u.sibling===null;){if(u.return===null||u.return===l)return null;u=u.return}u.sibling.return=u.return,u=u.sibling}return null}var Cc=[];function uo(){for(var l=0;l<Cc.length;l++)Cc[l]._workInProgressVersionPrimary=null;Cc.length=0}var El=A.ReactCurrentDispatcher,Ml=A.ReactCurrentBatchConfig,Bo=0,Xn=null,cr=null,In=null,Wi=!1,rs=!1,Ea=0,Is=0;function Wr(){throw Error(t(321))}function nd(l,u){if(u===null)return!1;for(var y=0;y<u.length&&y<l.length;y++)if(!Xs(l[y],u[y]))return!1;return!0}function rd(l,u,y,M,P,U){if(Bo=U,Xn=u,u.memoizedState=null,u.updateQueue=null,u.lanes=0,El.current=l===null||l.memoizedState===null?Ev:Mv,l=y(M,P),rs){U=0;do{if(rs=!1,Ea=0,25<=U)throw Error(t(301));U+=1,In=cr=null,u.updateQueue=null,El.current=Tv,l=y(M,P)}while(rs)}if(El.current=Mf,u=cr!==null&&cr.next!==null,Bo=0,In=cr=Xn=null,Wi=!1,u)throw Error(t(300));return l}function Km(){var l=Ea!==0;return Ea=0,l}function $r(){var l={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return In===null?Xn.memoizedState=In=l:In=In.next=l,In}function Zs(){if(cr===null){var l=Xn.alternate;l=l!==null?l.memoizedState:null}else l=cr.next;var u=In===null?Xn.memoizedState:In.next;if(u!==null)In=u,cr=l;else{if(l===null)throw Error(t(310));cr=l,l={memoizedState:cr.memoizedState,baseState:cr.baseState,baseQueue:cr.baseQueue,queue:cr.queue,next:null},In===null?Xn.memoizedState=In=l:In=In.next=l}return In}function Ac(l,u){return typeof u=="function"?u(l):u}function sd(l){var u=Zs(),y=u.queue;if(y===null)throw Error(t(311));y.lastRenderedReducer=l;var M=cr,P=M.baseQueue,U=y.pending;if(U!==null){if(P!==null){var G=P.next;P.next=U.next,U.next=G}M.baseQueue=P=U,y.pending=null}if(P!==null){U=P.next,M=M.baseState;var se=G=null,de=null,Pe=U;do{var Qe=Pe.lane;if((Bo&Qe)===Qe)de!==null&&(de=de.next={lane:0,action:Pe.action,hasEagerState:Pe.hasEagerState,eagerState:Pe.eagerState,next:null}),M=Pe.hasEagerState?Pe.eagerState:l(M,Pe.action);else{var tt={lane:Qe,action:Pe.action,hasEagerState:Pe.hasEagerState,eagerState:Pe.eagerState,next:null};de===null?(se=de=tt,G=M):de=de.next=tt,Xn.lanes|=Qe,cd|=Qe}Pe=Pe.next}while(Pe!==null&&Pe!==U);de===null?G=M:de.next=se,Xs(M,u.memoizedState)||(hn=!0),u.memoizedState=M,u.baseState=G,u.baseQueue=de,y.lastRenderedState=M}if(l=y.interleaved,l!==null){P=l;do U=P.lane,Xn.lanes|=U,cd|=U,P=P.next;while(P!==l)}else P===null&&(y.lanes=0);return[u.memoizedState,y.dispatch]}function zo(l){var u=Zs(),y=u.queue;if(y===null)throw Error(t(311));y.lastRenderedReducer=l;var M=y.dispatch,P=y.pending,U=u.memoizedState;if(P!==null){y.pending=null;var G=P=P.next;do U=l(U,G.action),G=G.next;while(G!==P);Xs(U,u.memoizedState)||(hn=!0),u.memoizedState=U,u.baseQueue===null&&(u.baseState=U),y.lastRenderedState=U}return[U,M]}function Qm(){}function Jm(l,u){var y=Xn,M=Zs(),P=u(),U=!Xs(M.memoizedState,P);if(U&&(M.memoizedState=P,hn=!0),M=M.queue,tg(xv.bind(null,y,M,l),[l]),M.getSnapshot!==u||U||In!==null&&In.memoizedState.tag&1){if(y.flags|=2048,$i(9,id.bind(null,y,M,P,u),void 0,null),ss===null)throw Error(t(349));(Bo&30)!==0||yf(y,u,P)}return P}function yf(l,u,y){l.flags|=16384,l={getSnapshot:u,value:y},u=Xn.updateQueue,u===null?(u={lastEffect:null,stores:null},Xn.updateQueue=u,u.stores=[l]):(y=u.stores,y===null?u.stores=[l]:y.push(l))}function id(l,u,y,M){u.value=y,u.getSnapshot=M,yv(u)&&Zm(l)}function xv(l,u,y){return y(function(){yv(u)&&Zm(l)})}function yv(l){var u=l.getSnapshot;l=l.value;try{var y=u();return!Xs(l,y)}catch{return!0}}function Zm(l){var u=Hi(l,1);u!==null&&$o(u,l,1,-1)}function eg(l){var u=$r();return typeof l=="function"&&(l=l()),u.memoizedState=u.baseState=l,l={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Ac,lastRenderedState:l},u.queue=l,l=l.dispatch=Tl.bind(null,Xn,l),[u.memoizedState,l]}function $i(l,u,y,M){return l={tag:l,create:u,destroy:y,deps:M,next:null},u=Xn.updateQueue,u===null?(u={lastEffect:null,stores:null},Xn.updateQueue=u,u.lastEffect=l.next=l):(y=u.lastEffect,y===null?u.lastEffect=l.next=l:(M=y.next,y.next=l,l.next=M,u.lastEffect=l)),l}function _v(){return Zs().memoizedState}function ho(l,u,y,M){var P=$r();Xn.flags|=l,P.memoizedState=$i(1|u,y,void 0,M===void 0?null:M)}function od(l,u,y,M){var P=Zs();M=M===void 0?null:M;var U=void 0;if(cr!==null){var G=cr.memoizedState;if(U=G.destroy,M!==null&&nd(M,G.deps)){P.memoizedState=$i(u,y,U,M);return}}Xn.flags|=l,P.memoizedState=$i(1|u,y,U,M)}function ms(l,u){return ho(8390656,8,l,u)}function tg(l,u){return od(2048,8,l,u)}function ng(l,u){return od(4,2,l,u)}function wv(l,u){return od(4,4,l,u)}function Sv(l,u){if(typeof u=="function")return l=l(),u(l),function(){u(null)};if(u!=null)return l=l(),u.current=l,function(){u.current=null}}function rg(l,u,y){return y=y!=null?y.concat([l]):null,od(4,4,Sv.bind(null,u,l),y)}function _f(){}function bv(l,u){var y=Zs();u=u===void 0?null:u;var M=y.memoizedState;return M!==null&&u!==null&&nd(u,M[1])?M[0]:(y.memoizedState=[l,u],l)}function ei(l,u){var y=Zs();u=u===void 0?null:u;var M=y.memoizedState;return M!==null&&u!==null&&nd(u,M[1])?M[0]:(l=l(),y.memoizedState=[l,u],l)}function wf(l,u,y){return(Bo&21)===0?(l.baseState&&(l.baseState=!1,hn=!0),l.memoizedState=y):(Xs(y,u)||(y=wn(),Xn.lanes|=y,cd|=y,l.baseState=!0),u)}function Ow(l,u){var y=Sn;Sn=y!==0&&4>y?y:4,l(!0);var M=Ml.transition;Ml.transition={};try{l(!1),u()}finally{Sn=y,Ml.transition=M}}function Vo(){return Zs().memoizedState}function Sf(l,u,y){var M=Ic(l);if(y={lane:M,action:y,hasEagerState:!1,eagerState:null,next:null},ad(l))bf(u,y);else if(y=ed(l,u,y,M),y!==null){var P=ni();$o(y,l,M,P),Ef(y,u,M)}}function Tl(l,u,y){var M=Ic(l),P={lane:M,action:y,hasEagerState:!1,eagerState:null,next:null};if(ad(l))bf(u,P);else{var U=l.alternate;if(l.lanes===0&&(U===null||U.lanes===0)&&(U=u.lastRenderedReducer,U!==null))try{var G=u.lastRenderedState,se=U(G,y);if(P.hasEagerState=!0,P.eagerState=se,Xs(se,G)){var de=u.interleaved;de===null?(P.next=P,Ym(u)):(P.next=de.next,de.next=P),u.interleaved=P;return}}catch{}finally{}y=ed(l,u,P,M),y!==null&&(P=ni(),$o(y,l,M,P),Ef(y,u,M))}}function ad(l){var u=l.alternate;return l===Xn||u!==null&&u===Xn}function bf(l,u){rs=Wi=!0;var y=l.pending;y===null?u.next=u:(u.next=y.next,y.next=u),l.pending=u}function Ef(l,u,y){if((y&4194240)!==0){var M=u.lanes;M&=l.pendingLanes,y|=M,u.lanes=y,ur(l,y)}}var Mf={readContext:Qs,useCallback:Wr,useContext:Wr,useEffect:Wr,useImperativeHandle:Wr,useInsertionEffect:Wr,useLayoutEffect:Wr,useMemo:Wr,useReducer:Wr,useRef:Wr,useState:Wr,useDebugValue:Wr,useDeferredValue:Wr,useTransition:Wr,useMutableSource:Wr,useSyncExternalStore:Wr,useId:Wr,unstable_isNewReconciler:!1},Ev={readContext:Qs,useCallback:function(l,u){return $r().memoizedState=[l,u===void 0?null:u],l},useContext:Qs,useEffect:ms,useImperativeHandle:function(l,u,y){return y=y!=null?y.concat([l]):null,ho(4194308,4,Sv.bind(null,u,l),y)},useLayoutEffect:function(l,u){return ho(4194308,4,l,u)},useInsertionEffect:function(l,u){return ho(4,2,l,u)},useMemo:function(l,u){var y=$r();return u=u===void 0?null:u,l=l(),y.memoizedState=[l,u],l},useReducer:function(l,u,y){var M=$r();return u=y!==void 0?y(u):u,M.memoizedState=M.baseState=u,l={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:l,lastRenderedState:u},M.queue=l,l=l.dispatch=Sf.bind(null,Xn,l),[M.memoizedState,l]},useRef:function(l){var u=$r();return l={current:l},u.memoizedState=l},useState:eg,useDebugValue:_f,useDeferredValue:function(l){return $r().memoizedState=l},useTransition:function(){var l=eg(!1),u=l[0];return l=Ow.bind(null,l[1]),$r().memoizedState=l,[u,l]},useMutableSource:function(){},useSyncExternalStore:function(l,u,y){var M=Xn,P=$r();if(Qn){if(y===void 0)throw Error(t(407));y=y()}else{if(y=u(),ss===null)throw Error(t(349));(Bo&30)!==0||yf(M,u,y)}P.memoizedState=y;var U={value:y,getSnapshot:u};return P.queue=U,ms(xv.bind(null,M,U,l),[l]),M.flags|=2048,$i(9,id.bind(null,M,U,y,u),void 0,null),y},useId:function(){var l=$r(),u=ss.identifierPrefix;if(Qn){var y=xi,M=ut;y=(M&~(1<<32-Kt(M)-1)).toString(32)+y,u=":"+u+"R"+y,y=Ea++,0<y&&(u+="H"+y.toString(32)),u+=":"}else y=Is++,u=":"+u+"r"+y.toString(32)+":";return l.memoizedState=u},unstable_isNewReconciler:!1},Mv={readContext:Qs,useCallback:bv,useContext:Qs,useEffect:tg,useImperativeHandle:rg,useInsertionEffect:ng,useLayoutEffect:wv,useMemo:ei,useReducer:sd,useRef:_v,useState:function(){return sd(Ac)},useDebugValue:_f,useDeferredValue:function(l){var u=Zs();return wf(u,cr.memoizedState,l)},useTransition:function(){var l=sd(Ac)[0],u=Zs().memoizedState;return[l,u]},useMutableSource:Qm,useSyncExternalStore:Jm,useId:Vo,unstable_isNewReconciler:!1},Tv={readContext:Qs,useCallback:bv,useContext:Qs,useEffect:tg,useImperativeHandle:rg,useInsertionEffect:ng,useLayoutEffect:wv,useMemo:ei,useReducer:zo,useRef:_v,useState:function(){return zo(Ac)},useDebugValue:_f,useDeferredValue:function(l){var u=Zs();return cr===null?u.memoizedState=l:wf(u,cr.memoizedState,l)},useTransition:function(){var l=zo(Ac)[0],u=Zs().memoizedState;return[l,u]},useMutableSource:Qm,useSyncExternalStore:Jm,useId:Vo,unstable_isNewReconciler:!1};function _i(l,u){if(l&&l.defaultProps){u=Z({},u),l=l.defaultProps;for(var y in l)u[y]===void 0&&(u[y]=l[y]);return u}return u}function ld(l,u,y,M){u=l.memoizedState,y=y(M,u),y=y==null?u:Z({},u,y),l.memoizedState=y,l.lanes===0&&(l.updateQueue.baseState=y)}var Tf={isMounted:function(l){return(l=l._reactInternals)?no(l)===l:!1},enqueueSetState:function(l,u,y){l=l._reactInternals;var M=ni(),P=Ic(l),U=Vn(M,P);U.payload=u,y!=null&&(U.callback=y),u=er(l,U,P),u!==null&&($o(u,l,P,M),ns(u,l,P))},enqueueReplaceState:function(l,u,y){l=l._reactInternals;var M=ni(),P=Ic(l),U=Vn(M,P);U.tag=1,U.payload=u,y!=null&&(U.callback=y),u=er(l,U,P),u!==null&&($o(u,l,P,M),ns(u,l,P))},enqueueForceUpdate:function(l,u){l=l._reactInternals;var y=ni(),M=Ic(l),P=Vn(y,M);P.tag=2,u!=null&&(P.callback=u),u=er(l,P,M),u!==null&&($o(u,l,M,y),ns(u,l,M))}};function Cv(l,u,y,M,P,U,G){return l=l.stateNode,typeof l.shouldComponentUpdate=="function"?l.shouldComponentUpdate(M,U,G):u.prototype&&u.prototype.isPureReactComponent?!al(y,M)||!al(P,U):!0}function p(l,u,y){var M=!1,P=ko,U=u.contextType;return typeof U=="object"&&U!==null?U=Qs(U):(P=ts(u)?Do:Hr.current,M=u.contextTypes,U=(M=M!=null)?fl(l,P):ko),u=new u(y,U),l.memoizedState=u.state!==null&&u.state!==void 0?u.state:null,u.updater=Tf,l.stateNode=u,u._reactInternals=l,M&&(l=l.stateNode,l.__reactInternalMemoizedUnmaskedChildContext=P,l.__reactInternalMemoizedMaskedChildContext=U),u}function g(l,u,y,M){l=u.state,typeof u.componentWillReceiveProps=="function"&&u.componentWillReceiveProps(y,M),typeof u.UNSAFE_componentWillReceiveProps=="function"&&u.UNSAFE_componentWillReceiveProps(y,M),u.state!==l&&Tf.enqueueReplaceState(u,u.state,null)}function E(l,u,y,M){var P=l.stateNode;P.props=y,P.state=l.memoizedState,P.refs={},ln(l);var U=u.contextType;typeof U=="object"&&U!==null?P.context=Qs(U):(U=ts(u)?Do:Hr.current,P.context=fl(l,U)),P.state=l.memoizedState,U=u.getDerivedStateFromProps,typeof U=="function"&&(ld(l,u,U,y),P.state=l.memoizedState),typeof u.getDerivedStateFromProps=="function"||typeof P.getSnapshotBeforeUpdate=="function"||typeof P.UNSAFE_componentWillMount!="function"&&typeof P.componentWillMount!="function"||(u=P.state,typeof P.componentWillMount=="function"&&P.componentWillMount(),typeof P.UNSAFE_componentWillMount=="function"&&P.UNSAFE_componentWillMount(),u!==P.state&&Tf.enqueueReplaceState(P,P.state,null),lr(l,y,P,M),P.state=l.memoizedState),typeof P.componentDidMount=="function"&&(l.flags|=4194308)}function N(l,u){try{var y="",M=u;do y+=Ee(M),M=M.return;while(M);var P=y}catch(U){P=`
Error generating stack: `+U.message+`
`+U.stack}return{value:l,source:u,stack:P,digest:null}}function F(l,u,y){return{value:l,source:null,stack:y??null,digest:u??null}}function z(l,u){try{console.error(u.value)}catch(y){setTimeout(function(){throw y})}}var te=typeof WeakMap=="function"?WeakMap:Map;function pe(l,u,y){y=Vn(-1,y),y.tag=3,y.payload={element:null};var M=u.value;return y.callback=function(){Dv||(Dv=!0,$w=M),z(l,u)},y}function Oe(l,u,y){y=Vn(-1,y),y.tag=3;var M=l.type.getDerivedStateFromError;if(typeof M=="function"){var P=u.value;y.payload=function(){return M(P)},y.callback=function(){z(l,u)}}var U=l.stateNode;return U!==null&&typeof U.componentDidCatch=="function"&&(y.callback=function(){z(l,u),typeof M!="function"&&(Nc===null?Nc=new Set([this]):Nc.add(this));var G=u.stack;this.componentDidCatch(u.value,{componentStack:G!==null?G:""})}),y}function ot(l,u,y){var M=l.pingCache;if(M===null){M=l.pingCache=new te;var P=new Set;M.set(u,P)}else P=M.get(u),P===void 0&&(P=new Set,M.set(u,P));P.has(y)||(P.add(y),l=ML.bind(null,l,u,y),u.then(l,l))}function Tt(l){do{var u;if((u=l.tag===13)&&(u=l.memoizedState,u=u!==null?u.dehydrated!==null:!0),u)return l;l=l.return}while(l!==null);return null}function rn(l,u,y,M,P){return(l.mode&1)===0?(l===u?l.flags|=65536:(l.flags|=128,y.flags|=131072,y.flags&=-52805,y.tag===1&&(y.alternate===null?y.tag=17:(u=Vn(-1,1),u.tag=2,er(y,u,1))),y.lanes|=1),l):(l.flags|=65536,l.lanes=P,l)}var Gt=A.ReactCurrentOwner,hn=!1;function yt(l,u,y,M){u.child=l===null?Qu(u,null,y,M):vl(u,l.child,y,M)}function qr(l,u,y,M,P){y=y.render;var U=u.ref;return Sa(u,P),M=rd(l,u,y,M,U,P),y=Km(),l!==null&&!hn?(u.updateQueue=l.updateQueue,u.flags&=-2053,l.lanes&=~P,Cl(l,u,P)):(Qn&&y&&Hm(u),u.flags|=1,yt(l,u,M,P),u.child)}function ti(l,u,y,M,P){if(l===null){var U=y.type;return typeof U=="function"&&!Zw(U)&&U.defaultProps===void 0&&y.compare===null&&y.defaultProps===void 0?(u.tag=15,u.type=U,Te(l,u,U,M,P)):(l=Bv(y.type,null,M,u,u.mode,P),l.ref=u.ref,l.return=u,u.child=l)}if(U=l.child,(l.lanes&P)===0){var G=U.memoizedProps;if(y=y.compare,y=y!==null?y:al,y(G,M)&&l.ref===u.ref)return Cl(l,u,P)}return u.flags|=1,l=Dc(U,M),l.ref=u.ref,l.return=u,u.child=l}function Te(l,u,y,M,P){if(l!==null){var U=l.memoizedProps;if(al(U,M)&&l.ref===u.ref)if(hn=!1,u.pendingProps=M=U,(l.lanes&P)!==0)(l.flags&131072)!==0&&(hn=!0);else return u.lanes=l.lanes,Cl(l,u,P)}return gt(l,u,y,M,P)}function ge(l,u,y){var M=u.pendingProps,P=M.children,U=l!==null?l.memoizedState:null;if(M.mode==="hidden")if((u.mode&1)===0)u.memoizedState={baseLanes:0,cachePool:null,transitions:null},Gn(Af,qi),qi|=y;else{if((y&1073741824)===0)return l=U!==null?U.baseLanes|y:y,u.lanes=u.childLanes=1073741824,u.memoizedState={baseLanes:l,cachePool:null,transitions:null},u.updateQueue=null,Gn(Af,qi),qi|=l,null;u.memoizedState={baseLanes:0,cachePool:null,transitions:null},M=U!==null?U.baseLanes:y,Gn(Af,qi),qi|=M}else U!==null?(M=U.baseLanes|y,u.memoizedState=null):M=y,Gn(Af,qi),qi|=M;return yt(l,u,P,y),u.child}function De(l,u){var y=u.ref;(l===null&&y!==null||l!==null&&l.ref!==y)&&(u.flags|=512,u.flags|=2097152)}function gt(l,u,y,M,P){var U=ts(y)?Do:Hr.current;return U=fl(u,U),Sa(u,P),y=rd(l,u,y,M,U,P),M=Km(),l!==null&&!hn?(u.updateQueue=l.updateQueue,u.flags&=-2053,l.lanes&=~P,Cl(l,u,P)):(Qn&&M&&Hm(u),u.flags|=1,yt(l,u,y,P),u.child)}function Ot(l,u,y,M,P){if(ts(y)){var U=!0;pl(u)}else U=!1;if(Sa(u,P),u.stateNode===null)Rv(l,u),p(u,y,M),E(u,y,M,P),M=!0;else if(l===null){var G=u.stateNode,se=u.memoizedProps;G.props=se;var de=G.context,Pe=y.contextType;typeof Pe=="object"&&Pe!==null?Pe=Qs(Pe):(Pe=ts(y)?Do:Hr.current,Pe=fl(u,Pe));var Qe=y.getDerivedStateFromProps,tt=typeof Qe=="function"||typeof G.getSnapshotBeforeUpdate=="function";tt||typeof G.UNSAFE_componentWillReceiveProps!="function"&&typeof G.componentWillReceiveProps!="function"||(se!==M||de!==Pe)&&g(u,G,M,Pe),zn=!1;var Ke=u.memoizedState;G.state=Ke,lr(u,M,G,P),de=u.memoizedState,se!==M||Ke!==de||hs.current||zn?(typeof Qe=="function"&&(ld(u,y,Qe,M),de=u.memoizedState),(se=zn||Cv(u,y,se,M,Ke,de,Pe))?(tt||typeof G.UNSAFE_componentWillMount!="function"&&typeof G.componentWillMount!="function"||(typeof G.componentWillMount=="function"&&G.componentWillMount(),typeof G.UNSAFE_componentWillMount=="function"&&G.UNSAFE_componentWillMount()),typeof G.componentDidMount=="function"&&(u.flags|=4194308)):(typeof G.componentDidMount=="function"&&(u.flags|=4194308),u.memoizedProps=M,u.memoizedState=de),G.props=M,G.state=de,G.context=Pe,M=se):(typeof G.componentDidMount=="function"&&(u.flags|=4194308),M=!1)}else{G=u.stateNode,hr(l,u),se=u.memoizedProps,Pe=u.type===u.elementType?se:_i(u.type,se),G.props=Pe,tt=u.pendingProps,Ke=G.context,de=y.contextType,typeof de=="object"&&de!==null?de=Qs(de):(de=ts(y)?Do:Hr.current,de=fl(u,de));var wt=y.getDerivedStateFromProps;(Qe=typeof wt=="function"||typeof G.getSnapshotBeforeUpdate=="function")||typeof G.UNSAFE_componentWillReceiveProps!="function"&&typeof G.componentWillReceiveProps!="function"||(se!==tt||Ke!==de)&&g(u,G,M,de),zn=!1,Ke=u.memoizedState,G.state=Ke,lr(u,M,G,P);var Pt=u.memoizedState;se!==tt||Ke!==Pt||hs.current||zn?(typeof wt=="function"&&(ld(u,y,wt,M),Pt=u.memoizedState),(Pe=zn||Cv(u,y,Pe,M,Ke,Pt,de)||!1)?(Qe||typeof G.UNSAFE_componentWillUpdate!="function"&&typeof G.componentWillUpdate!="function"||(typeof G.componentWillUpdate=="function"&&G.componentWillUpdate(M,Pt,de),typeof G.UNSAFE_componentWillUpdate=="function"&&G.UNSAFE_componentWillUpdate(M,Pt,de)),typeof G.componentDidUpdate=="function"&&(u.flags|=4),typeof G.getSnapshotBeforeUpdate=="function"&&(u.flags|=1024)):(typeof G.componentDidUpdate!="function"||se===l.memoizedProps&&Ke===l.memoizedState||(u.flags|=4),typeof G.getSnapshotBeforeUpdate!="function"||se===l.memoizedProps&&Ke===l.memoizedState||(u.flags|=1024),u.memoizedProps=M,u.memoizedState=Pt),G.props=M,G.state=Pt,G.context=de,M=Pe):(typeof G.componentDidUpdate!="function"||se===l.memoizedProps&&Ke===l.memoizedState||(u.flags|=4),typeof G.getSnapshotBeforeUpdate!="function"||se===l.memoizedProps&&Ke===l.memoizedState||(u.flags|=1024),M=!1)}return on(l,u,y,M,U,P)}function on(l,u,y,M,P,U){De(l,u);var G=(u.flags&128)!==0;if(!M&&!G)return P&&zm(u,y,!1),Cl(l,u,U);M=u.stateNode,Gt.current=u;var se=G&&typeof y.getDerivedStateFromError!="function"?null:M.render();return u.flags|=1,l!==null&&G?(u.child=vl(u,l.child,null,U),u.child=vl(u,null,se,U)):yt(l,u,se,U),u.memoizedState=M.state,P&&zm(u,y,!0),u.child}function sn(l){var u=l.stateNode;u.pendingContext?Bm(l,u.pendingContext,u.pendingContext!==u.context):u.context&&Bm(l,u.context,!1),td(l,u.containerInfo)}function Rn(l,u,y,M,P){return wa(),bc(P),u.flags|=256,yt(l,u,y,M),u.child}var gr={dehydrated:null,treeContext:null,retryLane:0};function Tn(l){return{baseLanes:l,cachePool:null,transitions:null}}function Ho(l,u,y){var M=u.pendingProps,P=Jn.current,U=!1,G=(u.flags&128)!==0,se;if((se=G)||(se=l!==null&&l.memoizedState===null?!1:(P&2)!==0),se?(U=!0,u.flags&=-129):(l===null||l.memoizedState!==null)&&(P|=1),Gn(Jn,P&1),l===null)return vf(u),l=u.memoizedState,l!==null&&(l=l.dehydrated,l!==null)?((u.mode&1)===0?u.lanes=1:l.data==="$!"?u.lanes=8:u.lanes=1073741824,null):(G=M.children,l=M.fallback,U?(M=u.mode,U=u.child,G={mode:"hidden",children:G},(M&1)===0&&U!==null?(U.childLanes=0,U.pendingProps=G):U=zv(G,M,0,null),l=fd(l,M,y,null),U.return=u,l.return=u,U.sibling=l,u.child=U,u.child.memoizedState=Tn(y),u.memoizedState=gr,l):sg(u,G));if(P=l.memoizedState,P!==null&&(se=P.dehydrated,se!==null))return fL(l,u,G,M,se,P,y);if(U){U=M.fallback,G=u.mode,P=l.child,se=P.sibling;var de={mode:"hidden",children:M.children};return(G&1)===0&&u.child!==P?(M=u.child,M.childLanes=0,M.pendingProps=de,u.deletions=null):(M=Dc(P,de),M.subtreeFlags=P.subtreeFlags&14680064),se!==null?U=Dc(se,U):(U=fd(U,G,y,null),U.flags|=2),U.return=u,M.return=u,M.sibling=U,u.child=M,M=U,U=u.child,G=l.child.memoizedState,G=G===null?Tn(y):{baseLanes:G.baseLanes|y,cachePool:null,transitions:G.transitions},U.memoizedState=G,U.childLanes=l.childLanes&~y,u.memoizedState=gr,M}return U=l.child,l=U.sibling,M=Dc(U,{mode:"visible",children:M.children}),(u.mode&1)===0&&(M.lanes=y),M.return=u,M.sibling=null,l!==null&&(y=u.deletions,y===null?(u.deletions=[l],u.flags|=16):y.push(l)),u.child=M,u.memoizedState=null,M}function sg(l,u){return u=zv({mode:"visible",children:u},l.mode,0,null),u.return=l,l.child=u}function Av(l,u,y,M){return M!==null&&bc(M),vl(u,l.child,null,y),l=sg(u,u.pendingProps.children),l.flags|=2,u.memoizedState=null,l}function fL(l,u,y,M,P,U,G){if(y)return u.flags&256?(u.flags&=-257,M=F(Error(t(422))),Av(l,u,G,M)):u.memoizedState!==null?(u.child=l.child,u.flags|=128,null):(U=M.fallback,P=u.mode,M=zv({mode:"visible",children:M.children},P,0,null),U=fd(U,P,G,null),U.flags|=2,M.return=u,U.return=u,M.sibling=U,u.child=M,(u.mode&1)!==0&&vl(u,l.child,null,G),u.child.memoizedState=Tn(G),u.memoizedState=gr,U);if((u.mode&1)===0)return Av(l,u,G,null);if(P.data==="$!"){if(M=P.nextSibling&&P.nextSibling.dataset,M)var se=M.dgst;return M=se,U=Error(t(419)),M=F(U,M,void 0),Av(l,u,G,M)}if(se=(G&l.childLanes)!==0,hn||se){if(M=ss,M!==null){switch(G&-G){case 4:P=2;break;case 16:P=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:P=32;break;case 536870912:P=268435456;break;default:P=0}P=(P&(M.suspendedLanes|G))!==0?0:P,P!==0&&P!==U.retryLane&&(U.retryLane=P,Hi(l,P),$o(M,l,P,-1))}return Jw(),M=F(Error(t(421))),Av(l,u,G,M)}return P.data==="$?"?(u.flags|=128,u.child=l.child,u=TL.bind(null,l),P._reactRetry=u,null):(l=U.treeContext,ps=Po(P.nextSibling),Gr=u,Qn=!0,yi=null,l!==null&&(fs[Or++]=ut,fs[Or++]=xi,fs[Or++]=gl,ut=l.id,xi=l.overflow,gl=u),u=sg(u,M.children),u.flags|=4096,u)}function XM(l,u,y){l.lanes|=u;var M=l.alternate;M!==null&&(M.lanes|=u),Zu(l.return,u,y)}function jw(l,u,y,M,P){var U=l.memoizedState;U===null?l.memoizedState={isBackwards:u,rendering:null,renderingStartTime:0,last:M,tail:y,tailMode:P}:(U.isBackwards=u,U.rendering=null,U.renderingStartTime=0,U.last=M,U.tail=y,U.tailMode=P)}function YM(l,u,y){var M=u.pendingProps,P=M.revealOrder,U=M.tail;if(yt(l,u,M.children,y),M=Jn.current,(M&2)!==0)M=M&1|2,u.flags|=128;else{if(l!==null&&(l.flags&128)!==0)e:for(l=u.child;l!==null;){if(l.tag===13)l.memoizedState!==null&&XM(l,y,u);else if(l.tag===19)XM(l,y,u);else if(l.child!==null){l.child.return=l,l=l.child;continue}if(l===u)break e;for(;l.sibling===null;){if(l.return===null||l.return===u)break e;l=l.return}l.sibling.return=l.return,l=l.sibling}M&=1}if(Gn(Jn,M),(u.mode&1)===0)u.memoizedState=null;else switch(P){case"forwards":for(y=u.child,P=null;y!==null;)l=y.alternate,l!==null&&Gi(l)===null&&(P=y),y=y.sibling;y=P,y===null?(P=u.child,u.child=null):(P=y.sibling,y.sibling=null),jw(u,!1,P,y,U);break;case"backwards":for(y=null,P=u.child,u.child=null;P!==null;){if(l=P.alternate,l!==null&&Gi(l)===null){u.child=P;break}l=P.sibling,P.sibling=y,y=P,P=l}jw(u,!0,y,null,U);break;case"together":jw(u,!1,null,null,void 0);break;default:u.memoizedState=null}return u.child}function Rv(l,u){(u.mode&1)===0&&l!==null&&(l.alternate=null,u.alternate=null,u.flags|=2)}function Cl(l,u,y){if(l!==null&&(u.dependencies=l.dependencies),cd|=u.lanes,(y&u.childLanes)===0)return null;if(l!==null&&u.child!==l.child)throw Error(t(153));if(u.child!==null){for(l=u.child,y=Dc(l,l.pendingProps),u.child=y,y.return=u;l.sibling!==null;)l=l.sibling,y=y.sibling=Dc(l,l.pendingProps),y.return=u;y.sibling=null}return u.child}function pL(l,u,y){switch(u.tag){case 3:sn(u),wa();break;case 5:bl(u);break;case 1:ts(u.type)&&pl(u);break;case 4:td(u,u.stateNode.containerInfo);break;case 10:var M=u.type._context,P=u.memoizedProps.value;Gn(xl,M._currentValue),M._currentValue=P;break;case 13:if(M=u.memoizedState,M!==null)return M.dehydrated!==null?(Gn(Jn,Jn.current&1),u.flags|=128,null):(y&u.child.childLanes)!==0?Ho(l,u,y):(Gn(Jn,Jn.current&1),l=Cl(l,u,y),l!==null?l.sibling:null);Gn(Jn,Jn.current&1);break;case 19:if(M=(y&u.childLanes)!==0,(l.flags&128)!==0){if(M)return YM(l,u,y);u.flags|=128}if(P=u.memoizedState,P!==null&&(P.rendering=null,P.tail=null,P.lastEffect=null),Gn(Jn,Jn.current),M)break;return null;case 22:case 23:return u.lanes=0,ge(l,u,y)}return Cl(l,u,y)}var KM,Fw,QM,JM;KM=function(l,u){for(var y=u.child;y!==null;){if(y.tag===5||y.tag===6)l.appendChild(y.stateNode);else if(y.tag!==4&&y.child!==null){y.child.return=y,y=y.child;continue}if(y===u)break;for(;y.sibling===null;){if(y.return===null||y.return===u)return;y=y.return}y.sibling.return=y.return,y=y.sibling}},Fw=function(){},QM=function(l,u,y,M){var P=l.memoizedProps;if(P!==M){l=u.stateNode,mr(Js.current);var U=null;switch(y){case"input":P=$(l,P),M=$(l,M),U=[];break;case"select":P=Z({},P,{value:void 0}),M=Z({},M,{value:void 0}),U=[];break;case"textarea":P=jt(l,P),M=jt(l,M),U=[];break;default:typeof P.onClick!="function"&&typeof M.onClick=="function"&&(l.onclick=Gu)}le(y,M);var G;y=null;for(Pe in P)if(!M.hasOwnProperty(Pe)&&P.hasOwnProperty(Pe)&&P[Pe]!=null)if(Pe==="style"){var se=P[Pe];for(G in se)se.hasOwnProperty(G)&&(y||(y={}),y[G]="")}else Pe!=="dangerouslySetInnerHTML"&&Pe!=="children"&&Pe!=="suppressContentEditableWarning"&&Pe!=="suppressHydrationWarning"&&Pe!=="autoFocus"&&(s.hasOwnProperty(Pe)?U||(U=[]):(U=U||[]).push(Pe,null));for(Pe in M){var de=M[Pe];if(se=P!=null?P[Pe]:void 0,M.hasOwnProperty(Pe)&&de!==se&&(de!=null||se!=null))if(Pe==="style")if(se){for(G in se)!se.hasOwnProperty(G)||de&&de.hasOwnProperty(G)||(y||(y={}),y[G]="");for(G in de)de.hasOwnProperty(G)&&se[G]!==de[G]&&(y||(y={}),y[G]=de[G])}else y||(U||(U=[]),U.push(Pe,y)),y=de;else Pe==="dangerouslySetInnerHTML"?(de=de?de.__html:void 0,se=se?se.__html:void 0,de!=null&&se!==de&&(U=U||[]).push(Pe,de)):Pe==="children"?typeof de!="string"&&typeof de!="number"||(U=U||[]).push(Pe,""+de):Pe!=="suppressContentEditableWarning"&&Pe!=="suppressHydrationWarning"&&(s.hasOwnProperty(Pe)?(de!=null&&Pe==="onScroll"&&$n("scroll",l),U||se===de||(U=[])):(U=U||[]).push(Pe,de))}y&&(U=U||[]).push("style",y);var Pe=U;(u.updateQueue=Pe)&&(u.flags|=4)}},JM=function(l,u,y,M){y!==M&&(u.flags|=4)};function ig(l,u){if(!Qn)switch(l.tailMode){case"hidden":u=l.tail;for(var y=null;u!==null;)u.alternate!==null&&(y=u),u=u.sibling;y===null?l.tail=null:y.sibling=null;break;case"collapsed":y=l.tail;for(var M=null;y!==null;)y.alternate!==null&&(M=y),y=y.sibling;M===null?u||l.tail===null?l.tail=null:l.tail.sibling=null:M.sibling=null}}function ks(l){var u=l.alternate!==null&&l.alternate.child===l.child,y=0,M=0;if(u)for(var P=l.child;P!==null;)y|=P.lanes|P.childLanes,M|=P.subtreeFlags&14680064,M|=P.flags&14680064,P.return=l,P=P.sibling;else for(P=l.child;P!==null;)y|=P.lanes|P.childLanes,M|=P.subtreeFlags,M|=P.flags,P.return=l,P=P.sibling;return l.subtreeFlags|=M,l.childLanes=y,u}function mL(l,u,y){var M=u.pendingProps;switch(Oo(u),u.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return ks(u),null;case 1:return ts(u.type)&&Wu(),ks(u),null;case 3:return M=u.stateNode,ba(),qn(hs),qn(Hr),uo(),M.pendingContext&&(M.context=M.pendingContext,M.pendingContext=null),(l===null||l.child===null)&&(Sc(u)?u.flags|=4:l===null||l.memoizedState.isDehydrated&&(u.flags&256)===0||(u.flags|=1024,yi!==null&&(Yw(yi),yi=null))),Fw(l,u),ks(u),null;case 5:Tc(u);var P=mr(Uo.current);if(y=u.type,l!==null&&u.stateNode!=null)QM(l,u,y,M,P),l.ref!==u.ref&&(u.flags|=512,u.flags|=2097152);else{if(!M){if(u.stateNode===null)throw Error(t(166));return ks(u),null}if(l=mr(Js.current),Sc(u)){M=u.stateNode,y=u.type;var U=u.memoizedProps;switch(M[br]=u,M[wc]=U,l=(u.mode&1)!==0,y){case"dialog":$n("cancel",M),$n("close",M);break;case"iframe":case"object":case"embed":$n("load",M);break;case"video":case"audio":for(P=0;P<ya.length;P++)$n(ya[P],M);break;case"source":$n("error",M);break;case"img":case"image":case"link":$n("error",M),$n("load",M);break;case"details":$n("toggle",M);break;case"input":Ce(M,U),$n("invalid",M);break;case"select":M._wrapperState={wasMultiple:!!U.multiple},$n("invalid",M);break;case"textarea":Q(M,U),$n("invalid",M)}le(y,U),P=null;for(var G in U)if(U.hasOwnProperty(G)){var se=U[G];G==="children"?typeof se=="string"?M.textContent!==se&&(U.suppressHydrationWarning!==!0&&Hu(M.textContent,se,l),P=["children",se]):typeof se=="number"&&M.textContent!==""+se&&(U.suppressHydrationWarning!==!0&&Hu(M.textContent,se,l),P=["children",""+se]):s.hasOwnProperty(G)&&se!=null&&G==="onScroll"&&$n("scroll",M)}switch(y){case"input":dt(M),Ae(M,U,!0);break;case"textarea":dt(M),ye(M);break;case"select":case"option":break;default:typeof U.onClick=="function"&&(M.onclick=Gu)}M=P,u.updateQueue=M,M!==null&&(u.flags|=4)}else{G=P.nodeType===9?P:P.ownerDocument,l==="http://www.w3.org/1999/xhtml"&&(l=Re(y)),l==="http://www.w3.org/1999/xhtml"?y==="script"?(l=G.createElement("div"),l.innerHTML="<script><\/script>",l=l.removeChild(l.firstChild)):typeof M.is=="string"?l=G.createElement(y,{is:M.is}):(l=G.createElement(y),y==="select"&&(G=l,M.multiple?G.multiple=!0:M.size&&(G.size=M.size))):l=G.createElementNS(l,y),l[br]=u,l[wc]=M,KM(l,u,!1,!1),u.stateNode=l;e:{switch(G=Se(y,M),y){case"dialog":$n("cancel",l),$n("close",l),P=M;break;case"iframe":case"object":case"embed":$n("load",l),P=M;break;case"video":case"audio":for(P=0;P<ya.length;P++)$n(ya[P],l);P=M;break;case"source":$n("error",l),P=M;break;case"img":case"image":case"link":$n("error",l),$n("load",l),P=M;break;case"details":$n("toggle",l),P=M;break;case"input":Ce(l,M),P=$(l,M),$n("invalid",l);break;case"option":P=M;break;case"select":l._wrapperState={wasMultiple:!!M.multiple},P=Z({},M,{value:void 0}),$n("invalid",l);break;case"textarea":Q(l,M),P=jt(l,M),$n("invalid",l);break;default:P=M}le(y,P),se=P;for(U in se)if(se.hasOwnProperty(U)){var de=se[U];U==="style"?ft(l,de):U==="dangerouslySetInnerHTML"?(de=de?de.__html:void 0,de!=null&&bt(l,de)):U==="children"?typeof de=="string"?(y!=="textarea"||de!=="")&&st(l,de):typeof de=="number"&&st(l,""+de):U!=="suppressContentEditableWarning"&&U!=="suppressHydrationWarning"&&U!=="autoFocus"&&(s.hasOwnProperty(U)?de!=null&&U==="onScroll"&&$n("scroll",l):de!=null&&T(l,U,de,G))}switch(y){case"input":dt(l),Ae(l,M,!1);break;case"textarea":dt(l),ye(l);break;case"option":M.value!=null&&l.setAttribute("value",""+je(M.value));break;case"select":l.multiple=!!M.multiple,U=M.value,U!=null?nt(l,!!M.multiple,U,!1):M.defaultValue!=null&&nt(l,!!M.multiple,M.defaultValue,!0);break;default:typeof P.onClick=="function"&&(l.onclick=Gu)}switch(y){case"button":case"input":case"select":case"textarea":M=!!M.autoFocus;break e;case"img":M=!0;break e;default:M=!1}}M&&(u.flags|=4)}u.ref!==null&&(u.flags|=512,u.flags|=2097152)}return ks(u),null;case 6:if(l&&u.stateNode!=null)JM(l,u,l.memoizedProps,M);else{if(typeof M!="string"&&u.stateNode===null)throw Error(t(166));if(y=mr(Uo.current),mr(Js.current),Sc(u)){if(M=u.stateNode,y=u.memoizedProps,M[br]=u,(U=M.nodeValue!==y)&&(l=Gr,l!==null))switch(l.tag){case 3:Hu(M.nodeValue,y,(l.mode&1)!==0);break;case 5:l.memoizedProps.suppressHydrationWarning!==!0&&Hu(M.nodeValue,y,(l.mode&1)!==0)}U&&(u.flags|=4)}else M=(y.nodeType===9?y:y.ownerDocument).createTextNode(M),M[br]=u,u.stateNode=M}return ks(u),null;case 13:if(qn(Jn),M=u.memoizedState,l===null||l.memoizedState!==null&&l.memoizedState.dehydrated!==null){if(Qn&&ps!==null&&(u.mode&1)!==0&&(u.flags&128)===0)$m(),wa(),u.flags|=98560,U=!1;else if(U=Sc(u),M!==null&&M.dehydrated!==null){if(l===null){if(!U)throw Error(t(318));if(U=u.memoizedState,U=U!==null?U.dehydrated:null,!U)throw Error(t(317));U[br]=u}else wa(),(u.flags&128)===0&&(u.memoizedState=null),u.flags|=4;ks(u),U=!1}else yi!==null&&(Yw(yi),yi=null),U=!0;if(!U)return u.flags&65536?u:null}return(u.flags&128)!==0?(u.lanes=y,u):(M=M!==null,M!==(l!==null&&l.memoizedState!==null)&&M&&(u.child.flags|=8192,(u.mode&1)!==0&&(l===null||(Jn.current&1)!==0?Xr===0&&(Xr=3):Jw())),u.updateQueue!==null&&(u.flags|=4),ks(u),null);case 4:return ba(),Fw(l,u),l===null&&xc(u.stateNode.containerInfo),ks(u),null;case 10:return Ju(u.type._context),ks(u),null;case 17:return ts(u.type)&&Wu(),ks(u),null;case 19:if(qn(Jn),U=u.memoizedState,U===null)return ks(u),null;if(M=(u.flags&128)!==0,G=U.rendering,G===null)if(M)ig(U,!1);else{if(Xr!==0||l!==null&&(l.flags&128)!==0)for(l=u.child;l!==null;){if(G=Gi(l),G!==null){for(u.flags|=128,ig(U,!1),M=G.updateQueue,M!==null&&(u.updateQueue=M,u.flags|=4),u.subtreeFlags=0,M=y,y=u.child;y!==null;)U=y,l=M,U.flags&=14680066,G=U.alternate,G===null?(U.childLanes=0,U.lanes=l,U.child=null,U.subtreeFlags=0,U.memoizedProps=null,U.memoizedState=null,U.updateQueue=null,U.dependencies=null,U.stateNode=null):(U.childLanes=G.childLanes,U.lanes=G.lanes,U.child=G.child,U.subtreeFlags=0,U.deletions=null,U.memoizedProps=G.memoizedProps,U.memoizedState=G.memoizedState,U.updateQueue=G.updateQueue,U.type=G.type,l=G.dependencies,U.dependencies=l===null?null:{lanes:l.lanes,firstContext:l.firstContext}),y=y.sibling;return Gn(Jn,Jn.current&1|2),u.child}l=l.sibling}U.tail!==null&&_e()>Rf&&(u.flags|=128,M=!0,ig(U,!1),u.lanes=4194304)}else{if(!M)if(l=Gi(G),l!==null){if(u.flags|=128,M=!0,y=l.updateQueue,y!==null&&(u.updateQueue=y,u.flags|=4),ig(U,!0),U.tail===null&&U.tailMode==="hidden"&&!G.alternate&&!Qn)return ks(u),null}else 2*_e()-U.renderingStartTime>Rf&&y!==1073741824&&(u.flags|=128,M=!0,ig(U,!1),u.lanes=4194304);U.isBackwards?(G.sibling=u.child,u.child=G):(y=U.last,y!==null?y.sibling=G:u.child=G,U.last=G)}return U.tail!==null?(u=U.tail,U.rendering=u,U.tail=u.sibling,U.renderingStartTime=_e(),u.sibling=null,y=Jn.current,Gn(Jn,M?y&1|2:y&1),u):(ks(u),null);case 22:case 23:return Qw(),M=u.memoizedState!==null,l!==null&&l.memoizedState!==null!==M&&(u.flags|=8192),M&&(u.mode&1)!==0?(qi&1073741824)!==0&&(ks(u),u.subtreeFlags&6&&(u.flags|=8192)):ks(u),null;case 24:return null;case 25:return null}throw Error(t(156,u.tag))}function gL(l,u){switch(Oo(u),u.tag){case 1:return ts(u.type)&&Wu(),l=u.flags,l&65536?(u.flags=l&-65537|128,u):null;case 3:return ba(),qn(hs),qn(Hr),uo(),l=u.flags,(l&65536)!==0&&(l&128)===0?(u.flags=l&-65537|128,u):null;case 5:return Tc(u),null;case 13:if(qn(Jn),l=u.memoizedState,l!==null&&l.dehydrated!==null){if(u.alternate===null)throw Error(t(340));wa()}return l=u.flags,l&65536?(u.flags=l&-65537|128,u):null;case 19:return qn(Jn),null;case 4:return ba(),null;case 10:return Ju(u.type._context),null;case 22:case 23:return Qw(),null;case 24:return null;default:return null}}var Nv=!1,Ds=!1,vL=typeof WeakSet=="function"?WeakSet:Set,Ct=null;function Cf(l,u){var y=l.ref;if(y!==null)if(typeof y=="function")try{y(null)}catch(M){vr(l,u,M)}else y.current=null}function Uw(l,u,y){try{y()}catch(M){vr(l,u,M)}}var ZM=!1;function xL(l,u){if(_c=hi,l=rr(),Ir(l)){if("selectionStart"in l)var y={start:l.selectionStart,end:l.selectionEnd};else e:{y=(y=l.ownerDocument)&&y.defaultView||window;var M=y.getSelection&&y.getSelection();if(M&&M.rangeCount!==0){y=M.anchorNode;var P=M.anchorOffset,U=M.focusNode;M=M.focusOffset;try{y.nodeType,U.nodeType}catch{y=null;break e}var G=0,se=-1,de=-1,Pe=0,Qe=0,tt=l,Ke=null;t:for(;;){for(var wt;tt!==y||P!==0&&tt.nodeType!==3||(se=G+P),tt!==U||M!==0&&tt.nodeType!==3||(de=G+M),tt.nodeType===3&&(G+=tt.nodeValue.length),(wt=tt.firstChild)!==null;)Ke=tt,tt=wt;for(;;){if(tt===l)break t;if(Ke===y&&++Pe===P&&(se=G),Ke===U&&++Qe===M&&(de=G),(wt=tt.nextSibling)!==null)break;tt=Ke,Ke=tt.parentNode}tt=wt}y=se===-1||de===-1?null:{start:se,end:de}}else y=null}y=y||{start:0,end:0}}else y=null;for(Dm={focusedElem:l,selectionRange:y},hi=!1,Ct=u;Ct!==null;)if(u=Ct,l=u.child,(u.subtreeFlags&1028)!==0&&l!==null)l.return=u,Ct=l;else for(;Ct!==null;){u=Ct;try{var Pt=u.alternate;if((u.flags&1024)!==0)switch(u.tag){case 0:case 11:case 15:break;case 1:if(Pt!==null){var Lt=Pt.memoizedProps,Er=Pt.memoizedState,we=u.stateNode,he=we.getSnapshotBeforeUpdate(u.elementType===u.type?Lt:_i(u.type,Lt),Er);we.__reactInternalSnapshotBeforeUpdate=he}break;case 3:var Me=u.stateNode.containerInfo;Me.nodeType===1?Me.textContent="":Me.nodeType===9&&Me.documentElement&&Me.removeChild(Me.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(t(163))}}catch(at){vr(u,u.return,at)}if(l=u.sibling,l!==null){l.return=u.return,Ct=l;break}Ct=u.return}return Pt=ZM,ZM=!1,Pt}function og(l,u,y){var M=u.updateQueue;if(M=M!==null?M.lastEffect:null,M!==null){var P=M=M.next;do{if((P.tag&l)===l){var U=P.destroy;P.destroy=void 0,U!==void 0&&Uw(u,y,U)}P=P.next}while(P!==M)}}function Pv(l,u){if(u=u.updateQueue,u=u!==null?u.lastEffect:null,u!==null){var y=u=u.next;do{if((y.tag&l)===l){var M=y.create;y.destroy=M()}y=y.next}while(y!==u)}}function Bw(l){var u=l.ref;if(u!==null){var y=l.stateNode;switch(l.tag){case 5:l=y;break;default:l=y}typeof u=="function"?u(l):u.current=l}}function e2(l){var u=l.alternate;u!==null&&(l.alternate=null,e2(u)),l.child=null,l.deletions=null,l.sibling=null,l.tag===5&&(u=l.stateNode,u!==null&&(delete u[br],delete u[wc],delete u[hl],delete u[uf],delete u[df])),l.stateNode=null,l.return=null,l.dependencies=null,l.memoizedProps=null,l.memoizedState=null,l.pendingProps=null,l.stateNode=null,l.updateQueue=null}function t2(l){return l.tag===5||l.tag===3||l.tag===4}function n2(l){e:for(;;){for(;l.sibling===null;){if(l.return===null||t2(l.return))return null;l=l.return}for(l.sibling.return=l.return,l=l.sibling;l.tag!==5&&l.tag!==6&&l.tag!==18;){if(l.flags&2||l.child===null||l.tag===4)continue e;l.child.return=l,l=l.child}if(!(l.flags&2))return l.stateNode}}function zw(l,u,y){var M=l.tag;if(M===5||M===6)l=l.stateNode,u?y.nodeType===8?y.parentNode.insertBefore(l,u):y.insertBefore(l,u):(y.nodeType===8?(u=y.parentNode,u.insertBefore(l,y)):(u=y,u.appendChild(l)),y=y._reactRootContainer,y!=null||u.onclick!==null||(u.onclick=Gu));else if(M!==4&&(l=l.child,l!==null))for(zw(l,u,y),l=l.sibling;l!==null;)zw(l,u,y),l=l.sibling}function Vw(l,u,y){var M=l.tag;if(M===5||M===6)l=l.stateNode,u?y.insertBefore(l,u):y.appendChild(l);else if(M!==4&&(l=l.child,l!==null))for(Vw(l,u,y),l=l.sibling;l!==null;)Vw(l,u,y),l=l.sibling}var gs=null,Go=!1;function Rc(l,u,y){for(y=y.child;y!==null;)r2(l,u,y),y=y.sibling}function r2(l,u,y){if(it&&typeof it.onCommitFiberUnmount=="function")try{it.onCommitFiberUnmount(Ft,y)}catch{}switch(y.tag){case 5:Ds||Cf(y,u);case 6:var M=gs,P=Go;gs=null,Rc(l,u,y),gs=M,Go=P,gs!==null&&(Go?(l=gs,y=y.stateNode,l.nodeType===8?l.parentNode.removeChild(y):l.removeChild(y)):gs.removeChild(y.stateNode));break;case 18:gs!==null&&(Go?(l=gs,y=y.stateNode,l.nodeType===8?cf(l.parentNode,y):l.nodeType===1&&cf(l,y),Iu(l)):cf(gs,y.stateNode));break;case 4:M=gs,P=Go,gs=y.stateNode.containerInfo,Go=!0,Rc(l,u,y),gs=M,Go=P;break;case 0:case 11:case 14:case 15:if(!Ds&&(M=y.updateQueue,M!==null&&(M=M.lastEffect,M!==null))){P=M=M.next;do{var U=P,G=U.destroy;U=U.tag,G!==void 0&&((U&2)!==0||(U&4)!==0)&&Uw(y,u,G),P=P.next}while(P!==M)}Rc(l,u,y);break;case 1:if(!Ds&&(Cf(y,u),M=y.stateNode,typeof M.componentWillUnmount=="function"))try{M.props=y.memoizedProps,M.state=y.memoizedState,M.componentWillUnmount()}catch(se){vr(y,u,se)}Rc(l,u,y);break;case 21:Rc(l,u,y);break;case 22:y.mode&1?(Ds=(M=Ds)||y.memoizedState!==null,Rc(l,u,y),Ds=M):Rc(l,u,y);break;default:Rc(l,u,y)}}function s2(l){var u=l.updateQueue;if(u!==null){l.updateQueue=null;var y=l.stateNode;y===null&&(y=l.stateNode=new vL),u.forEach(function(M){var P=CL.bind(null,l,M);y.has(M)||(y.add(M),M.then(P,P))})}}function Wo(l,u){var y=u.deletions;if(y!==null)for(var M=0;M<y.length;M++){var P=y[M];try{var U=l,G=u,se=G;e:for(;se!==null;){switch(se.tag){case 5:gs=se.stateNode,Go=!1;break e;case 3:gs=se.stateNode.containerInfo,Go=!0;break e;case 4:gs=se.stateNode.containerInfo,Go=!0;break e}se=se.return}if(gs===null)throw Error(t(160));r2(U,G,P),gs=null,Go=!1;var de=P.alternate;de!==null&&(de.return=null),P.return=null}catch(Pe){vr(P,u,Pe)}}if(u.subtreeFlags&12854)for(u=u.child;u!==null;)i2(u,l),u=u.sibling}function i2(l,u){var y=l.alternate,M=l.flags;switch(l.tag){case 0:case 11:case 14:case 15:if(Wo(u,l),Ma(l),M&4){try{og(3,l,l.return),Pv(3,l)}catch(Lt){vr(l,l.return,Lt)}try{og(5,l,l.return)}catch(Lt){vr(l,l.return,Lt)}}break;case 1:Wo(u,l),Ma(l),M&512&&y!==null&&Cf(y,y.return);break;case 5:if(Wo(u,l),Ma(l),M&512&&y!==null&&Cf(y,y.return),l.flags&32){var P=l.stateNode;try{st(P,"")}catch(Lt){vr(l,l.return,Lt)}}if(M&4&&(P=l.stateNode,P!=null)){var U=l.memoizedProps,G=y!==null?y.memoizedProps:U,se=l.type,de=l.updateQueue;if(l.updateQueue=null,de!==null)try{se==="input"&&U.type==="radio"&&U.name!=null&&ke(P,U),Se(se,G);var Pe=Se(se,U);for(G=0;G<de.length;G+=2){var Qe=de[G],tt=de[G+1];Qe==="style"?ft(P,tt):Qe==="dangerouslySetInnerHTML"?bt(P,tt):Qe==="children"?st(P,tt):T(P,Qe,tt,Pe)}switch(se){case"input":Ge(P,U);break;case"textarea":H(P,U);break;case"select":var Ke=P._wrapperState.wasMultiple;P._wrapperState.wasMultiple=!!U.multiple;var wt=U.value;wt!=null?nt(P,!!U.multiple,wt,!1):Ke!==!!U.multiple&&(U.defaultValue!=null?nt(P,!!U.multiple,U.defaultValue,!0):nt(P,!!U.multiple,U.multiple?[]:"",!1))}P[wc]=U}catch(Lt){vr(l,l.return,Lt)}}break;case 6:if(Wo(u,l),Ma(l),M&4){if(l.stateNode===null)throw Error(t(162));P=l.stateNode,U=l.memoizedProps;try{P.nodeValue=U}catch(Lt){vr(l,l.return,Lt)}}break;case 3:if(Wo(u,l),Ma(l),M&4&&y!==null&&y.memoizedState.isDehydrated)try{Iu(u.containerInfo)}catch(Lt){vr(l,l.return,Lt)}break;case 4:Wo(u,l),Ma(l);break;case 13:Wo(u,l),Ma(l),P=l.child,P.flags&8192&&(U=P.memoizedState!==null,P.stateNode.isHidden=U,!U||P.alternate!==null&&P.alternate.memoizedState!==null||(Ww=_e())),M&4&&s2(l);break;case 22:if(Qe=y!==null&&y.memoizedState!==null,l.mode&1?(Ds=(Pe=Ds)||Qe,Wo(u,l),Ds=Pe):Wo(u,l),Ma(l),M&8192){if(Pe=l.memoizedState!==null,(l.stateNode.isHidden=Pe)&&!Qe&&(l.mode&1)!==0)for(Ct=l,Qe=l.child;Qe!==null;){for(tt=Ct=Qe;Ct!==null;){switch(Ke=Ct,wt=Ke.child,Ke.tag){case 0:case 11:case 14:case 15:og(4,Ke,Ke.return);break;case 1:Cf(Ke,Ke.return);var Pt=Ke.stateNode;if(typeof Pt.componentWillUnmount=="function"){M=Ke,y=Ke.return;try{u=M,Pt.props=u.memoizedProps,Pt.state=u.memoizedState,Pt.componentWillUnmount()}catch(Lt){vr(M,y,Lt)}}break;case 5:Cf(Ke,Ke.return);break;case 22:if(Ke.memoizedState!==null){l2(tt);continue}}wt!==null?(wt.return=Ke,Ct=wt):l2(tt)}Qe=Qe.sibling}e:for(Qe=null,tt=l;;){if(tt.tag===5){if(Qe===null){Qe=tt;try{P=tt.stateNode,Pe?(U=P.style,typeof U.setProperty=="function"?U.setProperty("display","none","important"):U.display="none"):(se=tt.stateNode,de=tt.memoizedProps.style,G=de!=null&&de.hasOwnProperty("display")?de.display:null,se.style.display=We("display",G))}catch(Lt){vr(l,l.return,Lt)}}}else if(tt.tag===6){if(Qe===null)try{tt.stateNode.nodeValue=Pe?"":tt.memoizedProps}catch(Lt){vr(l,l.return,Lt)}}else if((tt.tag!==22&&tt.tag!==23||tt.memoizedState===null||tt===l)&&tt.child!==null){tt.child.return=tt,tt=tt.child;continue}if(tt===l)break e;for(;tt.sibling===null;){if(tt.return===null||tt.return===l)break e;Qe===tt&&(Qe=null),tt=tt.return}Qe===tt&&(Qe=null),tt.sibling.return=tt.return,tt=tt.sibling}}break;case 19:Wo(u,l),Ma(l),M&4&&s2(l);break;case 21:break;default:Wo(u,l),Ma(l)}}function Ma(l){var u=l.flags;if(u&2){try{e:{for(var y=l.return;y!==null;){if(t2(y)){var M=y;break e}y=y.return}throw Error(t(160))}switch(M.tag){case 5:var P=M.stateNode;M.flags&32&&(st(P,""),M.flags&=-33);var U=n2(l);Vw(l,U,P);break;case 3:case 4:var G=M.stateNode.containerInfo,se=n2(l);zw(l,se,G);break;default:throw Error(t(161))}}catch(de){vr(l,l.return,de)}l.flags&=-3}u&4096&&(l.flags&=-4097)}function yL(l,u,y){Ct=l,o2(l)}function o2(l,u,y){for(var M=(l.mode&1)!==0;Ct!==null;){var P=Ct,U=P.child;if(P.tag===22&&M){var G=P.memoizedState!==null||Nv;if(!G){var se=P.alternate,de=se!==null&&se.memoizedState!==null||Ds;se=Nv;var Pe=Ds;if(Nv=G,(Ds=de)&&!Pe)for(Ct=P;Ct!==null;)G=Ct,de=G.child,G.tag===22&&G.memoizedState!==null?c2(P):de!==null?(de.return=G,Ct=de):c2(P);for(;U!==null;)Ct=U,o2(U),U=U.sibling;Ct=P,Nv=se,Ds=Pe}a2(l)}else(P.subtreeFlags&8772)!==0&&U!==null?(U.return=P,Ct=U):a2(l)}}function a2(l){for(;Ct!==null;){var u=Ct;if((u.flags&8772)!==0){var y=u.alternate;try{if((u.flags&8772)!==0)switch(u.tag){case 0:case 11:case 15:Ds||Pv(5,u);break;case 1:var M=u.stateNode;if(u.flags&4&&!Ds)if(y===null)M.componentDidMount();else{var P=u.elementType===u.type?y.memoizedProps:_i(u.type,y.memoizedProps);M.componentDidUpdate(P,y.memoizedState,M.__reactInternalSnapshotBeforeUpdate)}var U=u.updateQueue;U!==null&&Mc(u,U,M);break;case 3:var G=u.updateQueue;if(G!==null){if(y=null,u.child!==null)switch(u.child.tag){case 5:y=u.child.stateNode;break;case 1:y=u.child.stateNode}Mc(u,G,y)}break;case 5:var se=u.stateNode;if(y===null&&u.flags&4){y=se;var de=u.memoizedProps;switch(u.type){case"button":case"input":case"select":case"textarea":de.autoFocus&&y.focus();break;case"img":de.src&&(y.src=de.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(u.memoizedState===null){var Pe=u.alternate;if(Pe!==null){var Qe=Pe.memoizedState;if(Qe!==null){var tt=Qe.dehydrated;tt!==null&&Iu(tt)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(t(163))}Ds||u.flags&512&&Bw(u)}catch(Ke){vr(u,u.return,Ke)}}if(u===l){Ct=null;break}if(y=u.sibling,y!==null){y.return=u.return,Ct=y;break}Ct=u.return}}function l2(l){for(;Ct!==null;){var u=Ct;if(u===l){Ct=null;break}var y=u.sibling;if(y!==null){y.return=u.return,Ct=y;break}Ct=u.return}}function c2(l){for(;Ct!==null;){var u=Ct;try{switch(u.tag){case 0:case 11:case 15:var y=u.return;try{Pv(4,u)}catch(de){vr(u,y,de)}break;case 1:var M=u.stateNode;if(typeof M.componentDidMount=="function"){var P=u.return;try{M.componentDidMount()}catch(de){vr(u,P,de)}}var U=u.return;try{Bw(u)}catch(de){vr(u,U,de)}break;case 5:var G=u.return;try{Bw(u)}catch(de){vr(u,G,de)}}}catch(de){vr(u,u.return,de)}if(u===l){Ct=null;break}var se=u.sibling;if(se!==null){se.return=u.return,Ct=se;break}Ct=u.return}}var _L=Math.ceil,Iv=A.ReactCurrentDispatcher,Hw=A.ReactCurrentOwner,fo=A.ReactCurrentBatchConfig,Dn=0,ss=null,jr=null,vs=0,qi=0,Af=ar(0),Xr=0,ag=null,cd=0,kv=0,Gw=0,lg=null,wi=null,Ww=0,Rf=1/0,Al=null,Dv=!1,$w=null,Nc=null,Lv=!1,Pc=null,Ov=0,cg=0,qw=null,jv=-1,Fv=0;function ni(){return(Dn&6)!==0?_e():jv!==-1?jv:jv=_e()}function Ic(l){return(l.mode&1)===0?1:(Dn&2)!==0&&vs!==0?vs&-vs:Lw.transition!==null?(Fv===0&&(Fv=wn()),Fv):(l=Sn,l!==0||(l=window.event,l=l===void 0?16:rv(l.type)),l)}function $o(l,u,y,M){if(50<cg)throw cg=0,qw=null,Error(t(185));Pr(l,y,M),((Dn&2)===0||l!==ss)&&(l===ss&&((Dn&2)===0&&(kv|=y),Xr===4&&kc(l,vs)),Si(l,M),y===1&&Dn===0&&(u.mode&1)===0&&(Rf=_e()+500,qu&&lo()))}function Si(l,u){var y=l.callbackNode;Nr(l,u);var M=Br(l,l===ss?vs:0);if(M===0)y!==null&&Y(y),l.callbackNode=null,l.callbackPriority=0;else if(u=M&-M,l.callbackPriority!==u){if(y!=null&&Y(y),u===1)l.tag===0?vv(d2.bind(null,l)):Xu(d2.bind(null,l)),Dw(function(){(Dn&6)===0&&lo()}),y=null;else{switch(Cs(M)){case 1:y=et;break;case 4:y=pt;break;case 16:y=Mt;break;case 536870912:y=Vt;break;default:y=Mt}y=y2(y,u2.bind(null,l))}l.callbackPriority=u,l.callbackNode=y}}function u2(l,u){if(jv=-1,Fv=0,(Dn&6)!==0)throw Error(t(327));var y=l.callbackNode;if(Nf()&&l.callbackNode!==y)return null;var M=Br(l,l===ss?vs:0);if(M===0)return null;if((M&30)!==0||(M&l.expiredLanes)!==0||u)u=Uv(l,M);else{u=M;var P=Dn;Dn|=2;var U=f2();(ss!==l||vs!==u)&&(Al=null,Rf=_e()+500,dd(l,u));do try{bL();break}catch(se){h2(l,se)}while(!0);_l(),Iv.current=U,Dn=P,jr!==null?u=0:(ss=null,vs=0,u=Xr)}if(u!==0){if(u===2&&(P=ro(l),P!==0&&(M=P,u=Xw(l,P))),u===1)throw y=ag,dd(l,0),kc(l,M),Si(l,_e()),y;if(u===6)kc(l,M);else{if(P=l.current.alternate,(M&30)===0&&!wL(P)&&(u=Uv(l,M),u===2&&(U=ro(l),U!==0&&(M=U,u=Xw(l,U))),u===1))throw y=ag,dd(l,0),kc(l,M),Si(l,_e()),y;switch(l.finishedWork=P,l.finishedLanes=M,u){case 0:case 1:throw Error(t(345));case 2:hd(l,wi,Al);break;case 3:if(kc(l,M),(M&130023424)===M&&(u=Ww+500-_e(),10<u)){if(Br(l,0)!==0)break;if(P=l.suspendedLanes,(P&M)!==M){ni(),l.pingedLanes|=l.suspendedLanes&P;break}l.timeoutHandle=Om(hd.bind(null,l,wi,Al),u);break}hd(l,wi,Al);break;case 4:if(kc(l,M),(M&4194240)===M)break;for(u=l.eventTimes,P=-1;0<M;){var G=31-Kt(M);U=1<<G,G=u[G],G>P&&(P=G),M&=~U}if(M=P,M=_e()-M,M=(120>M?120:480>M?480:1080>M?1080:1920>M?1920:3e3>M?3e3:4320>M?4320:1960*_L(M/1960))-M,10<M){l.timeoutHandle=Om(hd.bind(null,l,wi,Al),M);break}hd(l,wi,Al);break;case 5:hd(l,wi,Al);break;default:throw Error(t(329))}}}return Si(l,_e()),l.callbackNode===y?u2.bind(null,l):null}function Xw(l,u){var y=lg;return l.current.memoizedState.isDehydrated&&(dd(l,u).flags|=256),l=Uv(l,u),l!==2&&(u=wi,wi=y,u!==null&&Yw(u)),l}function Yw(l){wi===null?wi=l:wi.push.apply(wi,l)}function wL(l){for(var u=l;;){if(u.flags&16384){var y=u.updateQueue;if(y!==null&&(y=y.stores,y!==null))for(var M=0;M<y.length;M++){var P=y[M],U=P.getSnapshot;P=P.value;try{if(!Xs(U(),P))return!1}catch{return!1}}}if(y=u.child,u.subtreeFlags&16384&&y!==null)y.return=u,u=y;else{if(u===l)break;for(;u.sibling===null;){if(u.return===null||u.return===l)return!0;u=u.return}u.sibling.return=u.return,u=u.sibling}}return!0}function kc(l,u){for(u&=~Gw,u&=~kv,l.suspendedLanes|=u,l.pingedLanes&=~u,l=l.expirationTimes;0<u;){var y=31-Kt(u),M=1<<y;l[y]=-1,u&=~M}}function d2(l){if((Dn&6)!==0)throw Error(t(327));Nf();var u=Br(l,0);if((u&1)===0)return Si(l,_e()),null;var y=Uv(l,u);if(l.tag!==0&&y===2){var M=ro(l);M!==0&&(u=M,y=Xw(l,M))}if(y===1)throw y=ag,dd(l,0),kc(l,u),Si(l,_e()),y;if(y===6)throw Error(t(345));return l.finishedWork=l.current.alternate,l.finishedLanes=u,hd(l,wi,Al),Si(l,_e()),null}function Kw(l,u){var y=Dn;Dn|=1;try{return l(u)}finally{Dn=y,Dn===0&&(Rf=_e()+500,qu&&lo())}}function ud(l){Pc!==null&&Pc.tag===0&&(Dn&6)===0&&Nf();var u=Dn;Dn|=1;var y=fo.transition,M=Sn;try{if(fo.transition=null,Sn=1,l)return l()}finally{Sn=M,fo.transition=y,Dn=u,(Dn&6)===0&&lo()}}function Qw(){qi=Af.current,qn(Af)}function dd(l,u){l.finishedWork=null,l.finishedLanes=0;var y=l.timeoutHandle;if(y!==-1&&(l.timeoutHandle=-1,jm(y)),jr!==null)for(y=jr.return;y!==null;){var M=y;switch(Oo(M),M.tag){case 1:M=M.type.childContextTypes,M!=null&&Wu();break;case 3:ba(),qn(hs),qn(Hr),uo();break;case 5:Tc(M);break;case 4:ba();break;case 13:qn(Jn);break;case 19:qn(Jn);break;case 10:Ju(M.type._context);break;case 22:case 23:Qw()}y=y.return}if(ss=l,jr=l=Dc(l.current,null),vs=qi=u,Xr=0,ag=null,Gw=kv=cd=0,wi=lg=null,Fo!==null){for(u=0;u<Fo.length;u++)if(y=Fo[u],M=y.interleaved,M!==null){y.interleaved=null;var P=M.next,U=y.pending;if(U!==null){var G=U.next;U.next=P,M.next=G}y.pending=M}Fo=null}return l}function h2(l,u){do{var y=jr;try{if(_l(),El.current=Mf,Wi){for(var M=Xn.memoizedState;M!==null;){var P=M.queue;P!==null&&(P.pending=null),M=M.next}Wi=!1}if(Bo=0,In=cr=Xn=null,rs=!1,Ea=0,Hw.current=null,y===null||y.return===null){Xr=1,ag=u,jr=null;break}e:{var U=l,G=y.return,se=y,de=u;if(u=vs,se.flags|=32768,de!==null&&typeof de=="object"&&typeof de.then=="function"){var Pe=de,Qe=se,tt=Qe.tag;if((Qe.mode&1)===0&&(tt===0||tt===11||tt===15)){var Ke=Qe.alternate;Ke?(Qe.updateQueue=Ke.updateQueue,Qe.memoizedState=Ke.memoizedState,Qe.lanes=Ke.lanes):(Qe.updateQueue=null,Qe.memoizedState=null)}var wt=Tt(G);if(wt!==null){wt.flags&=-257,rn(wt,G,se,U,u),wt.mode&1&&ot(U,Pe,u),u=wt,de=Pe;var Pt=u.updateQueue;if(Pt===null){var Lt=new Set;Lt.add(de),u.updateQueue=Lt}else Pt.add(de);break e}else{if((u&1)===0){ot(U,Pe,u),Jw();break e}de=Error(t(426))}}else if(Qn&&se.mode&1){var Er=Tt(G);if(Er!==null){(Er.flags&65536)===0&&(Er.flags|=256),rn(Er,G,se,U,u),bc(N(de,se));break e}}U=de=N(de,se),Xr!==4&&(Xr=2),lg===null?lg=[U]:lg.push(U),U=G;do{switch(U.tag){case 3:U.flags|=65536,u&=-u,U.lanes|=u;var we=pe(U,de,u);wl(U,we);break e;case 1:se=de;var he=U.type,Me=U.stateNode;if((U.flags&128)===0&&(typeof he.getDerivedStateFromError=="function"||Me!==null&&typeof Me.componentDidCatch=="function"&&(Nc===null||!Nc.has(Me)))){U.flags|=65536,u&=-u,U.lanes|=u;var at=Oe(U,se,u);wl(U,at);break e}}U=U.return}while(U!==null)}m2(y)}catch(Ut){u=Ut,jr===y&&y!==null&&(jr=y=y.return);continue}break}while(!0)}function f2(){var l=Iv.current;return Iv.current=Mf,l===null?Mf:l}function Jw(){(Xr===0||Xr===3||Xr===2)&&(Xr=4),ss===null||(cd&268435455)===0&&(kv&268435455)===0||kc(ss,vs)}function Uv(l,u){var y=Dn;Dn|=2;var M=f2();(ss!==l||vs!==u)&&(Al=null,dd(l,u));do try{SL();break}catch(P){h2(l,P)}while(!0);if(_l(),Dn=y,Iv.current=M,jr!==null)throw Error(t(261));return ss=null,vs=0,Xr}function SL(){for(;jr!==null;)p2(jr)}function bL(){for(;jr!==null&&!xe();)p2(jr)}function p2(l){var u=x2(l.alternate,l,qi);l.memoizedProps=l.pendingProps,u===null?m2(l):jr=u,Hw.current=null}function m2(l){var u=l;do{var y=u.alternate;if(l=u.return,(u.flags&32768)===0){if(y=mL(y,u,qi),y!==null){jr=y;return}}else{if(y=gL(y,u),y!==null){y.flags&=32767,jr=y;return}if(l!==null)l.flags|=32768,l.subtreeFlags=0,l.deletions=null;else{Xr=6,jr=null;return}}if(u=u.sibling,u!==null){jr=u;return}jr=u=l}while(u!==null);Xr===0&&(Xr=5)}function hd(l,u,y){var M=Sn,P=fo.transition;try{fo.transition=null,Sn=1,EL(l,u,y,M)}finally{fo.transition=P,Sn=M}return null}function EL(l,u,y,M){do Nf();while(Pc!==null);if((Dn&6)!==0)throw Error(t(327));y=l.finishedWork;var P=l.finishedLanes;if(y===null)return null;if(l.finishedWork=null,l.finishedLanes=0,y===l.current)throw Error(t(177));l.callbackNode=null,l.callbackPriority=0;var U=y.lanes|y.childLanes;if(zr(l,U),l===ss&&(jr=ss=null,vs=0),(y.subtreeFlags&2064)===0&&(y.flags&2064)===0||Lv||(Lv=!0,y2(Mt,function(){return Nf(),null})),U=(y.flags&15990)!==0,(y.subtreeFlags&15990)!==0||U){U=fo.transition,fo.transition=null;var G=Sn;Sn=1;var se=Dn;Dn|=4,Hw.current=null,xL(l,y),i2(y,l),kr(Dm),hi=!!_c,Dm=_c=null,l.current=y,yL(y),Ne(),Dn=se,Sn=G,fo.transition=U}else l.current=y;if(Lv&&(Lv=!1,Pc=l,Ov=P),U=l.pendingLanes,U===0&&(Nc=null),Nt(y.stateNode),Si(l,_e()),u!==null)for(M=l.onRecoverableError,y=0;y<u.length;y++)P=u[y],M(P.value,{componentStack:P.stack,digest:P.digest});if(Dv)throw Dv=!1,l=$w,$w=null,l;return(Ov&1)!==0&&l.tag!==0&&Nf(),U=l.pendingLanes,(U&1)!==0?l===qw?cg++:(cg=0,qw=l):cg=0,lo(),null}function Nf(){if(Pc!==null){var l=Cs(Ov),u=fo.transition,y=Sn;try{if(fo.transition=null,Sn=16>l?16:l,Pc===null)var M=!1;else{if(l=Pc,Pc=null,Ov=0,(Dn&6)!==0)throw Error(t(331));var P=Dn;for(Dn|=4,Ct=l.current;Ct!==null;){var U=Ct,G=U.child;if((Ct.flags&16)!==0){var se=U.deletions;if(se!==null){for(var de=0;de<se.length;de++){var Pe=se[de];for(Ct=Pe;Ct!==null;){var Qe=Ct;switch(Qe.tag){case 0:case 11:case 15:og(8,Qe,U)}var tt=Qe.child;if(tt!==null)tt.return=Qe,Ct=tt;else for(;Ct!==null;){Qe=Ct;var Ke=Qe.sibling,wt=Qe.return;if(e2(Qe),Qe===Pe){Ct=null;break}if(Ke!==null){Ke.return=wt,Ct=Ke;break}Ct=wt}}}var Pt=U.alternate;if(Pt!==null){var Lt=Pt.child;if(Lt!==null){Pt.child=null;do{var Er=Lt.sibling;Lt.sibling=null,Lt=Er}while(Lt!==null)}}Ct=U}}if((U.subtreeFlags&2064)!==0&&G!==null)G.return=U,Ct=G;else e:for(;Ct!==null;){if(U=Ct,(U.flags&2048)!==0)switch(U.tag){case 0:case 11:case 15:og(9,U,U.return)}var we=U.sibling;if(we!==null){we.return=U.return,Ct=we;break e}Ct=U.return}}var he=l.current;for(Ct=he;Ct!==null;){G=Ct;var Me=G.child;if((G.subtreeFlags&2064)!==0&&Me!==null)Me.return=G,Ct=Me;else e:for(G=he;Ct!==null;){if(se=Ct,(se.flags&2048)!==0)try{switch(se.tag){case 0:case 11:case 15:Pv(9,se)}}catch(Ut){vr(se,se.return,Ut)}if(se===G){Ct=null;break e}var at=se.sibling;if(at!==null){at.return=se.return,Ct=at;break e}Ct=se.return}}if(Dn=P,lo(),it&&typeof it.onPostCommitFiberRoot=="function")try{it.onPostCommitFiberRoot(Ft,l)}catch{}M=!0}return M}finally{Sn=y,fo.transition=u}}return!1}function g2(l,u,y){u=N(y,u),u=pe(l,u,1),l=er(l,u,1),u=ni(),l!==null&&(Pr(l,1,u),Si(l,u))}function vr(l,u,y){if(l.tag===3)g2(l,l,y);else for(;u!==null;){if(u.tag===3){g2(u,l,y);break}else if(u.tag===1){var M=u.stateNode;if(typeof u.type.getDerivedStateFromError=="function"||typeof M.componentDidCatch=="function"&&(Nc===null||!Nc.has(M))){l=N(y,l),l=Oe(u,l,1),u=er(u,l,1),l=ni(),u!==null&&(Pr(u,1,l),Si(u,l));break}}u=u.return}}function ML(l,u,y){var M=l.pingCache;M!==null&&M.delete(u),u=ni(),l.pingedLanes|=l.suspendedLanes&y,ss===l&&(vs&y)===y&&(Xr===4||Xr===3&&(vs&130023424)===vs&&500>_e()-Ww?dd(l,0):Gw|=y),Si(l,u)}function v2(l,u){u===0&&((l.mode&1)===0?u=1:(u=En,En<<=1,(En&130023424)===0&&(En=4194304)));var y=ni();l=Hi(l,u),l!==null&&(Pr(l,u,y),Si(l,y))}function TL(l){var u=l.memoizedState,y=0;u!==null&&(y=u.retryLane),v2(l,y)}function CL(l,u){var y=0;switch(l.tag){case 13:var M=l.stateNode,P=l.memoizedState;P!==null&&(y=P.retryLane);break;case 19:M=l.stateNode;break;default:throw Error(t(314))}M!==null&&M.delete(u),v2(l,y)}var x2;x2=function(l,u,y){if(l!==null)if(l.memoizedProps!==u.pendingProps||hs.current)hn=!0;else{if((l.lanes&y)===0&&(u.flags&128)===0)return hn=!1,pL(l,u,y);hn=(l.flags&131072)!==0}else hn=!1,Qn&&(u.flags&1048576)!==0&&Vm(u,mf,u.index);switch(u.lanes=0,u.tag){case 2:var M=u.type;Rv(l,u),l=u.pendingProps;var P=fl(u,Hr.current);Sa(u,y),P=rd(null,u,M,l,P,y);var U=Km();return u.flags|=1,typeof P=="object"&&P!==null&&typeof P.render=="function"&&P.$$typeof===void 0?(u.tag=1,u.memoizedState=null,u.updateQueue=null,ts(M)?(U=!0,pl(u)):U=!1,u.memoizedState=P.state!==null&&P.state!==void 0?P.state:null,ln(u),P.updater=Tf,u.stateNode=P,P._reactInternals=u,E(u,M,l,y),u=on(null,u,M,!0,U,y)):(u.tag=0,Qn&&U&&Hm(u),yt(null,u,P,y),u=u.child),u;case 16:M=u.elementType;e:{switch(Rv(l,u),l=u.pendingProps,P=M._init,M=P(M._payload),u.type=M,P=u.tag=RL(M),l=_i(M,l),P){case 0:u=gt(null,u,M,l,y);break e;case 1:u=Ot(null,u,M,l,y);break e;case 11:u=qr(null,u,M,l,y);break e;case 14:u=ti(null,u,M,_i(M.type,l),y);break e}throw Error(t(306,M,""))}return u;case 0:return M=u.type,P=u.pendingProps,P=u.elementType===M?P:_i(M,P),gt(l,u,M,P,y);case 1:return M=u.type,P=u.pendingProps,P=u.elementType===M?P:_i(M,P),Ot(l,u,M,P,y);case 3:e:{if(sn(u),l===null)throw Error(t(387));M=u.pendingProps,U=u.memoizedState,P=U.element,hr(l,u),lr(u,M,null,y);var G=u.memoizedState;if(M=G.element,U.isDehydrated)if(U={element:M,isDehydrated:!1,cache:G.cache,pendingSuspenseBoundaries:G.pendingSuspenseBoundaries,transitions:G.transitions},u.updateQueue.baseState=U,u.memoizedState=U,u.flags&256){P=N(Error(t(423)),u),u=Rn(l,u,M,y,P);break e}else if(M!==P){P=N(Error(t(424)),u),u=Rn(l,u,M,y,P);break e}else for(ps=Po(u.stateNode.containerInfo.firstChild),Gr=u,Qn=!0,yi=null,y=Qu(u,null,M,y),u.child=y;y;)y.flags=y.flags&-3|4096,y=y.sibling;else{if(wa(),M===P){u=Cl(l,u,y);break e}yt(l,u,M,y)}u=u.child}return u;case 5:return bl(u),l===null&&vf(u),M=u.type,P=u.pendingProps,U=l!==null?l.memoizedProps:null,G=P.children,Lm(M,P)?G=null:U!==null&&Lm(M,U)&&(u.flags|=32),De(l,u),yt(l,u,G,y),u.child;case 6:return l===null&&vf(u),null;case 13:return Ho(l,u,y);case 4:return td(u,u.stateNode.containerInfo),M=u.pendingProps,l===null?u.child=vl(u,null,M,y):yt(l,u,M,y),u.child;case 11:return M=u.type,P=u.pendingProps,P=u.elementType===M?P:_i(M,P),qr(l,u,M,P,y);case 7:return yt(l,u,u.pendingProps,y),u.child;case 8:return yt(l,u,u.pendingProps.children,y),u.child;case 12:return yt(l,u,u.pendingProps.children,y),u.child;case 10:e:{if(M=u.type._context,P=u.pendingProps,U=u.memoizedProps,G=P.value,Gn(xl,M._currentValue),M._currentValue=G,U!==null)if(Xs(U.value,G)){if(U.children===P.children&&!hs.current){u=Cl(l,u,y);break e}}else for(U=u.child,U!==null&&(U.return=u);U!==null;){var se=U.dependencies;if(se!==null){G=U.child;for(var de=se.firstContext;de!==null;){if(de.context===M){if(U.tag===1){de=Vn(-1,y&-y),de.tag=2;var Pe=U.updateQueue;if(Pe!==null){Pe=Pe.shared;var Qe=Pe.pending;Qe===null?de.next=de:(de.next=Qe.next,Qe.next=de),Pe.pending=de}}U.lanes|=y,de=U.alternate,de!==null&&(de.lanes|=y),Zu(U.return,y,u),se.lanes|=y;break}de=de.next}}else if(U.tag===10)G=U.type===u.type?null:U.child;else if(U.tag===18){if(G=U.return,G===null)throw Error(t(341));G.lanes|=y,se=G.alternate,se!==null&&(se.lanes|=y),Zu(G,y,u),G=U.sibling}else G=U.child;if(G!==null)G.return=U;else for(G=U;G!==null;){if(G===u){G=null;break}if(U=G.sibling,U!==null){U.return=G.return,G=U;break}G=G.return}U=G}yt(l,u,P.children,y),u=u.child}return u;case 9:return P=u.type,M=u.pendingProps.children,Sa(u,y),P=Qs(P),M=M(P),u.flags|=1,yt(l,u,M,y),u.child;case 14:return M=u.type,P=_i(M,u.pendingProps),P=_i(M.type,P),ti(l,u,M,P,y);case 15:return Te(l,u,u.type,u.pendingProps,y);case 17:return M=u.type,P=u.pendingProps,P=u.elementType===M?P:_i(M,P),Rv(l,u),u.tag=1,ts(M)?(l=!0,pl(u)):l=!1,Sa(u,y),p(u,M,P),E(u,M,P,y),on(null,u,M,!0,l,y);case 19:return YM(l,u,y);case 22:return ge(l,u,y)}throw Error(t(156,u.tag))};function y2(l,u){return Ih(l,u)}function AL(l,u,y,M){this.tag=l,this.key=y,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=u,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=M,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function po(l,u,y,M){return new AL(l,u,y,M)}function Zw(l){return l=l.prototype,!(!l||!l.isReactComponent)}function RL(l){if(typeof l=="function")return Zw(l)?1:0;if(l!=null){if(l=l.$$typeof,l===W)return 11;if(l===oe)return 14}return 2}function Dc(l,u){var y=l.alternate;return y===null?(y=po(l.tag,u,l.key,l.mode),y.elementType=l.elementType,y.type=l.type,y.stateNode=l.stateNode,y.alternate=l,l.alternate=y):(y.pendingProps=u,y.type=l.type,y.flags=0,y.subtreeFlags=0,y.deletions=null),y.flags=l.flags&14680064,y.childLanes=l.childLanes,y.lanes=l.lanes,y.child=l.child,y.memoizedProps=l.memoizedProps,y.memoizedState=l.memoizedState,y.updateQueue=l.updateQueue,u=l.dependencies,y.dependencies=u===null?null:{lanes:u.lanes,firstContext:u.firstContext},y.sibling=l.sibling,y.index=l.index,y.ref=l.ref,y}function Bv(l,u,y,M,P,U){var G=2;if(M=l,typeof l=="function")Zw(l)&&(G=1);else if(typeof l=="string")G=5;else e:switch(l){case D:return fd(y.children,P,U,u);case L:G=8,P|=8;break;case O:return l=po(12,y,u,P|2),l.elementType=O,l.lanes=U,l;case K:return l=po(13,y,u,P),l.elementType=K,l.lanes=U,l;case ee:return l=po(19,y,u,P),l.elementType=ee,l.lanes=U,l;case ce:return zv(y,P,U,u);default:if(typeof l=="object"&&l!==null)switch(l.$$typeof){case I:G=10;break e;case B:G=9;break e;case W:G=11;break e;case oe:G=14;break e;case ne:G=16,M=null;break e}throw Error(t(130,l==null?l:typeof l,""))}return u=po(G,y,u,P),u.elementType=l,u.type=M,u.lanes=U,u}function fd(l,u,y,M){return l=po(7,l,M,u),l.lanes=y,l}function zv(l,u,y,M){return l=po(22,l,M,u),l.elementType=ce,l.lanes=y,l.stateNode={isHidden:!1},l}function e1(l,u,y){return l=po(6,l,null,u),l.lanes=y,l}function t1(l,u,y){return u=po(4,l.children!==null?l.children:[],l.key,u),u.lanes=y,u.stateNode={containerInfo:l.containerInfo,pendingChildren:null,implementation:l.implementation},u}function NL(l,u,y,M,P){this.tag=u,this.containerInfo=l,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=es(0),this.expirationTimes=es(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=es(0),this.identifierPrefix=M,this.onRecoverableError=P,this.mutableSourceEagerHydrationData=null}function n1(l,u,y,M,P,U,G,se,de){return l=new NL(l,u,y,se,de),u===1?(u=1,U===!0&&(u|=8)):u=0,U=po(3,null,null,u),l.current=U,U.stateNode=l,U.memoizedState={element:M,isDehydrated:y,cache:null,transitions:null,pendingSuspenseBoundaries:null},ln(U),l}function PL(l,u,y){var M=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:j,key:M==null?null:""+M,children:l,containerInfo:u,implementation:y}}function _2(l){if(!l)return ko;l=l._reactInternals;e:{if(no(l)!==l||l.tag!==1)throw Error(t(170));var u=l;do{switch(u.tag){case 3:u=u.stateNode.context;break e;case 1:if(ts(u.type)){u=u.stateNode.__reactInternalMemoizedMergedChildContext;break e}}u=u.return}while(u!==null);throw Error(t(171))}if(l.tag===1){var y=l.type;if(ts(y))return $u(l,y,u)}return u}function w2(l,u,y,M,P,U,G,se,de){return l=n1(y,M,!0,l,P,U,G,se,de),l.context=_2(null),y=l.current,M=ni(),P=Ic(y),U=Vn(M,P),U.callback=u??null,er(y,U,P),l.current.lanes=P,Pr(l,P,M),Si(l,M),l}function Vv(l,u,y,M){var P=u.current,U=ni(),G=Ic(P);return y=_2(y),u.context===null?u.context=y:u.pendingContext=y,u=Vn(U,G),u.payload={element:l},M=M===void 0?null:M,M!==null&&(u.callback=M),l=er(P,u,G),l!==null&&($o(l,P,G,U),ns(l,P,G)),G}function Hv(l){if(l=l.current,!l.child)return null;switch(l.child.tag){case 5:return l.child.stateNode;default:return l.child.stateNode}}function S2(l,u){if(l=l.memoizedState,l!==null&&l.dehydrated!==null){var y=l.retryLane;l.retryLane=y!==0&&y<u?y:u}}function r1(l,u){S2(l,u),(l=l.alternate)&&S2(l,u)}function IL(){return null}var b2=typeof reportError=="function"?reportError:function(l){console.error(l)};function s1(l){this._internalRoot=l}Gv.prototype.render=s1.prototype.render=function(l){var u=this._internalRoot;if(u===null)throw Error(t(409));Vv(l,u,null,null)},Gv.prototype.unmount=s1.prototype.unmount=function(){var l=this._internalRoot;if(l!==null){this._internalRoot=null;var u=l.containerInfo;ud(function(){Vv(null,l,null,null)}),u[Ks]=null}};function Gv(l){this._internalRoot=l}Gv.prototype.unstable_scheduleHydration=function(l){if(l){var u=kh();l={blockedOn:null,target:l,priority:u};for(var y=0;y<fa.length&&u!==0&&u<fa[y].priority;y++);fa.splice(y,0,l),y===0&&Oh(l)}};function i1(l){return!(!l||l.nodeType!==1&&l.nodeType!==9&&l.nodeType!==11)}function Wv(l){return!(!l||l.nodeType!==1&&l.nodeType!==9&&l.nodeType!==11&&(l.nodeType!==8||l.nodeValue!==" react-mount-point-unstable "))}function E2(){}function kL(l,u,y,M,P){if(P){if(typeof M=="function"){var U=M;M=function(){var Pe=Hv(G);U.call(Pe)}}var G=w2(u,M,l,0,null,!1,!1,"",E2);return l._reactRootContainer=G,l[Ks]=G.current,xc(l.nodeType===8?l.parentNode:l),ud(),G}for(;P=l.lastChild;)l.removeChild(P);if(typeof M=="function"){var se=M;M=function(){var Pe=Hv(de);se.call(Pe)}}var de=n1(l,0,!1,null,null,!1,!1,"",E2);return l._reactRootContainer=de,l[Ks]=de.current,xc(l.nodeType===8?l.parentNode:l),ud(function(){Vv(u,de,y,M)}),de}function $v(l,u,y,M,P){var U=y._reactRootContainer;if(U){var G=U;if(typeof P=="function"){var se=P;P=function(){var de=Hv(G);se.call(de)}}Vv(u,G,l,P)}else G=kL(y,u,l,P,M);return Hv(G)}Ru=function(l){switch(l.tag){case 3:var u=l.stateNode;if(u.current.memoizedState.isDehydrated){var y=gn(u.pendingLanes);y!==0&&(ur(u,y|1),Si(u,_e()),(Dn&6)===0&&(Rf=_e()+500,lo()))}break;case 13:ud(function(){var M=Hi(l,1);if(M!==null){var P=ni();$o(M,l,1,P)}}),r1(l,1)}},vm=function(l){if(l.tag===13){var u=Hi(l,134217728);if(u!==null){var y=ni();$o(u,l,134217728,y)}r1(l,134217728)}},nv=function(l){if(l.tag===13){var u=Ic(l),y=Hi(l,u);if(y!==null){var M=ni();$o(y,l,u,M)}r1(l,u)}},kh=function(){return Sn},Dh=function(l,u){var y=Sn;try{return Sn=l,u()}finally{Sn=y}},Je=function(l,u,y){switch(u){case"input":if(Ge(l,y),u=y.name,y.type==="radio"&&u!=null){for(y=l;y.parentNode;)y=y.parentNode;for(y=y.querySelectorAll("input[name="+JSON.stringify(""+u)+'][type="radio"]'),u=0;u<y.length;u++){var M=y[u];if(M!==l&&M.form===l.form){var P=hf(M);if(!P)throw Error(t(90));ht(M),Ge(M,P)}}}break;case"textarea":H(l,y);break;case"select":u=y.value,u!=null&&nt(l,!!y.multiple,u,!1)}},lt=Kw,Dt=ud;var DL={usingClientEntryPoint:!1,Events:[Io,dr,hf,ze,Be,Kw]},ug={findFiberByHostInstance:_a,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},LL={bundleType:ug.bundleType,version:ug.version,rendererPackageName:ug.rendererPackageName,rendererConfig:ug.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:A.ReactCurrentDispatcher,findHostInstanceByFiber:function(l){return l=Nh(l),l===null?null:l.stateNode},findFiberByHostInstance:ug.findFiberByHostInstance||IL,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var qv=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!qv.isDisabled&&qv.supportsFiber)try{Ft=qv.inject(LL),it=qv}catch{}}return bi.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=DL,bi.createPortal=function(l,u){var y=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!i1(u))throw Error(t(200));return PL(l,u,null,y)},bi.createRoot=function(l,u){if(!i1(l))throw Error(t(299));var y=!1,M="",P=b2;return u!=null&&(u.unstable_strictMode===!0&&(y=!0),u.identifierPrefix!==void 0&&(M=u.identifierPrefix),u.onRecoverableError!==void 0&&(P=u.onRecoverableError)),u=n1(l,1,!1,null,null,y,!1,M,P),l[Ks]=u.current,xc(l.nodeType===8?l.parentNode:l),new s1(u)},bi.findDOMNode=function(l){if(l==null)return null;if(l.nodeType===1)return l;var u=l._reactInternals;if(u===void 0)throw typeof l.render=="function"?Error(t(188)):(l=Object.keys(l).join(","),Error(t(268,l)));return l=Nh(u),l=l===null?null:l.stateNode,l},bi.flushSync=function(l){return ud(l)},bi.hydrate=function(l,u,y){if(!Wv(u))throw Error(t(200));return $v(null,l,u,!0,y)},bi.hydrateRoot=function(l,u,y){if(!i1(l))throw Error(t(405));var M=y!=null&&y.hydratedSources||null,P=!1,U="",G=b2;if(y!=null&&(y.unstable_strictMode===!0&&(P=!0),y.identifierPrefix!==void 0&&(U=y.identifierPrefix),y.onRecoverableError!==void 0&&(G=y.onRecoverableError)),u=w2(u,null,l,1,y??null,P,!1,U,G),l[Ks]=u.current,xc(l),M)for(l=0;l<M.length;l++)y=M[l],P=y._getVersion,P=P(y._source),u.mutableSourceEagerHydrationData==null?u.mutableSourceEagerHydrationData=[y,P]:u.mutableSourceEagerHydrationData.push(y,P);return new Gv(u)},bi.render=function(l,u,y){if(!Wv(u))throw Error(t(200));return $v(null,l,u,!1,y)},bi.unmountComponentAtNode=function(l){if(!Wv(l))throw Error(t(40));return l._reactRootContainer?(ud(function(){$v(null,null,l,!1,function(){l._reactRootContainer=null,l[Ks]=null})}),!0):!1},bi.unstable_batchedUpdates=Kw,bi.unstable_renderSubtreeIntoContainer=function(l,u,y,M){if(!Wv(y))throw Error(t(200));if(l==null||l._reactInternals===void 0)throw Error(t(38));return $v(l,u,y,!1,M)},bi.version="18.3.1-next-f1338f8080-20240426",bi}var D2;function MR(){if(D2)return c1.exports;D2=1;function r(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(r)}catch(e){console.error(e)}}return r(),c1.exports=$L(),c1.exports}var L2;function qL(){if(L2)return Yv;L2=1;var r=MR();return Yv.createRoot=r.createRoot,Yv.hydrateRoot=r.hydrateRoot,Yv}var XL=qL(),R=__();const re=y_(R),Qb=UL({__proto__:null,default:re},[R]),YL=1,KL=1e6;let h1=0;function QL(){return h1=(h1+1)%Number.MAX_SAFE_INTEGER,h1.toString()}const f1=new Map,O2=r=>{if(f1.has(r))return;const e=setTimeout(()=>{f1.delete(r),Ug({type:"REMOVE_TOAST",toastId:r})},KL);f1.set(r,e)},JL=(r,e)=>{switch(e.type){case"ADD_TOAST":return{...r,toasts:[e.toast,...r.toasts].slice(0,YL)};case"UPDATE_TOAST":return{...r,toasts:r.toasts.map(t=>t.id===e.toast.id?{...t,...e.toast}:t)};case"DISMISS_TOAST":{const{toastId:t}=e;return t?O2(t):r.toasts.forEach(n=>{O2(n.id)}),{...r,toasts:r.toasts.map(n=>n.id===t||t===void 0?{...n,open:!1}:n)}}case"REMOVE_TOAST":return e.toastId===void 0?{...r,toasts:[]}:{...r,toasts:r.toasts.filter(t=>t.id!==e.toastId)}}},oy=[];let ay={toasts:[]};function Ug(r){ay=JL(ay,r),oy.forEach(e=>{e(ay)})}function ZL({...r}){const e=QL(),t=s=>Ug({type:"UPDATE_TOAST",toast:{...s,id:e}}),n=()=>Ug({type:"DISMISS_TOAST",toastId:e});return Ug({type:"ADD_TOAST",toast:{...r,id:e,open:!0,onOpenChange:s=>{s||n()}}}),{id:e,dismiss:n,update:t}}function eO(){const[r,e]=R.useState(ay);return R.useEffect(()=>(oy.push(e),()=>{const t=oy.indexOf(e);t>-1&&oy.splice(t,1)}),[r]),{...r,toast:ZL,dismiss:t=>Ug({type:"DISMISS_TOAST",toastId:t})}}var Jp=MR();const TR=y_(Jp);function mt(r,e,{checkForDefaultPrevented:t=!0}={}){return function(s){if(r==null||r(s),t===!1||!s.defaultPrevented)return e==null?void 0:e(s)}}function j2(r,e){if(typeof r=="function")return r(e);r!=null&&(r.current=e)}function w_(...r){return e=>{let t=!1;const n=r.map(s=>{const i=j2(s,e);return!t&&typeof i=="function"&&(t=!0),i});if(t)return()=>{for(let s=0;s<n.length;s++){const i=n[s];typeof i=="function"?i():j2(r[s],null)}}}}function Cn(...r){return R.useCallback(w_(...r),r)}function tO(r,e){const t=R.createContext(e),n=i=>{const{children:o,...a}=i,c=R.useMemo(()=>a,Object.values(a));return h.jsx(t.Provider,{value:c,children:o})};n.displayName=r+"Provider";function s(i){const o=R.useContext(t);if(o)return o;if(e!==void 0)return e;throw new Error(`\`${i}\` must be used within \`${r}\``)}return[n,s]}function to(r,e=[]){let t=[];function n(i,o){const a=R.createContext(o),c=t.length;t=[...t,o];const d=m=>{var S;const{scope:v,children:x,..._}=m,b=((S=v==null?void 0:v[r])==null?void 0:S[c])||a,w=R.useMemo(()=>_,Object.values(_));return h.jsx(b.Provider,{value:w,children:x})};d.displayName=i+"Provider";function f(m,v){var b;const x=((b=v==null?void 0:v[r])==null?void 0:b[c])||a,_=R.useContext(x);if(_)return _;if(o!==void 0)return o;throw new Error(`\`${m}\` must be used within \`${i}\``)}return[d,f]}const s=()=>{const i=t.map(o=>R.createContext(o));return function(a){const c=(a==null?void 0:a[r])||i;return R.useMemo(()=>({[`__scope${r}`]:{...a,[r]:c}}),[a,c])}};return s.scopeName=r,[n,nO(s,...e)]}function nO(...r){const e=r[0];if(r.length===1)return e;const t=()=>{const n=r.map(s=>({useScope:s(),scopeName:s.scopeName}));return function(i){const o=n.reduce((a,{useScope:c,scopeName:d})=>{const m=c(i)[`__scope${d}`];return{...a,...m}},{});return R.useMemo(()=>({[`__scope${e.scopeName}`]:o}),[o])}};return t.scopeName=e.scopeName,t}function th(r){const e=sO(r),t=R.forwardRef((n,s)=>{const{children:i,...o}=n,a=R.Children.toArray(i),c=a.find(oO);if(c){const d=c.props.children,f=a.map(m=>m===c?R.Children.count(d)>1?R.Children.only(null):R.isValidElement(d)?d.props.children:null:m);return h.jsx(e,{...o,ref:s,children:R.isValidElement(d)?R.cloneElement(d,void 0,f):null})}return h.jsx(e,{...o,ref:s,children:i})});return t.displayName=`${r}.Slot`,t}var rO=th("Slot");function sO(r){const e=R.forwardRef((t,n)=>{const{children:s,...i}=t;if(R.isValidElement(s)){const o=lO(s),a=aO(i,s.props);return s.type!==R.Fragment&&(a.ref=n?w_(n,o):o),R.cloneElement(s,a)}return R.Children.count(s)>1?R.Children.only(null):null});return e.displayName=`${r}.SlotClone`,e}var CR=Symbol("radix.slottable");function iO(r){const e=({children:t})=>h.jsx(h.Fragment,{children:t});return e.displayName=`${r}.Slottable`,e.__radixId=CR,e}function oO(r){return R.isValidElement(r)&&typeof r.type=="function"&&"__radixId"in r.type&&r.type.__radixId===CR}function aO(r,e){const t={...e};for(const n in e){const s=r[n],i=e[n];/^on[A-Z]/.test(n)?s&&i?t[n]=(...a)=>{const c=i(...a);return s(...a),c}:s&&(t[n]=s):n==="style"?t[n]={...s,...i}:n==="className"&&(t[n]=[s,i].filter(Boolean).join(" "))}return{...r,...t}}function lO(r){var n,s;let e=(n=Object.getOwnPropertyDescriptor(r.props,"ref"))==null?void 0:n.get,t=e&&"isReactWarning"in e&&e.isReactWarning;return t?r.ref:(e=(s=Object.getOwnPropertyDescriptor(r,"ref"))==null?void 0:s.get,t=e&&"isReactWarning"in e&&e.isReactWarning,t?r.props.ref:r.props.ref||r.ref)}function S_(r){const e=r+"CollectionProvider",[t,n]=to(e),[s,i]=t(e,{collectionRef:{current:null},itemMap:new Map}),o=b=>{const{scope:w,children:S}=b,C=re.useRef(null),T=re.useRef(new Map).current;return h.jsx(s,{scope:w,itemMap:T,collectionRef:C,children:S})};o.displayName=e;const a=r+"CollectionSlot",c=th(a),d=re.forwardRef((b,w)=>{const{scope:S,children:C}=b,T=i(a,S),A=Cn(w,T.collectionRef);return h.jsx(c,{ref:A,children:C})});d.displayName=a;const f=r+"CollectionItemSlot",m="data-radix-collection-item",v=th(f),x=re.forwardRef((b,w)=>{const{scope:S,children:C,...T}=b,A=re.useRef(null),k=Cn(w,A),j=i(f,S);return re.useEffect(()=>(j.itemMap.set(A,{ref:A,...T}),()=>void j.itemMap.delete(A))),h.jsx(v,{[m]:"",ref:k,children:C})});x.displayName=f;function _(b){const w=i(r+"CollectionConsumer",b);return re.useCallback(()=>{const C=w.collectionRef.current;if(!C)return[];const T=Array.from(C.querySelectorAll(`[${m}]`));return Array.from(w.itemMap.values()).sort((j,D)=>T.indexOf(j.ref.current)-T.indexOf(D.ref.current))},[w.collectionRef,w.itemMap])}return[{Provider:o,Slot:d,ItemSlot:x},_,n]}var cO=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"],$t=cO.reduce((r,e)=>{const t=th(`Primitive.${e}`),n=R.forwardRef((s,i)=>{const{asChild:o,...a}=s,c=o?t:e;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),h.jsx(c,{...a,ref:i})});return n.displayName=`Primitive.${e}`,{...r,[e]:n}},{});function Jb(r,e){r&&Jp.flushSync(()=>r.dispatchEvent(e))}function Di(r){const e=R.useRef(r);return R.useEffect(()=>{e.current=r}),R.useMemo(()=>(...t)=>{var n;return(n=e.current)==null?void 0:n.call(e,...t)},[])}function uO(r,e=globalThis==null?void 0:globalThis.document){const t=Di(r);R.useEffect(()=>{const n=s=>{s.key==="Escape"&&t(s)};return e.addEventListener("keydown",n,{capture:!0}),()=>e.removeEventListener("keydown",n,{capture:!0})},[t,e])}var dO="DismissableLayer",BS="dismissableLayer.update",hO="dismissableLayer.pointerDownOutside",fO="dismissableLayer.focusOutside",F2,AR=R.createContext({layers:new Set,layersWithOutsidePointerEventsDisabled:new Set,branches:new Set}),Zp=R.forwardRef((r,e)=>{const{disableOutsidePointerEvents:t=!1,onEscapeKeyDown:n,onPointerDownOutside:s,onFocusOutside:i,onInteractOutside:o,onDismiss:a,...c}=r,d=R.useContext(AR),[f,m]=R.useState(null),v=(f==null?void 0:f.ownerDocument)??(globalThis==null?void 0:globalThis.document),[,x]=R.useState({}),_=Cn(e,D=>m(D)),b=Array.from(d.layers),[w]=[...d.layersWithOutsidePointerEventsDisabled].slice(-1),S=b.indexOf(w),C=f?b.indexOf(f):-1,T=d.layersWithOutsidePointerEventsDisabled.size>0,A=C>=S,k=mO(D=>{const L=D.target,O=[...d.branches].some(I=>I.contains(L));!A||O||(s==null||s(D),o==null||o(D),D.defaultPrevented||a==null||a())},v),j=gO(D=>{const L=D.target;[...d.branches].some(I=>I.contains(L))||(i==null||i(D),o==null||o(D),D.defaultPrevented||a==null||a())},v);return uO(D=>{C===d.layers.size-1&&(n==null||n(D),!D.defaultPrevented&&a&&(D.preventDefault(),a()))},v),R.useEffect(()=>{if(f)return t&&(d.layersWithOutsidePointerEventsDisabled.size===0&&(F2=v.body.style.pointerEvents,v.body.style.pointerEvents="none"),d.layersWithOutsidePointerEventsDisabled.add(f)),d.layers.add(f),U2(),()=>{t&&d.layersWithOutsidePointerEventsDisabled.size===1&&(v.body.style.pointerEvents=F2)}},[f,v,t,d]),R.useEffect(()=>()=>{f&&(d.layers.delete(f),d.layersWithOutsidePointerEventsDisabled.delete(f),U2())},[f,d]),R.useEffect(()=>{const D=()=>x({});return document.addEventListener(BS,D),()=>document.removeEventListener(BS,D)},[]),h.jsx($t.div,{...c,ref:_,style:{pointerEvents:T?A?"auto":"none":void 0,...r.style},onFocusCapture:mt(r.onFocusCapture,j.onFocusCapture),onBlurCapture:mt(r.onBlurCapture,j.onBlurCapture),onPointerDownCapture:mt(r.onPointerDownCapture,k.onPointerDownCapture)})});Zp.displayName=dO;var pO="DismissableLayerBranch",RR=R.forwardRef((r,e)=>{const t=R.useContext(AR),n=R.useRef(null),s=Cn(e,n);return R.useEffect(()=>{const i=n.current;if(i)return t.branches.add(i),()=>{t.branches.delete(i)}},[t.branches]),h.jsx($t.div,{...r,ref:s})});RR.displayName=pO;function mO(r,e=globalThis==null?void 0:globalThis.document){const t=Di(r),n=R.useRef(!1),s=R.useRef(()=>{});return R.useEffect(()=>{const i=a=>{if(a.target&&!n.current){let c=function(){NR(hO,t,d,{discrete:!0})};const d={originalEvent:a};a.pointerType==="touch"?(e.removeEventListener("click",s.current),s.current=c,e.addEventListener("click",s.current,{once:!0})):c()}else e.removeEventListener("click",s.current);n.current=!1},o=window.setTimeout(()=>{e.addEventListener("pointerdown",i)},0);return()=>{window.clearTimeout(o),e.removeEventListener("pointerdown",i),e.removeEventListener("click",s.current)}},[e,t]),{onPointerDownCapture:()=>n.current=!0}}function gO(r,e=globalThis==null?void 0:globalThis.document){const t=Di(r),n=R.useRef(!1);return R.useEffect(()=>{const s=i=>{i.target&&!n.current&&NR(fO,t,{originalEvent:i},{discrete:!1})};return e.addEventListener("focusin",s),()=>e.removeEventListener("focusin",s)},[e,t]),{onFocusCapture:()=>n.current=!0,onBlurCapture:()=>n.current=!1}}function U2(){const r=new CustomEvent(BS);document.dispatchEvent(r)}function NR(r,e,t,{discrete:n}){const s=t.originalEvent.target,i=new CustomEvent(r,{bubbles:!1,cancelable:!0,detail:t});e&&s.addEventListener(r,e,{once:!0}),n?Jb(s,i):s.dispatchEvent(i)}var vO=Zp,xO=RR,Es=globalThis!=null&&globalThis.document?R.useLayoutEffect:()=>{},yO="Portal",D0=R.forwardRef((r,e)=>{var a;const{container:t,...n}=r,[s,i]=R.useState(!1);Es(()=>i(!0),[]);const o=t||s&&((a=globalThis==null?void 0:globalThis.document)==null?void 0:a.body);return o?TR.createPortal(h.jsx($t.div,{...n,ref:e}),o):null});D0.displayName=yO;function _O(r,e){return R.useReducer((t,n)=>e[t][n]??t,r)}var wo=r=>{const{present:e,children:t}=r,n=wO(e),s=typeof t=="function"?t({present:n.isPresent}):R.Children.only(t),i=Cn(n.ref,SO(s));return typeof t=="function"||n.isPresent?R.cloneElement(s,{ref:i}):null};wo.displayName="Presence";function wO(r){const[e,t]=R.useState(),n=R.useRef(null),s=R.useRef(r),i=R.useRef("none"),o=r?"mounted":"unmounted",[a,c]=_O(o,{mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}});return R.useEffect(()=>{const d=Kv(n.current);i.current=a==="mounted"?d:"none"},[a]),Es(()=>{const d=n.current,f=s.current;if(f!==r){const v=i.current,x=Kv(d);r?c("MOUNT"):x==="none"||(d==null?void 0:d.display)==="none"?c("UNMOUNT"):c(f&&v!==x?"ANIMATION_OUT":"UNMOUNT"),s.current=r}},[r,c]),Es(()=>{if(e){let d;const f=e.ownerDocument.defaultView??window,m=x=>{const b=Kv(n.current).includes(x.animationName);if(x.target===e&&b&&(c("ANIMATION_END"),!s.current)){const w=e.style.animationFillMode;e.style.animationFillMode="forwards",d=f.setTimeout(()=>{e.style.animationFillMode==="forwards"&&(e.style.animationFillMode=w)})}},v=x=>{x.target===e&&(i.current=Kv(n.current))};return e.addEventListener("animationstart",v),e.addEventListener("animationcancel",m),e.addEventListener("animationend",m),()=>{f.clearTimeout(d),e.removeEventListener("animationstart",v),e.removeEventListener("animationcancel",m),e.removeEventListener("animationend",m)}}else c("ANIMATION_END")},[e,c]),{isPresent:["mounted","unmountSuspended"].includes(a),ref:R.useCallback(d=>{n.current=d?getComputedStyle(d):null,t(d)},[])}}function Kv(r){return(r==null?void 0:r.animationName)||"none"}function SO(r){var n,s;let e=(n=Object.getOwnPropertyDescriptor(r.props,"ref"))==null?void 0:n.get,t=e&&"isReactWarning"in e&&e.isReactWarning;return t?r.ref:(e=(s=Object.getOwnPropertyDescriptor(r,"ref"))==null?void 0:s.get,t=e&&"isReactWarning"in e&&e.isReactWarning,t?r.props.ref:r.props.ref||r.ref)}var bO=Qb[" useInsertionEffect ".trim().toString()]||Es;function ql({prop:r,defaultProp:e,onChange:t=()=>{},caller:n}){const[s,i,o]=EO({defaultProp:e,onChange:t}),a=r!==void 0,c=a?r:s;{const f=R.useRef(r!==void 0);R.useEffect(()=>{const m=f.current;m!==a&&console.warn(`${n} is changing from ${m?"controlled":"uncontrolled"} to ${a?"controlled":"uncontrolled"}. Components should not switch from controlled to uncontrolled (or vice versa). Decide between using a controlled or uncontrolled value for the lifetime of the component.`),f.current=a},[a,n])}const d=R.useCallback(f=>{var m;if(a){const v=MO(f)?f(r):f;v!==r&&((m=o.current)==null||m.call(o,v))}else i(f)},[a,r,i,o]);return[c,d]}function EO({defaultProp:r,onChange:e}){const[t,n]=R.useState(r),s=R.useRef(t),i=R.useRef(e);return bO(()=>{i.current=e},[e]),R.useEffect(()=>{var o;s.current!==t&&((o=i.current)==null||o.call(i,t),s.current=t)},[t,s]),[t,n,i]}function MO(r){return typeof r=="function"}var PR=Object.freeze({position:"absolute",border:0,width:1,height:1,padding:0,margin:-1,overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",wordWrap:"normal"}),TO="VisuallyHidden",b_=R.forwardRef((r,e)=>h.jsx($t.span,{...r,ref:e,style:{...PR,...r.style}}));b_.displayName=TO;var CO=b_,Zb="ToastProvider",[eE,AO,RO]=S_("Toast"),[IR,Iee]=to("Toast",[RO]),[NO,E_]=IR(Zb),kR=r=>{const{__scopeToast:e,label:t="Notification",duration:n=5e3,swipeDirection:s="right",swipeThreshold:i=50,children:o}=r,[a,c]=R.useState(null),[d,f]=R.useState(0),m=R.useRef(!1),v=R.useRef(!1);return t.trim()||console.error(`Invalid prop \`label\` supplied to \`${Zb}\`. Expected non-empty \`string\`.`),h.jsx(eE.Provider,{scope:e,children:h.jsx(NO,{scope:e,label:t,duration:n,swipeDirection:s,swipeThreshold:i,toastCount:d,viewport:a,onViewportChange:c,onToastAdd:R.useCallback(()=>f(x=>x+1),[]),onToastRemove:R.useCallback(()=>f(x=>x-1),[]),isFocusedToastEscapeKeyDownRef:m,isClosePausedRef:v,children:o})})};kR.displayName=Zb;var DR="ToastViewport",PO=["F8"],zS="toast.viewportPause",VS="toast.viewportResume",LR=R.forwardRef((r,e)=>{const{__scopeToast:t,hotkey:n=PO,label:s="Notifications ({hotkey})",...i}=r,o=E_(DR,t),a=AO(t),c=R.useRef(null),d=R.useRef(null),f=R.useRef(null),m=R.useRef(null),v=Cn(e,m,o.onViewportChange),x=n.join("+").replace(/Key/g,"").replace(/Digit/g,""),_=o.toastCount>0;R.useEffect(()=>{const w=S=>{var T;n.length!==0&&n.every(A=>S[A]||S.code===A)&&((T=m.current)==null||T.focus())};return document.addEventListener("keydown",w),()=>document.removeEventListener("keydown",w)},[n]),R.useEffect(()=>{const w=c.current,S=m.current;if(_&&w&&S){const C=()=>{if(!o.isClosePausedRef.current){const j=new CustomEvent(zS);S.dispatchEvent(j),o.isClosePausedRef.current=!0}},T=()=>{if(o.isClosePausedRef.current){const j=new CustomEvent(VS);S.dispatchEvent(j),o.isClosePausedRef.current=!1}},A=j=>{!w.contains(j.relatedTarget)&&T()},k=()=>{w.contains(document.activeElement)||T()};return w.addEventListener("focusin",C),w.addEventListener("focusout",A),w.addEventListener("pointermove",C),w.addEventListener("pointerleave",k),window.addEventListener("blur",C),window.addEventListener("focus",T),()=>{w.removeEventListener("focusin",C),w.removeEventListener("focusout",A),w.removeEventListener("pointermove",C),w.removeEventListener("pointerleave",k),window.removeEventListener("blur",C),window.removeEventListener("focus",T)}}},[_,o.isClosePausedRef]);const b=R.useCallback(({tabbingDirection:w})=>{const C=a().map(T=>{const A=T.ref.current,k=[A,...GO(A)];return w==="forwards"?k:k.reverse()});return(w==="forwards"?C.reverse():C).flat()},[a]);return R.useEffect(()=>{const w=m.current;if(w){const S=C=>{var k,j,D;const T=C.altKey||C.ctrlKey||C.metaKey;if(C.key==="Tab"&&!T){const L=document.activeElement,O=C.shiftKey;if(C.target===w&&O){(k=d.current)==null||k.focus();return}const W=b({tabbingDirection:O?"backwards":"forwards"}),K=W.findIndex(ee=>ee===L);p1(W.slice(K+1))?C.preventDefault():O?(j=d.current)==null||j.focus():(D=f.current)==null||D.focus()}};return w.addEventListener("keydown",S),()=>w.removeEventListener("keydown",S)}},[a,b]),h.jsxs(xO,{ref:c,role:"region","aria-label":s.replace("{hotkey}",x),tabIndex:-1,style:{pointerEvents:_?void 0:"none"},children:[_&&h.jsx(HS,{ref:d,onFocusFromOutsideViewport:()=>{const w=b({tabbingDirection:"forwards"});p1(w)}}),h.jsx(eE.Slot,{scope:t,children:h.jsx($t.ol,{tabIndex:-1,...i,ref:v})}),_&&h.jsx(HS,{ref:f,onFocusFromOutsideViewport:()=>{const w=b({tabbingDirection:"backwards"});p1(w)}})]})});LR.displayName=DR;var OR="ToastFocusProxy",HS=R.forwardRef((r,e)=>{const{__scopeToast:t,onFocusFromOutsideViewport:n,...s}=r,i=E_(OR,t);return h.jsx(b_,{"aria-hidden":!0,tabIndex:0,...s,ref:e,style:{position:"fixed"},onFocus:o=>{var d;const a=o.relatedTarget;!((d=i.viewport)!=null&&d.contains(a))&&n()}})});HS.displayName=OR;var L0="Toast",IO="toast.swipeStart",kO="toast.swipeMove",DO="toast.swipeCancel",LO="toast.swipeEnd",jR=R.forwardRef((r,e)=>{const{forceMount:t,open:n,defaultOpen:s,onOpenChange:i,...o}=r,[a,c]=ql({prop:n,defaultProp:s??!0,onChange:i,caller:L0});return h.jsx(wo,{present:t||a,children:h.jsx(FO,{open:a,...o,ref:e,onClose:()=>c(!1),onPause:Di(r.onPause),onResume:Di(r.onResume),onSwipeStart:mt(r.onSwipeStart,d=>{d.currentTarget.setAttribute("data-swipe","start")}),onSwipeMove:mt(r.onSwipeMove,d=>{const{x:f,y:m}=d.detail.delta;d.currentTarget.setAttribute("data-swipe","move"),d.currentTarget.style.setProperty("--radix-toast-swipe-move-x",`${f}px`),d.currentTarget.style.setProperty("--radix-toast-swipe-move-y",`${m}px`)}),onSwipeCancel:mt(r.onSwipeCancel,d=>{d.currentTarget.setAttribute("data-swipe","cancel"),d.currentTarget.style.removeProperty("--radix-toast-swipe-move-x"),d.currentTarget.style.removeProperty("--radix-toast-swipe-move-y"),d.currentTarget.style.removeProperty("--radix-toast-swipe-end-x"),d.currentTarget.style.removeProperty("--radix-toast-swipe-end-y")}),onSwipeEnd:mt(r.onSwipeEnd,d=>{const{x:f,y:m}=d.detail.delta;d.currentTarget.setAttribute("data-swipe","end"),d.currentTarget.style.removeProperty("--radix-toast-swipe-move-x"),d.currentTarget.style.removeProperty("--radix-toast-swipe-move-y"),d.currentTarget.style.setProperty("--radix-toast-swipe-end-x",`${f}px`),d.currentTarget.style.setProperty("--radix-toast-swipe-end-y",`${m}px`),c(!1)})})})});jR.displayName=L0;var[OO,jO]=IR(L0,{onClose(){}}),FO=R.forwardRef((r,e)=>{const{__scopeToast:t,type:n="foreground",duration:s,open:i,onClose:o,onEscapeKeyDown:a,onPause:c,onResume:d,onSwipeStart:f,onSwipeMove:m,onSwipeCancel:v,onSwipeEnd:x,..._}=r,b=E_(L0,t),[w,S]=R.useState(null),C=Cn(e,ee=>S(ee)),T=R.useRef(null),A=R.useRef(null),k=s||b.duration,j=R.useRef(0),D=R.useRef(k),L=R.useRef(0),{onToastAdd:O,onToastRemove:I}=b,B=Di(()=>{var oe;(w==null?void 0:w.contains(document.activeElement))&&((oe=b.viewport)==null||oe.focus()),o()}),W=R.useCallback(ee=>{!ee||ee===1/0||(window.clearTimeout(L.current),j.current=new Date().getTime(),L.current=window.setTimeout(B,ee))},[B]);R.useEffect(()=>{const ee=b.viewport;if(ee){const oe=()=>{W(D.current),d==null||d()},ne=()=>{const ce=new Date().getTime()-j.current;D.current=D.current-ce,window.clearTimeout(L.current),c==null||c()};return ee.addEventListener(zS,ne),ee.addEventListener(VS,oe),()=>{ee.removeEventListener(zS,ne),ee.removeEventListener(VS,oe)}}},[b.viewport,k,c,d,W]),R.useEffect(()=>{i&&!b.isClosePausedRef.current&&W(k)},[i,k,b.isClosePausedRef,W]),R.useEffect(()=>(O(),()=>I()),[O,I]);const K=R.useMemo(()=>w?GR(w):null,[w]);return b.viewport?h.jsxs(h.Fragment,{children:[K&&h.jsx(UO,{__scopeToast:t,role:"status","aria-live":n==="foreground"?"assertive":"polite","aria-atomic":!0,children:K}),h.jsx(OO,{scope:t,onClose:B,children:Jp.createPortal(h.jsx(eE.ItemSlot,{scope:t,children:h.jsx(vO,{asChild:!0,onEscapeKeyDown:mt(a,()=>{b.isFocusedToastEscapeKeyDownRef.current||B(),b.isFocusedToastEscapeKeyDownRef.current=!1}),children:h.jsx($t.li,{role:"status","aria-live":"off","aria-atomic":!0,tabIndex:0,"data-state":i?"open":"closed","data-swipe-direction":b.swipeDirection,..._,ref:C,style:{userSelect:"none",touchAction:"none",...r.style},onKeyDown:mt(r.onKeyDown,ee=>{ee.key==="Escape"&&(a==null||a(ee.nativeEvent),ee.nativeEvent.defaultPrevented||(b.isFocusedToastEscapeKeyDownRef.current=!0,B()))}),onPointerDown:mt(r.onPointerDown,ee=>{ee.button===0&&(T.current={x:ee.clientX,y:ee.clientY})}),onPointerMove:mt(r.onPointerMove,ee=>{if(!T.current)return;const oe=ee.clientX-T.current.x,ne=ee.clientY-T.current.y,ce=!!A.current,V=["left","right"].includes(b.swipeDirection),q=["left","up"].includes(b.swipeDirection)?Math.min:Math.max,Z=V?q(0,oe):0,X=V?0:q(0,ne),ie=ee.pointerType==="touch"?10:2,be={x:Z,y:X},ue={originalEvent:ee,delta:be};ce?(A.current=be,Qv(kO,m,ue,{discrete:!1})):B2(be,b.swipeDirection,ie)?(A.current=be,Qv(IO,f,ue,{discrete:!1}),ee.target.setPointerCapture(ee.pointerId)):(Math.abs(oe)>ie||Math.abs(ne)>ie)&&(T.current=null)}),onPointerUp:mt(r.onPointerUp,ee=>{const oe=A.current,ne=ee.target;if(ne.hasPointerCapture(ee.pointerId)&&ne.releasePointerCapture(ee.pointerId),A.current=null,T.current=null,oe){const ce=ee.currentTarget,V={originalEvent:ee,delta:oe};B2(oe,b.swipeDirection,b.swipeThreshold)?Qv(LO,x,V,{discrete:!0}):Qv(DO,v,V,{discrete:!0}),ce.addEventListener("click",q=>q.preventDefault(),{once:!0})}})})})}),b.viewport)})]}):null}),UO=r=>{const{__scopeToast:e,children:t,...n}=r,s=E_(L0,e),[i,o]=R.useState(!1),[a,c]=R.useState(!1);return VO(()=>o(!0)),R.useEffect(()=>{const d=window.setTimeout(()=>c(!0),1e3);return()=>window.clearTimeout(d)},[]),a?null:h.jsx(D0,{asChild:!0,children:h.jsx(b_,{...n,children:i&&h.jsxs(h.Fragment,{children:[s.label," ",t]})})})},BO="ToastTitle",FR=R.forwardRef((r,e)=>{const{__scopeToast:t,...n}=r;return h.jsx($t.div,{...n,ref:e})});FR.displayName=BO;var zO="ToastDescription",UR=R.forwardRef((r,e)=>{const{__scopeToast:t,...n}=r;return h.jsx($t.div,{...n,ref:e})});UR.displayName=zO;var BR="ToastAction",zR=R.forwardRef((r,e)=>{const{altText:t,...n}=r;return t.trim()?h.jsx(HR,{altText:t,asChild:!0,children:h.jsx(tE,{...n,ref:e})}):(console.error(`Invalid prop \`altText\` supplied to \`${BR}\`. Expected non-empty \`string\`.`),null)});zR.displayName=BR;var VR="ToastClose",tE=R.forwardRef((r,e)=>{const{__scopeToast:t,...n}=r,s=jO(VR,t);return h.jsx(HR,{asChild:!0,children:h.jsx($t.button,{type:"button",...n,ref:e,onClick:mt(r.onClick,s.onClose)})})});tE.displayName=VR;var HR=R.forwardRef((r,e)=>{const{__scopeToast:t,altText:n,...s}=r;return h.jsx($t.div,{"data-radix-toast-announce-exclude":"","data-radix-toast-announce-alt":n||void 0,...s,ref:e})});function GR(r){const e=[];return Array.from(r.childNodes).forEach(n=>{if(n.nodeType===n.TEXT_NODE&&n.textContent&&e.push(n.textContent),HO(n)){const s=n.ariaHidden||n.hidden||n.style.display==="none",i=n.dataset.radixToastAnnounceExclude==="";if(!s)if(i){const o=n.dataset.radixToastAnnounceAlt;o&&e.push(o)}else e.push(...GR(n))}}),e}function Qv(r,e,t,{discrete:n}){const s=t.originalEvent.currentTarget,i=new CustomEvent(r,{bubbles:!0,cancelable:!0,detail:t});e&&s.addEventListener(r,e,{once:!0}),n?Jb(s,i):s.dispatchEvent(i)}var B2=(r,e,t=0)=>{const n=Math.abs(r.x),s=Math.abs(r.y),i=n>s;return e==="left"||e==="right"?i&&n>t:!i&&s>t};function VO(r=()=>{}){const e=Di(r);Es(()=>{let t=0,n=0;return t=window.requestAnimationFrame(()=>n=window.requestAnimationFrame(e)),()=>{window.cancelAnimationFrame(t),window.cancelAnimationFrame(n)}},[e])}function HO(r){return r.nodeType===r.ELEMENT_NODE}function GO(r){const e=[],t=document.createTreeWalker(r,NodeFilter.SHOW_ELEMENT,{acceptNode:n=>{const s=n.tagName==="INPUT"&&n.type==="hidden";return n.disabled||n.hidden||s?NodeFilter.FILTER_SKIP:n.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;t.nextNode();)e.push(t.currentNode);return e}function p1(r){const e=document.activeElement;return r.some(t=>t===e?!0:(t.focus(),document.activeElement!==e))}var WO=kR,WR=LR,$R=jR,qR=FR,XR=UR,YR=zR,KR=tE;function QR(r){var e,t,n="";if(typeof r=="string"||typeof r=="number")n+=r;else if(typeof r=="object")if(Array.isArray(r)){var s=r.length;for(e=0;e<s;e++)r[e]&&(t=QR(r[e]))&&(n&&(n+=" "),n+=t)}else for(t in r)r[t]&&(n&&(n+=" "),n+=t);return n}function JR(){for(var r,e,t=0,n="",s=arguments.length;t<s;t++)(r=arguments[t])&&(e=QR(r))&&(n&&(n+=" "),n+=e);return n}const z2=r=>typeof r=="boolean"?`${r}`:r===0?"0":r,V2=JR,M_=(r,e)=>t=>{var n;if((e==null?void 0:e.variants)==null)return V2(r,t==null?void 0:t.class,t==null?void 0:t.className);const{variants:s,defaultVariants:i}=e,o=Object.keys(s).map(d=>{const f=t==null?void 0:t[d],m=i==null?void 0:i[d];if(f===null)return null;const v=z2(f)||z2(m);return s[d][v]}),a=t&&Object.entries(t).reduce((d,f)=>{let[m,v]=f;return v===void 0||(d[m]=v),d},{}),c=e==null||(n=e.compoundVariants)===null||n===void 0?void 0:n.reduce((d,f)=>{let{class:m,className:v,...x}=f;return Object.entries(x).every(_=>{let[b,w]=_;return Array.isArray(w)?w.includes({...i,...a}[b]):{...i,...a}[b]===w})?[...d,m,v]:d},[]);return V2(r,o,c,t==null?void 0:t.class,t==null?void 0:t.className)};/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $O=r=>r.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),ZR=(...r)=>r.filter((e,t,n)=>!!e&&e.trim()!==""&&n.indexOf(e)===t).join(" ").trim();/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var qO={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const XO=R.forwardRef(({color:r="currentColor",size:e=24,strokeWidth:t=2,absoluteStrokeWidth:n,className:s="",children:i,iconNode:o,...a},c)=>R.createElement("svg",{ref:c,...qO,width:e,height:e,stroke:r,strokeWidth:n?Number(t)*24/Number(e):t,className:ZR("lucide",s),...a},[...o.map(([d,f])=>R.createElement(d,f)),...Array.isArray(i)?i:[i]]));/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qt=(r,e)=>{const t=R.forwardRef(({className:n,...s},i)=>R.createElement(XO,{ref:i,iconNode:e,className:ZR(`lucide-${$O(r)}`,n),...s}));return t.displayName=`${r}`,t};/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const em=Qt("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const YO=Qt("ArrowRight",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const za=Qt("BookOpen",[["path",{d:"M12 7v14",key:"1akyts"}],["path",{d:"M3 18a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1h5a4 4 0 0 1 4 4 4 4 0 0 1 4-4h5a1 1 0 0 1 1 1v13a1 1 0 0 1-1 1h-6a3 3 0 0 0-3 3 3 3 0 0 0-3-3z",key:"ruj8y"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const H2=Qt("Bot",[["path",{d:"M12 8V4H8",key:"hb8ula"}],["rect",{width:"16",height:"12",x:"4",y:"8",rx:"2",key:"enze0r"}],["path",{d:"M2 14h2",key:"vft8re"}],["path",{d:"M20 14h2",key:"4cs60a"}],["path",{d:"M15 13v2",key:"1xurst"}],["path",{d:"M9 13v2",key:"rq6x2g"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const KO=Qt("Calculator",[["rect",{width:"16",height:"20",x:"4",y:"2",rx:"2",key:"1nb95v"}],["line",{x1:"8",x2:"16",y1:"6",y2:"6",key:"x4nwl0"}],["line",{x1:"16",x2:"16",y1:"14",y2:"18",key:"wjye3r"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M8 14h.01",key:"6423bh"}],["path",{d:"M12 18h.01",key:"mhygvu"}],["path",{d:"M8 18h.01",key:"lrp35t"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const T_=Qt("Calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ly=Qt("ChartColumn",[["path",{d:"M3 3v16a2 2 0 0 0 2 2h16",key:"c24i48"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const t0=Qt("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nh=Qt("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const QO=Qt("ChevronLeft",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const n0=Qt("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const eN=Qt("ChevronUp",[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ar=Qt("CircleCheckBig",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tN=Qt("Circle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const JO=Qt("Clipboard",[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fu=Qt("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ZO=Qt("Eraser",[["path",{d:"m7 21-4.3-4.3c-1-1-1-2.5 0-3.4l9.6-9.6c1-1 2.5-1 3.4 0l5.6 5.6c1 1 1 2.5 0 3.4L13 21",key:"182aya"}],["path",{d:"M22 21H7",key:"t4ddhn"}],["path",{d:"m5 11 9 9",key:"1mo9qw"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const e5=Qt("ExternalLink",[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"M10 14 21 3",key:"gplh6r"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Sp=Qt("FileText",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const t5=Qt("FlaskConical",[["path",{d:"M10 2v7.527a2 2 0 0 1-.211.896L4.72 20.55a1 1 0 0 0 .9 1.45h12.76a1 1 0 0 0 .9-1.45l-5.069-10.127A2 2 0 0 1 14 9.527V2",key:"pzvekw"}],["path",{d:"M8.5 2h7",key:"csnxdl"}],["path",{d:"M7 16h10",key:"wp8him"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const n5=Qt("Info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xl=Qt("LoaderCircle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const r5=Qt("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const GS=Qt("MessageSquare",[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nN=Qt("MicOff",[["line",{x1:"2",x2:"22",y1:"2",y2:"22",key:"a6p6uj"}],["path",{d:"M18.89 13.23A7.12 7.12 0 0 0 19 12v-2",key:"80xlxr"}],["path",{d:"M5 10v2a7 7 0 0 0 12 5",key:"p2k8kg"}],["path",{d:"M15 9.34V5a3 3 0 0 0-5.68-1.33",key:"1gzdoj"}],["path",{d:"M9 9v3a3 3 0 0 0 5.12 2.12",key:"r2i35w"}],["line",{x1:"12",x2:"12",y1:"19",y2:"22",key:"x3vr5v"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rN=Qt("Mic",[["path",{d:"M12 2a3 3 0 0 0-3 3v7a3 3 0 0 0 6 0V5a3 3 0 0 0-3-3Z",key:"131961"}],["path",{d:"M19 10v2a7 7 0 0 1-14 0v-2",key:"1vc78b"}],["line",{x1:"12",x2:"12",y1:"19",y2:"22",key:"x3vr5v"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const s5=Qt("Minimize2",[["polyline",{points:"4 14 10 14 10 20",key:"11kfnr"}],["polyline",{points:"20 10 14 10 14 4",key:"rlmsce"}],["line",{x1:"14",x2:"21",y1:"10",y2:"3",key:"o5lafz"}],["line",{x1:"3",x2:"10",y1:"21",y2:"14",key:"1atl0r"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const i5=Qt("Palette",[["circle",{cx:"13.5",cy:"6.5",r:".5",fill:"currentColor",key:"1okk4w"}],["circle",{cx:"17.5",cy:"10.5",r:".5",fill:"currentColor",key:"f64h9f"}],["circle",{cx:"8.5",cy:"7.5",r:".5",fill:"currentColor",key:"fotxhn"}],["circle",{cx:"6.5",cy:"12.5",r:".5",fill:"currentColor",key:"qy21gx"}],["path",{d:"M12 2C6.5 2 2 6.5 2 12s4.5 10 10 10c.926 0 1.648-.746 1.648-1.688 0-.437-.18-.835-.437-1.125-.29-.289-.438-.652-.438-1.125a1.64 1.64 0 0 1 1.668-1.668h1.996c3.051 0 5.555-2.503 5.555-5.554C21.965 6.012 17.461 2 12 2z",key:"12rzf8"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rh=Qt("Play",[["polygon",{points:"6 3 20 12 6 21 6 3",key:"1oa8hb"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sN=Qt("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Yd=Qt("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nE=Qt("RotateCcw",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const C_=Qt("Save",[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const o5=Qt("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const a5=Qt("Send",[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z",key:"1ffxy3"}],["path",{d:"m21.854 2.147-10.94 10.939",key:"12cjpa"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const r0=Qt("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const l5=Qt("Shuffle",[["path",{d:"m18 14 4 4-4 4",key:"10pe0f"}],["path",{d:"m18 2 4 4-4 4",key:"pucp1d"}],["path",{d:"M2 18h1.973a4 4 0 0 0 3.3-1.7l5.454-8.6a4 4 0 0 1 3.3-1.7H22",key:"1ailkh"}],["path",{d:"M2 6h1.972a4 4 0 0 1 3.6 2.2",key:"km57vx"}],["path",{d:"M22 18h-6.041a4 4 0 0 1-3.3-1.8l-.359-.45",key:"os18l9"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const c5=Qt("Sigma",[["path",{d:"M18 7V5a1 1 0 0 0-1-1H6.5a.5.5 0 0 0-.4.8l4.5 6a2 2 0 0 1 0 2.4l-4.5 6a.5.5 0 0 0 .4.8H17a1 1 0 0 0 1-1v-2",key:"wuwx1p"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const u5=Qt("SquarePen",[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sh=Qt("Target",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const d5=Qt("ToggleLeft",[["rect",{width:"20",height:"12",x:"2",y:"6",rx:"6",ry:"6",key:"f2vt7d"}],["circle",{cx:"8",cy:"12",r:"2",key:"1nvbw3"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const h5=Qt("ToggleRight",[["rect",{width:"20",height:"12",x:"2",y:"6",rx:"6",ry:"6",key:"f2vt7d"}],["circle",{cx:"16",cy:"12",r:"2",key:"4ma0v8"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const f5=Qt("TrendingDown",[["polyline",{points:"22 17 13.5 8.5 8.5 13.5 2 7",key:"1r2t7k"}],["polyline",{points:"16 17 22 17 22 11",key:"11uiuu"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const iN=Qt("TrendingUp",[["polyline",{points:"22 7 13.5 15.5 8.5 10.5 2 17",key:"126l90"}],["polyline",{points:"16 7 22 7 22 13",key:"kwv8wd"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Hs=Qt("TriangleAlert",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const p5=Qt("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const m5=Qt("UserCheck",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["polyline",{points:"16 11 18 13 22 9",key:"1pwet4"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Bg=Qt("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qi=Qt("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ih=Qt("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]),rE="-",g5=r=>{const e=x5(r),{conflictingClassGroups:t,conflictingClassGroupModifiers:n}=r;return{getClassGroupId:o=>{const a=o.split(rE);return a[0]===""&&a.length!==1&&a.shift(),oN(a,e)||v5(o)},getConflictingClassGroupIds:(o,a)=>{const c=t[o]||[];return a&&n[o]?[...c,...n[o]]:c}}},oN=(r,e)=>{var o;if(r.length===0)return e.classGroupId;const t=r[0],n=e.nextPart.get(t),s=n?oN(r.slice(1),n):void 0;if(s)return s;if(e.validators.length===0)return;const i=r.join(rE);return(o=e.validators.find(({validator:a})=>a(i)))==null?void 0:o.classGroupId},G2=/^\[(.+)\]$/,v5=r=>{if(G2.test(r)){const e=G2.exec(r)[1],t=e==null?void 0:e.substring(0,e.indexOf(":"));if(t)return"arbitrary.."+t}},x5=r=>{const{theme:e,prefix:t}=r,n={nextPart:new Map,validators:[]};return _5(Object.entries(r.classGroups),t).forEach(([i,o])=>{WS(o,n,i,e)}),n},WS=(r,e,t,n)=>{r.forEach(s=>{if(typeof s=="string"){const i=s===""?e:W2(e,s);i.classGroupId=t;return}if(typeof s=="function"){if(y5(s)){WS(s(n),e,t,n);return}e.validators.push({validator:s,classGroupId:t});return}Object.entries(s).forEach(([i,o])=>{WS(o,W2(e,i),t,n)})})},W2=(r,e)=>{let t=r;return e.split(rE).forEach(n=>{t.nextPart.has(n)||t.nextPart.set(n,{nextPart:new Map,validators:[]}),t=t.nextPart.get(n)}),t},y5=r=>r.isThemeGetter,_5=(r,e)=>e?r.map(([t,n])=>{const s=n.map(i=>typeof i=="string"?e+i:typeof i=="object"?Object.fromEntries(Object.entries(i).map(([o,a])=>[e+o,a])):i);return[t,s]}):r,w5=r=>{if(r<1)return{get:()=>{},set:()=>{}};let e=0,t=new Map,n=new Map;const s=(i,o)=>{t.set(i,o),e++,e>r&&(e=0,n=t,t=new Map)};return{get(i){let o=t.get(i);if(o!==void 0)return o;if((o=n.get(i))!==void 0)return s(i,o),o},set(i,o){t.has(i)?t.set(i,o):s(i,o)}}},aN="!",S5=r=>{const{separator:e,experimentalParseClassName:t}=r,n=e.length===1,s=e[0],i=e.length,o=a=>{const c=[];let d=0,f=0,m;for(let w=0;w<a.length;w++){let S=a[w];if(d===0){if(S===s&&(n||a.slice(w,w+i)===e)){c.push(a.slice(f,w)),f=w+i;continue}if(S==="/"){m=w;continue}}S==="["?d++:S==="]"&&d--}const v=c.length===0?a:a.substring(f),x=v.startsWith(aN),_=x?v.substring(1):v,b=m&&m>f?m-f:void 0;return{modifiers:c,hasImportantModifier:x,baseClassName:_,maybePostfixModifierPosition:b}};return t?a=>t({className:a,parseClassName:o}):o},b5=r=>{if(r.length<=1)return r;const e=[];let t=[];return r.forEach(n=>{n[0]==="["?(e.push(...t.sort(),n),t=[]):t.push(n)}),e.push(...t.sort()),e},E5=r=>({cache:w5(r.cacheSize),parseClassName:S5(r),...g5(r)}),M5=/\s+/,T5=(r,e)=>{const{parseClassName:t,getClassGroupId:n,getConflictingClassGroupIds:s}=e,i=[],o=r.trim().split(M5);let a="";for(let c=o.length-1;c>=0;c-=1){const d=o[c],{modifiers:f,hasImportantModifier:m,baseClassName:v,maybePostfixModifierPosition:x}=t(d);let _=!!x,b=n(_?v.substring(0,x):v);if(!b){if(!_){a=d+(a.length>0?" "+a:a);continue}if(b=n(v),!b){a=d+(a.length>0?" "+a:a);continue}_=!1}const w=b5(f).join(":"),S=m?w+aN:w,C=S+b;if(i.includes(C))continue;i.push(C);const T=s(b,_);for(let A=0;A<T.length;++A){const k=T[A];i.push(S+k)}a=d+(a.length>0?" "+a:a)}return a};function C5(){let r=0,e,t,n="";for(;r<arguments.length;)(e=arguments[r++])&&(t=lN(e))&&(n&&(n+=" "),n+=t);return n}const lN=r=>{if(typeof r=="string")return r;let e,t="";for(let n=0;n<r.length;n++)r[n]&&(e=lN(r[n]))&&(t&&(t+=" "),t+=e);return t};function A5(r,...e){let t,n,s,i=o;function o(c){const d=e.reduce((f,m)=>m(f),r());return t=E5(d),n=t.cache.get,s=t.cache.set,i=a,a(c)}function a(c){const d=n(c);if(d)return d;const f=T5(c,t);return s(c,f),f}return function(){return i(C5.apply(null,arguments))}}const sr=r=>{const e=t=>t[r]||[];return e.isThemeGetter=!0,e},cN=/^\[(?:([a-z-]+):)?(.+)\]$/i,R5=/^\d+\/\d+$/,N5=new Set(["px","full","screen"]),P5=/^(\d+(\.\d+)?)?(xs|sm|md|lg|xl)$/,I5=/\d+(%|px|r?em|[sdl]?v([hwib]|min|max)|pt|pc|in|cm|mm|cap|ch|ex|r?lh|cq(w|h|i|b|min|max))|\b(calc|min|max|clamp)\(.+\)|^0$/,k5=/^(rgba?|hsla?|hwb|(ok)?(lab|lch))\(.+\)$/,D5=/^(inset_)?-?((\d+)?\.?(\d+)[a-z]+|0)_-?((\d+)?\.?(\d+)[a-z]+|0)/,L5=/^(url|image|image-set|cross-fade|element|(repeating-)?(linear|radial|conic)-gradient)\(.+\)$/,Rl=r=>bp(r)||N5.has(r)||R5.test(r),Oc=r=>tm(r,"length",H5),bp=r=>!!r&&!Number.isNaN(Number(r)),m1=r=>tm(r,"number",bp),hg=r=>!!r&&Number.isInteger(Number(r)),O5=r=>r.endsWith("%")&&bp(r.slice(0,-1)),xn=r=>cN.test(r),jc=r=>P5.test(r),j5=new Set(["length","size","percentage"]),F5=r=>tm(r,j5,uN),U5=r=>tm(r,"position",uN),B5=new Set(["image","url"]),z5=r=>tm(r,B5,W5),V5=r=>tm(r,"",G5),fg=()=>!0,tm=(r,e,t)=>{const n=cN.exec(r);return n?n[1]?typeof e=="string"?n[1]===e:e.has(n[1]):t(n[2]):!1},H5=r=>I5.test(r)&&!k5.test(r),uN=()=>!1,G5=r=>D5.test(r),W5=r=>L5.test(r),$5=()=>{const r=sr("colors"),e=sr("spacing"),t=sr("blur"),n=sr("brightness"),s=sr("borderColor"),i=sr("borderRadius"),o=sr("borderSpacing"),a=sr("borderWidth"),c=sr("contrast"),d=sr("grayscale"),f=sr("hueRotate"),m=sr("invert"),v=sr("gap"),x=sr("gradientColorStops"),_=sr("gradientColorStopPositions"),b=sr("inset"),w=sr("margin"),S=sr("opacity"),C=sr("padding"),T=sr("saturate"),A=sr("scale"),k=sr("sepia"),j=sr("skew"),D=sr("space"),L=sr("translate"),O=()=>["auto","contain","none"],I=()=>["auto","hidden","clip","visible","scroll"],B=()=>["auto",xn,e],W=()=>[xn,e],K=()=>["",Rl,Oc],ee=()=>["auto",bp,xn],oe=()=>["bottom","center","left","left-bottom","left-top","right","right-bottom","right-top","top"],ne=()=>["solid","dashed","dotted","double","none"],ce=()=>["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity"],V=()=>["start","end","center","between","around","evenly","stretch"],q=()=>["","0",xn],Z=()=>["auto","avoid","all","avoid-page","page","left","right","column"],X=()=>[bp,xn];return{cacheSize:500,separator:":",theme:{colors:[fg],spacing:[Rl,Oc],blur:["none","",jc,xn],brightness:X(),borderColor:[r],borderRadius:["none","","full",jc,xn],borderSpacing:W(),borderWidth:K(),contrast:X(),grayscale:q(),hueRotate:X(),invert:q(),gap:W(),gradientColorStops:[r],gradientColorStopPositions:[O5,Oc],inset:B(),margin:B(),opacity:X(),padding:W(),saturate:X(),scale:X(),sepia:q(),skew:X(),space:W(),translate:W()},classGroups:{aspect:[{aspect:["auto","square","video",xn]}],container:["container"],columns:[{columns:[jc]}],"break-after":[{"break-after":Z()}],"break-before":[{"break-before":Z()}],"break-inside":[{"break-inside":["auto","avoid","avoid-page","avoid-column"]}],"box-decoration":[{"box-decoration":["slice","clone"]}],box:[{box:["border","content"]}],display:["block","inline-block","inline","flex","inline-flex","table","inline-table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row-group","table-row","flow-root","grid","inline-grid","contents","list-item","hidden"],float:[{float:["right","left","none","start","end"]}],clear:[{clear:["left","right","both","none","start","end"]}],isolation:["isolate","isolation-auto"],"object-fit":[{object:["contain","cover","fill","none","scale-down"]}],"object-position":[{object:[...oe(),xn]}],overflow:[{overflow:I()}],"overflow-x":[{"overflow-x":I()}],"overflow-y":[{"overflow-y":I()}],overscroll:[{overscroll:O()}],"overscroll-x":[{"overscroll-x":O()}],"overscroll-y":[{"overscroll-y":O()}],position:["static","fixed","absolute","relative","sticky"],inset:[{inset:[b]}],"inset-x":[{"inset-x":[b]}],"inset-y":[{"inset-y":[b]}],start:[{start:[b]}],end:[{end:[b]}],top:[{top:[b]}],right:[{right:[b]}],bottom:[{bottom:[b]}],left:[{left:[b]}],visibility:["visible","invisible","collapse"],z:[{z:["auto",hg,xn]}],basis:[{basis:B()}],"flex-direction":[{flex:["row","row-reverse","col","col-reverse"]}],"flex-wrap":[{flex:["wrap","wrap-reverse","nowrap"]}],flex:[{flex:["1","auto","initial","none",xn]}],grow:[{grow:q()}],shrink:[{shrink:q()}],order:[{order:["first","last","none",hg,xn]}],"grid-cols":[{"grid-cols":[fg]}],"col-start-end":[{col:["auto",{span:["full",hg,xn]},xn]}],"col-start":[{"col-start":ee()}],"col-end":[{"col-end":ee()}],"grid-rows":[{"grid-rows":[fg]}],"row-start-end":[{row:["auto",{span:[hg,xn]},xn]}],"row-start":[{"row-start":ee()}],"row-end":[{"row-end":ee()}],"grid-flow":[{"grid-flow":["row","col","dense","row-dense","col-dense"]}],"auto-cols":[{"auto-cols":["auto","min","max","fr",xn]}],"auto-rows":[{"auto-rows":["auto","min","max","fr",xn]}],gap:[{gap:[v]}],"gap-x":[{"gap-x":[v]}],"gap-y":[{"gap-y":[v]}],"justify-content":[{justify:["normal",...V()]}],"justify-items":[{"justify-items":["start","end","center","stretch"]}],"justify-self":[{"justify-self":["auto","start","end","center","stretch"]}],"align-content":[{content:["normal",...V(),"baseline"]}],"align-items":[{items:["start","end","center","baseline","stretch"]}],"align-self":[{self:["auto","start","end","center","stretch","baseline"]}],"place-content":[{"place-content":[...V(),"baseline"]}],"place-items":[{"place-items":["start","end","center","baseline","stretch"]}],"place-self":[{"place-self":["auto","start","end","center","stretch"]}],p:[{p:[C]}],px:[{px:[C]}],py:[{py:[C]}],ps:[{ps:[C]}],pe:[{pe:[C]}],pt:[{pt:[C]}],pr:[{pr:[C]}],pb:[{pb:[C]}],pl:[{pl:[C]}],m:[{m:[w]}],mx:[{mx:[w]}],my:[{my:[w]}],ms:[{ms:[w]}],me:[{me:[w]}],mt:[{mt:[w]}],mr:[{mr:[w]}],mb:[{mb:[w]}],ml:[{ml:[w]}],"space-x":[{"space-x":[D]}],"space-x-reverse":["space-x-reverse"],"space-y":[{"space-y":[D]}],"space-y-reverse":["space-y-reverse"],w:[{w:["auto","min","max","fit","svw","lvw","dvw",xn,e]}],"min-w":[{"min-w":[xn,e,"min","max","fit"]}],"max-w":[{"max-w":[xn,e,"none","full","min","max","fit","prose",{screen:[jc]},jc]}],h:[{h:[xn,e,"auto","min","max","fit","svh","lvh","dvh"]}],"min-h":[{"min-h":[xn,e,"min","max","fit","svh","lvh","dvh"]}],"max-h":[{"max-h":[xn,e,"min","max","fit","svh","lvh","dvh"]}],size:[{size:[xn,e,"auto","min","max","fit"]}],"font-size":[{text:["base",jc,Oc]}],"font-smoothing":["antialiased","subpixel-antialiased"],"font-style":["italic","not-italic"],"font-weight":[{font:["thin","extralight","light","normal","medium","semibold","bold","extrabold","black",m1]}],"font-family":[{font:[fg]}],"fvn-normal":["normal-nums"],"fvn-ordinal":["ordinal"],"fvn-slashed-zero":["slashed-zero"],"fvn-figure":["lining-nums","oldstyle-nums"],"fvn-spacing":["proportional-nums","tabular-nums"],"fvn-fraction":["diagonal-fractions","stacked-fractions"],tracking:[{tracking:["tighter","tight","normal","wide","wider","widest",xn]}],"line-clamp":[{"line-clamp":["none",bp,m1]}],leading:[{leading:["none","tight","snug","normal","relaxed","loose",Rl,xn]}],"list-image":[{"list-image":["none",xn]}],"list-style-type":[{list:["none","disc","decimal",xn]}],"list-style-position":[{list:["inside","outside"]}],"placeholder-color":[{placeholder:[r]}],"placeholder-opacity":[{"placeholder-opacity":[S]}],"text-alignment":[{text:["left","center","right","justify","start","end"]}],"text-color":[{text:[r]}],"text-opacity":[{"text-opacity":[S]}],"text-decoration":["underline","overline","line-through","no-underline"],"text-decoration-style":[{decoration:[...ne(),"wavy"]}],"text-decoration-thickness":[{decoration:["auto","from-font",Rl,Oc]}],"underline-offset":[{"underline-offset":["auto",Rl,xn]}],"text-decoration-color":[{decoration:[r]}],"text-transform":["uppercase","lowercase","capitalize","normal-case"],"text-overflow":["truncate","text-ellipsis","text-clip"],"text-wrap":[{text:["wrap","nowrap","balance","pretty"]}],indent:[{indent:W()}],"vertical-align":[{align:["baseline","top","middle","bottom","text-top","text-bottom","sub","super",xn]}],whitespace:[{whitespace:["normal","nowrap","pre","pre-line","pre-wrap","break-spaces"]}],break:[{break:["normal","words","all","keep"]}],hyphens:[{hyphens:["none","manual","auto"]}],content:[{content:["none",xn]}],"bg-attachment":[{bg:["fixed","local","scroll"]}],"bg-clip":[{"bg-clip":["border","padding","content","text"]}],"bg-opacity":[{"bg-opacity":[S]}],"bg-origin":[{"bg-origin":["border","padding","content"]}],"bg-position":[{bg:[...oe(),U5]}],"bg-repeat":[{bg:["no-repeat",{repeat:["","x","y","round","space"]}]}],"bg-size":[{bg:["auto","cover","contain",F5]}],"bg-image":[{bg:["none",{"gradient-to":["t","tr","r","br","b","bl","l","tl"]},z5]}],"bg-color":[{bg:[r]}],"gradient-from-pos":[{from:[_]}],"gradient-via-pos":[{via:[_]}],"gradient-to-pos":[{to:[_]}],"gradient-from":[{from:[x]}],"gradient-via":[{via:[x]}],"gradient-to":[{to:[x]}],rounded:[{rounded:[i]}],"rounded-s":[{"rounded-s":[i]}],"rounded-e":[{"rounded-e":[i]}],"rounded-t":[{"rounded-t":[i]}],"rounded-r":[{"rounded-r":[i]}],"rounded-b":[{"rounded-b":[i]}],"rounded-l":[{"rounded-l":[i]}],"rounded-ss":[{"rounded-ss":[i]}],"rounded-se":[{"rounded-se":[i]}],"rounded-ee":[{"rounded-ee":[i]}],"rounded-es":[{"rounded-es":[i]}],"rounded-tl":[{"rounded-tl":[i]}],"rounded-tr":[{"rounded-tr":[i]}],"rounded-br":[{"rounded-br":[i]}],"rounded-bl":[{"rounded-bl":[i]}],"border-w":[{border:[a]}],"border-w-x":[{"border-x":[a]}],"border-w-y":[{"border-y":[a]}],"border-w-s":[{"border-s":[a]}],"border-w-e":[{"border-e":[a]}],"border-w-t":[{"border-t":[a]}],"border-w-r":[{"border-r":[a]}],"border-w-b":[{"border-b":[a]}],"border-w-l":[{"border-l":[a]}],"border-opacity":[{"border-opacity":[S]}],"border-style":[{border:[...ne(),"hidden"]}],"divide-x":[{"divide-x":[a]}],"divide-x-reverse":["divide-x-reverse"],"divide-y":[{"divide-y":[a]}],"divide-y-reverse":["divide-y-reverse"],"divide-opacity":[{"divide-opacity":[S]}],"divide-style":[{divide:ne()}],"border-color":[{border:[s]}],"border-color-x":[{"border-x":[s]}],"border-color-y":[{"border-y":[s]}],"border-color-s":[{"border-s":[s]}],"border-color-e":[{"border-e":[s]}],"border-color-t":[{"border-t":[s]}],"border-color-r":[{"border-r":[s]}],"border-color-b":[{"border-b":[s]}],"border-color-l":[{"border-l":[s]}],"divide-color":[{divide:[s]}],"outline-style":[{outline:["",...ne()]}],"outline-offset":[{"outline-offset":[Rl,xn]}],"outline-w":[{outline:[Rl,Oc]}],"outline-color":[{outline:[r]}],"ring-w":[{ring:K()}],"ring-w-inset":["ring-inset"],"ring-color":[{ring:[r]}],"ring-opacity":[{"ring-opacity":[S]}],"ring-offset-w":[{"ring-offset":[Rl,Oc]}],"ring-offset-color":[{"ring-offset":[r]}],shadow:[{shadow:["","inner","none",jc,V5]}],"shadow-color":[{shadow:[fg]}],opacity:[{opacity:[S]}],"mix-blend":[{"mix-blend":[...ce(),"plus-lighter","plus-darker"]}],"bg-blend":[{"bg-blend":ce()}],filter:[{filter:["","none"]}],blur:[{blur:[t]}],brightness:[{brightness:[n]}],contrast:[{contrast:[c]}],"drop-shadow":[{"drop-shadow":["","none",jc,xn]}],grayscale:[{grayscale:[d]}],"hue-rotate":[{"hue-rotate":[f]}],invert:[{invert:[m]}],saturate:[{saturate:[T]}],sepia:[{sepia:[k]}],"backdrop-filter":[{"backdrop-filter":["","none"]}],"backdrop-blur":[{"backdrop-blur":[t]}],"backdrop-brightness":[{"backdrop-brightness":[n]}],"backdrop-contrast":[{"backdrop-contrast":[c]}],"backdrop-grayscale":[{"backdrop-grayscale":[d]}],"backdrop-hue-rotate":[{"backdrop-hue-rotate":[f]}],"backdrop-invert":[{"backdrop-invert":[m]}],"backdrop-opacity":[{"backdrop-opacity":[S]}],"backdrop-saturate":[{"backdrop-saturate":[T]}],"backdrop-sepia":[{"backdrop-sepia":[k]}],"border-collapse":[{border:["collapse","separate"]}],"border-spacing":[{"border-spacing":[o]}],"border-spacing-x":[{"border-spacing-x":[o]}],"border-spacing-y":[{"border-spacing-y":[o]}],"table-layout":[{table:["auto","fixed"]}],caption:[{caption:["top","bottom"]}],transition:[{transition:["none","all","","colors","opacity","shadow","transform",xn]}],duration:[{duration:X()}],ease:[{ease:["linear","in","out","in-out",xn]}],delay:[{delay:X()}],animate:[{animate:["none","spin","ping","pulse","bounce",xn]}],transform:[{transform:["","gpu","none"]}],scale:[{scale:[A]}],"scale-x":[{"scale-x":[A]}],"scale-y":[{"scale-y":[A]}],rotate:[{rotate:[hg,xn]}],"translate-x":[{"translate-x":[L]}],"translate-y":[{"translate-y":[L]}],"skew-x":[{"skew-x":[j]}],"skew-y":[{"skew-y":[j]}],"transform-origin":[{origin:["center","top","top-right","right","bottom-right","bottom","bottom-left","left","top-left",xn]}],accent:[{accent:["auto",r]}],appearance:[{appearance:["none","auto"]}],cursor:[{cursor:["auto","default","pointer","wait","text","move","help","not-allowed","none","context-menu","progress","cell","crosshair","vertical-text","alias","copy","no-drop","grab","grabbing","all-scroll","col-resize","row-resize","n-resize","e-resize","s-resize","w-resize","ne-resize","nw-resize","se-resize","sw-resize","ew-resize","ns-resize","nesw-resize","nwse-resize","zoom-in","zoom-out",xn]}],"caret-color":[{caret:[r]}],"pointer-events":[{"pointer-events":["none","auto"]}],resize:[{resize:["none","y","x",""]}],"scroll-behavior":[{scroll:["auto","smooth"]}],"scroll-m":[{"scroll-m":W()}],"scroll-mx":[{"scroll-mx":W()}],"scroll-my":[{"scroll-my":W()}],"scroll-ms":[{"scroll-ms":W()}],"scroll-me":[{"scroll-me":W()}],"scroll-mt":[{"scroll-mt":W()}],"scroll-mr":[{"scroll-mr":W()}],"scroll-mb":[{"scroll-mb":W()}],"scroll-ml":[{"scroll-ml":W()}],"scroll-p":[{"scroll-p":W()}],"scroll-px":[{"scroll-px":W()}],"scroll-py":[{"scroll-py":W()}],"scroll-ps":[{"scroll-ps":W()}],"scroll-pe":[{"scroll-pe":W()}],"scroll-pt":[{"scroll-pt":W()}],"scroll-pr":[{"scroll-pr":W()}],"scroll-pb":[{"scroll-pb":W()}],"scroll-pl":[{"scroll-pl":W()}],"snap-align":[{snap:["start","end","center","align-none"]}],"snap-stop":[{snap:["normal","always"]}],"snap-type":[{snap:["none","x","y","both"]}],"snap-strictness":[{snap:["mandatory","proximity"]}],touch:[{touch:["auto","none","manipulation"]}],"touch-x":[{"touch-pan":["x","left","right"]}],"touch-y":[{"touch-pan":["y","up","down"]}],"touch-pz":["touch-pinch-zoom"],select:[{select:["none","text","all","auto"]}],"will-change":[{"will-change":["auto","scroll","contents","transform",xn]}],fill:[{fill:[r,"none"]}],"stroke-w":[{stroke:[Rl,Oc,m1]}],stroke:[{stroke:[r,"none"]}],sr:["sr-only","not-sr-only"],"forced-color-adjust":[{"forced-color-adjust":["auto","none"]}]},conflictingClassGroups:{overflow:["overflow-x","overflow-y"],overscroll:["overscroll-x","overscroll-y"],inset:["inset-x","inset-y","start","end","top","right","bottom","left"],"inset-x":["right","left"],"inset-y":["top","bottom"],flex:["basis","grow","shrink"],gap:["gap-x","gap-y"],p:["px","py","ps","pe","pt","pr","pb","pl"],px:["pr","pl"],py:["pt","pb"],m:["mx","my","ms","me","mt","mr","mb","ml"],mx:["mr","ml"],my:["mt","mb"],size:["w","h"],"font-size":["leading"],"fvn-normal":["fvn-ordinal","fvn-slashed-zero","fvn-figure","fvn-spacing","fvn-fraction"],"fvn-ordinal":["fvn-normal"],"fvn-slashed-zero":["fvn-normal"],"fvn-figure":["fvn-normal"],"fvn-spacing":["fvn-normal"],"fvn-fraction":["fvn-normal"],"line-clamp":["display","overflow"],rounded:["rounded-s","rounded-e","rounded-t","rounded-r","rounded-b","rounded-l","rounded-ss","rounded-se","rounded-ee","rounded-es","rounded-tl","rounded-tr","rounded-br","rounded-bl"],"rounded-s":["rounded-ss","rounded-es"],"rounded-e":["rounded-se","rounded-ee"],"rounded-t":["rounded-tl","rounded-tr"],"rounded-r":["rounded-tr","rounded-br"],"rounded-b":["rounded-br","rounded-bl"],"rounded-l":["rounded-tl","rounded-bl"],"border-spacing":["border-spacing-x","border-spacing-y"],"border-w":["border-w-s","border-w-e","border-w-t","border-w-r","border-w-b","border-w-l"],"border-w-x":["border-w-r","border-w-l"],"border-w-y":["border-w-t","border-w-b"],"border-color":["border-color-s","border-color-e","border-color-t","border-color-r","border-color-b","border-color-l"],"border-color-x":["border-color-r","border-color-l"],"border-color-y":["border-color-t","border-color-b"],"scroll-m":["scroll-mx","scroll-my","scroll-ms","scroll-me","scroll-mt","scroll-mr","scroll-mb","scroll-ml"],"scroll-mx":["scroll-mr","scroll-ml"],"scroll-my":["scroll-mt","scroll-mb"],"scroll-p":["scroll-px","scroll-py","scroll-ps","scroll-pe","scroll-pt","scroll-pr","scroll-pb","scroll-pl"],"scroll-px":["scroll-pr","scroll-pl"],"scroll-py":["scroll-pt","scroll-pb"],touch:["touch-x","touch-y","touch-pz"],"touch-x":["touch"],"touch-y":["touch"],"touch-pz":["touch"]},conflictingClassGroupModifiers:{"font-size":["leading"]}}},q5=A5($5);function Zt(...r){return q5(JR(r))}const X5=WO,dN=R.forwardRef(({className:r,...e},t)=>h.jsx(WR,{ref:t,className:Zt("fixed top-0 z-[100] flex max-h-screen w-full flex-col-reverse p-4 sm:bottom-0 sm:right-0 sm:top-auto sm:flex-col md:max-w-[420px]",r),...e}));dN.displayName=WR.displayName;const Y5=M_("group pointer-events-auto relative flex w-full items-center justify-between space-x-4 overflow-hidden rounded-md border p-6 pr-8 shadow-lg transition-all data-[swipe=cancel]:translate-x-0 data-[swipe=end]:translate-x-[var(--radix-toast-swipe-end-x)] data-[swipe=move]:translate-x-[var(--radix-toast-swipe-move-x)] data-[swipe=move]:transition-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[swipe=end]:animate-out data-[state=closed]:fade-out-80 data-[state=closed]:slide-out-to-right-full data-[state=open]:slide-in-from-top-full data-[state=open]:sm:slide-in-from-bottom-full",{variants:{variant:{default:"border bg-background text-foreground",destructive:"destructive group border-destructive bg-destructive text-destructive-foreground"}},defaultVariants:{variant:"default"}}),hN=R.forwardRef(({className:r,variant:e,...t},n)=>h.jsx($R,{ref:n,className:Zt(Y5({variant:e}),r),...t}));hN.displayName=$R.displayName;const K5=R.forwardRef(({className:r,...e},t)=>h.jsx(YR,{ref:t,className:Zt("inline-flex h-8 shrink-0 items-center justify-center rounded-md border bg-transparent px-3 text-sm font-medium ring-offset-background transition-colors hover:bg-secondary focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 group-[.destructive]:border-muted/40 group-[.destructive]:hover:border-destructive/30 group-[.destructive]:hover:bg-destructive group-[.destructive]:hover:text-destructive-foreground group-[.destructive]:focus:ring-destructive",r),...e}));K5.displayName=YR.displayName;const fN=R.forwardRef(({className:r,...e},t)=>h.jsx(KR,{ref:t,className:Zt("absolute right-2 top-2 rounded-md p-1 text-foreground/50 opacity-0 transition-opacity hover:text-foreground focus:opacity-100 focus:outline-none focus:ring-2 group-hover:opacity-100 group-[.destructive]:text-red-300 group-[.destructive]:hover:text-red-50 group-[.destructive]:focus:ring-red-400 group-[.destructive]:focus:ring-offset-red-600",r),"toast-close":"",...e,children:h.jsx(ih,{className:"h-4 w-4"})}));fN.displayName=KR.displayName;const pN=R.forwardRef(({className:r,...e},t)=>h.jsx(qR,{ref:t,className:Zt("text-sm font-semibold",r),...e}));pN.displayName=qR.displayName;const mN=R.forwardRef(({className:r,...e},t)=>h.jsx(XR,{ref:t,className:Zt("text-sm opacity-90",r),...e}));mN.displayName=XR.displayName;function Q5(){const{toasts:r}=eO();return h.jsxs(X5,{children:[r.map(function({id:e,title:t,description:n,action:s,...i}){return h.jsxs(hN,{...i,children:[h.jsxs("div",{className:"grid gap-1",children:[t&&h.jsx(pN,{children:t}),n&&h.jsx(mN,{children:n})]}),s,h.jsx(fN,{})]},e)}),h.jsx(dN,{})]})}var $2=["light","dark"],J5="(prefers-color-scheme: dark)",Z5=R.createContext(void 0),ej={setTheme:r=>{},themes:[]},tj=()=>{var r;return(r=R.useContext(Z5))!=null?r:ej};R.memo(({forcedTheme:r,storageKey:e,attribute:t,enableSystem:n,enableColorScheme:s,defaultTheme:i,value:o,attrs:a,nonce:c})=>{let d=i==="system",f=t==="class"?`var d=document.documentElement,c=d.classList;${`c.remove(${a.map(_=>`'${_}'`).join(",")})`};`:`var d=document.documentElement,n='${t}',s='setAttribute';`,m=s?$2.includes(i)&&i?`if(e==='light'||e==='dark'||!e)d.style.colorScheme=e||'${i}'`:"if(e==='light'||e==='dark')d.style.colorScheme=e":"",v=(_,b=!1,w=!0)=>{let S=o?o[_]:_,C=b?_+"|| ''":`'${S}'`,T="";return s&&w&&!b&&$2.includes(_)&&(T+=`d.style.colorScheme = '${_}';`),t==="class"?b||S?T+=`c.add(${C})`:T+="null":S&&(T+=`d[s](n,${C})`),T},x=r?`!function(){${f}${v(r)}}()`:n?`!function(){try{${f}var e=localStorage.getItem('${e}');if('system'===e||(!e&&${d})){var t='${J5}',m=window.matchMedia(t);if(m.media!==t||m.matches){${v("dark")}}else{${v("light")}}}else if(e){${o?`var x=${JSON.stringify(o)};`:""}${v(o?"x[e]":"e",!0)}}${d?"":"else{"+v(i,!1,!1)+"}"}${m}}catch(e){}}()`:`!function(){try{${f}var e=localStorage.getItem('${e}');if(e){${o?`var x=${JSON.stringify(o)};`:""}${v(o?"x[e]":"e",!0)}}else{${v(i,!1,!1)};}${m}}catch(t){}}();`;return R.createElement("script",{nonce:c,dangerouslySetInnerHTML:{__html:x}})});var nj=r=>{switch(r){case"success":return ij;case"info":return aj;case"warning":return oj;case"error":return lj;default:return null}},rj=Array(12).fill(0),sj=({visible:r,className:e})=>re.createElement("div",{className:["sonner-loading-wrapper",e].filter(Boolean).join(" "),"data-visible":r},re.createElement("div",{className:"sonner-spinner"},rj.map((t,n)=>re.createElement("div",{className:"sonner-loading-bar",key:`spinner-bar-${n}`})))),ij=re.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},re.createElement("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.857-9.809a.75.75 0 00-1.214-.882l-3.483 4.79-1.88-1.88a.75.75 0 10-1.06 1.061l2.5 2.5a.75.75 0 001.137-.089l4-5.5z",clipRule:"evenodd"})),oj=re.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",height:"20",width:"20"},re.createElement("path",{fillRule:"evenodd",d:"M9.401 3.003c1.155-2 4.043-2 5.197 0l7.355 12.748c1.154 2-.29 4.5-2.599 4.5H4.645c-2.309 0-3.752-2.5-2.598-4.5L9.4 3.003zM12 8.25a.75.75 0 01.75.75v3.75a.75.75 0 01-1.5 0V9a.75.75 0 01.75-.75zm0 8.25a.75.75 0 100-1.5.75.75 0 000 1.5z",clipRule:"evenodd"})),aj=re.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},re.createElement("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a.75.75 0 000 1.5h.253a.25.25 0 01.244.304l-.459 2.066A1.75 1.75 0 0010.747 15H11a.75.75 0 000-1.5h-.253a.25.25 0 01-.244-.304l.459-2.066A1.75 1.75 0 009.253 9H9z",clipRule:"evenodd"})),lj=re.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},re.createElement("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-8-5a.75.75 0 01.75.75v4.5a.75.75 0 01-1.5 0v-4.5A.75.75 0 0110 5zm0 10a1 1 0 100-2 1 1 0 000 2z",clipRule:"evenodd"})),cj=re.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"},re.createElement("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),re.createElement("line",{x1:"6",y1:"6",x2:"18",y2:"18"})),uj=()=>{let[r,e]=re.useState(document.hidden);return re.useEffect(()=>{let t=()=>{e(document.hidden)};return document.addEventListener("visibilitychange",t),()=>window.removeEventListener("visibilitychange",t)},[]),r},$S=1,dj=class{constructor(){this.subscribe=r=>(this.subscribers.push(r),()=>{let e=this.subscribers.indexOf(r);this.subscribers.splice(e,1)}),this.publish=r=>{this.subscribers.forEach(e=>e(r))},this.addToast=r=>{this.publish(r),this.toasts=[...this.toasts,r]},this.create=r=>{var e;let{message:t,...n}=r,s=typeof(r==null?void 0:r.id)=="number"||((e=r.id)==null?void 0:e.length)>0?r.id:$S++,i=this.toasts.find(a=>a.id===s),o=r.dismissible===void 0?!0:r.dismissible;return this.dismissedToasts.has(s)&&this.dismissedToasts.delete(s),i?this.toasts=this.toasts.map(a=>a.id===s?(this.publish({...a,...r,id:s,title:t}),{...a,...r,id:s,dismissible:o,title:t}):a):this.addToast({title:t,...n,dismissible:o,id:s}),s},this.dismiss=r=>(this.dismissedToasts.add(r),r||this.toasts.forEach(e=>{this.subscribers.forEach(t=>t({id:e.id,dismiss:!0}))}),this.subscribers.forEach(e=>e({id:r,dismiss:!0})),r),this.message=(r,e)=>this.create({...e,message:r}),this.error=(r,e)=>this.create({...e,message:r,type:"error"}),this.success=(r,e)=>this.create({...e,type:"success",message:r}),this.info=(r,e)=>this.create({...e,type:"info",message:r}),this.warning=(r,e)=>this.create({...e,type:"warning",message:r}),this.loading=(r,e)=>this.create({...e,type:"loading",message:r}),this.promise=(r,e)=>{if(!e)return;let t;e.loading!==void 0&&(t=this.create({...e,promise:r,type:"loading",message:e.loading,description:typeof e.description!="function"?e.description:void 0}));let n=r instanceof Promise?r:r(),s=t!==void 0,i,o=n.then(async c=>{if(i=["resolve",c],re.isValidElement(c))s=!1,this.create({id:t,type:"default",message:c});else if(fj(c)&&!c.ok){s=!1;let d=typeof e.error=="function"?await e.error(`HTTP error! status: ${c.status}`):e.error,f=typeof e.description=="function"?await e.description(`HTTP error! status: ${c.status}`):e.description;this.create({id:t,type:"error",message:d,description:f})}else if(e.success!==void 0){s=!1;let d=typeof e.success=="function"?await e.success(c):e.success,f=typeof e.description=="function"?await e.description(c):e.description;this.create({id:t,type:"success",message:d,description:f})}}).catch(async c=>{if(i=["reject",c],e.error!==void 0){s=!1;let d=typeof e.error=="function"?await e.error(c):e.error,f=typeof e.description=="function"?await e.description(c):e.description;this.create({id:t,type:"error",message:d,description:f})}}).finally(()=>{var c;s&&(this.dismiss(t),t=void 0),(c=e.finally)==null||c.call(e)}),a=()=>new Promise((c,d)=>o.then(()=>i[0]==="reject"?d(i[1]):c(i[1])).catch(d));return typeof t!="string"&&typeof t!="number"?{unwrap:a}:Object.assign(t,{unwrap:a})},this.custom=(r,e)=>{let t=(e==null?void 0:e.id)||$S++;return this.create({jsx:r(t),id:t,...e}),t},this.getActiveToasts=()=>this.toasts.filter(r=>!this.dismissedToasts.has(r.id)),this.subscribers=[],this.toasts=[],this.dismissedToasts=new Set}},Ai=new dj,hj=(r,e)=>{let t=(e==null?void 0:e.id)||$S++;return Ai.addToast({title:r,...e,id:t}),t},fj=r=>r&&typeof r=="object"&&"ok"in r&&typeof r.ok=="boolean"&&"status"in r&&typeof r.status=="number",pj=hj,mj=()=>Ai.toasts,gj=()=>Ai.getActiveToasts(),Yr=Object.assign(pj,{success:Ai.success,info:Ai.info,warning:Ai.warning,error:Ai.error,custom:Ai.custom,message:Ai.message,promise:Ai.promise,dismiss:Ai.dismiss,loading:Ai.loading},{getHistory:mj,getToasts:gj});function vj(r,{insertAt:e}={}){if(typeof document>"u")return;let t=document.head||document.getElementsByTagName("head")[0],n=document.createElement("style");n.type="text/css",e==="top"&&t.firstChild?t.insertBefore(n,t.firstChild):t.appendChild(n),n.styleSheet?n.styleSheet.cssText=r:n.appendChild(document.createTextNode(r))}vj(`:where(html[dir="ltr"]),:where([data-sonner-toaster][dir="ltr"]){--toast-icon-margin-start: -3px;--toast-icon-margin-end: 4px;--toast-svg-margin-start: -1px;--toast-svg-margin-end: 0px;--toast-button-margin-start: auto;--toast-button-margin-end: 0;--toast-close-button-start: 0;--toast-close-button-end: unset;--toast-close-button-transform: translate(-35%, -35%)}:where(html[dir="rtl"]),:where([data-sonner-toaster][dir="rtl"]){--toast-icon-margin-start: 4px;--toast-icon-margin-end: -3px;--toast-svg-margin-start: 0px;--toast-svg-margin-end: -1px;--toast-button-margin-start: 0;--toast-button-margin-end: auto;--toast-close-button-start: unset;--toast-close-button-end: 0;--toast-close-button-transform: translate(35%, -35%)}:where([data-sonner-toaster]){position:fixed;width:var(--width);font-family:ui-sans-serif,system-ui,-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Arial,Noto Sans,sans-serif,Apple Color Emoji,Segoe UI Emoji,Segoe UI Symbol,Noto Color Emoji;--gray1: hsl(0, 0%, 99%);--gray2: hsl(0, 0%, 97.3%);--gray3: hsl(0, 0%, 95.1%);--gray4: hsl(0, 0%, 93%);--gray5: hsl(0, 0%, 90.9%);--gray6: hsl(0, 0%, 88.7%);--gray7: hsl(0, 0%, 85.8%);--gray8: hsl(0, 0%, 78%);--gray9: hsl(0, 0%, 56.1%);--gray10: hsl(0, 0%, 52.3%);--gray11: hsl(0, 0%, 43.5%);--gray12: hsl(0, 0%, 9%);--border-radius: 8px;box-sizing:border-box;padding:0;margin:0;list-style:none;outline:none;z-index:999999999;transition:transform .4s ease}:where([data-sonner-toaster][data-lifted="true"]){transform:translateY(-10px)}@media (hover: none) and (pointer: coarse){:where([data-sonner-toaster][data-lifted="true"]){transform:none}}:where([data-sonner-toaster][data-x-position="right"]){right:var(--offset-right)}:where([data-sonner-toaster][data-x-position="left"]){left:var(--offset-left)}:where([data-sonner-toaster][data-x-position="center"]){left:50%;transform:translate(-50%)}:where([data-sonner-toaster][data-y-position="top"]){top:var(--offset-top)}:where([data-sonner-toaster][data-y-position="bottom"]){bottom:var(--offset-bottom)}:where([data-sonner-toast]){--y: translateY(100%);--lift-amount: calc(var(--lift) * var(--gap));z-index:var(--z-index);position:absolute;opacity:0;transform:var(--y);filter:blur(0);touch-action:none;transition:transform .4s,opacity .4s,height .4s,box-shadow .2s;box-sizing:border-box;outline:none;overflow-wrap:anywhere}:where([data-sonner-toast][data-styled="true"]){padding:16px;background:var(--normal-bg);border:1px solid var(--normal-border);color:var(--normal-text);border-radius:var(--border-radius);box-shadow:0 4px 12px #0000001a;width:var(--width);font-size:13px;display:flex;align-items:center;gap:6px}:where([data-sonner-toast]:focus-visible){box-shadow:0 4px 12px #0000001a,0 0 0 2px #0003}:where([data-sonner-toast][data-y-position="top"]){top:0;--y: translateY(-100%);--lift: 1;--lift-amount: calc(1 * var(--gap))}:where([data-sonner-toast][data-y-position="bottom"]){bottom:0;--y: translateY(100%);--lift: -1;--lift-amount: calc(var(--lift) * var(--gap))}:where([data-sonner-toast]) :where([data-description]){font-weight:400;line-height:1.4;color:inherit}:where([data-sonner-toast]) :where([data-title]){font-weight:500;line-height:1.5;color:inherit}:where([data-sonner-toast]) :where([data-icon]){display:flex;height:16px;width:16px;position:relative;justify-content:flex-start;align-items:center;flex-shrink:0;margin-left:var(--toast-icon-margin-start);margin-right:var(--toast-icon-margin-end)}:where([data-sonner-toast][data-promise="true"]) :where([data-icon])>svg{opacity:0;transform:scale(.8);transform-origin:center;animation:sonner-fade-in .3s ease forwards}:where([data-sonner-toast]) :where([data-icon])>*{flex-shrink:0}:where([data-sonner-toast]) :where([data-icon]) svg{margin-left:var(--toast-svg-margin-start);margin-right:var(--toast-svg-margin-end)}:where([data-sonner-toast]) :where([data-content]){display:flex;flex-direction:column;gap:2px}[data-sonner-toast][data-styled=true] [data-button]{border-radius:4px;padding-left:8px;padding-right:8px;height:24px;font-size:12px;color:var(--normal-bg);background:var(--normal-text);margin-left:var(--toast-button-margin-start);margin-right:var(--toast-button-margin-end);border:none;cursor:pointer;outline:none;display:flex;align-items:center;flex-shrink:0;transition:opacity .4s,box-shadow .2s}:where([data-sonner-toast]) :where([data-button]):focus-visible{box-shadow:0 0 0 2px #0006}:where([data-sonner-toast]) :where([data-button]):first-of-type{margin-left:var(--toast-button-margin-start);margin-right:var(--toast-button-margin-end)}:where([data-sonner-toast]) :where([data-cancel]){color:var(--normal-text);background:rgba(0,0,0,.08)}:where([data-sonner-toast][data-theme="dark"]) :where([data-cancel]){background:rgba(255,255,255,.3)}:where([data-sonner-toast]) :where([data-close-button]){position:absolute;left:var(--toast-close-button-start);right:var(--toast-close-button-end);top:0;height:20px;width:20px;display:flex;justify-content:center;align-items:center;padding:0;color:var(--gray12);border:1px solid var(--gray4);transform:var(--toast-close-button-transform);border-radius:50%;cursor:pointer;z-index:1;transition:opacity .1s,background .2s,border-color .2s}[data-sonner-toast] [data-close-button]{background:var(--gray1)}:where([data-sonner-toast]) :where([data-close-button]):focus-visible{box-shadow:0 4px 12px #0000001a,0 0 0 2px #0003}:where([data-sonner-toast]) :where([data-disabled="true"]){cursor:not-allowed}:where([data-sonner-toast]):hover :where([data-close-button]):hover{background:var(--gray2);border-color:var(--gray5)}:where([data-sonner-toast][data-swiping="true"]):before{content:"";position:absolute;left:-50%;right:-50%;height:100%;z-index:-1}:where([data-sonner-toast][data-y-position="top"][data-swiping="true"]):before{bottom:50%;transform:scaleY(3) translateY(50%)}:where([data-sonner-toast][data-y-position="bottom"][data-swiping="true"]):before{top:50%;transform:scaleY(3) translateY(-50%)}:where([data-sonner-toast][data-swiping="false"][data-removed="true"]):before{content:"";position:absolute;inset:0;transform:scaleY(2)}:where([data-sonner-toast]):after{content:"";position:absolute;left:0;height:calc(var(--gap) + 1px);bottom:100%;width:100%}:where([data-sonner-toast][data-mounted="true"]){--y: translateY(0);opacity:1}:where([data-sonner-toast][data-expanded="false"][data-front="false"]){--scale: var(--toasts-before) * .05 + 1;--y: translateY(calc(var(--lift-amount) * var(--toasts-before))) scale(calc(-1 * var(--scale)));height:var(--front-toast-height)}:where([data-sonner-toast])>*{transition:opacity .4s}:where([data-sonner-toast][data-expanded="false"][data-front="false"][data-styled="true"])>*{opacity:0}:where([data-sonner-toast][data-visible="false"]){opacity:0;pointer-events:none}:where([data-sonner-toast][data-mounted="true"][data-expanded="true"]){--y: translateY(calc(var(--lift) * var(--offset)));height:var(--initial-height)}:where([data-sonner-toast][data-removed="true"][data-front="true"][data-swipe-out="false"]){--y: translateY(calc(var(--lift) * -100%));opacity:0}:where([data-sonner-toast][data-removed="true"][data-front="false"][data-swipe-out="false"][data-expanded="true"]){--y: translateY(calc(var(--lift) * var(--offset) + var(--lift) * -100%));opacity:0}:where([data-sonner-toast][data-removed="true"][data-front="false"][data-swipe-out="false"][data-expanded="false"]){--y: translateY(40%);opacity:0;transition:transform .5s,opacity .2s}:where([data-sonner-toast][data-removed="true"][data-front="false"]):before{height:calc(var(--initial-height) + 20%)}[data-sonner-toast][data-swiping=true]{transform:var(--y) translateY(var(--swipe-amount-y, 0px)) translate(var(--swipe-amount-x, 0px));transition:none}[data-sonner-toast][data-swiped=true]{user-select:none}[data-sonner-toast][data-swipe-out=true][data-y-position=bottom],[data-sonner-toast][data-swipe-out=true][data-y-position=top]{animation-duration:.2s;animation-timing-function:ease-out;animation-fill-mode:forwards}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=left]{animation-name:swipe-out-left}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=right]{animation-name:swipe-out-right}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=up]{animation-name:swipe-out-up}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=down]{animation-name:swipe-out-down}@keyframes swipe-out-left{0%{transform:var(--y) translate(var(--swipe-amount-x));opacity:1}to{transform:var(--y) translate(calc(var(--swipe-amount-x) - 100%));opacity:0}}@keyframes swipe-out-right{0%{transform:var(--y) translate(var(--swipe-amount-x));opacity:1}to{transform:var(--y) translate(calc(var(--swipe-amount-x) + 100%));opacity:0}}@keyframes swipe-out-up{0%{transform:var(--y) translateY(var(--swipe-amount-y));opacity:1}to{transform:var(--y) translateY(calc(var(--swipe-amount-y) - 100%));opacity:0}}@keyframes swipe-out-down{0%{transform:var(--y) translateY(var(--swipe-amount-y));opacity:1}to{transform:var(--y) translateY(calc(var(--swipe-amount-y) + 100%));opacity:0}}@media (max-width: 600px){[data-sonner-toaster]{position:fixed;right:var(--mobile-offset-right);left:var(--mobile-offset-left);width:100%}[data-sonner-toaster][dir=rtl]{left:calc(var(--mobile-offset-left) * -1)}[data-sonner-toaster] [data-sonner-toast]{left:0;right:0;width:calc(100% - var(--mobile-offset-left) * 2)}[data-sonner-toaster][data-x-position=left]{left:var(--mobile-offset-left)}[data-sonner-toaster][data-y-position=bottom]{bottom:var(--mobile-offset-bottom)}[data-sonner-toaster][data-y-position=top]{top:var(--mobile-offset-top)}[data-sonner-toaster][data-x-position=center]{left:var(--mobile-offset-left);right:var(--mobile-offset-right);transform:none}}[data-sonner-toaster][data-theme=light]{--normal-bg: #fff;--normal-border: var(--gray4);--normal-text: var(--gray12);--success-bg: hsl(143, 85%, 96%);--success-border: hsl(145, 92%, 91%);--success-text: hsl(140, 100%, 27%);--info-bg: hsl(208, 100%, 97%);--info-border: hsl(221, 91%, 91%);--info-text: hsl(210, 92%, 45%);--warning-bg: hsl(49, 100%, 97%);--warning-border: hsl(49, 91%, 91%);--warning-text: hsl(31, 92%, 45%);--error-bg: hsl(359, 100%, 97%);--error-border: hsl(359, 100%, 94%);--error-text: hsl(360, 100%, 45%)}[data-sonner-toaster][data-theme=light] [data-sonner-toast][data-invert=true]{--normal-bg: #000;--normal-border: hsl(0, 0%, 20%);--normal-text: var(--gray1)}[data-sonner-toaster][data-theme=dark] [data-sonner-toast][data-invert=true]{--normal-bg: #fff;--normal-border: var(--gray3);--normal-text: var(--gray12)}[data-sonner-toaster][data-theme=dark]{--normal-bg: #000;--normal-bg-hover: hsl(0, 0%, 12%);--normal-border: hsl(0, 0%, 20%);--normal-border-hover: hsl(0, 0%, 25%);--normal-text: var(--gray1);--success-bg: hsl(150, 100%, 6%);--success-border: hsl(147, 100%, 12%);--success-text: hsl(150, 86%, 65%);--info-bg: hsl(215, 100%, 6%);--info-border: hsl(223, 100%, 12%);--info-text: hsl(216, 87%, 65%);--warning-bg: hsl(64, 100%, 6%);--warning-border: hsl(60, 100%, 12%);--warning-text: hsl(46, 87%, 65%);--error-bg: hsl(358, 76%, 10%);--error-border: hsl(357, 89%, 16%);--error-text: hsl(358, 100%, 81%)}[data-sonner-toaster][data-theme=dark] [data-sonner-toast] [data-close-button]{background:var(--normal-bg);border-color:var(--normal-border);color:var(--normal-text)}[data-sonner-toaster][data-theme=dark] [data-sonner-toast] [data-close-button]:hover{background:var(--normal-bg-hover);border-color:var(--normal-border-hover)}[data-rich-colors=true][data-sonner-toast][data-type=success],[data-rich-colors=true][data-sonner-toast][data-type=success] [data-close-button]{background:var(--success-bg);border-color:var(--success-border);color:var(--success-text)}[data-rich-colors=true][data-sonner-toast][data-type=info],[data-rich-colors=true][data-sonner-toast][data-type=info] [data-close-button]{background:var(--info-bg);border-color:var(--info-border);color:var(--info-text)}[data-rich-colors=true][data-sonner-toast][data-type=warning],[data-rich-colors=true][data-sonner-toast][data-type=warning] [data-close-button]{background:var(--warning-bg);border-color:var(--warning-border);color:var(--warning-text)}[data-rich-colors=true][data-sonner-toast][data-type=error],[data-rich-colors=true][data-sonner-toast][data-type=error] [data-close-button]{background:var(--error-bg);border-color:var(--error-border);color:var(--error-text)}.sonner-loading-wrapper{--size: 16px;height:var(--size);width:var(--size);position:absolute;inset:0;z-index:10}.sonner-loading-wrapper[data-visible=false]{transform-origin:center;animation:sonner-fade-out .2s ease forwards}.sonner-spinner{position:relative;top:50%;left:50%;height:var(--size);width:var(--size)}.sonner-loading-bar{animation:sonner-spin 1.2s linear infinite;background:var(--gray11);border-radius:6px;height:8%;left:-10%;position:absolute;top:-3.9%;width:24%}.sonner-loading-bar:nth-child(1){animation-delay:-1.2s;transform:rotate(.0001deg) translate(146%)}.sonner-loading-bar:nth-child(2){animation-delay:-1.1s;transform:rotate(30deg) translate(146%)}.sonner-loading-bar:nth-child(3){animation-delay:-1s;transform:rotate(60deg) translate(146%)}.sonner-loading-bar:nth-child(4){animation-delay:-.9s;transform:rotate(90deg) translate(146%)}.sonner-loading-bar:nth-child(5){animation-delay:-.8s;transform:rotate(120deg) translate(146%)}.sonner-loading-bar:nth-child(6){animation-delay:-.7s;transform:rotate(150deg) translate(146%)}.sonner-loading-bar:nth-child(7){animation-delay:-.6s;transform:rotate(180deg) translate(146%)}.sonner-loading-bar:nth-child(8){animation-delay:-.5s;transform:rotate(210deg) translate(146%)}.sonner-loading-bar:nth-child(9){animation-delay:-.4s;transform:rotate(240deg) translate(146%)}.sonner-loading-bar:nth-child(10){animation-delay:-.3s;transform:rotate(270deg) translate(146%)}.sonner-loading-bar:nth-child(11){animation-delay:-.2s;transform:rotate(300deg) translate(146%)}.sonner-loading-bar:nth-child(12){animation-delay:-.1s;transform:rotate(330deg) translate(146%)}@keyframes sonner-fade-in{0%{opacity:0;transform:scale(.8)}to{opacity:1;transform:scale(1)}}@keyframes sonner-fade-out{0%{opacity:1;transform:scale(1)}to{opacity:0;transform:scale(.8)}}@keyframes sonner-spin{0%{opacity:1}to{opacity:.15}}@media (prefers-reduced-motion){[data-sonner-toast],[data-sonner-toast]>*,.sonner-loading-bar{transition:none!important;animation:none!important}}.sonner-loader{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);transform-origin:center;transition:opacity .2s,transform .2s}.sonner-loader[data-visible=false]{opacity:0;transform:scale(.8) translate(-50%,-50%)}
`);function Jv(r){return r.label!==void 0}var xj=3,yj="32px",_j="16px",q2=4e3,wj=356,Sj=14,bj=20,Ej=200;function qo(...r){return r.filter(Boolean).join(" ")}function Mj(r){let[e,t]=r.split("-"),n=[];return e&&n.push(e),t&&n.push(t),n}var Tj=r=>{var e,t,n,s,i,o,a,c,d,f,m;let{invert:v,toast:x,unstyled:_,interacting:b,setHeights:w,visibleToasts:S,heights:C,index:T,toasts:A,expanded:k,removeToast:j,defaultRichColors:D,closeButton:L,style:O,cancelButtonStyle:I,actionButtonStyle:B,className:W="",descriptionClassName:K="",duration:ee,position:oe,gap:ne,loadingIcon:ce,expandByDefault:V,classNames:q,icons:Z,closeButtonAriaLabel:X="Close toast",pauseWhenPageIsHidden:ie}=r,[be,ue]=re.useState(null),[Ee,Fe]=re.useState(null),[me,je]=re.useState(!1),[Xe,$e]=re.useState(!1),[dt,ht]=re.useState(!1),[Ie,$]=re.useState(!1),[Ce,ke]=re.useState(!1),[Ge,Ae]=re.useState(0),[rt,qe]=re.useState(0),nt=re.useRef(x.duration||ee||q2),jt=re.useRef(null),Q=re.useRef(null),H=T===0,ye=T+1<=S,Re=x.type,Ue=x.dismissible!==!1,Le=x.className||"",bt=x.descriptionClassName||"",st=re.useMemo(()=>C.findIndex(Be=>Be.toastId===x.id)||0,[C,x.id]),xt=re.useMemo(()=>{var Be;return(Be=x.closeButton)!=null?Be:L},[x.closeButton,L]),Et=re.useMemo(()=>x.duration||ee||q2,[x.duration,ee]),We=re.useRef(0),ft=re.useRef(0),Bt=re.useRef(0),le=re.useRef(null),[Se,Ze]=oe.split("-"),ae=re.useMemo(()=>C.reduce((Be,lt,Dt)=>Dt>=st?Be:Be+lt.height,0),[C,st]),Je=uj(),He=x.invert||v,ct=Re==="loading";ft.current=re.useMemo(()=>st*ne+ae,[st,ae]),re.useEffect(()=>{nt.current=Et},[Et]),re.useEffect(()=>{je(!0)},[]),re.useEffect(()=>{let Be=Q.current;if(Be){let lt=Be.getBoundingClientRect().height;return qe(lt),w(Dt=>[{toastId:x.id,height:lt,position:x.position},...Dt]),()=>w(Dt=>Dt.filter(Ht=>Ht.toastId!==x.id))}},[w,x.id]),re.useLayoutEffect(()=>{if(!me)return;let Be=Q.current,lt=Be.style.height;Be.style.height="auto";let Dt=Be.getBoundingClientRect().height;Be.style.height=lt,qe(Dt),w(Ht=>Ht.find(An=>An.toastId===x.id)?Ht.map(An=>An.toastId===x.id?{...An,height:Dt}:An):[{toastId:x.id,height:Dt,position:x.position},...Ht])},[me,x.title,x.description,w,x.id]);let Ye=re.useCallback(()=>{$e(!0),Ae(ft.current),w(Be=>Be.filter(lt=>lt.toastId!==x.id)),setTimeout(()=>{j(x)},Ej)},[x,j,w,ft]);re.useEffect(()=>{if(x.promise&&Re==="loading"||x.duration===1/0||x.type==="loading")return;let Be;return k||b||ie&&Je?(()=>{if(Bt.current<We.current){let lt=new Date().getTime()-We.current;nt.current=nt.current-lt}Bt.current=new Date().getTime()})():nt.current!==1/0&&(We.current=new Date().getTime(),Be=setTimeout(()=>{var lt;(lt=x.onAutoClose)==null||lt.call(x,x),Ye()},nt.current)),()=>clearTimeout(Be)},[k,b,x,Re,ie,Je,Ye]),re.useEffect(()=>{x.delete&&Ye()},[Ye,x.delete]);function ze(){var Be,lt,Dt;return Z!=null&&Z.loading?re.createElement("div",{className:qo(q==null?void 0:q.loader,(Be=x==null?void 0:x.classNames)==null?void 0:Be.loader,"sonner-loader"),"data-visible":Re==="loading"},Z.loading):ce?re.createElement("div",{className:qo(q==null?void 0:q.loader,(lt=x==null?void 0:x.classNames)==null?void 0:lt.loader,"sonner-loader"),"data-visible":Re==="loading"},ce):re.createElement(sj,{className:qo(q==null?void 0:q.loader,(Dt=x==null?void 0:x.classNames)==null?void 0:Dt.loader),visible:Re==="loading"})}return re.createElement("li",{tabIndex:0,ref:Q,className:qo(W,Le,q==null?void 0:q.toast,(e=x==null?void 0:x.classNames)==null?void 0:e.toast,q==null?void 0:q.default,q==null?void 0:q[Re],(t=x==null?void 0:x.classNames)==null?void 0:t[Re]),"data-sonner-toast":"","data-rich-colors":(n=x.richColors)!=null?n:D,"data-styled":!(x.jsx||x.unstyled||_),"data-mounted":me,"data-promise":!!x.promise,"data-swiped":Ce,"data-removed":Xe,"data-visible":ye,"data-y-position":Se,"data-x-position":Ze,"data-index":T,"data-front":H,"data-swiping":dt,"data-dismissible":Ue,"data-type":Re,"data-invert":He,"data-swipe-out":Ie,"data-swipe-direction":Ee,"data-expanded":!!(k||V&&me),style:{"--index":T,"--toasts-before":T,"--z-index":A.length-T,"--offset":`${Xe?Ge:ft.current}px`,"--initial-height":V?"auto":`${rt}px`,...O,...x.style},onDragEnd:()=>{ht(!1),ue(null),le.current=null},onPointerDown:Be=>{ct||!Ue||(jt.current=new Date,Ae(ft.current),Be.target.setPointerCapture(Be.pointerId),Be.target.tagName!=="BUTTON"&&(ht(!0),le.current={x:Be.clientX,y:Be.clientY}))},onPointerUp:()=>{var Be,lt,Dt,Ht;if(Ie||!Ue)return;le.current=null;let An=Number(((Be=Q.current)==null?void 0:Be.style.getPropertyValue("--swipe-amount-x").replace("px",""))||0),Bn=Number(((lt=Q.current)==null?void 0:lt.style.getPropertyValue("--swipe-amount-y").replace("px",""))||0),Ts=new Date().getTime()-((Dt=jt.current)==null?void 0:Dt.getTime()),pr=be==="x"?An:Bn,wr=Math.abs(pr)/Ts;if(Math.abs(pr)>=bj||wr>.11){Ae(ft.current),(Ht=x.onDismiss)==null||Ht.call(x,x),Fe(be==="x"?An>0?"right":"left":Bn>0?"down":"up"),Ye(),$(!0),ke(!1);return}ht(!1),ue(null)},onPointerMove:Be=>{var lt,Dt,Ht,An;if(!le.current||!Ue||((lt=window.getSelection())==null?void 0:lt.toString().length)>0)return;let Bn=Be.clientY-le.current.y,Ts=Be.clientX-le.current.x,pr=(Dt=r.swipeDirections)!=null?Dt:Mj(oe);!be&&(Math.abs(Ts)>1||Math.abs(Bn)>1)&&ue(Math.abs(Ts)>Math.abs(Bn)?"x":"y");let wr={x:0,y:0};be==="y"?(pr.includes("top")||pr.includes("bottom"))&&(pr.includes("top")&&Bn<0||pr.includes("bottom")&&Bn>0)&&(wr.y=Bn):be==="x"&&(pr.includes("left")||pr.includes("right"))&&(pr.includes("left")&&Ts<0||pr.includes("right")&&Ts>0)&&(wr.x=Ts),(Math.abs(wr.x)>0||Math.abs(wr.y)>0)&&ke(!0),(Ht=Q.current)==null||Ht.style.setProperty("--swipe-amount-x",`${wr.x}px`),(An=Q.current)==null||An.style.setProperty("--swipe-amount-y",`${wr.y}px`)}},xt&&!x.jsx?re.createElement("button",{"aria-label":X,"data-disabled":ct,"data-close-button":!0,onClick:ct||!Ue?()=>{}:()=>{var Be;Ye(),(Be=x.onDismiss)==null||Be.call(x,x)},className:qo(q==null?void 0:q.closeButton,(s=x==null?void 0:x.classNames)==null?void 0:s.closeButton)},(i=Z==null?void 0:Z.close)!=null?i:cj):null,x.jsx||R.isValidElement(x.title)?x.jsx?x.jsx:typeof x.title=="function"?x.title():x.title:re.createElement(re.Fragment,null,Re||x.icon||x.promise?re.createElement("div",{"data-icon":"",className:qo(q==null?void 0:q.icon,(o=x==null?void 0:x.classNames)==null?void 0:o.icon)},x.promise||x.type==="loading"&&!x.icon?x.icon||ze():null,x.type!=="loading"?x.icon||(Z==null?void 0:Z[Re])||nj(Re):null):null,re.createElement("div",{"data-content":"",className:qo(q==null?void 0:q.content,(a=x==null?void 0:x.classNames)==null?void 0:a.content)},re.createElement("div",{"data-title":"",className:qo(q==null?void 0:q.title,(c=x==null?void 0:x.classNames)==null?void 0:c.title)},typeof x.title=="function"?x.title():x.title),x.description?re.createElement("div",{"data-description":"",className:qo(K,bt,q==null?void 0:q.description,(d=x==null?void 0:x.classNames)==null?void 0:d.description)},typeof x.description=="function"?x.description():x.description):null),R.isValidElement(x.cancel)?x.cancel:x.cancel&&Jv(x.cancel)?re.createElement("button",{"data-button":!0,"data-cancel":!0,style:x.cancelButtonStyle||I,onClick:Be=>{var lt,Dt;Jv(x.cancel)&&Ue&&((Dt=(lt=x.cancel).onClick)==null||Dt.call(lt,Be),Ye())},className:qo(q==null?void 0:q.cancelButton,(f=x==null?void 0:x.classNames)==null?void 0:f.cancelButton)},x.cancel.label):null,R.isValidElement(x.action)?x.action:x.action&&Jv(x.action)?re.createElement("button",{"data-button":!0,"data-action":!0,style:x.actionButtonStyle||B,onClick:Be=>{var lt,Dt;Jv(x.action)&&((Dt=(lt=x.action).onClick)==null||Dt.call(lt,Be),!Be.defaultPrevented&&Ye())},className:qo(q==null?void 0:q.actionButton,(m=x==null?void 0:x.classNames)==null?void 0:m.actionButton)},x.action.label):null))};function X2(){if(typeof window>"u"||typeof document>"u")return"ltr";let r=document.documentElement.getAttribute("dir");return r==="auto"||!r?window.getComputedStyle(document.documentElement).direction:r}function Cj(r,e){let t={};return[r,e].forEach((n,s)=>{let i=s===1,o=i?"--mobile-offset":"--offset",a=i?_j:yj;function c(d){["top","right","bottom","left"].forEach(f=>{t[`${o}-${f}`]=typeof d=="number"?`${d}px`:d})}typeof n=="number"||typeof n=="string"?c(n):typeof n=="object"?["top","right","bottom","left"].forEach(d=>{n[d]===void 0?t[`${o}-${d}`]=a:t[`${o}-${d}`]=typeof n[d]=="number"?`${n[d]}px`:n[d]}):c(a)}),t}var Aj=R.forwardRef(function(r,e){let{invert:t,position:n="bottom-right",hotkey:s=["altKey","KeyT"],expand:i,closeButton:o,className:a,offset:c,mobileOffset:d,theme:f="light",richColors:m,duration:v,style:x,visibleToasts:_=xj,toastOptions:b,dir:w=X2(),gap:S=Sj,loadingIcon:C,icons:T,containerAriaLabel:A="Notifications",pauseWhenPageIsHidden:k}=r,[j,D]=re.useState([]),L=re.useMemo(()=>Array.from(new Set([n].concat(j.filter(ie=>ie.position).map(ie=>ie.position)))),[j,n]),[O,I]=re.useState([]),[B,W]=re.useState(!1),[K,ee]=re.useState(!1),[oe,ne]=re.useState(f!=="system"?f:typeof window<"u"&&window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"),ce=re.useRef(null),V=s.join("+").replace(/Key/g,"").replace(/Digit/g,""),q=re.useRef(null),Z=re.useRef(!1),X=re.useCallback(ie=>{D(be=>{var ue;return(ue=be.find(Ee=>Ee.id===ie.id))!=null&&ue.delete||Ai.dismiss(ie.id),be.filter(({id:Ee})=>Ee!==ie.id)})},[]);return re.useEffect(()=>Ai.subscribe(ie=>{if(ie.dismiss){D(be=>be.map(ue=>ue.id===ie.id?{...ue,delete:!0}:ue));return}setTimeout(()=>{TR.flushSync(()=>{D(be=>{let ue=be.findIndex(Ee=>Ee.id===ie.id);return ue!==-1?[...be.slice(0,ue),{...be[ue],...ie},...be.slice(ue+1)]:[ie,...be]})})})}),[]),re.useEffect(()=>{if(f!=="system"){ne(f);return}if(f==="system"&&(window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?ne("dark"):ne("light")),typeof window>"u")return;let ie=window.matchMedia("(prefers-color-scheme: dark)");try{ie.addEventListener("change",({matches:be})=>{ne(be?"dark":"light")})}catch{ie.addListener(({matches:ue})=>{try{ne(ue?"dark":"light")}catch(Ee){console.error(Ee)}})}},[f]),re.useEffect(()=>{j.length<=1&&W(!1)},[j]),re.useEffect(()=>{let ie=be=>{var ue,Ee;s.every(Fe=>be[Fe]||be.code===Fe)&&(W(!0),(ue=ce.current)==null||ue.focus()),be.code==="Escape"&&(document.activeElement===ce.current||(Ee=ce.current)!=null&&Ee.contains(document.activeElement))&&W(!1)};return document.addEventListener("keydown",ie),()=>document.removeEventListener("keydown",ie)},[s]),re.useEffect(()=>{if(ce.current)return()=>{q.current&&(q.current.focus({preventScroll:!0}),q.current=null,Z.current=!1)}},[ce.current]),re.createElement("section",{ref:e,"aria-label":`${A} ${V}`,tabIndex:-1,"aria-live":"polite","aria-relevant":"additions text","aria-atomic":"false",suppressHydrationWarning:!0},L.map((ie,be)=>{var ue;let[Ee,Fe]=ie.split("-");return j.length?re.createElement("ol",{key:ie,dir:w==="auto"?X2():w,tabIndex:-1,ref:ce,className:a,"data-sonner-toaster":!0,"data-theme":oe,"data-y-position":Ee,"data-lifted":B&&j.length>1&&!i,"data-x-position":Fe,style:{"--front-toast-height":`${((ue=O[0])==null?void 0:ue.height)||0}px`,"--width":`${wj}px`,"--gap":`${S}px`,...x,...Cj(c,d)},onBlur:me=>{Z.current&&!me.currentTarget.contains(me.relatedTarget)&&(Z.current=!1,q.current&&(q.current.focus({preventScroll:!0}),q.current=null))},onFocus:me=>{me.target instanceof HTMLElement&&me.target.dataset.dismissible==="false"||Z.current||(Z.current=!0,q.current=me.relatedTarget)},onMouseEnter:()=>W(!0),onMouseMove:()=>W(!0),onMouseLeave:()=>{K||W(!1)},onDragEnd:()=>W(!1),onPointerDown:me=>{me.target instanceof HTMLElement&&me.target.dataset.dismissible==="false"||ee(!0)},onPointerUp:()=>ee(!1)},j.filter(me=>!me.position&&be===0||me.position===ie).map((me,je)=>{var Xe,$e;return re.createElement(Tj,{key:me.id,icons:T,index:je,toast:me,defaultRichColors:m,duration:(Xe=b==null?void 0:b.duration)!=null?Xe:v,className:b==null?void 0:b.className,descriptionClassName:b==null?void 0:b.descriptionClassName,invert:t,visibleToasts:_,closeButton:($e=b==null?void 0:b.closeButton)!=null?$e:o,interacting:K,position:ie,style:b==null?void 0:b.style,unstyled:b==null?void 0:b.unstyled,classNames:b==null?void 0:b.classNames,cancelButtonStyle:b==null?void 0:b.cancelButtonStyle,actionButtonStyle:b==null?void 0:b.actionButtonStyle,removeToast:X,toasts:j.filter(dt=>dt.position==me.position),heights:O.filter(dt=>dt.position==me.position),setHeights:I,expandByDefault:i,gap:S,loadingIcon:C,expanded:B,pauseWhenPageIsHidden:k,swipeDirections:r.swipeDirections})})):null}))});const Rj=({...r})=>{const{theme:e="system"}=tj();return h.jsx(Aj,{theme:e,className:"toaster group",toastOptions:{classNames:{toast:"group toast group-[.toaster]:bg-background group-[.toaster]:text-foreground group-[.toaster]:border-border group-[.toaster]:shadow-lg",description:"group-[.toast]:text-muted-foreground",actionButton:"group-[.toast]:bg-primary group-[.toast]:text-primary-foreground",cancelButton:"group-[.toast]:bg-muted group-[.toast]:text-muted-foreground"}},...r})};var Nj=Qb[" useId ".trim().toString()]||(()=>{}),Pj=0;function Oa(r){const[e,t]=R.useState(Nj());return Es(()=>{t(n=>n??String(Pj++))},[r]),e?`radix-${e}`:""}const Ij=["top","right","bottom","left"],pu=Math.min,Ki=Math.max,yy=Math.round,Zv=Math.floor,ja=r=>({x:r,y:r}),kj={left:"right",right:"left",bottom:"top",top:"bottom"},Dj={start:"end",end:"start"};function qS(r,e,t){return Ki(r,pu(e,t))}function Yl(r,e){return typeof r=="function"?r(e):r}function Kl(r){return r.split("-")[0]}function nm(r){return r.split("-")[1]}function sE(r){return r==="x"?"y":"x"}function iE(r){return r==="y"?"height":"width"}function Da(r){return["top","bottom"].includes(Kl(r))?"y":"x"}function oE(r){return sE(Da(r))}function Lj(r,e,t){t===void 0&&(t=!1);const n=nm(r),s=oE(r),i=iE(s);let o=s==="x"?n===(t?"end":"start")?"right":"left":n==="start"?"bottom":"top";return e.reference[i]>e.floating[i]&&(o=_y(o)),[o,_y(o)]}function Oj(r){const e=_y(r);return[XS(r),e,XS(e)]}function XS(r){return r.replace(/start|end/g,e=>Dj[e])}function jj(r,e,t){const n=["left","right"],s=["right","left"],i=["top","bottom"],o=["bottom","top"];switch(r){case"top":case"bottom":return t?e?s:n:e?n:s;case"left":case"right":return e?i:o;default:return[]}}function Fj(r,e,t,n){const s=nm(r);let i=jj(Kl(r),t==="start",n);return s&&(i=i.map(o=>o+"-"+s),e&&(i=i.concat(i.map(XS)))),i}function _y(r){return r.replace(/left|right|bottom|top/g,e=>kj[e])}function Uj(r){return{top:0,right:0,bottom:0,left:0,...r}}function gN(r){return typeof r!="number"?Uj(r):{top:r,right:r,bottom:r,left:r}}function wy(r){const{x:e,y:t,width:n,height:s}=r;return{width:n,height:s,top:t,left:e,right:e+n,bottom:t+s,x:e,y:t}}function Y2(r,e,t){let{reference:n,floating:s}=r;const i=Da(e),o=oE(e),a=iE(o),c=Kl(e),d=i==="y",f=n.x+n.width/2-s.width/2,m=n.y+n.height/2-s.height/2,v=n[a]/2-s[a]/2;let x;switch(c){case"top":x={x:f,y:n.y-s.height};break;case"bottom":x={x:f,y:n.y+n.height};break;case"right":x={x:n.x+n.width,y:m};break;case"left":x={x:n.x-s.width,y:m};break;default:x={x:n.x,y:n.y}}switch(nm(e)){case"start":x[o]-=v*(t&&d?-1:1);break;case"end":x[o]+=v*(t&&d?-1:1);break}return x}const Bj=async(r,e,t)=>{const{placement:n="bottom",strategy:s="absolute",middleware:i=[],platform:o}=t,a=i.filter(Boolean),c=await(o.isRTL==null?void 0:o.isRTL(e));let d=await o.getElementRects({reference:r,floating:e,strategy:s}),{x:f,y:m}=Y2(d,n,c),v=n,x={},_=0;for(let b=0;b<a.length;b++){const{name:w,fn:S}=a[b],{x:C,y:T,data:A,reset:k}=await S({x:f,y:m,initialPlacement:n,placement:v,strategy:s,middlewareData:x,rects:d,platform:o,elements:{reference:r,floating:e}});f=C??f,m=T??m,x={...x,[w]:{...x[w],...A}},k&&_<=50&&(_++,typeof k=="object"&&(k.placement&&(v=k.placement),k.rects&&(d=k.rects===!0?await o.getElementRects({reference:r,floating:e,strategy:s}):k.rects),{x:f,y:m}=Y2(d,v,c)),b=-1)}return{x:f,y:m,placement:v,strategy:s,middlewareData:x}};async function s0(r,e){var t;e===void 0&&(e={});const{x:n,y:s,platform:i,rects:o,elements:a,strategy:c}=r,{boundary:d="clippingAncestors",rootBoundary:f="viewport",elementContext:m="floating",altBoundary:v=!1,padding:x=0}=Yl(e,r),_=gN(x),w=a[v?m==="floating"?"reference":"floating":m],S=wy(await i.getClippingRect({element:(t=await(i.isElement==null?void 0:i.isElement(w)))==null||t?w:w.contextElement||await(i.getDocumentElement==null?void 0:i.getDocumentElement(a.floating)),boundary:d,rootBoundary:f,strategy:c})),C=m==="floating"?{x:n,y:s,width:o.floating.width,height:o.floating.height}:o.reference,T=await(i.getOffsetParent==null?void 0:i.getOffsetParent(a.floating)),A=await(i.isElement==null?void 0:i.isElement(T))?await(i.getScale==null?void 0:i.getScale(T))||{x:1,y:1}:{x:1,y:1},k=wy(i.convertOffsetParentRelativeRectToViewportRelativeRect?await i.convertOffsetParentRelativeRectToViewportRelativeRect({elements:a,rect:C,offsetParent:T,strategy:c}):C);return{top:(S.top-k.top+_.top)/A.y,bottom:(k.bottom-S.bottom+_.bottom)/A.y,left:(S.left-k.left+_.left)/A.x,right:(k.right-S.right+_.right)/A.x}}const zj=r=>({name:"arrow",options:r,async fn(e){const{x:t,y:n,placement:s,rects:i,platform:o,elements:a,middlewareData:c}=e,{element:d,padding:f=0}=Yl(r,e)||{};if(d==null)return{};const m=gN(f),v={x:t,y:n},x=oE(s),_=iE(x),b=await o.getDimensions(d),w=x==="y",S=w?"top":"left",C=w?"bottom":"right",T=w?"clientHeight":"clientWidth",A=i.reference[_]+i.reference[x]-v[x]-i.floating[_],k=v[x]-i.reference[x],j=await(o.getOffsetParent==null?void 0:o.getOffsetParent(d));let D=j?j[T]:0;(!D||!await(o.isElement==null?void 0:o.isElement(j)))&&(D=a.floating[T]||i.floating[_]);const L=A/2-k/2,O=D/2-b[_]/2-1,I=pu(m[S],O),B=pu(m[C],O),W=I,K=D-b[_]-B,ee=D/2-b[_]/2+L,oe=qS(W,ee,K),ne=!c.arrow&&nm(s)!=null&&ee!==oe&&i.reference[_]/2-(ee<W?I:B)-b[_]/2<0,ce=ne?ee<W?ee-W:ee-K:0;return{[x]:v[x]+ce,data:{[x]:oe,centerOffset:ee-oe-ce,...ne&&{alignmentOffset:ce}},reset:ne}}}),Vj=function(r){return r===void 0&&(r={}),{name:"flip",options:r,async fn(e){var t,n;const{placement:s,middlewareData:i,rects:o,initialPlacement:a,platform:c,elements:d}=e,{mainAxis:f=!0,crossAxis:m=!0,fallbackPlacements:v,fallbackStrategy:x="bestFit",fallbackAxisSideDirection:_="none",flipAlignment:b=!0,...w}=Yl(r,e);if((t=i.arrow)!=null&&t.alignmentOffset)return{};const S=Kl(s),C=Da(a),T=Kl(a)===a,A=await(c.isRTL==null?void 0:c.isRTL(d.floating)),k=v||(T||!b?[_y(a)]:Oj(a)),j=_!=="none";!v&&j&&k.push(...Fj(a,b,_,A));const D=[a,...k],L=await s0(e,w),O=[];let I=((n=i.flip)==null?void 0:n.overflows)||[];if(f&&O.push(L[S]),m){const ee=Lj(s,o,A);O.push(L[ee[0]],L[ee[1]])}if(I=[...I,{placement:s,overflows:O}],!O.every(ee=>ee<=0)){var B,W;const ee=(((B=i.flip)==null?void 0:B.index)||0)+1,oe=D[ee];if(oe&&(!(m==="alignment"?C!==Da(oe):!1)||I.every(V=>V.overflows[0]>0&&Da(V.placement)===C)))return{data:{index:ee,overflows:I},reset:{placement:oe}};let ne=(W=I.filter(ce=>ce.overflows[0]<=0).sort((ce,V)=>ce.overflows[1]-V.overflows[1])[0])==null?void 0:W.placement;if(!ne)switch(x){case"bestFit":{var K;const ce=(K=I.filter(V=>{if(j){const q=Da(V.placement);return q===C||q==="y"}return!0}).map(V=>[V.placement,V.overflows.filter(q=>q>0).reduce((q,Z)=>q+Z,0)]).sort((V,q)=>V[1]-q[1])[0])==null?void 0:K[0];ce&&(ne=ce);break}case"initialPlacement":ne=a;break}if(s!==ne)return{reset:{placement:ne}}}return{}}}};function K2(r,e){return{top:r.top-e.height,right:r.right-e.width,bottom:r.bottom-e.height,left:r.left-e.width}}function Q2(r){return Ij.some(e=>r[e]>=0)}const Hj=function(r){return r===void 0&&(r={}),{name:"hide",options:r,async fn(e){const{rects:t}=e,{strategy:n="referenceHidden",...s}=Yl(r,e);switch(n){case"referenceHidden":{const i=await s0(e,{...s,elementContext:"reference"}),o=K2(i,t.reference);return{data:{referenceHiddenOffsets:o,referenceHidden:Q2(o)}}}case"escaped":{const i=await s0(e,{...s,altBoundary:!0}),o=K2(i,t.floating);return{data:{escapedOffsets:o,escaped:Q2(o)}}}default:return{}}}}};async function Gj(r,e){const{placement:t,platform:n,elements:s}=r,i=await(n.isRTL==null?void 0:n.isRTL(s.floating)),o=Kl(t),a=nm(t),c=Da(t)==="y",d=["left","top"].includes(o)?-1:1,f=i&&c?-1:1,m=Yl(e,r);let{mainAxis:v,crossAxis:x,alignmentAxis:_}=typeof m=="number"?{mainAxis:m,crossAxis:0,alignmentAxis:null}:{mainAxis:m.mainAxis||0,crossAxis:m.crossAxis||0,alignmentAxis:m.alignmentAxis};return a&&typeof _=="number"&&(x=a==="end"?_*-1:_),c?{x:x*f,y:v*d}:{x:v*d,y:x*f}}const Wj=function(r){return r===void 0&&(r=0),{name:"offset",options:r,async fn(e){var t,n;const{x:s,y:i,placement:o,middlewareData:a}=e,c=await Gj(e,r);return o===((t=a.offset)==null?void 0:t.placement)&&(n=a.arrow)!=null&&n.alignmentOffset?{}:{x:s+c.x,y:i+c.y,data:{...c,placement:o}}}}},$j=function(r){return r===void 0&&(r={}),{name:"shift",options:r,async fn(e){const{x:t,y:n,placement:s}=e,{mainAxis:i=!0,crossAxis:o=!1,limiter:a={fn:w=>{let{x:S,y:C}=w;return{x:S,y:C}}},...c}=Yl(r,e),d={x:t,y:n},f=await s0(e,c),m=Da(Kl(s)),v=sE(m);let x=d[v],_=d[m];if(i){const w=v==="y"?"top":"left",S=v==="y"?"bottom":"right",C=x+f[w],T=x-f[S];x=qS(C,x,T)}if(o){const w=m==="y"?"top":"left",S=m==="y"?"bottom":"right",C=_+f[w],T=_-f[S];_=qS(C,_,T)}const b=a.fn({...e,[v]:x,[m]:_});return{...b,data:{x:b.x-t,y:b.y-n,enabled:{[v]:i,[m]:o}}}}}},qj=function(r){return r===void 0&&(r={}),{options:r,fn(e){const{x:t,y:n,placement:s,rects:i,middlewareData:o}=e,{offset:a=0,mainAxis:c=!0,crossAxis:d=!0}=Yl(r,e),f={x:t,y:n},m=Da(s),v=sE(m);let x=f[v],_=f[m];const b=Yl(a,e),w=typeof b=="number"?{mainAxis:b,crossAxis:0}:{mainAxis:0,crossAxis:0,...b};if(c){const T=v==="y"?"height":"width",A=i.reference[v]-i.floating[T]+w.mainAxis,k=i.reference[v]+i.reference[T]-w.mainAxis;x<A?x=A:x>k&&(x=k)}if(d){var S,C;const T=v==="y"?"width":"height",A=["top","left"].includes(Kl(s)),k=i.reference[m]-i.floating[T]+(A&&((S=o.offset)==null?void 0:S[m])||0)+(A?0:w.crossAxis),j=i.reference[m]+i.reference[T]+(A?0:((C=o.offset)==null?void 0:C[m])||0)-(A?w.crossAxis:0);_<k?_=k:_>j&&(_=j)}return{[v]:x,[m]:_}}}},Xj=function(r){return r===void 0&&(r={}),{name:"size",options:r,async fn(e){var t,n;const{placement:s,rects:i,platform:o,elements:a}=e,{apply:c=()=>{},...d}=Yl(r,e),f=await s0(e,d),m=Kl(s),v=nm(s),x=Da(s)==="y",{width:_,height:b}=i.floating;let w,S;m==="top"||m==="bottom"?(w=m,S=v===(await(o.isRTL==null?void 0:o.isRTL(a.floating))?"start":"end")?"left":"right"):(S=m,w=v==="end"?"top":"bottom");const C=b-f.top-f.bottom,T=_-f.left-f.right,A=pu(b-f[w],C),k=pu(_-f[S],T),j=!e.middlewareData.shift;let D=A,L=k;if((t=e.middlewareData.shift)!=null&&t.enabled.x&&(L=T),(n=e.middlewareData.shift)!=null&&n.enabled.y&&(D=C),j&&!v){const I=Ki(f.left,0),B=Ki(f.right,0),W=Ki(f.top,0),K=Ki(f.bottom,0);x?L=_-2*(I!==0||B!==0?I+B:Ki(f.left,f.right)):D=b-2*(W!==0||K!==0?W+K:Ki(f.top,f.bottom))}await c({...e,availableWidth:L,availableHeight:D});const O=await o.getDimensions(a.floating);return _!==O.width||b!==O.height?{reset:{rects:!0}}:{}}}};function A_(){return typeof window<"u"}function rm(r){return vN(r)?(r.nodeName||"").toLowerCase():"#document"}function Ji(r){var e;return(r==null||(e=r.ownerDocument)==null?void 0:e.defaultView)||window}function Wa(r){var e;return(e=(vN(r)?r.ownerDocument:r.document)||window.document)==null?void 0:e.documentElement}function vN(r){return A_()?r instanceof Node||r instanceof Ji(r).Node:!1}function oa(r){return A_()?r instanceof Element||r instanceof Ji(r).Element:!1}function Va(r){return A_()?r instanceof HTMLElement||r instanceof Ji(r).HTMLElement:!1}function J2(r){return!A_()||typeof ShadowRoot>"u"?!1:r instanceof ShadowRoot||r instanceof Ji(r).ShadowRoot}function O0(r){const{overflow:e,overflowX:t,overflowY:n,display:s}=aa(r);return/auto|scroll|overlay|hidden|clip/.test(e+n+t)&&!["inline","contents"].includes(s)}function Yj(r){return["table","td","th"].includes(rm(r))}function R_(r){return[":popover-open",":modal"].some(e=>{try{return r.matches(e)}catch{return!1}})}function aE(r){const e=lE(),t=oa(r)?aa(r):r;return["transform","translate","scale","rotate","perspective"].some(n=>t[n]?t[n]!=="none":!1)||(t.containerType?t.containerType!=="normal":!1)||!e&&(t.backdropFilter?t.backdropFilter!=="none":!1)||!e&&(t.filter?t.filter!=="none":!1)||["transform","translate","scale","rotate","perspective","filter"].some(n=>(t.willChange||"").includes(n))||["paint","layout","strict","content"].some(n=>(t.contain||"").includes(n))}function Kj(r){let e=mu(r);for(;Va(e)&&!Bp(e);){if(aE(e))return e;if(R_(e))return null;e=mu(e)}return null}function lE(){return typeof CSS>"u"||!CSS.supports?!1:CSS.supports("-webkit-backdrop-filter","none")}function Bp(r){return["html","body","#document"].includes(rm(r))}function aa(r){return Ji(r).getComputedStyle(r)}function N_(r){return oa(r)?{scrollLeft:r.scrollLeft,scrollTop:r.scrollTop}:{scrollLeft:r.scrollX,scrollTop:r.scrollY}}function mu(r){if(rm(r)==="html")return r;const e=r.assignedSlot||r.parentNode||J2(r)&&r.host||Wa(r);return J2(e)?e.host:e}function xN(r){const e=mu(r);return Bp(e)?r.ownerDocument?r.ownerDocument.body:r.body:Va(e)&&O0(e)?e:xN(e)}function i0(r,e,t){var n;e===void 0&&(e=[]),t===void 0&&(t=!0);const s=xN(r),i=s===((n=r.ownerDocument)==null?void 0:n.body),o=Ji(s);if(i){const a=YS(o);return e.concat(o,o.visualViewport||[],O0(s)?s:[],a&&t?i0(a):[])}return e.concat(s,i0(s,[],t))}function YS(r){return r.parent&&Object.getPrototypeOf(r.parent)?r.frameElement:null}function yN(r){const e=aa(r);let t=parseFloat(e.width)||0,n=parseFloat(e.height)||0;const s=Va(r),i=s?r.offsetWidth:t,o=s?r.offsetHeight:n,a=yy(t)!==i||yy(n)!==o;return a&&(t=i,n=o),{width:t,height:n,$:a}}function cE(r){return oa(r)?r:r.contextElement}function Ep(r){const e=cE(r);if(!Va(e))return ja(1);const t=e.getBoundingClientRect(),{width:n,height:s,$:i}=yN(e);let o=(i?yy(t.width):t.width)/n,a=(i?yy(t.height):t.height)/s;return(!o||!Number.isFinite(o))&&(o=1),(!a||!Number.isFinite(a))&&(a=1),{x:o,y:a}}const Qj=ja(0);function _N(r){const e=Ji(r);return!lE()||!e.visualViewport?Qj:{x:e.visualViewport.offsetLeft,y:e.visualViewport.offsetTop}}function Jj(r,e,t){return e===void 0&&(e=!1),!t||e&&t!==Ji(r)?!1:e}function oh(r,e,t,n){e===void 0&&(e=!1),t===void 0&&(t=!1);const s=r.getBoundingClientRect(),i=cE(r);let o=ja(1);e&&(n?oa(n)&&(o=Ep(n)):o=Ep(r));const a=Jj(i,t,n)?_N(i):ja(0);let c=(s.left+a.x)/o.x,d=(s.top+a.y)/o.y,f=s.width/o.x,m=s.height/o.y;if(i){const v=Ji(i),x=n&&oa(n)?Ji(n):n;let _=v,b=YS(_);for(;b&&n&&x!==_;){const w=Ep(b),S=b.getBoundingClientRect(),C=aa(b),T=S.left+(b.clientLeft+parseFloat(C.paddingLeft))*w.x,A=S.top+(b.clientTop+parseFloat(C.paddingTop))*w.y;c*=w.x,d*=w.y,f*=w.x,m*=w.y,c+=T,d+=A,_=Ji(b),b=YS(_)}}return wy({width:f,height:m,x:c,y:d})}function uE(r,e){const t=N_(r).scrollLeft;return e?e.left+t:oh(Wa(r)).left+t}function wN(r,e,t){t===void 0&&(t=!1);const n=r.getBoundingClientRect(),s=n.left+e.scrollLeft-(t?0:uE(r,n)),i=n.top+e.scrollTop;return{x:s,y:i}}function Zj(r){let{elements:e,rect:t,offsetParent:n,strategy:s}=r;const i=s==="fixed",o=Wa(n),a=e?R_(e.floating):!1;if(n===o||a&&i)return t;let c={scrollLeft:0,scrollTop:0},d=ja(1);const f=ja(0),m=Va(n);if((m||!m&&!i)&&((rm(n)!=="body"||O0(o))&&(c=N_(n)),Va(n))){const x=oh(n);d=Ep(n),f.x=x.x+n.clientLeft,f.y=x.y+n.clientTop}const v=o&&!m&&!i?wN(o,c,!0):ja(0);return{width:t.width*d.x,height:t.height*d.y,x:t.x*d.x-c.scrollLeft*d.x+f.x+v.x,y:t.y*d.y-c.scrollTop*d.y+f.y+v.y}}function eF(r){return Array.from(r.getClientRects())}function tF(r){const e=Wa(r),t=N_(r),n=r.ownerDocument.body,s=Ki(e.scrollWidth,e.clientWidth,n.scrollWidth,n.clientWidth),i=Ki(e.scrollHeight,e.clientHeight,n.scrollHeight,n.clientHeight);let o=-t.scrollLeft+uE(r);const a=-t.scrollTop;return aa(n).direction==="rtl"&&(o+=Ki(e.clientWidth,n.clientWidth)-s),{width:s,height:i,x:o,y:a}}function nF(r,e){const t=Ji(r),n=Wa(r),s=t.visualViewport;let i=n.clientWidth,o=n.clientHeight,a=0,c=0;if(s){i=s.width,o=s.height;const d=lE();(!d||d&&e==="fixed")&&(a=s.offsetLeft,c=s.offsetTop)}return{width:i,height:o,x:a,y:c}}function rF(r,e){const t=oh(r,!0,e==="fixed"),n=t.top+r.clientTop,s=t.left+r.clientLeft,i=Va(r)?Ep(r):ja(1),o=r.clientWidth*i.x,a=r.clientHeight*i.y,c=s*i.x,d=n*i.y;return{width:o,height:a,x:c,y:d}}function Z2(r,e,t){let n;if(e==="viewport")n=nF(r,t);else if(e==="document")n=tF(Wa(r));else if(oa(e))n=rF(e,t);else{const s=_N(r);n={x:e.x-s.x,y:e.y-s.y,width:e.width,height:e.height}}return wy(n)}function SN(r,e){const t=mu(r);return t===e||!oa(t)||Bp(t)?!1:aa(t).position==="fixed"||SN(t,e)}function sF(r,e){const t=e.get(r);if(t)return t;let n=i0(r,[],!1).filter(a=>oa(a)&&rm(a)!=="body"),s=null;const i=aa(r).position==="fixed";let o=i?mu(r):r;for(;oa(o)&&!Bp(o);){const a=aa(o),c=aE(o);!c&&a.position==="fixed"&&(s=null),(i?!c&&!s:!c&&a.position==="static"&&!!s&&["absolute","fixed"].includes(s.position)||O0(o)&&!c&&SN(r,o))?n=n.filter(f=>f!==o):s=a,o=mu(o)}return e.set(r,n),n}function iF(r){let{element:e,boundary:t,rootBoundary:n,strategy:s}=r;const o=[...t==="clippingAncestors"?R_(e)?[]:sF(e,this._c):[].concat(t),n],a=o[0],c=o.reduce((d,f)=>{const m=Z2(e,f,s);return d.top=Ki(m.top,d.top),d.right=pu(m.right,d.right),d.bottom=pu(m.bottom,d.bottom),d.left=Ki(m.left,d.left),d},Z2(e,a,s));return{width:c.right-c.left,height:c.bottom-c.top,x:c.left,y:c.top}}function oF(r){const{width:e,height:t}=yN(r);return{width:e,height:t}}function aF(r,e,t){const n=Va(e),s=Wa(e),i=t==="fixed",o=oh(r,!0,i,e);let a={scrollLeft:0,scrollTop:0};const c=ja(0);function d(){c.x=uE(s)}if(n||!n&&!i)if((rm(e)!=="body"||O0(s))&&(a=N_(e)),n){const x=oh(e,!0,i,e);c.x=x.x+e.clientLeft,c.y=x.y+e.clientTop}else s&&d();i&&!n&&s&&d();const f=s&&!n&&!i?wN(s,a):ja(0),m=o.left+a.scrollLeft-c.x-f.x,v=o.top+a.scrollTop-c.y-f.y;return{x:m,y:v,width:o.width,height:o.height}}function g1(r){return aa(r).position==="static"}function eT(r,e){if(!Va(r)||aa(r).position==="fixed")return null;if(e)return e(r);let t=r.offsetParent;return Wa(r)===t&&(t=t.ownerDocument.body),t}function bN(r,e){const t=Ji(r);if(R_(r))return t;if(!Va(r)){let s=mu(r);for(;s&&!Bp(s);){if(oa(s)&&!g1(s))return s;s=mu(s)}return t}let n=eT(r,e);for(;n&&Yj(n)&&g1(n);)n=eT(n,e);return n&&Bp(n)&&g1(n)&&!aE(n)?t:n||Kj(r)||t}const lF=async function(r){const e=this.getOffsetParent||bN,t=this.getDimensions,n=await t(r.floating);return{reference:aF(r.reference,await e(r.floating),r.strategy),floating:{x:0,y:0,width:n.width,height:n.height}}};function cF(r){return aa(r).direction==="rtl"}const uF={convertOffsetParentRelativeRectToViewportRelativeRect:Zj,getDocumentElement:Wa,getClippingRect:iF,getOffsetParent:bN,getElementRects:lF,getClientRects:eF,getDimensions:oF,getScale:Ep,isElement:oa,isRTL:cF};function EN(r,e){return r.x===e.x&&r.y===e.y&&r.width===e.width&&r.height===e.height}function dF(r,e){let t=null,n;const s=Wa(r);function i(){var a;clearTimeout(n),(a=t)==null||a.disconnect(),t=null}function o(a,c){a===void 0&&(a=!1),c===void 0&&(c=1),i();const d=r.getBoundingClientRect(),{left:f,top:m,width:v,height:x}=d;if(a||e(),!v||!x)return;const _=Zv(m),b=Zv(s.clientWidth-(f+v)),w=Zv(s.clientHeight-(m+x)),S=Zv(f),T={rootMargin:-_+"px "+-b+"px "+-w+"px "+-S+"px",threshold:Ki(0,pu(1,c))||1};let A=!0;function k(j){const D=j[0].intersectionRatio;if(D!==c){if(!A)return o();D?o(!1,D):n=setTimeout(()=>{o(!1,1e-7)},1e3)}D===1&&!EN(d,r.getBoundingClientRect())&&o(),A=!1}try{t=new IntersectionObserver(k,{...T,root:s.ownerDocument})}catch{t=new IntersectionObserver(k,T)}t.observe(r)}return o(!0),i}function hF(r,e,t,n){n===void 0&&(n={});const{ancestorScroll:s=!0,ancestorResize:i=!0,elementResize:o=typeof ResizeObserver=="function",layoutShift:a=typeof IntersectionObserver=="function",animationFrame:c=!1}=n,d=cE(r),f=s||i?[...d?i0(d):[],...i0(e)]:[];f.forEach(S=>{s&&S.addEventListener("scroll",t,{passive:!0}),i&&S.addEventListener("resize",t)});const m=d&&a?dF(d,t):null;let v=-1,x=null;o&&(x=new ResizeObserver(S=>{let[C]=S;C&&C.target===d&&x&&(x.unobserve(e),cancelAnimationFrame(v),v=requestAnimationFrame(()=>{var T;(T=x)==null||T.observe(e)})),t()}),d&&!c&&x.observe(d),x.observe(e));let _,b=c?oh(r):null;c&&w();function w(){const S=oh(r);b&&!EN(b,S)&&t(),b=S,_=requestAnimationFrame(w)}return t(),()=>{var S;f.forEach(C=>{s&&C.removeEventListener("scroll",t),i&&C.removeEventListener("resize",t)}),m==null||m(),(S=x)==null||S.disconnect(),x=null,c&&cancelAnimationFrame(_)}}const fF=Wj,pF=$j,mF=Vj,gF=Xj,vF=Hj,tT=zj,xF=qj,yF=(r,e,t)=>{const n=new Map,s={platform:uF,...t},i={...s.platform,_c:n};return Bj(r,e,{...s,platform:i})};var _F=typeof document<"u",wF=function(){},cy=_F?R.useLayoutEffect:wF;function Sy(r,e){if(r===e)return!0;if(typeof r!=typeof e)return!1;if(typeof r=="function"&&r.toString()===e.toString())return!0;let t,n,s;if(r&&e&&typeof r=="object"){if(Array.isArray(r)){if(t=r.length,t!==e.length)return!1;for(n=t;n--!==0;)if(!Sy(r[n],e[n]))return!1;return!0}if(s=Object.keys(r),t=s.length,t!==Object.keys(e).length)return!1;for(n=t;n--!==0;)if(!{}.hasOwnProperty.call(e,s[n]))return!1;for(n=t;n--!==0;){const i=s[n];if(!(i==="_owner"&&r.$$typeof)&&!Sy(r[i],e[i]))return!1}return!0}return r!==r&&e!==e}function MN(r){return typeof window>"u"?1:(r.ownerDocument.defaultView||window).devicePixelRatio||1}function nT(r,e){const t=MN(r);return Math.round(e*t)/t}function v1(r){const e=R.useRef(r);return cy(()=>{e.current=r}),e}function SF(r){r===void 0&&(r={});const{placement:e="bottom",strategy:t="absolute",middleware:n=[],platform:s,elements:{reference:i,floating:o}={},transform:a=!0,whileElementsMounted:c,open:d}=r,[f,m]=R.useState({x:0,y:0,strategy:t,placement:e,middlewareData:{},isPositioned:!1}),[v,x]=R.useState(n);Sy(v,n)||x(n);const[_,b]=R.useState(null),[w,S]=R.useState(null),C=R.useCallback(V=>{V!==j.current&&(j.current=V,b(V))},[]),T=R.useCallback(V=>{V!==D.current&&(D.current=V,S(V))},[]),A=i||_,k=o||w,j=R.useRef(null),D=R.useRef(null),L=R.useRef(f),O=c!=null,I=v1(c),B=v1(s),W=v1(d),K=R.useCallback(()=>{if(!j.current||!D.current)return;const V={placement:e,strategy:t,middleware:v};B.current&&(V.platform=B.current),yF(j.current,D.current,V).then(q=>{const Z={...q,isPositioned:W.current!==!1};ee.current&&!Sy(L.current,Z)&&(L.current=Z,Jp.flushSync(()=>{m(Z)}))})},[v,e,t,B,W]);cy(()=>{d===!1&&L.current.isPositioned&&(L.current.isPositioned=!1,m(V=>({...V,isPositioned:!1})))},[d]);const ee=R.useRef(!1);cy(()=>(ee.current=!0,()=>{ee.current=!1}),[]),cy(()=>{if(A&&(j.current=A),k&&(D.current=k),A&&k){if(I.current)return I.current(A,k,K);K()}},[A,k,K,I,O]);const oe=R.useMemo(()=>({reference:j,floating:D,setReference:C,setFloating:T}),[C,T]),ne=R.useMemo(()=>({reference:A,floating:k}),[A,k]),ce=R.useMemo(()=>{const V={position:t,left:0,top:0};if(!ne.floating)return V;const q=nT(ne.floating,f.x),Z=nT(ne.floating,f.y);return a?{...V,transform:"translate("+q+"px, "+Z+"px)",...MN(ne.floating)>=1.5&&{willChange:"transform"}}:{position:t,left:q,top:Z}},[t,a,ne.floating,f.x,f.y]);return R.useMemo(()=>({...f,update:K,refs:oe,elements:ne,floatingStyles:ce}),[f,K,oe,ne,ce])}const bF=r=>{function e(t){return{}.hasOwnProperty.call(t,"current")}return{name:"arrow",options:r,fn(t){const{element:n,padding:s}=typeof r=="function"?r(t):r;return n&&e(n)?n.current!=null?tT({element:n.current,padding:s}).fn(t):{}:n?tT({element:n,padding:s}).fn(t):{}}}},EF=(r,e)=>({...fF(r),options:[r,e]}),MF=(r,e)=>({...pF(r),options:[r,e]}),TF=(r,e)=>({...xF(r),options:[r,e]}),CF=(r,e)=>({...mF(r),options:[r,e]}),AF=(r,e)=>({...gF(r),options:[r,e]}),RF=(r,e)=>({...vF(r),options:[r,e]}),NF=(r,e)=>({...bF(r),options:[r,e]});var PF="Arrow",TN=R.forwardRef((r,e)=>{const{children:t,width:n=10,height:s=5,...i}=r;return h.jsx($t.svg,{...i,ref:e,width:n,height:s,viewBox:"0 0 30 10",preserveAspectRatio:"none",children:r.asChild?t:h.jsx("polygon",{points:"0,0 30,0 15,10"})})});TN.displayName=PF;var IF=TN;function dE(r){const[e,t]=R.useState(void 0);return Es(()=>{if(r){t({width:r.offsetWidth,height:r.offsetHeight});const n=new ResizeObserver(s=>{if(!Array.isArray(s)||!s.length)return;const i=s[0];let o,a;if("borderBoxSize"in i){const c=i.borderBoxSize,d=Array.isArray(c)?c[0]:c;o=d.inlineSize,a=d.blockSize}else o=r.offsetWidth,a=r.offsetHeight;t({width:o,height:a})});return n.observe(r,{box:"border-box"}),()=>n.unobserve(r)}else t(void 0)},[r]),e}var hE="Popper",[CN,sm]=to(hE),[kF,AN]=CN(hE),RN=r=>{const{__scopePopper:e,children:t}=r,[n,s]=R.useState(null);return h.jsx(kF,{scope:e,anchor:n,onAnchorChange:s,children:t})};RN.displayName=hE;var NN="PopperAnchor",PN=R.forwardRef((r,e)=>{const{__scopePopper:t,virtualRef:n,...s}=r,i=AN(NN,t),o=R.useRef(null),a=Cn(e,o);return R.useEffect(()=>{i.onAnchorChange((n==null?void 0:n.current)||o.current)}),n?null:h.jsx($t.div,{...s,ref:a})});PN.displayName=NN;var fE="PopperContent",[DF,LF]=CN(fE),IN=R.forwardRef((r,e)=>{var me,je,Xe,$e,dt,ht;const{__scopePopper:t,side:n="bottom",sideOffset:s=0,align:i="center",alignOffset:o=0,arrowPadding:a=0,avoidCollisions:c=!0,collisionBoundary:d=[],collisionPadding:f=0,sticky:m="partial",hideWhenDetached:v=!1,updatePositionStrategy:x="optimized",onPlaced:_,...b}=r,w=AN(fE,t),[S,C]=R.useState(null),T=Cn(e,Ie=>C(Ie)),[A,k]=R.useState(null),j=dE(A),D=(j==null?void 0:j.width)??0,L=(j==null?void 0:j.height)??0,O=n+(i!=="center"?"-"+i:""),I=typeof f=="number"?f:{top:0,right:0,bottom:0,left:0,...f},B=Array.isArray(d)?d:[d],W=B.length>0,K={padding:I,boundary:B.filter(jF),altBoundary:W},{refs:ee,floatingStyles:oe,placement:ne,isPositioned:ce,middlewareData:V}=SF({strategy:"fixed",placement:O,whileElementsMounted:(...Ie)=>hF(...Ie,{animationFrame:x==="always"}),elements:{reference:w.anchor},middleware:[EF({mainAxis:s+L,alignmentAxis:o}),c&&MF({mainAxis:!0,crossAxis:!1,limiter:m==="partial"?TF():void 0,...K}),c&&CF({...K}),AF({...K,apply:({elements:Ie,rects:$,availableWidth:Ce,availableHeight:ke})=>{const{width:Ge,height:Ae}=$.reference,rt=Ie.floating.style;rt.setProperty("--radix-popper-available-width",`${Ce}px`),rt.setProperty("--radix-popper-available-height",`${ke}px`),rt.setProperty("--radix-popper-anchor-width",`${Ge}px`),rt.setProperty("--radix-popper-anchor-height",`${Ae}px`)}}),A&&NF({element:A,padding:a}),FF({arrowWidth:D,arrowHeight:L}),v&&RF({strategy:"referenceHidden",...K})]}),[q,Z]=LN(ne),X=Di(_);Es(()=>{ce&&(X==null||X())},[ce,X]);const ie=(me=V.arrow)==null?void 0:me.x,be=(je=V.arrow)==null?void 0:je.y,ue=((Xe=V.arrow)==null?void 0:Xe.centerOffset)!==0,[Ee,Fe]=R.useState();return Es(()=>{S&&Fe(window.getComputedStyle(S).zIndex)},[S]),h.jsx("div",{ref:ee.setFloating,"data-radix-popper-content-wrapper":"",style:{...oe,transform:ce?oe.transform:"translate(0, -200%)",minWidth:"max-content",zIndex:Ee,"--radix-popper-transform-origin":[($e=V.transformOrigin)==null?void 0:$e.x,(dt=V.transformOrigin)==null?void 0:dt.y].join(" "),...((ht=V.hide)==null?void 0:ht.referenceHidden)&&{visibility:"hidden",pointerEvents:"none"}},dir:r.dir,children:h.jsx(DF,{scope:t,placedSide:q,onArrowChange:k,arrowX:ie,arrowY:be,shouldHideArrow:ue,children:h.jsx($t.div,{"data-side":q,"data-align":Z,...b,ref:T,style:{...b.style,animation:ce?void 0:"none"}})})})});IN.displayName=fE;var kN="PopperArrow",OF={top:"bottom",right:"left",bottom:"top",left:"right"},DN=R.forwardRef(function(e,t){const{__scopePopper:n,...s}=e,i=LF(kN,n),o=OF[i.placedSide];return h.jsx("span",{ref:i.onArrowChange,style:{position:"absolute",left:i.arrowX,top:i.arrowY,[o]:0,transformOrigin:{top:"",right:"0 0",bottom:"center 0",left:"100% 0"}[i.placedSide],transform:{top:"translateY(100%)",right:"translateY(50%) rotate(90deg) translateX(-50%)",bottom:"rotate(180deg)",left:"translateY(50%) rotate(-90deg) translateX(50%)"}[i.placedSide],visibility:i.shouldHideArrow?"hidden":void 0},children:h.jsx(IF,{...s,ref:t,style:{...s.style,display:"block"}})})});DN.displayName=kN;function jF(r){return r!==null}var FF=r=>({name:"transformOrigin",options:r,fn(e){var w,S,C;const{placement:t,rects:n,middlewareData:s}=e,o=((w=s.arrow)==null?void 0:w.centerOffset)!==0,a=o?0:r.arrowWidth,c=o?0:r.arrowHeight,[d,f]=LN(t),m={start:"0%",center:"50%",end:"100%"}[f],v=(((S=s.arrow)==null?void 0:S.x)??0)+a/2,x=(((C=s.arrow)==null?void 0:C.y)??0)+c/2;let _="",b="";return d==="bottom"?(_=o?m:`${v}px`,b=`${-c}px`):d==="top"?(_=o?m:`${v}px`,b=`${n.floating.height+c}px`):d==="right"?(_=`${-c}px`,b=o?m:`${x}px`):d==="left"&&(_=`${n.floating.width+c}px`,b=o?m:`${x}px`),{data:{x:_,y:b}}}});function LN(r){const[e,t="center"]=r.split("-");return[e,t]}var ON=RN,pE=PN,mE=IN,gE=DN,[P_,kee]=to("Tooltip",[sm]),vE=sm(),jN="TooltipProvider",UF=700,rT="tooltip.open",[BF,FN]=P_(jN),UN=r=>{const{__scopeTooltip:e,delayDuration:t=UF,skipDelayDuration:n=300,disableHoverableContent:s=!1,children:i}=r,o=R.useRef(!0),a=R.useRef(!1),c=R.useRef(0);return R.useEffect(()=>{const d=c.current;return()=>window.clearTimeout(d)},[]),h.jsx(BF,{scope:e,isOpenDelayedRef:o,delayDuration:t,onOpen:R.useCallback(()=>{window.clearTimeout(c.current),o.current=!1},[]),onClose:R.useCallback(()=>{window.clearTimeout(c.current),c.current=window.setTimeout(()=>o.current=!0,n)},[n]),isPointerInTransitRef:a,onPointerInTransitChange:R.useCallback(d=>{a.current=d},[]),disableHoverableContent:s,children:i})};UN.displayName=jN;var BN="Tooltip",[Dee,I_]=P_(BN),KS="TooltipTrigger",zF=R.forwardRef((r,e)=>{const{__scopeTooltip:t,...n}=r,s=I_(KS,t),i=FN(KS,t),o=vE(t),a=R.useRef(null),c=Cn(e,a,s.onTriggerChange),d=R.useRef(!1),f=R.useRef(!1),m=R.useCallback(()=>d.current=!1,[]);return R.useEffect(()=>()=>document.removeEventListener("pointerup",m),[m]),h.jsx(pE,{asChild:!0,...o,children:h.jsx($t.button,{"aria-describedby":s.open?s.contentId:void 0,"data-state":s.stateAttribute,...n,ref:c,onPointerMove:mt(r.onPointerMove,v=>{v.pointerType!=="touch"&&!f.current&&!i.isPointerInTransitRef.current&&(s.onTriggerEnter(),f.current=!0)}),onPointerLeave:mt(r.onPointerLeave,()=>{s.onTriggerLeave(),f.current=!1}),onPointerDown:mt(r.onPointerDown,()=>{s.open&&s.onClose(),d.current=!0,document.addEventListener("pointerup",m,{once:!0})}),onFocus:mt(r.onFocus,()=>{d.current||s.onOpen()}),onBlur:mt(r.onBlur,s.onClose),onClick:mt(r.onClick,s.onClose)})})});zF.displayName=KS;var VF="TooltipPortal",[Lee,HF]=P_(VF,{forceMount:void 0}),zp="TooltipContent",zN=R.forwardRef((r,e)=>{const t=HF(zp,r.__scopeTooltip),{forceMount:n=t.forceMount,side:s="top",...i}=r,o=I_(zp,r.__scopeTooltip);return h.jsx(wo,{present:n||o.open,children:o.disableHoverableContent?h.jsx(VN,{side:s,...i,ref:e}):h.jsx(GF,{side:s,...i,ref:e})})}),GF=R.forwardRef((r,e)=>{const t=I_(zp,r.__scopeTooltip),n=FN(zp,r.__scopeTooltip),s=R.useRef(null),i=Cn(e,s),[o,a]=R.useState(null),{trigger:c,onClose:d}=t,f=s.current,{onPointerInTransitChange:m}=n,v=R.useCallback(()=>{a(null),m(!1)},[m]),x=R.useCallback((_,b)=>{const w=_.currentTarget,S={x:_.clientX,y:_.clientY},C=YF(S,w.getBoundingClientRect()),T=KF(S,C),A=QF(b.getBoundingClientRect()),k=ZF([...T,...A]);a(k),m(!0)},[m]);return R.useEffect(()=>()=>v(),[v]),R.useEffect(()=>{if(c&&f){const _=w=>x(w,f),b=w=>x(w,c);return c.addEventListener("pointerleave",_),f.addEventListener("pointerleave",b),()=>{c.removeEventListener("pointerleave",_),f.removeEventListener("pointerleave",b)}}},[c,f,x,v]),R.useEffect(()=>{if(o){const _=b=>{const w=b.target,S={x:b.clientX,y:b.clientY},C=(c==null?void 0:c.contains(w))||(f==null?void 0:f.contains(w)),T=!JF(S,o);C?v():T&&(v(),d())};return document.addEventListener("pointermove",_),()=>document.removeEventListener("pointermove",_)}},[c,f,o,d,v]),h.jsx(VN,{...r,ref:i})}),[WF,$F]=P_(BN,{isInside:!1}),qF=iO("TooltipContent"),VN=R.forwardRef((r,e)=>{const{__scopeTooltip:t,children:n,"aria-label":s,onEscapeKeyDown:i,onPointerDownOutside:o,...a}=r,c=I_(zp,t),d=vE(t),{onClose:f}=c;return R.useEffect(()=>(document.addEventListener(rT,f),()=>document.removeEventListener(rT,f)),[f]),R.useEffect(()=>{if(c.trigger){const m=v=>{const x=v.target;x!=null&&x.contains(c.trigger)&&f()};return window.addEventListener("scroll",m,{capture:!0}),()=>window.removeEventListener("scroll",m,{capture:!0})}},[c.trigger,f]),h.jsx(Zp,{asChild:!0,disableOutsidePointerEvents:!1,onEscapeKeyDown:i,onPointerDownOutside:o,onFocusOutside:m=>m.preventDefault(),onDismiss:f,children:h.jsxs(mE,{"data-state":c.stateAttribute,...d,...a,ref:e,style:{...a.style,"--radix-tooltip-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-tooltip-content-available-width":"var(--radix-popper-available-width)","--radix-tooltip-content-available-height":"var(--radix-popper-available-height)","--radix-tooltip-trigger-width":"var(--radix-popper-anchor-width)","--radix-tooltip-trigger-height":"var(--radix-popper-anchor-height)"},children:[h.jsx(qF,{children:n}),h.jsx(WF,{scope:t,isInside:!0,children:h.jsx(CO,{id:c.contentId,role:"tooltip",children:s||n})})]})})});zN.displayName=zp;var HN="TooltipArrow",XF=R.forwardRef((r,e)=>{const{__scopeTooltip:t,...n}=r,s=vE(t);return $F(HN,t).isInside?null:h.jsx(gE,{...s,...n,ref:e})});XF.displayName=HN;function YF(r,e){const t=Math.abs(e.top-r.y),n=Math.abs(e.bottom-r.y),s=Math.abs(e.right-r.x),i=Math.abs(e.left-r.x);switch(Math.min(t,n,s,i)){case i:return"left";case s:return"right";case t:return"top";case n:return"bottom";default:throw new Error("unreachable")}}function KF(r,e,t=5){const n=[];switch(e){case"top":n.push({x:r.x-t,y:r.y+t},{x:r.x+t,y:r.y+t});break;case"bottom":n.push({x:r.x-t,y:r.y-t},{x:r.x+t,y:r.y-t});break;case"left":n.push({x:r.x+t,y:r.y-t},{x:r.x+t,y:r.y+t});break;case"right":n.push({x:r.x-t,y:r.y-t},{x:r.x-t,y:r.y+t});break}return n}function QF(r){const{top:e,right:t,bottom:n,left:s}=r;return[{x:s,y:e},{x:t,y:e},{x:t,y:n},{x:s,y:n}]}function JF(r,e){const{x:t,y:n}=r;let s=!1;for(let i=0,o=e.length-1;i<e.length;o=i++){const a=e[i],c=e[o],d=a.x,f=a.y,m=c.x,v=c.y;f>n!=v>n&&t<(m-d)*(n-f)/(v-f)+d&&(s=!s)}return s}function ZF(r){const e=r.slice();return e.sort((t,n)=>t.x<n.x?-1:t.x>n.x?1:t.y<n.y?-1:t.y>n.y?1:0),eU(e)}function eU(r){if(r.length<=1)return r.slice();const e=[];for(let n=0;n<r.length;n++){const s=r[n];for(;e.length>=2;){const i=e[e.length-1],o=e[e.length-2];if((i.x-o.x)*(s.y-o.y)>=(i.y-o.y)*(s.x-o.x))e.pop();else break}e.push(s)}e.pop();const t=[];for(let n=r.length-1;n>=0;n--){const s=r[n];for(;t.length>=2;){const i=t[t.length-1],o=t[t.length-2];if((i.x-o.x)*(s.y-o.y)>=(i.y-o.y)*(s.x-o.x))t.pop();else break}t.push(s)}return t.pop(),e.length===1&&t.length===1&&e[0].x===t[0].x&&e[0].y===t[0].y?e:e.concat(t)}var tU=UN,GN=zN;const nU=tU,rU=R.forwardRef(({className:r,sideOffset:e=4,...t},n)=>h.jsx(GN,{ref:n,sideOffset:e,className:Zt("z-50 overflow-hidden rounded-md border bg-popover px-3 py-1.5 text-sm text-popover-foreground shadow-md animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",r),...t}));rU.displayName=GN.displayName;var j0=class{constructor(){this.listeners=new Set,this.subscribe=this.subscribe.bind(this)}subscribe(r){return this.listeners.add(r),this.onSubscribe(),()=>{this.listeners.delete(r),this.onUnsubscribe()}}hasListeners(){return this.listeners.size>0}onSubscribe(){}onUnsubscribe(){}},ah=typeof window>"u"||"Deno"in globalThis;function Ri(){}function sU(r,e){return typeof r=="function"?r(e):r}function QS(r){return typeof r=="number"&&r>=0&&r!==1/0}function WN(r,e){return Math.max(r+(e||0)-Date.now(),0)}function lu(r,e){return typeof r=="function"?r(e):r}function ra(r,e){return typeof r=="function"?r(e):r}function sT(r,e){const{type:t="all",exact:n,fetchStatus:s,predicate:i,queryKey:o,stale:a}=r;if(o){if(n){if(e.queryHash!==xE(o,e.options))return!1}else if(!a0(e.queryKey,o))return!1}if(t!=="all"){const c=e.isActive();if(t==="active"&&!c||t==="inactive"&&c)return!1}return!(typeof a=="boolean"&&e.isStale()!==a||s&&s!==e.state.fetchStatus||i&&!i(e))}function iT(r,e){const{exact:t,status:n,predicate:s,mutationKey:i}=r;if(i){if(!e.options.mutationKey)return!1;if(t){if(o0(e.options.mutationKey)!==o0(i))return!1}else if(!a0(e.options.mutationKey,i))return!1}return!(n&&e.state.status!==n||s&&!s(e))}function xE(r,e){return((e==null?void 0:e.queryKeyHashFn)||o0)(r)}function o0(r){return JSON.stringify(r,(e,t)=>ZS(t)?Object.keys(t).sort().reduce((n,s)=>(n[s]=t[s],n),{}):t)}function a0(r,e){return r===e?!0:typeof r!=typeof e?!1:r&&e&&typeof r=="object"&&typeof e=="object"?Object.keys(e).every(t=>a0(r[t],e[t])):!1}function $N(r,e){if(r===e)return r;const t=oT(r)&&oT(e);if(t||ZS(r)&&ZS(e)){const n=t?r:Object.keys(r),s=n.length,i=t?e:Object.keys(e),o=i.length,a=t?[]:{},c=new Set(n);let d=0;for(let f=0;f<o;f++){const m=t?f:i[f];(!t&&c.has(m)||t)&&r[m]===void 0&&e[m]===void 0?(a[m]=void 0,d++):(a[m]=$N(r[m],e[m]),a[m]===r[m]&&r[m]!==void 0&&d++)}return s===o&&d===s?r:a}return e}function JS(r,e){if(!e||Object.keys(r).length!==Object.keys(e).length)return!1;for(const t in r)if(r[t]!==e[t])return!1;return!0}function oT(r){return Array.isArray(r)&&r.length===Object.keys(r).length}function ZS(r){if(!aT(r))return!1;const e=r.constructor;if(e===void 0)return!0;const t=e.prototype;return!(!aT(t)||!t.hasOwnProperty("isPrototypeOf")||Object.getPrototypeOf(r)!==Object.prototype)}function aT(r){return Object.prototype.toString.call(r)==="[object Object]"}function iU(r){return new Promise(e=>{setTimeout(e,r)})}function eb(r,e,t){return typeof t.structuralSharing=="function"?t.structuralSharing(r,e):t.structuralSharing!==!1?$N(r,e):e}function oU(r,e,t=0){const n=[...r,e];return t&&n.length>t?n.slice(1):n}function aU(r,e,t=0){const n=[e,...r];return t&&n.length>t?n.slice(0,-1):n}var yE=Symbol();function qN(r,e){return!r.queryFn&&(e!=null&&e.initialPromise)?()=>e.initialPromise:!r.queryFn||r.queryFn===yE?()=>Promise.reject(new Error(`Missing queryFn: '${r.queryHash}'`)):r.queryFn}function lU(r,e){return typeof r=="function"?r(...e):!!r}var Bd,Jc,Ap,gR,cU=(gR=class extends j0{constructor(){super();en(this,Bd);en(this,Jc);en(this,Ap);At(this,Ap,e=>{if(!ah&&window.addEventListener){const t=()=>e();return window.addEventListener("visibilitychange",t,!1),()=>{window.removeEventListener("visibilitychange",t)}}})}onSubscribe(){fe(this,Jc)||this.setEventListener(fe(this,Ap))}onUnsubscribe(){var e;this.hasListeners()||((e=fe(this,Jc))==null||e.call(this),At(this,Jc,void 0))}setEventListener(e){var t;At(this,Ap,e),(t=fe(this,Jc))==null||t.call(this),At(this,Jc,e(n=>{typeof n=="boolean"?this.setFocused(n):this.onFocus()}))}setFocused(e){fe(this,Bd)!==e&&(At(this,Bd,e),this.onFocus())}onFocus(){const e=this.isFocused();this.listeners.forEach(t=>{t(e)})}isFocused(){var e;return typeof fe(this,Bd)=="boolean"?fe(this,Bd):((e=globalThis.document)==null?void 0:e.visibilityState)!=="hidden"}},Bd=new WeakMap,Jc=new WeakMap,Ap=new WeakMap,gR),_E=new cU,Rp,Zc,Np,vR,uU=(vR=class extends j0{constructor(){super();en(this,Rp,!0);en(this,Zc);en(this,Np);At(this,Np,e=>{if(!ah&&window.addEventListener){const t=()=>e(!0),n=()=>e(!1);return window.addEventListener("online",t,!1),window.addEventListener("offline",n,!1),()=>{window.removeEventListener("online",t),window.removeEventListener("offline",n)}}})}onSubscribe(){fe(this,Zc)||this.setEventListener(fe(this,Np))}onUnsubscribe(){var e;this.hasListeners()||((e=fe(this,Zc))==null||e.call(this),At(this,Zc,void 0))}setEventListener(e){var t;At(this,Np,e),(t=fe(this,Zc))==null||t.call(this),At(this,Zc,e(this.setOnline.bind(this)))}setOnline(e){fe(this,Rp)!==e&&(At(this,Rp,e),this.listeners.forEach(n=>{n(e)}))}isOnline(){return fe(this,Rp)}},Rp=new WeakMap,Zc=new WeakMap,Np=new WeakMap,vR),by=new uU;function tb(){let r,e;const t=new Promise((s,i)=>{r=s,e=i});t.status="pending",t.catch(()=>{});function n(s){Object.assign(t,s),delete t.resolve,delete t.reject}return t.resolve=s=>{n({status:"fulfilled",value:s}),r(s)},t.reject=s=>{n({status:"rejected",reason:s}),e(s)},t}function dU(r){return Math.min(1e3*2**r,3e4)}function XN(r){return(r??"online")==="online"?by.isOnline():!0}var YN=class extends Error{constructor(r){super("CancelledError"),this.revert=r==null?void 0:r.revert,this.silent=r==null?void 0:r.silent}};function x1(r){return r instanceof YN}function KN(r){let e=!1,t=0,n=!1,s;const i=tb(),o=b=>{var w;n||(v(new YN(b)),(w=r.abort)==null||w.call(r))},a=()=>{e=!0},c=()=>{e=!1},d=()=>_E.isFocused()&&(r.networkMode==="always"||by.isOnline())&&r.canRun(),f=()=>XN(r.networkMode)&&r.canRun(),m=b=>{var w;n||(n=!0,(w=r.onSuccess)==null||w.call(r,b),s==null||s(),i.resolve(b))},v=b=>{var w;n||(n=!0,(w=r.onError)==null||w.call(r,b),s==null||s(),i.reject(b))},x=()=>new Promise(b=>{var w;s=S=>{(n||d())&&b(S)},(w=r.onPause)==null||w.call(r)}).then(()=>{var b;s=void 0,n||(b=r.onContinue)==null||b.call(r)}),_=()=>{if(n)return;let b;const w=t===0?r.initialPromise:void 0;try{b=w??r.fn()}catch(S){b=Promise.reject(S)}Promise.resolve(b).then(m).catch(S=>{var j;if(n)return;const C=r.retry??(ah?0:3),T=r.retryDelay??dU,A=typeof T=="function"?T(t,S):T,k=C===!0||typeof C=="number"&&t<C||typeof C=="function"&&C(t,S);if(e||!k){v(S);return}t++,(j=r.onFail)==null||j.call(r,t,S),iU(A).then(()=>d()?void 0:x()).then(()=>{e?v(S):_()})})};return{promise:i,cancel:o,continue:()=>(s==null||s(),i),cancelRetry:a,continueRetry:c,canStart:f,start:()=>(f()?_():x().then(_),i)}}var hU=r=>setTimeout(r,0);function fU(){let r=[],e=0,t=a=>{a()},n=a=>{a()},s=hU;const i=a=>{e?r.push(a):s(()=>{t(a)})},o=()=>{const a=r;r=[],a.length&&s(()=>{n(()=>{a.forEach(c=>{t(c)})})})};return{batch:a=>{let c;e++;try{c=a()}finally{e--,e||o()}return c},batchCalls:a=>(...c)=>{i(()=>{a(...c)})},schedule:i,setNotifyFunction:a=>{t=a},setBatchNotifyFunction:a=>{n=a},setScheduler:a=>{s=a}}}var ys=fU(),zd,xR,QN=(xR=class{constructor(){en(this,zd)}destroy(){this.clearGcTimeout()}scheduleGc(){this.clearGcTimeout(),QS(this.gcTime)&&At(this,zd,setTimeout(()=>{this.optionalRemove()},this.gcTime))}updateGcTime(r){this.gcTime=Math.max(this.gcTime||0,r??(ah?1/0:5*60*1e3))}clearGcTimeout(){fe(this,zd)&&(clearTimeout(fe(this,zd)),At(this,zd,void 0))}},zd=new WeakMap,xR),Pp,Vd,go,Hd,Us,N0,Gd,ea,Ol,yR,pU=(yR=class extends QN{constructor(e){super();en(this,ea);en(this,Pp);en(this,Vd);en(this,go);en(this,Hd);en(this,Us);en(this,N0);en(this,Gd);At(this,Gd,!1),At(this,N0,e.defaultOptions),this.setOptions(e.options),this.observers=[],At(this,Hd,e.client),At(this,go,fe(this,Hd).getQueryCache()),this.queryKey=e.queryKey,this.queryHash=e.queryHash,At(this,Pp,mU(this.options)),this.state=e.state??fe(this,Pp),this.scheduleGc()}get meta(){return this.options.meta}get promise(){var e;return(e=fe(this,Us))==null?void 0:e.promise}setOptions(e){this.options={...fe(this,N0),...e},this.updateGcTime(this.options.gcTime)}optionalRemove(){!this.observers.length&&this.state.fetchStatus==="idle"&&fe(this,go).remove(this)}setData(e,t){const n=eb(this.state.data,e,this.options);return Nn(this,ea,Ol).call(this,{data:n,type:"success",dataUpdatedAt:t==null?void 0:t.updatedAt,manual:t==null?void 0:t.manual}),n}setState(e,t){Nn(this,ea,Ol).call(this,{type:"setState",state:e,setStateOptions:t})}cancel(e){var n,s;const t=(n=fe(this,Us))==null?void 0:n.promise;return(s=fe(this,Us))==null||s.cancel(e),t?t.then(Ri).catch(Ri):Promise.resolve()}destroy(){super.destroy(),this.cancel({silent:!0})}reset(){this.destroy(),this.setState(fe(this,Pp))}isActive(){return this.observers.some(e=>ra(e.options.enabled,this)!==!1)}isDisabled(){return this.getObserversCount()>0?!this.isActive():this.options.queryFn===yE||this.state.dataUpdateCount+this.state.errorUpdateCount===0}isStatic(){return this.getObserversCount()>0?this.observers.some(e=>lu(e.options.staleTime,this)==="static"):!1}isStale(){return this.getObserversCount()>0?this.observers.some(e=>e.getCurrentResult().isStale):this.state.data===void 0||this.state.isInvalidated}isStaleByTime(e=0){return this.state.data===void 0?!0:e==="static"?!1:this.state.isInvalidated?!0:!WN(this.state.dataUpdatedAt,e)}onFocus(){var t;const e=this.observers.find(n=>n.shouldFetchOnWindowFocus());e==null||e.refetch({cancelRefetch:!1}),(t=fe(this,Us))==null||t.continue()}onOnline(){var t;const e=this.observers.find(n=>n.shouldFetchOnReconnect());e==null||e.refetch({cancelRefetch:!1}),(t=fe(this,Us))==null||t.continue()}addObserver(e){this.observers.includes(e)||(this.observers.push(e),this.clearGcTimeout(),fe(this,go).notify({type:"observerAdded",query:this,observer:e}))}removeObserver(e){this.observers.includes(e)&&(this.observers=this.observers.filter(t=>t!==e),this.observers.length||(fe(this,Us)&&(fe(this,Gd)?fe(this,Us).cancel({revert:!0}):fe(this,Us).cancelRetry()),this.scheduleGc()),fe(this,go).notify({type:"observerRemoved",query:this,observer:e}))}getObserversCount(){return this.observers.length}invalidate(){this.state.isInvalidated||Nn(this,ea,Ol).call(this,{type:"invalidate"})}fetch(e,t){var d,f,m;if(this.state.fetchStatus!=="idle"){if(this.state.data!==void 0&&(t!=null&&t.cancelRefetch))this.cancel({silent:!0});else if(fe(this,Us))return fe(this,Us).continueRetry(),fe(this,Us).promise}if(e&&this.setOptions(e),!this.options.queryFn){const v=this.observers.find(x=>x.options.queryFn);v&&this.setOptions(v.options)}const n=new AbortController,s=v=>{Object.defineProperty(v,"signal",{enumerable:!0,get:()=>(At(this,Gd,!0),n.signal)})},i=()=>{const v=qN(this.options,t),_=(()=>{const b={client:fe(this,Hd),queryKey:this.queryKey,meta:this.meta};return s(b),b})();return At(this,Gd,!1),this.options.persister?this.options.persister(v,_,this):v(_)},a=(()=>{const v={fetchOptions:t,options:this.options,queryKey:this.queryKey,client:fe(this,Hd),state:this.state,fetchFn:i};return s(v),v})();(d=this.options.behavior)==null||d.onFetch(a,this),At(this,Vd,this.state),(this.state.fetchStatus==="idle"||this.state.fetchMeta!==((f=a.fetchOptions)==null?void 0:f.meta))&&Nn(this,ea,Ol).call(this,{type:"fetch",meta:(m=a.fetchOptions)==null?void 0:m.meta});const c=v=>{var x,_,b,w;x1(v)&&v.silent||Nn(this,ea,Ol).call(this,{type:"error",error:v}),x1(v)||((_=(x=fe(this,go).config).onError)==null||_.call(x,v,this),(w=(b=fe(this,go).config).onSettled)==null||w.call(b,this.state.data,v,this)),this.scheduleGc()};return At(this,Us,KN({initialPromise:t==null?void 0:t.initialPromise,fn:a.fetchFn,abort:n.abort.bind(n),onSuccess:v=>{var x,_,b,w;if(v===void 0){c(new Error(`${this.queryHash} data is undefined`));return}try{this.setData(v)}catch(S){c(S);return}(_=(x=fe(this,go).config).onSuccess)==null||_.call(x,v,this),(w=(b=fe(this,go).config).onSettled)==null||w.call(b,v,this.state.error,this),this.scheduleGc()},onError:c,onFail:(v,x)=>{Nn(this,ea,Ol).call(this,{type:"failed",failureCount:v,error:x})},onPause:()=>{Nn(this,ea,Ol).call(this,{type:"pause"})},onContinue:()=>{Nn(this,ea,Ol).call(this,{type:"continue"})},retry:a.options.retry,retryDelay:a.options.retryDelay,networkMode:a.options.networkMode,canRun:()=>!0})),fe(this,Us).start()}},Pp=new WeakMap,Vd=new WeakMap,go=new WeakMap,Hd=new WeakMap,Us=new WeakMap,N0=new WeakMap,Gd=new WeakMap,ea=new WeakSet,Ol=function(e){const t=n=>{switch(e.type){case"failed":return{...n,fetchFailureCount:e.failureCount,fetchFailureReason:e.error};case"pause":return{...n,fetchStatus:"paused"};case"continue":return{...n,fetchStatus:"fetching"};case"fetch":return{...n,...JN(n.data,this.options),fetchMeta:e.meta??null};case"success":return At(this,Vd,void 0),{...n,data:e.data,dataUpdateCount:n.dataUpdateCount+1,dataUpdatedAt:e.dataUpdatedAt??Date.now(),error:null,isInvalidated:!1,status:"success",...!e.manual&&{fetchStatus:"idle",fetchFailureCount:0,fetchFailureReason:null}};case"error":const s=e.error;return x1(s)&&s.revert&&fe(this,Vd)?{...fe(this,Vd),fetchStatus:"idle"}:{...n,error:s,errorUpdateCount:n.errorUpdateCount+1,errorUpdatedAt:Date.now(),fetchFailureCount:n.fetchFailureCount+1,fetchFailureReason:s,fetchStatus:"idle",status:"error"};case"invalidate":return{...n,isInvalidated:!0};case"setState":return{...n,...e.state}}};this.state=t(this.state),ys.batch(()=>{this.observers.forEach(n=>{n.onQueryUpdate()}),fe(this,go).notify({query:this,type:"updated",action:e})})},yR);function JN(r,e){return{fetchFailureCount:0,fetchFailureReason:null,fetchStatus:XN(e.networkMode)?"fetching":"paused",...r===void 0&&{error:null,status:"pending"}}}function mU(r){const e=typeof r.initialData=="function"?r.initialData():r.initialData,t=e!==void 0,n=t?typeof r.initialDataUpdatedAt=="function"?r.initialDataUpdatedAt():r.initialDataUpdatedAt:0;return{data:e,dataUpdateCount:0,dataUpdatedAt:t?n??Date.now():0,error:null,errorUpdateCount:0,errorUpdatedAt:0,fetchFailureCount:0,fetchFailureReason:null,fetchMeta:null,isInvalidated:!1,status:t?"success":"pending",fetchStatus:"idle"}}var Aa,_R,gU=(_R=class extends j0{constructor(e={}){super();en(this,Aa);this.config=e,At(this,Aa,new Map)}build(e,t,n){const s=t.queryKey,i=t.queryHash??xE(s,t);let o=this.get(i);return o||(o=new pU({client:e,queryKey:s,queryHash:i,options:e.defaultQueryOptions(t),state:n,defaultOptions:e.getQueryDefaults(s)}),this.add(o)),o}add(e){fe(this,Aa).has(e.queryHash)||(fe(this,Aa).set(e.queryHash,e),this.notify({type:"added",query:e}))}remove(e){const t=fe(this,Aa).get(e.queryHash);t&&(e.destroy(),t===e&&fe(this,Aa).delete(e.queryHash),this.notify({type:"removed",query:e}))}clear(){ys.batch(()=>{this.getAll().forEach(e=>{this.remove(e)})})}get(e){return fe(this,Aa).get(e)}getAll(){return[...fe(this,Aa).values()]}find(e){const t={exact:!0,...e};return this.getAll().find(n=>sT(t,n))}findAll(e={}){const t=this.getAll();return Object.keys(e).length>0?t.filter(n=>sT(e,n)):t}notify(e){ys.batch(()=>{this.listeners.forEach(t=>{t(e)})})}onFocus(){ys.batch(()=>{this.getAll().forEach(e=>{e.onFocus()})})}onOnline(){ys.batch(()=>{this.getAll().forEach(e=>{e.onOnline()})})}},Aa=new WeakMap,_R),Ra,oi,Wd,Na,$c,wR,vU=(wR=class extends QN{constructor(e){super();en(this,Na);en(this,Ra);en(this,oi);en(this,Wd);this.mutationId=e.mutationId,At(this,oi,e.mutationCache),At(this,Ra,[]),this.state=e.state||xU(),this.setOptions(e.options),this.scheduleGc()}setOptions(e){this.options=e,this.updateGcTime(this.options.gcTime)}get meta(){return this.options.meta}addObserver(e){fe(this,Ra).includes(e)||(fe(this,Ra).push(e),this.clearGcTimeout(),fe(this,oi).notify({type:"observerAdded",mutation:this,observer:e}))}removeObserver(e){At(this,Ra,fe(this,Ra).filter(t=>t!==e)),this.scheduleGc(),fe(this,oi).notify({type:"observerRemoved",mutation:this,observer:e})}optionalRemove(){fe(this,Ra).length||(this.state.status==="pending"?this.scheduleGc():fe(this,oi).remove(this))}continue(){var e;return((e=fe(this,Wd))==null?void 0:e.continue())??this.execute(this.state.variables)}async execute(e){var i,o,a,c,d,f,m,v,x,_,b,w,S,C,T,A,k,j,D,L;const t=()=>{Nn(this,Na,$c).call(this,{type:"continue"})};At(this,Wd,KN({fn:()=>this.options.mutationFn?this.options.mutationFn(e):Promise.reject(new Error("No mutationFn found")),onFail:(O,I)=>{Nn(this,Na,$c).call(this,{type:"failed",failureCount:O,error:I})},onPause:()=>{Nn(this,Na,$c).call(this,{type:"pause"})},onContinue:t,retry:this.options.retry??0,retryDelay:this.options.retryDelay,networkMode:this.options.networkMode,canRun:()=>fe(this,oi).canRun(this)}));const n=this.state.status==="pending",s=!fe(this,Wd).canStart();try{if(n)t();else{Nn(this,Na,$c).call(this,{type:"pending",variables:e,isPaused:s}),await((o=(i=fe(this,oi).config).onMutate)==null?void 0:o.call(i,e,this));const I=await((c=(a=this.options).onMutate)==null?void 0:c.call(a,e));I!==this.state.context&&Nn(this,Na,$c).call(this,{type:"pending",context:I,variables:e,isPaused:s})}const O=await fe(this,Wd).start();return await((f=(d=fe(this,oi).config).onSuccess)==null?void 0:f.call(d,O,e,this.state.context,this)),await((v=(m=this.options).onSuccess)==null?void 0:v.call(m,O,e,this.state.context)),await((_=(x=fe(this,oi).config).onSettled)==null?void 0:_.call(x,O,null,this.state.variables,this.state.context,this)),await((w=(b=this.options).onSettled)==null?void 0:w.call(b,O,null,e,this.state.context)),Nn(this,Na,$c).call(this,{type:"success",data:O}),O}catch(O){try{throw await((C=(S=fe(this,oi).config).onError)==null?void 0:C.call(S,O,e,this.state.context,this)),await((A=(T=this.options).onError)==null?void 0:A.call(T,O,e,this.state.context)),await((j=(k=fe(this,oi).config).onSettled)==null?void 0:j.call(k,void 0,O,this.state.variables,this.state.context,this)),await((L=(D=this.options).onSettled)==null?void 0:L.call(D,void 0,O,e,this.state.context)),O}finally{Nn(this,Na,$c).call(this,{type:"error",error:O})}}finally{fe(this,oi).runNext(this)}}},Ra=new WeakMap,oi=new WeakMap,Wd=new WeakMap,Na=new WeakSet,$c=function(e){const t=n=>{switch(e.type){case"failed":return{...n,failureCount:e.failureCount,failureReason:e.error};case"pause":return{...n,isPaused:!0};case"continue":return{...n,isPaused:!1};case"pending":return{...n,context:e.context,data:void 0,failureCount:0,failureReason:null,error:null,isPaused:e.isPaused,status:"pending",variables:e.variables,submittedAt:Date.now()};case"success":return{...n,data:e.data,failureCount:0,failureReason:null,error:null,status:"success",isPaused:!1};case"error":return{...n,data:void 0,error:e.error,failureCount:n.failureCount+1,failureReason:e.error,isPaused:!1,status:"error"}}};this.state=t(this.state),ys.batch(()=>{fe(this,Ra).forEach(n=>{n.onMutationUpdate(e)}),fe(this,oi).notify({mutation:this,type:"updated",action:e})})},wR);function xU(){return{context:void 0,data:void 0,error:null,failureCount:0,failureReason:null,isPaused:!1,status:"idle",variables:void 0,submittedAt:0}}var zl,ta,P0,SR,yU=(SR=class extends j0{constructor(e={}){super();en(this,zl);en(this,ta);en(this,P0);this.config=e,At(this,zl,new Set),At(this,ta,new Map),At(this,P0,0)}build(e,t,n){const s=new vU({mutationCache:this,mutationId:++Xv(this,P0)._,options:e.defaultMutationOptions(t),state:n});return this.add(s),s}add(e){fe(this,zl).add(e);const t=ex(e);if(typeof t=="string"){const n=fe(this,ta).get(t);n?n.push(e):fe(this,ta).set(t,[e])}this.notify({type:"added",mutation:e})}remove(e){if(fe(this,zl).delete(e)){const t=ex(e);if(typeof t=="string"){const n=fe(this,ta).get(t);if(n)if(n.length>1){const s=n.indexOf(e);s!==-1&&n.splice(s,1)}else n[0]===e&&fe(this,ta).delete(t)}}this.notify({type:"removed",mutation:e})}canRun(e){const t=ex(e);if(typeof t=="string"){const n=fe(this,ta).get(t),s=n==null?void 0:n.find(i=>i.state.status==="pending");return!s||s===e}else return!0}runNext(e){var n;const t=ex(e);if(typeof t=="string"){const s=(n=fe(this,ta).get(t))==null?void 0:n.find(i=>i!==e&&i.state.isPaused);return(s==null?void 0:s.continue())??Promise.resolve()}else return Promise.resolve()}clear(){ys.batch(()=>{fe(this,zl).forEach(e=>{this.notify({type:"removed",mutation:e})}),fe(this,zl).clear(),fe(this,ta).clear()})}getAll(){return Array.from(fe(this,zl))}find(e){const t={exact:!0,...e};return this.getAll().find(n=>iT(t,n))}findAll(e={}){return this.getAll().filter(t=>iT(e,t))}notify(e){ys.batch(()=>{this.listeners.forEach(t=>{t(e)})})}resumePausedMutations(){const e=this.getAll().filter(t=>t.state.isPaused);return ys.batch(()=>Promise.all(e.map(t=>t.continue().catch(Ri))))}},zl=new WeakMap,ta=new WeakMap,P0=new WeakMap,SR);function ex(r){var e;return(e=r.options.scope)==null?void 0:e.id}function lT(r){return{onFetch:(e,t)=>{var f,m,v,x,_;const n=e.options,s=(v=(m=(f=e.fetchOptions)==null?void 0:f.meta)==null?void 0:m.fetchMore)==null?void 0:v.direction,i=((x=e.state.data)==null?void 0:x.pages)||[],o=((_=e.state.data)==null?void 0:_.pageParams)||[];let a={pages:[],pageParams:[]},c=0;const d=async()=>{let b=!1;const w=T=>{Object.defineProperty(T,"signal",{enumerable:!0,get:()=>(e.signal.aborted?b=!0:e.signal.addEventListener("abort",()=>{b=!0}),e.signal)})},S=qN(e.options,e.fetchOptions),C=async(T,A,k)=>{if(b)return Promise.reject();if(A==null&&T.pages.length)return Promise.resolve(T);const D=(()=>{const B={client:e.client,queryKey:e.queryKey,pageParam:A,direction:k?"backward":"forward",meta:e.options.meta};return w(B),B})(),L=await S(D),{maxPages:O}=e.options,I=k?aU:oU;return{pages:I(T.pages,L,O),pageParams:I(T.pageParams,A,O)}};if(s&&i.length){const T=s==="backward",A=T?_U:cT,k={pages:i,pageParams:o},j=A(n,k);a=await C(k,j,T)}else{const T=r??i.length;do{const A=c===0?o[0]??n.initialPageParam:cT(n,a);if(c>0&&A==null)break;a=await C(a,A),c++}while(c<T)}return a};e.options.persister?e.fetchFn=()=>{var b,w;return(w=(b=e.options).persister)==null?void 0:w.call(b,d,{client:e.client,queryKey:e.queryKey,meta:e.options.meta,signal:e.signal},t)}:e.fetchFn=d}}}function cT(r,{pages:e,pageParams:t}){const n=e.length-1;return e.length>0?r.getNextPageParam(e[n],e,t[n],t):void 0}function _U(r,{pages:e,pageParams:t}){var n;return e.length>0?(n=r.getPreviousPageParam)==null?void 0:n.call(r,e[0],e,t[0],t):void 0}var yr,eu,tu,Ip,kp,nu,Dp,Lp,bR,wU=(bR=class{constructor(r={}){en(this,yr);en(this,eu);en(this,tu);en(this,Ip);en(this,kp);en(this,nu);en(this,Dp);en(this,Lp);At(this,yr,r.queryCache||new gU),At(this,eu,r.mutationCache||new yU),At(this,tu,r.defaultOptions||{}),At(this,Ip,new Map),At(this,kp,new Map),At(this,nu,0)}mount(){Xv(this,nu)._++,fe(this,nu)===1&&(At(this,Dp,_E.subscribe(async r=>{r&&(await this.resumePausedMutations(),fe(this,yr).onFocus())})),At(this,Lp,by.subscribe(async r=>{r&&(await this.resumePausedMutations(),fe(this,yr).onOnline())})))}unmount(){var r,e;Xv(this,nu)._--,fe(this,nu)===0&&((r=fe(this,Dp))==null||r.call(this),At(this,Dp,void 0),(e=fe(this,Lp))==null||e.call(this),At(this,Lp,void 0))}isFetching(r){return fe(this,yr).findAll({...r,fetchStatus:"fetching"}).length}isMutating(r){return fe(this,eu).findAll({...r,status:"pending"}).length}getQueryData(r){var t;const e=this.defaultQueryOptions({queryKey:r});return(t=fe(this,yr).get(e.queryHash))==null?void 0:t.state.data}ensureQueryData(r){const e=this.defaultQueryOptions(r),t=fe(this,yr).build(this,e),n=t.state.data;return n===void 0?this.fetchQuery(r):(r.revalidateIfStale&&t.isStaleByTime(lu(e.staleTime,t))&&this.prefetchQuery(e),Promise.resolve(n))}getQueriesData(r){return fe(this,yr).findAll(r).map(({queryKey:e,state:t})=>{const n=t.data;return[e,n]})}setQueryData(r,e,t){const n=this.defaultQueryOptions({queryKey:r}),s=fe(this,yr).get(n.queryHash),i=s==null?void 0:s.state.data,o=sU(e,i);if(o!==void 0)return fe(this,yr).build(this,n).setData(o,{...t,manual:!0})}setQueriesData(r,e,t){return ys.batch(()=>fe(this,yr).findAll(r).map(({queryKey:n})=>[n,this.setQueryData(n,e,t)]))}getQueryState(r){var t;const e=this.defaultQueryOptions({queryKey:r});return(t=fe(this,yr).get(e.queryHash))==null?void 0:t.state}removeQueries(r){const e=fe(this,yr);ys.batch(()=>{e.findAll(r).forEach(t=>{e.remove(t)})})}resetQueries(r,e){const t=fe(this,yr);return ys.batch(()=>(t.findAll(r).forEach(n=>{n.reset()}),this.refetchQueries({type:"active",...r},e)))}cancelQueries(r,e={}){const t={revert:!0,...e},n=ys.batch(()=>fe(this,yr).findAll(r).map(s=>s.cancel(t)));return Promise.all(n).then(Ri).catch(Ri)}invalidateQueries(r,e={}){return ys.batch(()=>(fe(this,yr).findAll(r).forEach(t=>{t.invalidate()}),(r==null?void 0:r.refetchType)==="none"?Promise.resolve():this.refetchQueries({...r,type:(r==null?void 0:r.refetchType)??(r==null?void 0:r.type)??"active"},e)))}refetchQueries(r,e={}){const t={...e,cancelRefetch:e.cancelRefetch??!0},n=ys.batch(()=>fe(this,yr).findAll(r).filter(s=>!s.isDisabled()&&!s.isStatic()).map(s=>{let i=s.fetch(void 0,t);return t.throwOnError||(i=i.catch(Ri)),s.state.fetchStatus==="paused"?Promise.resolve():i}));return Promise.all(n).then(Ri)}fetchQuery(r){const e=this.defaultQueryOptions(r);e.retry===void 0&&(e.retry=!1);const t=fe(this,yr).build(this,e);return t.isStaleByTime(lu(e.staleTime,t))?t.fetch(e):Promise.resolve(t.state.data)}prefetchQuery(r){return this.fetchQuery(r).then(Ri).catch(Ri)}fetchInfiniteQuery(r){return r.behavior=lT(r.pages),this.fetchQuery(r)}prefetchInfiniteQuery(r){return this.fetchInfiniteQuery(r).then(Ri).catch(Ri)}ensureInfiniteQueryData(r){return r.behavior=lT(r.pages),this.ensureQueryData(r)}resumePausedMutations(){return by.isOnline()?fe(this,eu).resumePausedMutations():Promise.resolve()}getQueryCache(){return fe(this,yr)}getMutationCache(){return fe(this,eu)}getDefaultOptions(){return fe(this,tu)}setDefaultOptions(r){At(this,tu,r)}setQueryDefaults(r,e){fe(this,Ip).set(o0(r),{queryKey:r,defaultOptions:e})}getQueryDefaults(r){const e=[...fe(this,Ip).values()],t={};return e.forEach(n=>{a0(r,n.queryKey)&&Object.assign(t,n.defaultOptions)}),t}setMutationDefaults(r,e){fe(this,kp).set(o0(r),{mutationKey:r,defaultOptions:e})}getMutationDefaults(r){const e=[...fe(this,kp).values()],t={};return e.forEach(n=>{a0(r,n.mutationKey)&&Object.assign(t,n.defaultOptions)}),t}defaultQueryOptions(r){if(r._defaulted)return r;const e={...fe(this,tu).queries,...this.getQueryDefaults(r.queryKey),...r,_defaulted:!0};return e.queryHash||(e.queryHash=xE(e.queryKey,e)),e.refetchOnReconnect===void 0&&(e.refetchOnReconnect=e.networkMode!=="always"),e.throwOnError===void 0&&(e.throwOnError=!!e.suspense),!e.networkMode&&e.persister&&(e.networkMode="offlineFirst"),e.queryFn===yE&&(e.enabled=!1),e}defaultMutationOptions(r){return r!=null&&r._defaulted?r:{...fe(this,tu).mutations,...(r==null?void 0:r.mutationKey)&&this.getMutationDefaults(r.mutationKey),...r,_defaulted:!0}}clear(){fe(this,yr).clear(),fe(this,eu).clear()}},yr=new WeakMap,eu=new WeakMap,tu=new WeakMap,Ip=new WeakMap,kp=new WeakMap,nu=new WeakMap,Dp=new WeakMap,Lp=new WeakMap,bR),Ci,Pn,I0,ai,$d,Op,ru,su,k0,jp,Fp,qd,Xd,iu,Up,Hn,Pg,nb,rb,sb,ib,ob,ab,lb,ZN,ER,SU=(ER=class extends j0{constructor(e,t){super();en(this,Hn);en(this,Ci);en(this,Pn);en(this,I0);en(this,ai);en(this,$d);en(this,Op);en(this,ru);en(this,su);en(this,k0);en(this,jp);en(this,Fp);en(this,qd);en(this,Xd);en(this,iu);en(this,Up,new Set);this.options=t,At(this,Ci,e),At(this,su,null),At(this,ru,tb()),this.options.experimental_prefetchInRender||fe(this,ru).reject(new Error("experimental_prefetchInRender feature flag is not enabled")),this.bindMethods(),this.setOptions(t)}bindMethods(){this.refetch=this.refetch.bind(this)}onSubscribe(){this.listeners.size===1&&(fe(this,Pn).addObserver(this),uT(fe(this,Pn),this.options)?Nn(this,Hn,Pg).call(this):this.updateResult(),Nn(this,Hn,ib).call(this))}onUnsubscribe(){this.hasListeners()||this.destroy()}shouldFetchOnReconnect(){return cb(fe(this,Pn),this.options,this.options.refetchOnReconnect)}shouldFetchOnWindowFocus(){return cb(fe(this,Pn),this.options,this.options.refetchOnWindowFocus)}destroy(){this.listeners=new Set,Nn(this,Hn,ob).call(this),Nn(this,Hn,ab).call(this),fe(this,Pn).removeObserver(this)}setOptions(e){const t=this.options,n=fe(this,Pn);if(this.options=fe(this,Ci).defaultQueryOptions(e),this.options.enabled!==void 0&&typeof this.options.enabled!="boolean"&&typeof this.options.enabled!="function"&&typeof ra(this.options.enabled,fe(this,Pn))!="boolean")throw new Error("Expected enabled to be a boolean or a callback that returns a boolean");Nn(this,Hn,lb).call(this),fe(this,Pn).setOptions(this.options),t._defaulted&&!JS(this.options,t)&&fe(this,Ci).getQueryCache().notify({type:"observerOptionsUpdated",query:fe(this,Pn),observer:this});const s=this.hasListeners();s&&dT(fe(this,Pn),n,this.options,t)&&Nn(this,Hn,Pg).call(this),this.updateResult(),s&&(fe(this,Pn)!==n||ra(this.options.enabled,fe(this,Pn))!==ra(t.enabled,fe(this,Pn))||lu(this.options.staleTime,fe(this,Pn))!==lu(t.staleTime,fe(this,Pn)))&&Nn(this,Hn,nb).call(this);const i=Nn(this,Hn,rb).call(this);s&&(fe(this,Pn)!==n||ra(this.options.enabled,fe(this,Pn))!==ra(t.enabled,fe(this,Pn))||i!==fe(this,iu))&&Nn(this,Hn,sb).call(this,i)}getOptimisticResult(e){const t=fe(this,Ci).getQueryCache().build(fe(this,Ci),e),n=this.createResult(t,e);return EU(this,n)&&(At(this,ai,n),At(this,Op,this.options),At(this,$d,fe(this,Pn).state)),n}getCurrentResult(){return fe(this,ai)}trackResult(e,t){return new Proxy(e,{get:(n,s)=>(this.trackProp(s),t==null||t(s),Reflect.get(n,s))})}trackProp(e){fe(this,Up).add(e)}getCurrentQuery(){return fe(this,Pn)}refetch({...e}={}){return this.fetch({...e})}fetchOptimistic(e){const t=fe(this,Ci).defaultQueryOptions(e),n=fe(this,Ci).getQueryCache().build(fe(this,Ci),t);return n.fetch().then(()=>this.createResult(n,t))}fetch(e){return Nn(this,Hn,Pg).call(this,{...e,cancelRefetch:e.cancelRefetch??!0}).then(()=>(this.updateResult(),fe(this,ai)))}createResult(e,t){var O;const n=fe(this,Pn),s=this.options,i=fe(this,ai),o=fe(this,$d),a=fe(this,Op),d=e!==n?e.state:fe(this,I0),{state:f}=e;let m={...f},v=!1,x;if(t._optimisticResults){const I=this.hasListeners(),B=!I&&uT(e,t),W=I&&dT(e,n,t,s);(B||W)&&(m={...m,...JN(f.data,e.options)}),t._optimisticResults==="isRestoring"&&(m.fetchStatus="idle")}let{error:_,errorUpdatedAt:b,status:w}=m;x=m.data;let S=!1;if(t.placeholderData!==void 0&&x===void 0&&w==="pending"){let I;i!=null&&i.isPlaceholderData&&t.placeholderData===(a==null?void 0:a.placeholderData)?(I=i.data,S=!0):I=typeof t.placeholderData=="function"?t.placeholderData((O=fe(this,Fp))==null?void 0:O.state.data,fe(this,Fp)):t.placeholderData,I!==void 0&&(w="success",x=eb(i==null?void 0:i.data,I,t),v=!0)}if(t.select&&x!==void 0&&!S)if(i&&x===(o==null?void 0:o.data)&&t.select===fe(this,k0))x=fe(this,jp);else try{At(this,k0,t.select),x=t.select(x),x=eb(i==null?void 0:i.data,x,t),At(this,jp,x),At(this,su,null)}catch(I){At(this,su,I)}fe(this,su)&&(_=fe(this,su),x=fe(this,jp),b=Date.now(),w="error");const C=m.fetchStatus==="fetching",T=w==="pending",A=w==="error",k=T&&C,j=x!==void 0,L={status:w,fetchStatus:m.fetchStatus,isPending:T,isSuccess:w==="success",isError:A,isInitialLoading:k,isLoading:k,data:x,dataUpdatedAt:m.dataUpdatedAt,error:_,errorUpdatedAt:b,failureCount:m.fetchFailureCount,failureReason:m.fetchFailureReason,errorUpdateCount:m.errorUpdateCount,isFetched:m.dataUpdateCount>0||m.errorUpdateCount>0,isFetchedAfterMount:m.dataUpdateCount>d.dataUpdateCount||m.errorUpdateCount>d.errorUpdateCount,isFetching:C,isRefetching:C&&!T,isLoadingError:A&&!j,isPaused:m.fetchStatus==="paused",isPlaceholderData:v,isRefetchError:A&&j,isStale:wE(e,t),refetch:this.refetch,promise:fe(this,ru)};if(this.options.experimental_prefetchInRender){const I=K=>{L.status==="error"?K.reject(L.error):L.data!==void 0&&K.resolve(L.data)},B=()=>{const K=At(this,ru,L.promise=tb());I(K)},W=fe(this,ru);switch(W.status){case"pending":e.queryHash===n.queryHash&&I(W);break;case"fulfilled":(L.status==="error"||L.data!==W.value)&&B();break;case"rejected":(L.status!=="error"||L.error!==W.reason)&&B();break}}return L}updateResult(){const e=fe(this,ai),t=this.createResult(fe(this,Pn),this.options);if(At(this,$d,fe(this,Pn).state),At(this,Op,this.options),fe(this,$d).data!==void 0&&At(this,Fp,fe(this,Pn)),JS(t,e))return;At(this,ai,t);const n=()=>{if(!e)return!0;const{notifyOnChangeProps:s}=this.options,i=typeof s=="function"?s():s;if(i==="all"||!i&&!fe(this,Up).size)return!0;const o=new Set(i??fe(this,Up));return this.options.throwOnError&&o.add("error"),Object.keys(fe(this,ai)).some(a=>{const c=a;return fe(this,ai)[c]!==e[c]&&o.has(c)})};Nn(this,Hn,ZN).call(this,{listeners:n()})}onQueryUpdate(){this.updateResult(),this.hasListeners()&&Nn(this,Hn,ib).call(this)}},Ci=new WeakMap,Pn=new WeakMap,I0=new WeakMap,ai=new WeakMap,$d=new WeakMap,Op=new WeakMap,ru=new WeakMap,su=new WeakMap,k0=new WeakMap,jp=new WeakMap,Fp=new WeakMap,qd=new WeakMap,Xd=new WeakMap,iu=new WeakMap,Up=new WeakMap,Hn=new WeakSet,Pg=function(e){Nn(this,Hn,lb).call(this);let t=fe(this,Pn).fetch(this.options,e);return e!=null&&e.throwOnError||(t=t.catch(Ri)),t},nb=function(){Nn(this,Hn,ob).call(this);const e=lu(this.options.staleTime,fe(this,Pn));if(ah||fe(this,ai).isStale||!QS(e))return;const n=WN(fe(this,ai).dataUpdatedAt,e)+1;At(this,qd,setTimeout(()=>{fe(this,ai).isStale||this.updateResult()},n))},rb=function(){return(typeof this.options.refetchInterval=="function"?this.options.refetchInterval(fe(this,Pn)):this.options.refetchInterval)??!1},sb=function(e){Nn(this,Hn,ab).call(this),At(this,iu,e),!(ah||ra(this.options.enabled,fe(this,Pn))===!1||!QS(fe(this,iu))||fe(this,iu)===0)&&At(this,Xd,setInterval(()=>{(this.options.refetchIntervalInBackground||_E.isFocused())&&Nn(this,Hn,Pg).call(this)},fe(this,iu)))},ib=function(){Nn(this,Hn,nb).call(this),Nn(this,Hn,sb).call(this,Nn(this,Hn,rb).call(this))},ob=function(){fe(this,qd)&&(clearTimeout(fe(this,qd)),At(this,qd,void 0))},ab=function(){fe(this,Xd)&&(clearInterval(fe(this,Xd)),At(this,Xd,void 0))},lb=function(){const e=fe(this,Ci).getQueryCache().build(fe(this,Ci),this.options);if(e===fe(this,Pn))return;const t=fe(this,Pn);At(this,Pn,e),At(this,I0,e.state),this.hasListeners()&&(t==null||t.removeObserver(this),e.addObserver(this))},ZN=function(e){ys.batch(()=>{e.listeners&&this.listeners.forEach(t=>{t(fe(this,ai))}),fe(this,Ci).getQueryCache().notify({query:fe(this,Pn),type:"observerResultsUpdated"})})},ER);function bU(r,e){return ra(e.enabled,r)!==!1&&r.state.data===void 0&&!(r.state.status==="error"&&e.retryOnMount===!1)}function uT(r,e){return bU(r,e)||r.state.data!==void 0&&cb(r,e,e.refetchOnMount)}function cb(r,e,t){if(ra(e.enabled,r)!==!1&&lu(e.staleTime,r)!=="static"){const n=typeof t=="function"?t(r):t;return n==="always"||n!==!1&&wE(r,e)}return!1}function dT(r,e,t,n){return(r!==e||ra(n.enabled,r)===!1)&&(!t.suspense||r.state.status!=="error")&&wE(r,t)}function wE(r,e){return ra(e.enabled,r)!==!1&&r.isStaleByTime(lu(e.staleTime,r))}function EU(r,e){return!JS(r.getCurrentResult(),e)}var e3=R.createContext(void 0),MU=r=>{const e=R.useContext(e3);if(!e)throw new Error("No QueryClient set, use QueryClientProvider to set one");return e},TU=({client:r,children:e})=>(R.useEffect(()=>(r.mount(),()=>{r.unmount()}),[r]),h.jsx(e3.Provider,{value:r,children:e})),t3=R.createContext(!1),CU=()=>R.useContext(t3);t3.Provider;function AU(){let r=!1;return{clearReset:()=>{r=!1},reset:()=>{r=!0},isReset:()=>r}}var RU=R.createContext(AU()),NU=()=>R.useContext(RU),PU=(r,e)=>{(r.suspense||r.throwOnError||r.experimental_prefetchInRender)&&(e.isReset()||(r.retryOnMount=!1))},IU=r=>{R.useEffect(()=>{r.clearReset()},[r])},kU=({result:r,errorResetBoundary:e,throwOnError:t,query:n,suspense:s})=>r.isError&&!e.isReset()&&!r.isFetching&&n&&(s&&r.data===void 0||lU(t,[r.error,n])),DU=r=>{if(r.suspense){const e=n=>n==="static"?n:Math.max(n??1e3,1e3),t=r.staleTime;r.staleTime=typeof t=="function"?(...n)=>e(t(...n)):e(t),typeof r.gcTime=="number"&&(r.gcTime=Math.max(r.gcTime,1e3))}},LU=(r,e)=>r.isLoading&&r.isFetching&&!e,OU=(r,e)=>(r==null?void 0:r.suspense)&&e.isPending,hT=(r,e,t)=>e.fetchOptimistic(r).catch(()=>{t.clearReset()});function jU(r,e,t){var m,v,x,_,b;const n=CU(),s=NU(),i=MU(),o=i.defaultQueryOptions(r);(v=(m=i.getDefaultOptions().queries)==null?void 0:m._experimental_beforeQuery)==null||v.call(m,o),o._optimisticResults=n?"isRestoring":"optimistic",DU(o),PU(o,s),IU(s);const a=!i.getQueryCache().get(o.queryHash),[c]=R.useState(()=>new e(i,o)),d=c.getOptimisticResult(o),f=!n&&r.subscribed!==!1;if(R.useSyncExternalStore(R.useCallback(w=>{const S=f?c.subscribe(ys.batchCalls(w)):Ri;return c.updateResult(),S},[c,f]),()=>c.getCurrentResult(),()=>c.getCurrentResult()),R.useEffect(()=>{c.setOptions(o)},[o,c]),OU(o,d))throw hT(o,c,s);if(kU({result:d,errorResetBoundary:s,throwOnError:o.throwOnError,query:i.getQueryCache().get(o.queryHash),suspense:o.suspense}))throw d.error;if((_=(x=i.getDefaultOptions().queries)==null?void 0:x._experimental_afterQuery)==null||_.call(x,o,d),o.experimental_prefetchInRender&&!ah&&LU(d,n)){const w=a?hT(o,c,s):(b=i.getQueryCache().get(o.queryHash))==null?void 0:b.promise;w==null||w.catch(Ri).finally(()=>{c.updateResult()})}return o.notifyOnChangeProps?d:c.trackResult(d)}function ki(r,e){return jU(r,SU)}/**
 * @remix-run/router v1.23.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function l0(){return l0=Object.assign?Object.assign.bind():function(r){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(r[n]=t[n])}return r},l0.apply(this,arguments)}var ou;(function(r){r.Pop="POP",r.Push="PUSH",r.Replace="REPLACE"})(ou||(ou={}));const fT="popstate";function FU(r){r===void 0&&(r={});function e(n,s){let{pathname:i,search:o,hash:a}=n.location;return ub("",{pathname:i,search:o,hash:a},s.state&&s.state.usr||null,s.state&&s.state.key||"default")}function t(n,s){return typeof s=="string"?s:Ey(s)}return BU(e,t,null,r)}function Rr(r,e){if(r===!1||r===null||typeof r>"u")throw new Error(e)}function n3(r,e){if(!r){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function UU(){return Math.random().toString(36).substr(2,8)}function pT(r,e){return{usr:r.state,key:r.key,idx:e}}function ub(r,e,t,n){return t===void 0&&(t=null),l0({pathname:typeof r=="string"?r:r.pathname,search:"",hash:""},typeof e=="string"?im(e):e,{state:t,key:e&&e.key||n||UU()})}function Ey(r){let{pathname:e="/",search:t="",hash:n=""}=r;return t&&t!=="?"&&(e+=t.charAt(0)==="?"?t:"?"+t),n&&n!=="#"&&(e+=n.charAt(0)==="#"?n:"#"+n),e}function im(r){let e={};if(r){let t=r.indexOf("#");t>=0&&(e.hash=r.substr(t),r=r.substr(0,t));let n=r.indexOf("?");n>=0&&(e.search=r.substr(n),r=r.substr(0,n)),r&&(e.pathname=r)}return e}function BU(r,e,t,n){n===void 0&&(n={});let{window:s=document.defaultView,v5Compat:i=!1}=n,o=s.history,a=ou.Pop,c=null,d=f();d==null&&(d=0,o.replaceState(l0({},o.state,{idx:d}),""));function f(){return(o.state||{idx:null}).idx}function m(){a=ou.Pop;let w=f(),S=w==null?null:w-d;d=w,c&&c({action:a,location:b.location,delta:S})}function v(w,S){a=ou.Push;let C=ub(b.location,w,S);d=f()+1;let T=pT(C,d),A=b.createHref(C);try{o.pushState(T,"",A)}catch(k){if(k instanceof DOMException&&k.name==="DataCloneError")throw k;s.location.assign(A)}i&&c&&c({action:a,location:b.location,delta:1})}function x(w,S){a=ou.Replace;let C=ub(b.location,w,S);d=f();let T=pT(C,d),A=b.createHref(C);o.replaceState(T,"",A),i&&c&&c({action:a,location:b.location,delta:0})}function _(w){let S=s.location.origin!=="null"?s.location.origin:s.location.href,C=typeof w=="string"?w:Ey(w);return C=C.replace(/ $/,"%20"),Rr(S,"No window.location.(origin|href) available to create URL for href: "+C),new URL(C,S)}let b={get action(){return a},get location(){return r(s,o)},listen(w){if(c)throw new Error("A history only accepts one active listener");return s.addEventListener(fT,m),c=w,()=>{s.removeEventListener(fT,m),c=null}},createHref(w){return e(s,w)},createURL:_,encodeLocation(w){let S=_(w);return{pathname:S.pathname,search:S.search,hash:S.hash}},push:v,replace:x,go(w){return o.go(w)}};return b}var mT;(function(r){r.data="data",r.deferred="deferred",r.redirect="redirect",r.error="error"})(mT||(mT={}));function zU(r,e,t){return t===void 0&&(t="/"),VU(r,e,t)}function VU(r,e,t,n){let s=typeof e=="string"?im(e):e,i=SE(s.pathname||"/",t);if(i==null)return null;let o=r3(r);HU(o);let a=null;for(let c=0;a==null&&c<o.length;++c){let d=t6(i);a=JU(o[c],d)}return a}function r3(r,e,t,n){e===void 0&&(e=[]),t===void 0&&(t=[]),n===void 0&&(n="");let s=(i,o,a)=>{let c={relativePath:a===void 0?i.path||"":a,caseSensitive:i.caseSensitive===!0,childrenIndex:o,route:i};c.relativePath.startsWith("/")&&(Rr(c.relativePath.startsWith(n),'Absolute route path "'+c.relativePath+'" nested under path '+('"'+n+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),c.relativePath=c.relativePath.slice(n.length));let d=cu([n,c.relativePath]),f=t.concat(c);i.children&&i.children.length>0&&(Rr(i.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+d+'".')),r3(i.children,e,f,d)),!(i.path==null&&!i.index)&&e.push({path:d,score:KU(d,i.index),routesMeta:f})};return r.forEach((i,o)=>{var a;if(i.path===""||!((a=i.path)!=null&&a.includes("?")))s(i,o);else for(let c of s3(i.path))s(i,o,c)}),e}function s3(r){let e=r.split("/");if(e.length===0)return[];let[t,...n]=e,s=t.endsWith("?"),i=t.replace(/\?$/,"");if(n.length===0)return s?[i,""]:[i];let o=s3(n.join("/")),a=[];return a.push(...o.map(c=>c===""?i:[i,c].join("/"))),s&&a.push(...o),a.map(c=>r.startsWith("/")&&c===""?"/":c)}function HU(r){r.sort((e,t)=>e.score!==t.score?t.score-e.score:QU(e.routesMeta.map(n=>n.childrenIndex),t.routesMeta.map(n=>n.childrenIndex)))}const GU=/^:[\w-]+$/,WU=3,$U=2,qU=1,XU=10,YU=-2,gT=r=>r==="*";function KU(r,e){let t=r.split("/"),n=t.length;return t.some(gT)&&(n+=YU),e&&(n+=$U),t.filter(s=>!gT(s)).reduce((s,i)=>s+(GU.test(i)?WU:i===""?qU:XU),n)}function QU(r,e){return r.length===e.length&&r.slice(0,-1).every((n,s)=>n===e[s])?r[r.length-1]-e[e.length-1]:0}function JU(r,e,t){let{routesMeta:n}=r,s={},i="/",o=[];for(let a=0;a<n.length;++a){let c=n[a],d=a===n.length-1,f=i==="/"?e:e.slice(i.length)||"/",m=ZU({path:c.relativePath,caseSensitive:c.caseSensitive,end:d},f),v=c.route;if(!m)return null;Object.assign(s,m.params),o.push({params:s,pathname:cu([i,m.pathname]),pathnameBase:i6(cu([i,m.pathnameBase])),route:v}),m.pathnameBase!=="/"&&(i=cu([i,m.pathnameBase]))}return o}function ZU(r,e){typeof r=="string"&&(r={path:r,caseSensitive:!1,end:!0});let[t,n]=e6(r.path,r.caseSensitive,r.end),s=e.match(t);if(!s)return null;let i=s[0],o=i.replace(/(.)\/+$/,"$1"),a=s.slice(1);return{params:n.reduce((d,f,m)=>{let{paramName:v,isOptional:x}=f;if(v==="*"){let b=a[m]||"";o=i.slice(0,i.length-b.length).replace(/(.)\/+$/,"$1")}const _=a[m];return x&&!_?d[v]=void 0:d[v]=(_||"").replace(/%2F/g,"/"),d},{}),pathname:i,pathnameBase:o,pattern:r}}function e6(r,e,t){e===void 0&&(e=!1),t===void 0&&(t=!0),n3(r==="*"||!r.endsWith("*")||r.endsWith("/*"),'Route path "'+r+'" will be treated as if it were '+('"'+r.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+r.replace(/\*$/,"/*")+'".'));let n=[],s="^"+r.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(o,a,c)=>(n.push({paramName:a,isOptional:c!=null}),c?"/?([^\\/]+)?":"/([^\\/]+)"));return r.endsWith("*")?(n.push({paramName:"*"}),s+=r==="*"||r==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):t?s+="\\/*$":r!==""&&r!=="/"&&(s+="(?:(?=\\/|$))"),[new RegExp(s,e?void 0:"i"),n]}function t6(r){try{return r.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return n3(!1,'The URL path "'+r+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+e+").")),r}}function SE(r,e){if(e==="/")return r;if(!r.toLowerCase().startsWith(e.toLowerCase()))return null;let t=e.endsWith("/")?e.length-1:e.length,n=r.charAt(t);return n&&n!=="/"?null:r.slice(t)||"/"}function n6(r,e){e===void 0&&(e="/");let{pathname:t,search:n="",hash:s=""}=typeof r=="string"?im(r):r;return{pathname:t?t.startsWith("/")?t:r6(t,e):e,search:o6(n),hash:a6(s)}}function r6(r,e){let t=e.replace(/\/+$/,"").split("/");return r.split("/").forEach(s=>{s===".."?t.length>1&&t.pop():s!=="."&&t.push(s)}),t.length>1?t.join("/"):"/"}function y1(r,e,t,n){return"Cannot include a '"+r+"' character in a manually specified "+("`to."+e+"` field ["+JSON.stringify(n)+"].  Please separate it out to the ")+("`to."+t+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function s6(r){return r.filter((e,t)=>t===0||e.route.path&&e.route.path.length>0)}function bE(r,e){let t=s6(r);return e?t.map((n,s)=>s===t.length-1?n.pathname:n.pathnameBase):t.map(n=>n.pathnameBase)}function EE(r,e,t,n){n===void 0&&(n=!1);let s;typeof r=="string"?s=im(r):(s=l0({},r),Rr(!s.pathname||!s.pathname.includes("?"),y1("?","pathname","search",s)),Rr(!s.pathname||!s.pathname.includes("#"),y1("#","pathname","hash",s)),Rr(!s.search||!s.search.includes("#"),y1("#","search","hash",s)));let i=r===""||s.pathname==="",o=i?"/":s.pathname,a;if(o==null)a=t;else{let m=e.length-1;if(!n&&o.startsWith("..")){let v=o.split("/");for(;v[0]==="..";)v.shift(),m-=1;s.pathname=v.join("/")}a=m>=0?e[m]:"/"}let c=n6(s,a),d=o&&o!=="/"&&o.endsWith("/"),f=(i||o===".")&&t.endsWith("/");return!c.pathname.endsWith("/")&&(d||f)&&(c.pathname+="/"),c}const cu=r=>r.join("/").replace(/\/\/+/g,"/"),i6=r=>r.replace(/\/+$/,"").replace(/^\/*/,"/"),o6=r=>!r||r==="?"?"":r.startsWith("?")?r:"?"+r,a6=r=>!r||r==="#"?"":r.startsWith("#")?r:"#"+r;function l6(r){return r!=null&&typeof r.status=="number"&&typeof r.statusText=="string"&&typeof r.internal=="boolean"&&"data"in r}const i3=["post","put","patch","delete"];new Set(i3);const c6=["get",...i3];new Set(c6);/**
 * React Router v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function c0(){return c0=Object.assign?Object.assign.bind():function(r){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(r[n]=t[n])}return r},c0.apply(this,arguments)}const ME=R.createContext(null),u6=R.createContext(null),_u=R.createContext(null),k_=R.createContext(null),$a=R.createContext({outlet:null,matches:[],isDataRoute:!1}),o3=R.createContext(null);function d6(r,e){let{relative:t}=e===void 0?{}:e;om()||Rr(!1);let{basename:n,navigator:s}=R.useContext(_u),{hash:i,pathname:o,search:a}=c3(r,{relative:t}),c=o;return n!=="/"&&(c=o==="/"?n:cu([n,o])),s.createHref({pathname:c,search:a,hash:i})}function om(){return R.useContext(k_)!=null}function rc(){return om()||Rr(!1),R.useContext(k_).location}function a3(r){R.useContext(_u).static||R.useLayoutEffect(r)}function mh(){let{isDataRoute:r}=R.useContext($a);return r?T6():h6()}function h6(){om()||Rr(!1);let r=R.useContext(ME),{basename:e,future:t,navigator:n}=R.useContext(_u),{matches:s}=R.useContext($a),{pathname:i}=rc(),o=JSON.stringify(bE(s,t.v7_relativeSplatPath)),a=R.useRef(!1);return a3(()=>{a.current=!0}),R.useCallback(function(d,f){if(f===void 0&&(f={}),!a.current)return;if(typeof d=="number"){n.go(d);return}let m=EE(d,JSON.parse(o),i,f.relative==="path");r==null&&e!=="/"&&(m.pathname=m.pathname==="/"?e:cu([e,m.pathname])),(f.replace?n.replace:n.push)(m,f.state,f)},[e,n,o,i,r])}const l3=R.createContext(null);function f6(){return R.useContext(l3)}function p6(r){let e=R.useContext($a).outlet;return e&&R.createElement(l3.Provider,{value:r},e)}function gh(){let{matches:r}=R.useContext($a),e=r[r.length-1];return e?e.params:{}}function c3(r,e){let{relative:t}=e===void 0?{}:e,{future:n}=R.useContext(_u),{matches:s}=R.useContext($a),{pathname:i}=rc(),o=JSON.stringify(bE(s,n.v7_relativeSplatPath));return R.useMemo(()=>EE(r,JSON.parse(o),i,t==="path"),[r,o,i,t])}function m6(r,e){return g6(r,e)}function g6(r,e,t,n){om()||Rr(!1);let{navigator:s}=R.useContext(_u),{matches:i}=R.useContext($a),o=i[i.length-1],a=o?o.params:{};o&&o.pathname;let c=o?o.pathnameBase:"/";o&&o.route;let d=rc(),f;if(e){var m;let w=typeof e=="string"?im(e):e;c==="/"||(m=w.pathname)!=null&&m.startsWith(c)||Rr(!1),f=w}else f=d;let v=f.pathname||"/",x=v;if(c!=="/"){let w=c.replace(/^\//,"").split("/");x="/"+v.replace(/^\//,"").split("/").slice(w.length).join("/")}let _=zU(r,{pathname:x}),b=w6(_&&_.map(w=>Object.assign({},w,{params:Object.assign({},a,w.params),pathname:cu([c,s.encodeLocation?s.encodeLocation(w.pathname).pathname:w.pathname]),pathnameBase:w.pathnameBase==="/"?c:cu([c,s.encodeLocation?s.encodeLocation(w.pathnameBase).pathname:w.pathnameBase])})),i,t,n);return e&&b?R.createElement(k_.Provider,{value:{location:c0({pathname:"/",search:"",hash:"",state:null,key:"default"},f),navigationType:ou.Pop}},b):b}function v6(){let r=M6(),e=l6(r)?r.status+" "+r.statusText:r instanceof Error?r.message:JSON.stringify(r),t=r instanceof Error?r.stack:null,s={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return R.createElement(R.Fragment,null,R.createElement("h2",null,"Unexpected Application Error!"),R.createElement("h3",{style:{fontStyle:"italic"}},e),t?R.createElement("pre",{style:s},t):null,null)}const x6=R.createElement(v6,null);class y6 extends R.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,t){return t.location!==e.location||t.revalidation!=="idle"&&e.revalidation==="idle"?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error!==void 0?e.error:t.error,location:t.location,revalidation:e.revalidation||t.revalidation}}componentDidCatch(e,t){console.error("React Router caught the following error during render",e,t)}render(){return this.state.error!==void 0?R.createElement($a.Provider,{value:this.props.routeContext},R.createElement(o3.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function _6(r){let{routeContext:e,match:t,children:n}=r,s=R.useContext(ME);return s&&s.static&&s.staticContext&&(t.route.errorElement||t.route.ErrorBoundary)&&(s.staticContext._deepestRenderedBoundaryId=t.route.id),R.createElement($a.Provider,{value:e},n)}function w6(r,e,t,n){var s;if(e===void 0&&(e=[]),t===void 0&&(t=null),n===void 0&&(n=null),r==null){var i;if(!t)return null;if(t.errors)r=t.matches;else if((i=n)!=null&&i.v7_partialHydration&&e.length===0&&!t.initialized&&t.matches.length>0)r=t.matches;else return null}let o=r,a=(s=t)==null?void 0:s.errors;if(a!=null){let f=o.findIndex(m=>m.route.id&&(a==null?void 0:a[m.route.id])!==void 0);f>=0||Rr(!1),o=o.slice(0,Math.min(o.length,f+1))}let c=!1,d=-1;if(t&&n&&n.v7_partialHydration)for(let f=0;f<o.length;f++){let m=o[f];if((m.route.HydrateFallback||m.route.hydrateFallbackElement)&&(d=f),m.route.id){let{loaderData:v,errors:x}=t,_=m.route.loader&&v[m.route.id]===void 0&&(!x||x[m.route.id]===void 0);if(m.route.lazy||_){c=!0,d>=0?o=o.slice(0,d+1):o=[o[0]];break}}}return o.reduceRight((f,m,v)=>{let x,_=!1,b=null,w=null;t&&(x=a&&m.route.id?a[m.route.id]:void 0,b=m.route.errorElement||x6,c&&(d<0&&v===0?(C6("route-fallback"),_=!0,w=null):d===v&&(_=!0,w=m.route.hydrateFallbackElement||null)));let S=e.concat(o.slice(0,v+1)),C=()=>{let T;return x?T=b:_?T=w:m.route.Component?T=R.createElement(m.route.Component,null):m.route.element?T=m.route.element:T=f,R.createElement(_6,{match:m,routeContext:{outlet:f,matches:S,isDataRoute:t!=null},children:T})};return t&&(m.route.ErrorBoundary||m.route.errorElement||v===0)?R.createElement(y6,{location:t.location,revalidation:t.revalidation,component:b,error:x,children:C(),routeContext:{outlet:null,matches:S,isDataRoute:!0}}):C()},null)}var u3=function(r){return r.UseBlocker="useBlocker",r.UseRevalidator="useRevalidator",r.UseNavigateStable="useNavigate",r}(u3||{}),d3=function(r){return r.UseBlocker="useBlocker",r.UseLoaderData="useLoaderData",r.UseActionData="useActionData",r.UseRouteError="useRouteError",r.UseNavigation="useNavigation",r.UseRouteLoaderData="useRouteLoaderData",r.UseMatches="useMatches",r.UseRevalidator="useRevalidator",r.UseNavigateStable="useNavigate",r.UseRouteId="useRouteId",r}(d3||{});function S6(r){let e=R.useContext(ME);return e||Rr(!1),e}function b6(r){let e=R.useContext(u6);return e||Rr(!1),e}function E6(r){let e=R.useContext($a);return e||Rr(!1),e}function h3(r){let e=E6(),t=e.matches[e.matches.length-1];return t.route.id||Rr(!1),t.route.id}function M6(){var r;let e=R.useContext(o3),t=b6(),n=h3();return e!==void 0?e:(r=t.errors)==null?void 0:r[n]}function T6(){let{router:r}=S6(u3.UseNavigateStable),e=h3(d3.UseNavigateStable),t=R.useRef(!1);return a3(()=>{t.current=!0}),R.useCallback(function(s,i){i===void 0&&(i={}),t.current&&(typeof s=="number"?r.navigate(s):r.navigate(s,c0({fromRouteId:e},i)))},[r,e])}const vT={};function C6(r,e,t){vT[r]||(vT[r]=!0)}function A6(r,e){r==null||r.v7_startTransition,r==null||r.v7_relativeSplatPath}function TE(r){let{to:e,replace:t,state:n,relative:s}=r;om()||Rr(!1);let{future:i,static:o}=R.useContext(_u),{matches:a}=R.useContext($a),{pathname:c}=rc(),d=mh(),f=EE(e,bE(a,i.v7_relativeSplatPath),c,s==="path"),m=JSON.stringify(f);return R.useEffect(()=>d(JSON.parse(m),{replace:t,state:n,relative:s}),[d,m,s,t,n]),null}function R6(r){return p6(r.context)}function xs(r){Rr(!1)}function N6(r){let{basename:e="/",children:t=null,location:n,navigationType:s=ou.Pop,navigator:i,static:o=!1,future:a}=r;om()&&Rr(!1);let c=e.replace(/^\/*/,"/"),d=R.useMemo(()=>({basename:c,navigator:i,static:o,future:c0({v7_relativeSplatPath:!1},a)}),[c,a,i,o]);typeof n=="string"&&(n=im(n));let{pathname:f="/",search:m="",hash:v="",state:x=null,key:_="default"}=n,b=R.useMemo(()=>{let w=SE(f,c);return w==null?null:{location:{pathname:w,search:m,hash:v,state:x,key:_},navigationType:s}},[c,f,m,v,x,_,s]);return b==null?null:R.createElement(_u.Provider,{value:d},R.createElement(k_.Provider,{children:t,value:b}))}function P6(r){let{children:e,location:t}=r;return m6(db(e),t)}new Promise(()=>{});function db(r,e){e===void 0&&(e=[]);let t=[];return R.Children.forEach(r,(n,s)=>{if(!R.isValidElement(n))return;let i=[...e,s];if(n.type===R.Fragment){t.push.apply(t,db(n.props.children,i));return}n.type!==xs&&Rr(!1),!n.props.index||!n.props.children||Rr(!1);let o={id:n.props.id||i.join("-"),caseSensitive:n.props.caseSensitive,element:n.props.element,Component:n.props.Component,index:n.props.index,path:n.props.path,loader:n.props.loader,action:n.props.action,errorElement:n.props.errorElement,ErrorBoundary:n.props.ErrorBoundary,hasErrorBoundary:n.props.ErrorBoundary!=null||n.props.errorElement!=null,shouldRevalidate:n.props.shouldRevalidate,handle:n.props.handle,lazy:n.props.lazy};n.props.children&&(o.children=db(n.props.children,i)),t.push(o)}),t}/**
 * React Router DOM v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function hb(){return hb=Object.assign?Object.assign.bind():function(r){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(r[n]=t[n])}return r},hb.apply(this,arguments)}function I6(r,e){if(r==null)return{};var t={},n=Object.keys(r),s,i;for(i=0;i<n.length;i++)s=n[i],!(e.indexOf(s)>=0)&&(t[s]=r[s]);return t}function k6(r){return!!(r.metaKey||r.altKey||r.ctrlKey||r.shiftKey)}function D6(r,e){return r.button===0&&(!e||e==="_self")&&!k6(r)}const L6=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"],O6="6";try{window.__reactRouterVersion=O6}catch{}const j6="startTransition",xT=Qb[j6];function F6(r){let{basename:e,children:t,future:n,window:s}=r,i=R.useRef();i.current==null&&(i.current=FU({window:s,v5Compat:!0}));let o=i.current,[a,c]=R.useState({action:o.action,location:o.location}),{v7_startTransition:d}=n||{},f=R.useCallback(m=>{d&&xT?xT(()=>c(m)):c(m)},[c,d]);return R.useLayoutEffect(()=>o.listen(f),[o,f]),R.useEffect(()=>A6(n),[n]),R.createElement(N6,{basename:e,children:t,location:a.location,navigationType:a.action,navigator:o,future:n})}const U6=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",B6=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,qa=R.forwardRef(function(e,t){let{onClick:n,relative:s,reloadDocument:i,replace:o,state:a,target:c,to:d,preventScrollReset:f,viewTransition:m}=e,v=I6(e,L6),{basename:x}=R.useContext(_u),_,b=!1;if(typeof d=="string"&&B6.test(d)&&(_=d,U6))try{let T=new URL(window.location.href),A=d.startsWith("//")?new URL(T.protocol+d):new URL(d),k=SE(A.pathname,x);A.origin===T.origin&&k!=null?d=k+A.search+A.hash:b=!0}catch{}let w=d6(d,{relative:s}),S=z6(d,{replace:o,state:a,target:c,preventScrollReset:f,relative:s,viewTransition:m});function C(T){n&&n(T),T.defaultPrevented||S(T)}return R.createElement("a",hb({},v,{href:_||w,onClick:b||i?n:C,ref:t,target:c}))});var yT;(function(r){r.UseScrollRestoration="useScrollRestoration",r.UseSubmit="useSubmit",r.UseSubmitFetcher="useSubmitFetcher",r.UseFetcher="useFetcher",r.useViewTransitionState="useViewTransitionState"})(yT||(yT={}));var _T;(function(r){r.UseFetcher="useFetcher",r.UseFetchers="useFetchers",r.UseScrollRestoration="useScrollRestoration"})(_T||(_T={}));function z6(r,e){let{target:t,replace:n,state:s,preventScrollReset:i,relative:o,viewTransition:a}=e===void 0?{}:e,c=mh(),d=rc(),f=c3(r,{relative:o});return R.useCallback(m=>{if(D6(m,t)){m.preventDefault();let v=n!==void 0?n:Ey(d)===Ey(f);c(r,{replace:v,state:s,preventScrollReset:i,relative:o,viewTransition:a})}},[d,c,f,n,s,t,r,i,o,a])}const Wt=R.forwardRef(({className:r,...e},t)=>h.jsx("div",{ref:t,className:Zt("rounded-lg border bg-card text-card-foreground shadow-sm",r),...e}));Wt.displayName="Card";const or=R.forwardRef(({className:r,...e},t)=>h.jsx("div",{ref:t,className:Zt("flex flex-col space-y-1.5 p-6",r),...e}));or.displayName="CardHeader";const ws=R.forwardRef(({className:r,...e},t)=>h.jsx("h3",{ref:t,className:Zt("text-2xl font-semibold leading-none tracking-tight",r),...e}));ws.displayName="CardTitle";const CE=R.forwardRef(({className:r,...e},t)=>h.jsx("p",{ref:t,className:Zt("text-sm text-muted-foreground",r),...e}));CE.displayName="CardDescription";const nn=R.forwardRef(({className:r,...e},t)=>h.jsx("div",{ref:t,className:Zt("p-6 pt-0",r),...e}));nn.displayName="CardContent";const V6=R.forwardRef(({className:r,...e},t)=>h.jsx("div",{ref:t,className:Zt("flex items-center p-6 pt-0",r),...e}));V6.displayName="CardFooter";const H6="modulepreload",G6=function(r){return"/"+r},wT={},F0=function(e,t,n){let s=Promise.resolve();if(t&&t.length>0){let o=function(d){return Promise.all(d.map(f=>Promise.resolve(f).then(m=>({status:"fulfilled",value:m}),m=>({status:"rejected",reason:m}))))};document.getElementsByTagName("link");const a=document.querySelector("meta[property=csp-nonce]"),c=(a==null?void 0:a.nonce)||(a==null?void 0:a.getAttribute("nonce"));s=o(t.map(d=>{if(d=G6(d),d in wT)return;wT[d]=!0;const f=d.endsWith(".css"),m=f?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${d}"]${m}`))return;const v=document.createElement("link");if(v.rel=f?"stylesheet":H6,f||(v.as="script"),v.crossOrigin="",v.href=d,c&&v.setAttribute("nonce",c),document.head.appendChild(v),f)return new Promise((x,_)=>{v.addEventListener("load",x),v.addEventListener("error",()=>_(new Error(`Unable to preload CSS for ${d}`)))})}))}function i(o){const a=new Event("vite:preloadError",{cancelable:!0});if(a.payload=o,window.dispatchEvent(a),!a.defaultPrevented)throw o}return s.then(o=>{for(const a of o||[])a.status==="rejected"&&i(a.reason);return e().catch(i)})},W6=r=>{let e;return r?e=r:typeof fetch>"u"?e=(...t)=>F0(async()=>{const{default:n}=await Promise.resolve().then(()=>am);return{default:n}},void 0).then(({default:n})=>n(...t)):e=fetch,(...t)=>e(...t)};class AE extends Error{constructor(e,t="FunctionsError",n){super(e),this.name=t,this.context=n}}class $6 extends AE{constructor(e){super("Failed to send a request to the Edge Function","FunctionsFetchError",e)}}class q6 extends AE{constructor(e){super("Relay Error invoking the Edge Function","FunctionsRelayError",e)}}class X6 extends AE{constructor(e){super("Edge Function returned a non-2xx status code","FunctionsHttpError",e)}}var fb;(function(r){r.Any="any",r.ApNortheast1="ap-northeast-1",r.ApNortheast2="ap-northeast-2",r.ApSouth1="ap-south-1",r.ApSoutheast1="ap-southeast-1",r.ApSoutheast2="ap-southeast-2",r.CaCentral1="ca-central-1",r.EuCentral1="eu-central-1",r.EuWest1="eu-west-1",r.EuWest2="eu-west-2",r.EuWest3="eu-west-3",r.SaEast1="sa-east-1",r.UsEast1="us-east-1",r.UsWest1="us-west-1",r.UsWest2="us-west-2"})(fb||(fb={}));var Y6=function(r,e,t,n){function s(i){return i instanceof t?i:new t(function(o){o(i)})}return new(t||(t=Promise))(function(i,o){function a(f){try{d(n.next(f))}catch(m){o(m)}}function c(f){try{d(n.throw(f))}catch(m){o(m)}}function d(f){f.done?i(f.value):s(f.value).then(a,c)}d((n=n.apply(r,e||[])).next())})};class K6{constructor(e,{headers:t={},customFetch:n,region:s=fb.Any}={}){this.url=e,this.headers=t,this.region=s,this.fetch=W6(n)}setAuth(e){this.headers.Authorization=`Bearer ${e}`}invoke(e,t={}){var n;return Y6(this,void 0,void 0,function*(){try{const{headers:s,method:i,body:o}=t;let a={},{region:c}=t;c||(c=this.region),c&&c!=="any"&&(a["x-region"]=c);let d;o&&(s&&!Object.prototype.hasOwnProperty.call(s,"Content-Type")||!s)&&(typeof Blob<"u"&&o instanceof Blob||o instanceof ArrayBuffer?(a["Content-Type"]="application/octet-stream",d=o):typeof o=="string"?(a["Content-Type"]="text/plain",d=o):typeof FormData<"u"&&o instanceof FormData?d=o:(a["Content-Type"]="application/json",d=JSON.stringify(o)));const f=yield this.fetch(`${this.url}/${e}`,{method:i||"POST",headers:Object.assign(Object.assign(Object.assign({},a),this.headers),s),body:d}).catch(_=>{throw new $6(_)}),m=f.headers.get("x-relay-error");if(m&&m==="true")throw new q6(f);if(!f.ok)throw new X6(f);let v=((n=f.headers.get("Content-Type"))!==null&&n!==void 0?n:"text/plain").split(";")[0].trim(),x;return v==="application/json"?x=yield f.json():v==="application/octet-stream"?x=yield f.blob():v==="text/event-stream"?x=f:v==="multipart/form-data"?x=yield f.formData():x=yield f.text(),{data:x,error:null}}catch(s){return{data:null,error:s}}})}}var os={},Pf={},If={},kf={},Df={},Lf={},Q6=function(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("unable to locate global object")},Vp=Q6();const J6=Vp.fetch,f3=Vp.fetch.bind(Vp),p3=Vp.Headers,Z6=Vp.Request,eB=Vp.Response,am=Object.freeze(Object.defineProperty({__proto__:null,Headers:p3,Request:Z6,Response:eB,default:f3,fetch:J6},Symbol.toStringTag,{value:"Module"})),tB=BL(am);var tx={},ST;function m3(){if(ST)return tx;ST=1,Object.defineProperty(tx,"__esModule",{value:!0});class r extends Error{constructor(t){super(t.message),this.name="PostgrestError",this.details=t.details,this.hint=t.hint,this.code=t.code}}return tx.default=r,tx}var bT;function g3(){if(bT)return Lf;bT=1;var r=Lf&&Lf.__importDefault||function(s){return s&&s.__esModule?s:{default:s}};Object.defineProperty(Lf,"__esModule",{value:!0});const e=r(tB),t=r(m3());class n{constructor(i){this.shouldThrowOnError=!1,this.method=i.method,this.url=i.url,this.headers=i.headers,this.schema=i.schema,this.body=i.body,this.shouldThrowOnError=i.shouldThrowOnError,this.signal=i.signal,this.isMaybeSingle=i.isMaybeSingle,i.fetch?this.fetch=i.fetch:typeof fetch>"u"?this.fetch=e.default:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(i,o){return this.headers=Object.assign({},this.headers),this.headers[i]=o,this}then(i,o){this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers["Accept-Profile"]=this.schema:this.headers["Content-Profile"]=this.schema),this.method!=="GET"&&this.method!=="HEAD"&&(this.headers["Content-Type"]="application/json");const a=this.fetch;let c=a(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async d=>{var f,m,v;let x=null,_=null,b=null,w=d.status,S=d.statusText;if(d.ok){if(this.method!=="HEAD"){const k=await d.text();k===""||(this.headers.Accept==="text/csv"||this.headers.Accept&&this.headers.Accept.includes("application/vnd.pgrst.plan+text")?_=k:_=JSON.parse(k))}const T=(f=this.headers.Prefer)===null||f===void 0?void 0:f.match(/count=(exact|planned|estimated)/),A=(m=d.headers.get("content-range"))===null||m===void 0?void 0:m.split("/");T&&A&&A.length>1&&(b=parseInt(A[1])),this.isMaybeSingle&&this.method==="GET"&&Array.isArray(_)&&(_.length>1?(x={code:"PGRST116",details:`Results contain ${_.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},_=null,b=null,w=406,S="Not Acceptable"):_.length===1?_=_[0]:_=null)}else{const T=await d.text();try{x=JSON.parse(T),Array.isArray(x)&&d.status===404&&(_=[],x=null,w=200,S="OK")}catch{d.status===404&&T===""?(w=204,S="No Content"):x={message:T}}if(x&&this.isMaybeSingle&&(!((v=x==null?void 0:x.details)===null||v===void 0)&&v.includes("0 rows"))&&(x=null,w=200,S="OK"),x&&this.shouldThrowOnError)throw new t.default(x)}return{error:x,data:_,count:b,status:w,statusText:S}});return this.shouldThrowOnError||(c=c.catch(d=>{var f,m,v;return{error:{message:`${(f=d==null?void 0:d.name)!==null&&f!==void 0?f:"FetchError"}: ${d==null?void 0:d.message}`,details:`${(m=d==null?void 0:d.stack)!==null&&m!==void 0?m:""}`,hint:"",code:`${(v=d==null?void 0:d.code)!==null&&v!==void 0?v:""}`},data:null,count:null,status:0,statusText:""}})),c.then(i,o)}returns(){return this}overrideTypes(){return this}}return Lf.default=n,Lf}var ET;function v3(){if(ET)return Df;ET=1;var r=Df&&Df.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty(Df,"__esModule",{value:!0});const e=r(g3());class t extends e.default{select(s){let i=!1;const o=(s??"*").split("").map(a=>/\s/.test(a)&&!i?"":(a==='"'&&(i=!i),a)).join("");return this.url.searchParams.set("select",o),this.headers.Prefer&&(this.headers.Prefer+=","),this.headers.Prefer+="return=representation",this}order(s,{ascending:i=!0,nullsFirst:o,foreignTable:a,referencedTable:c=a}={}){const d=c?`${c}.order`:"order",f=this.url.searchParams.get(d);return this.url.searchParams.set(d,`${f?`${f},`:""}${s}.${i?"asc":"desc"}${o===void 0?"":o?".nullsfirst":".nullslast"}`),this}limit(s,{foreignTable:i,referencedTable:o=i}={}){const a=typeof o>"u"?"limit":`${o}.limit`;return this.url.searchParams.set(a,`${s}`),this}range(s,i,{foreignTable:o,referencedTable:a=o}={}){const c=typeof a>"u"?"offset":`${a}.offset`,d=typeof a>"u"?"limit":`${a}.limit`;return this.url.searchParams.set(c,`${s}`),this.url.searchParams.set(d,`${i-s+1}`),this}abortSignal(s){return this.signal=s,this}single(){return this.headers.Accept="application/vnd.pgrst.object+json",this}maybeSingle(){return this.method==="GET"?this.headers.Accept="application/json":this.headers.Accept="application/vnd.pgrst.object+json",this.isMaybeSingle=!0,this}csv(){return this.headers.Accept="text/csv",this}geojson(){return this.headers.Accept="application/geo+json",this}explain({analyze:s=!1,verbose:i=!1,settings:o=!1,buffers:a=!1,wal:c=!1,format:d="text"}={}){var f;const m=[s?"analyze":null,i?"verbose":null,o?"settings":null,a?"buffers":null,c?"wal":null].filter(Boolean).join("|"),v=(f=this.headers.Accept)!==null&&f!==void 0?f:"application/json";return this.headers.Accept=`application/vnd.pgrst.plan+${d}; for="${v}"; options=${m};`,d==="json"?this:this}rollback(){var s;return((s=this.headers.Prefer)!==null&&s!==void 0?s:"").trim().length>0?this.headers.Prefer+=",tx=rollback":this.headers.Prefer="tx=rollback",this}returns(){return this}}return Df.default=t,Df}var MT;function RE(){if(MT)return kf;MT=1;var r=kf&&kf.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty(kf,"__esModule",{value:!0});const e=r(v3());class t extends e.default{eq(s,i){return this.url.searchParams.append(s,`eq.${i}`),this}neq(s,i){return this.url.searchParams.append(s,`neq.${i}`),this}gt(s,i){return this.url.searchParams.append(s,`gt.${i}`),this}gte(s,i){return this.url.searchParams.append(s,`gte.${i}`),this}lt(s,i){return this.url.searchParams.append(s,`lt.${i}`),this}lte(s,i){return this.url.searchParams.append(s,`lte.${i}`),this}like(s,i){return this.url.searchParams.append(s,`like.${i}`),this}likeAllOf(s,i){return this.url.searchParams.append(s,`like(all).{${i.join(",")}}`),this}likeAnyOf(s,i){return this.url.searchParams.append(s,`like(any).{${i.join(",")}}`),this}ilike(s,i){return this.url.searchParams.append(s,`ilike.${i}`),this}ilikeAllOf(s,i){return this.url.searchParams.append(s,`ilike(all).{${i.join(",")}}`),this}ilikeAnyOf(s,i){return this.url.searchParams.append(s,`ilike(any).{${i.join(",")}}`),this}is(s,i){return this.url.searchParams.append(s,`is.${i}`),this}in(s,i){const o=Array.from(new Set(i)).map(a=>typeof a=="string"&&new RegExp("[,()]").test(a)?`"${a}"`:`${a}`).join(",");return this.url.searchParams.append(s,`in.(${o})`),this}contains(s,i){return typeof i=="string"?this.url.searchParams.append(s,`cs.${i}`):Array.isArray(i)?this.url.searchParams.append(s,`cs.{${i.join(",")}}`):this.url.searchParams.append(s,`cs.${JSON.stringify(i)}`),this}containedBy(s,i){return typeof i=="string"?this.url.searchParams.append(s,`cd.${i}`):Array.isArray(i)?this.url.searchParams.append(s,`cd.{${i.join(",")}}`):this.url.searchParams.append(s,`cd.${JSON.stringify(i)}`),this}rangeGt(s,i){return this.url.searchParams.append(s,`sr.${i}`),this}rangeGte(s,i){return this.url.searchParams.append(s,`nxl.${i}`),this}rangeLt(s,i){return this.url.searchParams.append(s,`sl.${i}`),this}rangeLte(s,i){return this.url.searchParams.append(s,`nxr.${i}`),this}rangeAdjacent(s,i){return this.url.searchParams.append(s,`adj.${i}`),this}overlaps(s,i){return typeof i=="string"?this.url.searchParams.append(s,`ov.${i}`):this.url.searchParams.append(s,`ov.{${i.join(",")}}`),this}textSearch(s,i,{config:o,type:a}={}){let c="";a==="plain"?c="pl":a==="phrase"?c="ph":a==="websearch"&&(c="w");const d=o===void 0?"":`(${o})`;return this.url.searchParams.append(s,`${c}fts${d}.${i}`),this}match(s){return Object.entries(s).forEach(([i,o])=>{this.url.searchParams.append(i,`eq.${o}`)}),this}not(s,i,o){return this.url.searchParams.append(s,`not.${i}.${o}`),this}or(s,{foreignTable:i,referencedTable:o=i}={}){const a=o?`${o}.or`:"or";return this.url.searchParams.append(a,`(${s})`),this}filter(s,i,o){return this.url.searchParams.append(s,`${i}.${o}`),this}}return kf.default=t,kf}var TT;function x3(){if(TT)return If;TT=1;var r=If&&If.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty(If,"__esModule",{value:!0});const e=r(RE());class t{constructor(s,{headers:i={},schema:o,fetch:a}){this.url=s,this.headers=i,this.schema=o,this.fetch=a}select(s,{head:i=!1,count:o}={}){const a=i?"HEAD":"GET";let c=!1;const d=(s??"*").split("").map(f=>/\s/.test(f)&&!c?"":(f==='"'&&(c=!c),f)).join("");return this.url.searchParams.set("select",d),o&&(this.headers.Prefer=`count=${o}`),new e.default({method:a,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}insert(s,{count:i,defaultToNull:o=!0}={}){const a="POST",c=[];if(this.headers.Prefer&&c.push(this.headers.Prefer),i&&c.push(`count=${i}`),o||c.push("missing=default"),this.headers.Prefer=c.join(","),Array.isArray(s)){const d=s.reduce((f,m)=>f.concat(Object.keys(m)),[]);if(d.length>0){const f=[...new Set(d)].map(m=>`"${m}"`);this.url.searchParams.set("columns",f.join(","))}}return new e.default({method:a,url:this.url,headers:this.headers,schema:this.schema,body:s,fetch:this.fetch,allowEmpty:!1})}upsert(s,{onConflict:i,ignoreDuplicates:o=!1,count:a,defaultToNull:c=!0}={}){const d="POST",f=[`resolution=${o?"ignore":"merge"}-duplicates`];if(i!==void 0&&this.url.searchParams.set("on_conflict",i),this.headers.Prefer&&f.push(this.headers.Prefer),a&&f.push(`count=${a}`),c||f.push("missing=default"),this.headers.Prefer=f.join(","),Array.isArray(s)){const m=s.reduce((v,x)=>v.concat(Object.keys(x)),[]);if(m.length>0){const v=[...new Set(m)].map(x=>`"${x}"`);this.url.searchParams.set("columns",v.join(","))}}return new e.default({method:d,url:this.url,headers:this.headers,schema:this.schema,body:s,fetch:this.fetch,allowEmpty:!1})}update(s,{count:i}={}){const o="PATCH",a=[];return this.headers.Prefer&&a.push(this.headers.Prefer),i&&a.push(`count=${i}`),this.headers.Prefer=a.join(","),new e.default({method:o,url:this.url,headers:this.headers,schema:this.schema,body:s,fetch:this.fetch,allowEmpty:!1})}delete({count:s}={}){const i="DELETE",o=[];return s&&o.push(`count=${s}`),this.headers.Prefer&&o.unshift(this.headers.Prefer),this.headers.Prefer=o.join(","),new e.default({method:i,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}}return If.default=t,If}var pg={},mg={},CT;function nB(){return CT||(CT=1,Object.defineProperty(mg,"__esModule",{value:!0}),mg.version=void 0,mg.version="0.0.0-automated"),mg}var AT;function rB(){if(AT)return pg;AT=1,Object.defineProperty(pg,"__esModule",{value:!0}),pg.DEFAULT_HEADERS=void 0;const r=nB();return pg.DEFAULT_HEADERS={"X-Client-Info":`postgrest-js/${r.version}`},pg}var RT;function sB(){if(RT)return Pf;RT=1;var r=Pf&&Pf.__importDefault||function(i){return i&&i.__esModule?i:{default:i}};Object.defineProperty(Pf,"__esModule",{value:!0});const e=r(x3()),t=r(RE()),n=rB();class s{constructor(o,{headers:a={},schema:c,fetch:d}={}){this.url=o,this.headers=Object.assign(Object.assign({},n.DEFAULT_HEADERS),a),this.schemaName=c,this.fetch=d}from(o){const a=new URL(`${this.url}/${o}`);return new e.default(a,{headers:Object.assign({},this.headers),schema:this.schemaName,fetch:this.fetch})}schema(o){return new s(this.url,{headers:this.headers,schema:o,fetch:this.fetch})}rpc(o,a={},{head:c=!1,get:d=!1,count:f}={}){let m;const v=new URL(`${this.url}/rpc/${o}`);let x;c||d?(m=c?"HEAD":"GET",Object.entries(a).filter(([b,w])=>w!==void 0).map(([b,w])=>[b,Array.isArray(w)?`{${w.join(",")}}`:`${w}`]).forEach(([b,w])=>{v.searchParams.append(b,w)})):(m="POST",x=a);const _=Object.assign({},this.headers);return f&&(_.Prefer=`count=${f}`),new t.default({method:m,url:v,headers:_,schema:this.schemaName,body:x,fetch:this.fetch,allowEmpty:!1})}}return Pf.default=s,Pf}var NT;function iB(){if(NT)return os;NT=1;var r=os&&os.__importDefault||function(a){return a&&a.__esModule?a:{default:a}};Object.defineProperty(os,"__esModule",{value:!0}),os.PostgrestError=os.PostgrestBuilder=os.PostgrestTransformBuilder=os.PostgrestFilterBuilder=os.PostgrestQueryBuilder=os.PostgrestClient=void 0;const e=r(sB());os.PostgrestClient=e.default;const t=r(x3());os.PostgrestQueryBuilder=t.default;const n=r(RE());os.PostgrestFilterBuilder=n.default;const s=r(v3());os.PostgrestTransformBuilder=s.default;const i=r(g3());os.PostgrestBuilder=i.default;const o=r(m3());return os.PostgrestError=o.default,os.default={PostgrestClient:e.default,PostgrestQueryBuilder:t.default,PostgrestFilterBuilder:n.default,PostgrestTransformBuilder:s.default,PostgrestBuilder:i.default,PostgrestError:o.default},os}var oB=iB();const aB=y_(oB),{PostgrestClient:lB,PostgrestQueryBuilder:Oee,PostgrestFilterBuilder:jee,PostgrestTransformBuilder:Fee,PostgrestBuilder:Uee,PostgrestError:Bee}=aB;function cB(){if(typeof WebSocket<"u")return WebSocket;if(typeof global.WebSocket<"u")return global.WebSocket;if(typeof window.WebSocket<"u")return window.WebSocket;if(typeof self.WebSocket<"u")return self.WebSocket;throw new Error("`WebSocket` is not supported in this environment")}const uB=cB(),dB="2.11.15",hB=`realtime-js/${dB}`,fB="1.0.0",y3=1e4,pB=1e3;var zg;(function(r){r[r.connecting=0]="connecting",r[r.open=1]="open",r[r.closing=2]="closing",r[r.closed=3]="closed"})(zg||(zg={}));var Fs;(function(r){r.closed="closed",r.errored="errored",r.joined="joined",r.joining="joining",r.leaving="leaving"})(Fs||(Fs={}));var na;(function(r){r.close="phx_close",r.error="phx_error",r.join="phx_join",r.reply="phx_reply",r.leave="phx_leave",r.access_token="access_token"})(na||(na={}));var pb;(function(r){r.websocket="websocket"})(pb||(pb={}));var Dd;(function(r){r.Connecting="connecting",r.Open="open",r.Closing="closing",r.Closed="closed"})(Dd||(Dd={}));class mB{constructor(){this.HEADER_LENGTH=1}decode(e,t){return e.constructor===ArrayBuffer?t(this._binaryDecode(e)):t(typeof e=="string"?JSON.parse(e):{})}_binaryDecode(e){const t=new DataView(e),n=new TextDecoder;return this._decodeBroadcast(e,t,n)}_decodeBroadcast(e,t,n){const s=t.getUint8(1),i=t.getUint8(2);let o=this.HEADER_LENGTH+2;const a=n.decode(e.slice(o,o+s));o=o+s;const c=n.decode(e.slice(o,o+i));o=o+i;const d=JSON.parse(n.decode(e.slice(o,e.byteLength)));return{ref:null,topic:a,event:c,payload:d}}}class _3{constructor(e,t){this.callback=e,this.timerCalc=t,this.timer=void 0,this.tries=0,this.callback=e,this.timerCalc=t}reset(){this.tries=0,clearTimeout(this.timer)}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var tr;(function(r){r.abstime="abstime",r.bool="bool",r.date="date",r.daterange="daterange",r.float4="float4",r.float8="float8",r.int2="int2",r.int4="int4",r.int4range="int4range",r.int8="int8",r.int8range="int8range",r.json="json",r.jsonb="jsonb",r.money="money",r.numeric="numeric",r.oid="oid",r.reltime="reltime",r.text="text",r.time="time",r.timestamp="timestamp",r.timestamptz="timestamptz",r.timetz="timetz",r.tsrange="tsrange",r.tstzrange="tstzrange"})(tr||(tr={}));const PT=(r,e,t={})=>{var n;const s=(n=t.skipTypes)!==null&&n!==void 0?n:[];return Object.keys(e).reduce((i,o)=>(i[o]=gB(o,r,e,s),i),{})},gB=(r,e,t,n)=>{const s=e.find(a=>a.name===r),i=s==null?void 0:s.type,o=t[r];return i&&!n.includes(i)?w3(i,o):mb(o)},w3=(r,e)=>{if(r.charAt(0)==="_"){const t=r.slice(1,r.length);return _B(e,t)}switch(r){case tr.bool:return vB(e);case tr.float4:case tr.float8:case tr.int2:case tr.int4:case tr.int8:case tr.numeric:case tr.oid:return xB(e);case tr.json:case tr.jsonb:return yB(e);case tr.timestamp:return wB(e);case tr.abstime:case tr.date:case tr.daterange:case tr.int4range:case tr.int8range:case tr.money:case tr.reltime:case tr.text:case tr.time:case tr.timestamptz:case tr.timetz:case tr.tsrange:case tr.tstzrange:return mb(e);default:return mb(e)}},mb=r=>r,vB=r=>{switch(r){case"t":return!0;case"f":return!1;default:return r}},xB=r=>{if(typeof r=="string"){const e=parseFloat(r);if(!Number.isNaN(e))return e}return r},yB=r=>{if(typeof r=="string")try{return JSON.parse(r)}catch(e){return console.log(`JSON parse error: ${e}`),r}return r},_B=(r,e)=>{if(typeof r!="string")return r;const t=r.length-1,n=r[t];if(r[0]==="{"&&n==="}"){let i;const o=r.slice(1,t);try{i=JSON.parse("["+o+"]")}catch{i=o?o.split(","):[]}return i.map(a=>w3(e,a))}return r},wB=r=>typeof r=="string"?r.replace(" ","T"):r,S3=r=>{let e=r;return e=e.replace(/^ws/i,"http"),e=e.replace(/(\/socket\/websocket|\/socket|\/websocket)\/?$/i,""),e.replace(/\/+$/,"")};class _1{constructor(e,t,n={},s=y3){this.channel=e,this.event=t,this.payload=n,this.timeout=s,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(e){this.timeout=e,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(e){this.payload=Object.assign(Object.assign({},this.payload),e)}receive(e,t){var n;return this._hasReceived(e)&&t((n=this.receivedResp)===null||n===void 0?void 0:n.response),this.recHooks.push({status:e,callback:t}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const e=t=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=t,this._matchReceive(t)};this.channel._on(this.refEvent,{},e),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(e,t){this.refEvent&&this.channel._trigger(this.refEvent,{status:e,response:t})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:e,response:t}){this.recHooks.filter(n=>n.status===e).forEach(n=>n.callback(t))}_hasReceived(e){return this.receivedResp&&this.receivedResp.status===e}}var IT;(function(r){r.SYNC="sync",r.JOIN="join",r.LEAVE="leave"})(IT||(IT={}));class Vg{constructor(e,t){this.channel=e,this.state={},this.pendingDiffs=[],this.joinRef=null,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const n=(t==null?void 0:t.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(n.state,{},s=>{const{onJoin:i,onLeave:o,onSync:a}=this.caller;this.joinRef=this.channel._joinRef(),this.state=Vg.syncState(this.state,s,i,o),this.pendingDiffs.forEach(c=>{this.state=Vg.syncDiff(this.state,c,i,o)}),this.pendingDiffs=[],a()}),this.channel._on(n.diff,{},s=>{const{onJoin:i,onLeave:o,onSync:a}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(s):(this.state=Vg.syncDiff(this.state,s,i,o),a())}),this.onJoin((s,i,o)=>{this.channel._trigger("presence",{event:"join",key:s,currentPresences:i,newPresences:o})}),this.onLeave((s,i,o)=>{this.channel._trigger("presence",{event:"leave",key:s,currentPresences:i,leftPresences:o})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(e,t,n,s){const i=this.cloneDeep(e),o=this.transformState(t),a={},c={};return this.map(i,(d,f)=>{o[d]||(c[d]=f)}),this.map(o,(d,f)=>{const m=i[d];if(m){const v=f.map(w=>w.presence_ref),x=m.map(w=>w.presence_ref),_=f.filter(w=>x.indexOf(w.presence_ref)<0),b=m.filter(w=>v.indexOf(w.presence_ref)<0);_.length>0&&(a[d]=_),b.length>0&&(c[d]=b)}else a[d]=f}),this.syncDiff(i,{joins:a,leaves:c},n,s)}static syncDiff(e,t,n,s){const{joins:i,leaves:o}={joins:this.transformState(t.joins),leaves:this.transformState(t.leaves)};return n||(n=()=>{}),s||(s=()=>{}),this.map(i,(a,c)=>{var d;const f=(d=e[a])!==null&&d!==void 0?d:[];if(e[a]=this.cloneDeep(c),f.length>0){const m=e[a].map(x=>x.presence_ref),v=f.filter(x=>m.indexOf(x.presence_ref)<0);e[a].unshift(...v)}n(a,f,c)}),this.map(o,(a,c)=>{let d=e[a];if(!d)return;const f=c.map(m=>m.presence_ref);d=d.filter(m=>f.indexOf(m.presence_ref)<0),e[a]=d,s(a,d,c),d.length===0&&delete e[a]}),e}static map(e,t){return Object.getOwnPropertyNames(e).map(n=>t(n,e[n]))}static transformState(e){return e=this.cloneDeep(e),Object.getOwnPropertyNames(e).reduce((t,n)=>{const s=e[n];return"metas"in s?t[n]=s.metas.map(i=>(i.presence_ref=i.phx_ref,delete i.phx_ref,delete i.phx_ref_prev,i)):t[n]=s,t},{})}static cloneDeep(e){return JSON.parse(JSON.stringify(e))}onJoin(e){this.caller.onJoin=e}onLeave(e){this.caller.onLeave=e}onSync(e){this.caller.onSync=e}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var kT;(function(r){r.ALL="*",r.INSERT="INSERT",r.UPDATE="UPDATE",r.DELETE="DELETE"})(kT||(kT={}));var DT;(function(r){r.BROADCAST="broadcast",r.PRESENCE="presence",r.POSTGRES_CHANGES="postgres_changes",r.SYSTEM="system"})(DT||(DT={}));var Ul;(function(r){r.SUBSCRIBED="SUBSCRIBED",r.TIMED_OUT="TIMED_OUT",r.CLOSED="CLOSED",r.CHANNEL_ERROR="CHANNEL_ERROR"})(Ul||(Ul={}));class NE{constructor(e,t={config:{}},n){this.topic=e,this.params=t,this.socket=n,this.bindings={},this.state=Fs.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=e.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:""},private:!1},t.config),this.timeout=this.socket.timeout,this.joinPush=new _1(this,na.join,this.params,this.timeout),this.rejoinTimer=new _3(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=Fs.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(s=>s.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=Fs.closed,this.socket._remove(this)}),this._onError(s=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,s),this.state=Fs.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=Fs.errored,this.rejoinTimer.scheduleTimeout())}),this._on(na.reply,{},(s,i)=>{this._trigger(this._replyEventName(i),s)}),this.presence=new Vg(this),this.broadcastEndpointURL=S3(this.socket.endPoint)+"/api/broadcast",this.private=this.params.config.private||!1}subscribe(e,t=this.timeout){var n,s;if(this.socket.isConnected()||this.socket.connect(),this.state==Fs.closed){const{config:{broadcast:i,presence:o,private:a}}=this.params;this._onError(f=>e==null?void 0:e(Ul.CHANNEL_ERROR,f)),this._onClose(()=>e==null?void 0:e(Ul.CLOSED));const c={},d={broadcast:i,presence:o,postgres_changes:(s=(n=this.bindings.postgres_changes)===null||n===void 0?void 0:n.map(f=>f.filter))!==null&&s!==void 0?s:[],private:a};this.socket.accessTokenValue&&(c.access_token=this.socket.accessTokenValue),this.updateJoinPayload(Object.assign({config:d},c)),this.joinedOnce=!0,this._rejoin(t),this.joinPush.receive("ok",async({postgres_changes:f})=>{var m;if(this.socket.setAuth(),f===void 0){e==null||e(Ul.SUBSCRIBED);return}else{const v=this.bindings.postgres_changes,x=(m=v==null?void 0:v.length)!==null&&m!==void 0?m:0,_=[];for(let b=0;b<x;b++){const w=v[b],{filter:{event:S,schema:C,table:T,filter:A}}=w,k=f&&f[b];if(k&&k.event===S&&k.schema===C&&k.table===T&&k.filter===A)_.push(Object.assign(Object.assign({},w),{id:k.id}));else{this.unsubscribe(),this.state=Fs.errored,e==null||e(Ul.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=_,e&&e(Ul.SUBSCRIBED);return}}).receive("error",f=>{this.state=Fs.errored,e==null||e(Ul.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(f).join(", ")||"error")))}).receive("timeout",()=>{e==null||e(Ul.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(e,t={}){return await this.send({type:"presence",event:"track",payload:e},t.timeout||this.timeout)}async untrack(e={}){return await this.send({type:"presence",event:"untrack"},e)}on(e,t,n){return this._on(e,t,n)}async send(e,t={}){var n,s;if(!this._canPush()&&e.type==="broadcast"){const{event:i,payload:o}=e,c={method:"POST",headers:{Authorization:this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:i,payload:o,private:this.private}]})};try{const d=await this._fetchWithTimeout(this.broadcastEndpointURL,c,(n=t.timeout)!==null&&n!==void 0?n:this.timeout);return await((s=d.body)===null||s===void 0?void 0:s.cancel()),d.ok?"ok":"error"}catch(d){return d.name==="AbortError"?"timed out":"error"}}else return new Promise(i=>{var o,a,c;const d=this._push(e.type,e,t.timeout||this.timeout);e.type==="broadcast"&&!(!((c=(a=(o=this.params)===null||o===void 0?void 0:o.config)===null||a===void 0?void 0:a.broadcast)===null||c===void 0)&&c.ack)&&i("ok"),d.receive("ok",()=>i("ok")),d.receive("error",()=>i("error")),d.receive("timeout",()=>i("timed out"))})}updateJoinPayload(e){this.joinPush.updatePayload(e)}unsubscribe(e=this.timeout){this.state=Fs.leaving;const t=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(na.close,"leave",this._joinRef())};this.joinPush.destroy();let n=null;return new Promise(s=>{n=new _1(this,na.leave,{},e),n.receive("ok",()=>{t(),s("ok")}).receive("timeout",()=>{t(),s("timed out")}).receive("error",()=>{s("error")}),n.send(),this._canPush()||n.trigger("ok",{})}).finally(()=>{n==null||n.destroy()})}teardown(){this.pushBuffer.forEach(e=>e.destroy()),this.rejoinTimer&&clearTimeout(this.rejoinTimer.timer),this.joinPush.destroy()}async _fetchWithTimeout(e,t,n){const s=new AbortController,i=setTimeout(()=>s.abort(),n),o=await this.socket.fetch(e,Object.assign(Object.assign({},t),{signal:s.signal}));return clearTimeout(i),o}_push(e,t,n=this.timeout){if(!this.joinedOnce)throw`tried to push '${e}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let s=new _1(this,e,t,n);return this._canPush()?s.send():(s.startTimeout(),this.pushBuffer.push(s)),s}_onMessage(e,t,n){return t}_isMember(e){return this.topic===e}_joinRef(){return this.joinPush.ref}_trigger(e,t,n){var s,i;const o=e.toLocaleLowerCase(),{close:a,error:c,leave:d,join:f}=na;if(n&&[a,c,d,f].indexOf(o)>=0&&n!==this._joinRef())return;let v=this._onMessage(o,t,n);if(t&&!v)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(o)?(s=this.bindings.postgres_changes)===null||s===void 0||s.filter(x=>{var _,b,w;return((_=x.filter)===null||_===void 0?void 0:_.event)==="*"||((w=(b=x.filter)===null||b===void 0?void 0:b.event)===null||w===void 0?void 0:w.toLocaleLowerCase())===o}).map(x=>x.callback(v,n)):(i=this.bindings[o])===null||i===void 0||i.filter(x=>{var _,b,w,S,C,T;if(["broadcast","presence","postgres_changes"].includes(o))if("id"in x){const A=x.id,k=(_=x.filter)===null||_===void 0?void 0:_.event;return A&&((b=t.ids)===null||b===void 0?void 0:b.includes(A))&&(k==="*"||(k==null?void 0:k.toLocaleLowerCase())===((w=t.data)===null||w===void 0?void 0:w.type.toLocaleLowerCase()))}else{const A=(C=(S=x==null?void 0:x.filter)===null||S===void 0?void 0:S.event)===null||C===void 0?void 0:C.toLocaleLowerCase();return A==="*"||A===((T=t==null?void 0:t.event)===null||T===void 0?void 0:T.toLocaleLowerCase())}else return x.type.toLocaleLowerCase()===o}).map(x=>{if(typeof v=="object"&&"ids"in v){const _=v.data,{schema:b,table:w,commit_timestamp:S,type:C,errors:T}=_;v=Object.assign(Object.assign({},{schema:b,table:w,commit_timestamp:S,eventType:C,new:{},old:{},errors:T}),this._getPayloadRecords(_))}x.callback(v,n)})}_isClosed(){return this.state===Fs.closed}_isJoined(){return this.state===Fs.joined}_isJoining(){return this.state===Fs.joining}_isLeaving(){return this.state===Fs.leaving}_replyEventName(e){return`chan_reply_${e}`}_on(e,t,n){const s=e.toLocaleLowerCase(),i={type:s,filter:t,callback:n};return this.bindings[s]?this.bindings[s].push(i):this.bindings[s]=[i],this}_off(e,t){const n=e.toLocaleLowerCase();return this.bindings[n]=this.bindings[n].filter(s=>{var i;return!(((i=s.type)===null||i===void 0?void 0:i.toLocaleLowerCase())===n&&NE.isEqual(s.filter,t))}),this}static isEqual(e,t){if(Object.keys(e).length!==Object.keys(t).length)return!1;for(const n in e)if(e[n]!==t[n])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(e){this._on(na.close,{},e)}_onError(e){this._on(na.error,{},t=>e(t))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(e=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=Fs.joining,this.joinPush.resend(e))}_getPayloadRecords(e){const t={new:{},old:{}};return(e.type==="INSERT"||e.type==="UPDATE")&&(t.new=PT(e.columns,e.record)),(e.type==="UPDATE"||e.type==="DELETE")&&(t.old=PT(e.columns,e.old_record)),t}}const LT=()=>{},SB=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class bB{constructor(e,t){var n;this.accessTokenValue=null,this.apiKey=null,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=y3,this.heartbeatIntervalMs=25e3,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=LT,this.ref=0,this.logger=LT,this.conn=null,this.sendBuffer=[],this.serializer=new mB,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._resolveFetch=i=>{let o;return i?o=i:typeof fetch>"u"?o=(...a)=>F0(async()=>{const{default:c}=await Promise.resolve().then(()=>am);return{default:c}},void 0).then(({default:c})=>c(...a)):o=fetch,(...a)=>o(...a)},this.endPoint=`${e}/${pb.websocket}`,this.httpEndpoint=S3(e),t!=null&&t.transport?this.transport=t.transport:this.transport=null,t!=null&&t.params&&(this.params=t.params),t!=null&&t.timeout&&(this.timeout=t.timeout),t!=null&&t.logger&&(this.logger=t.logger),(t!=null&&t.logLevel||t!=null&&t.log_level)&&(this.logLevel=t.logLevel||t.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),t!=null&&t.heartbeatIntervalMs&&(this.heartbeatIntervalMs=t.heartbeatIntervalMs);const s=(n=t==null?void 0:t.params)===null||n===void 0?void 0:n.apikey;if(s&&(this.accessTokenValue=s,this.apiKey=s),this.reconnectAfterMs=t!=null&&t.reconnectAfterMs?t.reconnectAfterMs:i=>[1e3,2e3,5e3,1e4][i-1]||1e4,this.encode=t!=null&&t.encode?t.encode:(i,o)=>o(JSON.stringify(i)),this.decode=t!=null&&t.decode?t.decode:this.serializer.decode.bind(this.serializer),this.reconnectTimer=new _3(async()=>{this.disconnect(),this.connect()},this.reconnectAfterMs),this.fetch=this._resolveFetch(t==null?void 0:t.fetch),t!=null&&t.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.worker=(t==null?void 0:t.worker)||!1,this.workerUrl=t==null?void 0:t.workerUrl}this.accessToken=(t==null?void 0:t.accessToken)||null}connect(){if(!this.conn){if(this.transport||(this.transport=uB),!this.transport)throw new Error("No transport provided");this.conn=new this.transport(this.endpointURL()),this.setupConnection()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:fB}))}disconnect(e,t){this.conn&&(this.conn.onclose=function(){},e?this.conn.close(e,t??""):this.conn.close(),this.conn=null,this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.reset(),this.channels.forEach(n=>n.teardown()))}getChannels(){return this.channels}async removeChannel(e){const t=await e.unsubscribe();return this.channels.length===0&&this.disconnect(),t}async removeAllChannels(){const e=await Promise.all(this.channels.map(t=>t.unsubscribe()));return this.channels=[],this.disconnect(),e}log(e,t,n){this.logger(e,t,n)}connectionState(){switch(this.conn&&this.conn.readyState){case zg.connecting:return Dd.Connecting;case zg.open:return Dd.Open;case zg.closing:return Dd.Closing;default:return Dd.Closed}}isConnected(){return this.connectionState()===Dd.Open}channel(e,t={config:{}}){const n=`realtime:${e}`,s=this.getChannels().find(i=>i.topic===n);if(s)return s;{const i=new NE(`realtime:${e}`,t,this);return this.channels.push(i),i}}push(e){const{topic:t,event:n,payload:s,ref:i}=e,o=()=>{this.encode(e,a=>{var c;(c=this.conn)===null||c===void 0||c.send(a)})};this.log("push",`${t} ${n} (${i})`,s),this.isConnected()?o():this.sendBuffer.push(o)}async setAuth(e=null){let t=e||this.accessToken&&await this.accessToken()||this.accessTokenValue;this.accessTokenValue!=t&&(this.accessTokenValue=t,this.channels.forEach(n=>{const s={access_token:t,version:hB};t&&n.updateJoinPayload(s),n.joinedOnce&&n._isJoined()&&n._push(na.access_token,{access_token:t})}))}async sendHeartbeat(){var e;if(!this.isConnected()){this.heartbeatCallback("disconnected");return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection"),this.heartbeatCallback("timeout"),(e=this.conn)===null||e===void 0||e.close(pB,"hearbeat timeout");return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef}),this.heartbeatCallback("sent"),await this.setAuth()}onHeartbeat(e){this.heartbeatCallback=e}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(e=>e()),this.sendBuffer=[])}_makeRef(){let e=this.ref+1;return e===this.ref?this.ref=0:this.ref=e,this.ref.toString()}_leaveOpenTopic(e){let t=this.channels.find(n=>n.topic===e&&(n._isJoined()||n._isJoining()));t&&(this.log("transport",`leaving duplicate topic "${e}"`),t.unsubscribe())}_remove(e){this.channels=this.channels.filter(t=>t.topic!==e.topic)}setupConnection(){this.conn&&(this.conn.binaryType="arraybuffer",this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=e=>this._onConnError(e),this.conn.onmessage=e=>this._onConnMessage(e),this.conn.onclose=e=>this._onConnClose(e))}_onConnMessage(e){this.decode(e.data,t=>{let{topic:n,event:s,payload:i,ref:o}=t;n==="phoenix"&&s==="phx_reply"&&this.heartbeatCallback(t.payload.status=="ok"?"ok":"error"),o&&o===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null),this.log("receive",`${i.status||""} ${n} ${s} ${o&&"("+o+")"||""}`,i),Array.from(this.channels).filter(a=>a._isMember(n)).forEach(a=>a._trigger(s,i,o)),this.stateChangeCallbacks.message.forEach(a=>a(t))})}_onConnOpen(){this.log("transport",`connected to ${this.endpointURL()}`),this.flushSendBuffer(),this.reconnectTimer.reset(),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this.stateChangeCallbacks.open.forEach(e=>e())}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const e=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(e),this.workerRef.onerror=t=>{this.log("worker","worker error",t.message),this.workerRef.terminate()},this.workerRef.onmessage=t=>{t.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_onConnClose(e){this.log("transport","close",e),this._triggerChanError(),this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.scheduleTimeout(),this.stateChangeCallbacks.close.forEach(t=>t(e))}_onConnError(e){this.log("transport",`${e}`),this._triggerChanError(),this.stateChangeCallbacks.error.forEach(t=>t(e))}_triggerChanError(){this.channels.forEach(e=>e._trigger(na.error))}_appendParams(e,t){if(Object.keys(t).length===0)return e;const n=e.match(/\?/)?"&":"?",s=new URLSearchParams(t);return`${e}${n}${s}`}_workerObjectUrl(e){let t;if(e)t=e;else{const n=new Blob([SB],{type:"application/javascript"});t=URL.createObjectURL(n)}return t}}class PE extends Error{constructor(e){super(e),this.__isStorageError=!0,this.name="StorageError"}}function ls(r){return typeof r=="object"&&r!==null&&"__isStorageError"in r}class EB extends PE{constructor(e,t){super(e),this.name="StorageApiError",this.status=t}toJSON(){return{name:this.name,message:this.message,status:this.status}}}class gb extends PE{constructor(e,t){super(e),this.name="StorageUnknownError",this.originalError=t}}var MB=function(r,e,t,n){function s(i){return i instanceof t?i:new t(function(o){o(i)})}return new(t||(t=Promise))(function(i,o){function a(f){try{d(n.next(f))}catch(m){o(m)}}function c(f){try{d(n.throw(f))}catch(m){o(m)}}function d(f){f.done?i(f.value):s(f.value).then(a,c)}d((n=n.apply(r,e||[])).next())})};const b3=r=>{let e;return r?e=r:typeof fetch>"u"?e=(...t)=>F0(async()=>{const{default:n}=await Promise.resolve().then(()=>am);return{default:n}},void 0).then(({default:n})=>n(...t)):e=fetch,(...t)=>e(...t)},TB=()=>MB(void 0,void 0,void 0,function*(){return typeof Response>"u"?(yield F0(()=>Promise.resolve().then(()=>am),void 0)).Response:Response}),vb=r=>{if(Array.isArray(r))return r.map(t=>vb(t));if(typeof r=="function"||r!==Object(r))return r;const e={};return Object.entries(r).forEach(([t,n])=>{const s=t.replace(/([-_][a-z])/gi,i=>i.toUpperCase().replace(/[-_]/g,""));e[s]=vb(n)}),e};var vh=function(r,e,t,n){function s(i){return i instanceof t?i:new t(function(o){o(i)})}return new(t||(t=Promise))(function(i,o){function a(f){try{d(n.next(f))}catch(m){o(m)}}function c(f){try{d(n.throw(f))}catch(m){o(m)}}function d(f){f.done?i(f.value):s(f.value).then(a,c)}d((n=n.apply(r,e||[])).next())})};const w1=r=>r.msg||r.message||r.error_description||r.error||JSON.stringify(r),CB=(r,e,t)=>vh(void 0,void 0,void 0,function*(){const n=yield TB();r instanceof n&&!(t!=null&&t.noResolveJson)?r.json().then(s=>{e(new EB(w1(s),r.status||500))}).catch(s=>{e(new gb(w1(s),s))}):e(new gb(w1(r),r))}),AB=(r,e,t,n)=>{const s={method:r,headers:(e==null?void 0:e.headers)||{}};return r==="GET"?s:(s.headers=Object.assign({"Content-Type":"application/json"},e==null?void 0:e.headers),n&&(s.body=JSON.stringify(n)),Object.assign(Object.assign({},s),t))};function U0(r,e,t,n,s,i){return vh(this,void 0,void 0,function*(){return new Promise((o,a)=>{r(t,AB(e,n,s,i)).then(c=>{if(!c.ok)throw c;return n!=null&&n.noResolveJson?c:c.json()}).then(c=>o(c)).catch(c=>CB(c,a,n))})})}function My(r,e,t,n){return vh(this,void 0,void 0,function*(){return U0(r,"GET",e,t,n)})}function Yc(r,e,t,n,s){return vh(this,void 0,void 0,function*(){return U0(r,"POST",e,n,s,t)})}function RB(r,e,t,n,s){return vh(this,void 0,void 0,function*(){return U0(r,"PUT",e,n,s,t)})}function NB(r,e,t,n){return vh(this,void 0,void 0,function*(){return U0(r,"HEAD",e,Object.assign(Object.assign({},t),{noResolveJson:!0}),n)})}function E3(r,e,t,n,s){return vh(this,void 0,void 0,function*(){return U0(r,"DELETE",e,n,s,t)})}var Ei=function(r,e,t,n){function s(i){return i instanceof t?i:new t(function(o){o(i)})}return new(t||(t=Promise))(function(i,o){function a(f){try{d(n.next(f))}catch(m){o(m)}}function c(f){try{d(n.throw(f))}catch(m){o(m)}}function d(f){f.done?i(f.value):s(f.value).then(a,c)}d((n=n.apply(r,e||[])).next())})};const PB={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},OT={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class IB{constructor(e,t={},n,s){this.url=e,this.headers=t,this.bucketId=n,this.fetch=b3(s)}uploadOrUpdate(e,t,n,s){return Ei(this,void 0,void 0,function*(){try{let i;const o=Object.assign(Object.assign({},OT),s);let a=Object.assign(Object.assign({},this.headers),e==="POST"&&{"x-upsert":String(o.upsert)});const c=o.metadata;typeof Blob<"u"&&n instanceof Blob?(i=new FormData,i.append("cacheControl",o.cacheControl),c&&i.append("metadata",this.encodeMetadata(c)),i.append("",n)):typeof FormData<"u"&&n instanceof FormData?(i=n,i.append("cacheControl",o.cacheControl),c&&i.append("metadata",this.encodeMetadata(c))):(i=n,a["cache-control"]=`max-age=${o.cacheControl}`,a["content-type"]=o.contentType,c&&(a["x-metadata"]=this.toBase64(this.encodeMetadata(c)))),s!=null&&s.headers&&(a=Object.assign(Object.assign({},a),s.headers));const d=this._removeEmptyFolders(t),f=this._getFinalPath(d),m=yield this.fetch(`${this.url}/object/${f}`,Object.assign({method:e,body:i,headers:a},o!=null&&o.duplex?{duplex:o.duplex}:{})),v=yield m.json();return m.ok?{data:{path:d,id:v.Id,fullPath:v.Key},error:null}:{data:null,error:v}}catch(i){if(ls(i))return{data:null,error:i};throw i}})}upload(e,t,n){return Ei(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",e,t,n)})}uploadToSignedUrl(e,t,n,s){return Ei(this,void 0,void 0,function*(){const i=this._removeEmptyFolders(e),o=this._getFinalPath(i),a=new URL(this.url+`/object/upload/sign/${o}`);a.searchParams.set("token",t);try{let c;const d=Object.assign({upsert:OT.upsert},s),f=Object.assign(Object.assign({},this.headers),{"x-upsert":String(d.upsert)});typeof Blob<"u"&&n instanceof Blob?(c=new FormData,c.append("cacheControl",d.cacheControl),c.append("",n)):typeof FormData<"u"&&n instanceof FormData?(c=n,c.append("cacheControl",d.cacheControl)):(c=n,f["cache-control"]=`max-age=${d.cacheControl}`,f["content-type"]=d.contentType);const m=yield this.fetch(a.toString(),{method:"PUT",body:c,headers:f}),v=yield m.json();return m.ok?{data:{path:i,fullPath:v.Key},error:null}:{data:null,error:v}}catch(c){if(ls(c))return{data:null,error:c};throw c}})}createSignedUploadUrl(e,t){return Ei(this,void 0,void 0,function*(){try{let n=this._getFinalPath(e);const s=Object.assign({},this.headers);t!=null&&t.upsert&&(s["x-upsert"]="true");const i=yield Yc(this.fetch,`${this.url}/object/upload/sign/${n}`,{},{headers:s}),o=new URL(this.url+i.url),a=o.searchParams.get("token");if(!a)throw new PE("No token returned by API");return{data:{signedUrl:o.toString(),path:e,token:a},error:null}}catch(n){if(ls(n))return{data:null,error:n};throw n}})}update(e,t,n){return Ei(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",e,t,n)})}move(e,t,n){return Ei(this,void 0,void 0,function*(){try{return{data:yield Yc(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:e,destinationKey:t,destinationBucket:n==null?void 0:n.destinationBucket},{headers:this.headers}),error:null}}catch(s){if(ls(s))return{data:null,error:s};throw s}})}copy(e,t,n){return Ei(this,void 0,void 0,function*(){try{return{data:{path:(yield Yc(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:e,destinationKey:t,destinationBucket:n==null?void 0:n.destinationBucket},{headers:this.headers})).Key},error:null}}catch(s){if(ls(s))return{data:null,error:s};throw s}})}createSignedUrl(e,t,n){return Ei(this,void 0,void 0,function*(){try{let s=this._getFinalPath(e),i=yield Yc(this.fetch,`${this.url}/object/sign/${s}`,Object.assign({expiresIn:t},n!=null&&n.transform?{transform:n.transform}:{}),{headers:this.headers});const o=n!=null&&n.download?`&download=${n.download===!0?"":n.download}`:"";return i={signedUrl:encodeURI(`${this.url}${i.signedURL}${o}`)},{data:i,error:null}}catch(s){if(ls(s))return{data:null,error:s};throw s}})}createSignedUrls(e,t,n){return Ei(this,void 0,void 0,function*(){try{const s=yield Yc(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:t,paths:e},{headers:this.headers}),i=n!=null&&n.download?`&download=${n.download===!0?"":n.download}`:"";return{data:s.map(o=>Object.assign(Object.assign({},o),{signedUrl:o.signedURL?encodeURI(`${this.url}${o.signedURL}${i}`):null})),error:null}}catch(s){if(ls(s))return{data:null,error:s};throw s}})}download(e,t){return Ei(this,void 0,void 0,function*(){const s=typeof(t==null?void 0:t.transform)<"u"?"render/image/authenticated":"object",i=this.transformOptsToQueryString((t==null?void 0:t.transform)||{}),o=i?`?${i}`:"";try{const a=this._getFinalPath(e);return{data:yield(yield My(this.fetch,`${this.url}/${s}/${a}${o}`,{headers:this.headers,noResolveJson:!0})).blob(),error:null}}catch(a){if(ls(a))return{data:null,error:a};throw a}})}info(e){return Ei(this,void 0,void 0,function*(){const t=this._getFinalPath(e);try{const n=yield My(this.fetch,`${this.url}/object/info/${t}`,{headers:this.headers});return{data:vb(n),error:null}}catch(n){if(ls(n))return{data:null,error:n};throw n}})}exists(e){return Ei(this,void 0,void 0,function*(){const t=this._getFinalPath(e);try{return yield NB(this.fetch,`${this.url}/object/${t}`,{headers:this.headers}),{data:!0,error:null}}catch(n){if(ls(n)&&n instanceof gb){const s=n.originalError;if([400,404].includes(s==null?void 0:s.status))return{data:!1,error:n}}throw n}})}getPublicUrl(e,t){const n=this._getFinalPath(e),s=[],i=t!=null&&t.download?`download=${t.download===!0?"":t.download}`:"";i!==""&&s.push(i);const a=typeof(t==null?void 0:t.transform)<"u"?"render/image":"object",c=this.transformOptsToQueryString((t==null?void 0:t.transform)||{});c!==""&&s.push(c);let d=s.join("&");return d!==""&&(d=`?${d}`),{data:{publicUrl:encodeURI(`${this.url}/${a}/public/${n}${d}`)}}}remove(e){return Ei(this,void 0,void 0,function*(){try{return{data:yield E3(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:e},{headers:this.headers}),error:null}}catch(t){if(ls(t))return{data:null,error:t};throw t}})}list(e,t,n){return Ei(this,void 0,void 0,function*(){try{const s=Object.assign(Object.assign(Object.assign({},PB),t),{prefix:e||""});return{data:yield Yc(this.fetch,`${this.url}/object/list/${this.bucketId}`,s,{headers:this.headers},n),error:null}}catch(s){if(ls(s))return{data:null,error:s};throw s}})}encodeMetadata(e){return JSON.stringify(e)}toBase64(e){return typeof Buffer<"u"?Buffer.from(e).toString("base64"):btoa(e)}_getFinalPath(e){return`${this.bucketId}/${e}`}_removeEmptyFolders(e){return e.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(e){const t=[];return e.width&&t.push(`width=${e.width}`),e.height&&t.push(`height=${e.height}`),e.resize&&t.push(`resize=${e.resize}`),e.format&&t.push(`format=${e.format}`),e.quality&&t.push(`quality=${e.quality}`),t.join("&")}}const kB="2.7.1",DB={"X-Client-Info":`storage-js/${kB}`};var Of=function(r,e,t,n){function s(i){return i instanceof t?i:new t(function(o){o(i)})}return new(t||(t=Promise))(function(i,o){function a(f){try{d(n.next(f))}catch(m){o(m)}}function c(f){try{d(n.throw(f))}catch(m){o(m)}}function d(f){f.done?i(f.value):s(f.value).then(a,c)}d((n=n.apply(r,e||[])).next())})};class LB{constructor(e,t={},n){this.url=e,this.headers=Object.assign(Object.assign({},DB),t),this.fetch=b3(n)}listBuckets(){return Of(this,void 0,void 0,function*(){try{return{data:yield My(this.fetch,`${this.url}/bucket`,{headers:this.headers}),error:null}}catch(e){if(ls(e))return{data:null,error:e};throw e}})}getBucket(e){return Of(this,void 0,void 0,function*(){try{return{data:yield My(this.fetch,`${this.url}/bucket/${e}`,{headers:this.headers}),error:null}}catch(t){if(ls(t))return{data:null,error:t};throw t}})}createBucket(e,t={public:!1}){return Of(this,void 0,void 0,function*(){try{return{data:yield Yc(this.fetch,`${this.url}/bucket`,{id:e,name:e,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:this.headers}),error:null}}catch(n){if(ls(n))return{data:null,error:n};throw n}})}updateBucket(e,t){return Of(this,void 0,void 0,function*(){try{return{data:yield RB(this.fetch,`${this.url}/bucket/${e}`,{id:e,name:e,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:this.headers}),error:null}}catch(n){if(ls(n))return{data:null,error:n};throw n}})}emptyBucket(e){return Of(this,void 0,void 0,function*(){try{return{data:yield Yc(this.fetch,`${this.url}/bucket/${e}/empty`,{},{headers:this.headers}),error:null}}catch(t){if(ls(t))return{data:null,error:t};throw t}})}deleteBucket(e){return Of(this,void 0,void 0,function*(){try{return{data:yield E3(this.fetch,`${this.url}/bucket/${e}`,{},{headers:this.headers}),error:null}}catch(t){if(ls(t))return{data:null,error:t};throw t}})}}class OB extends LB{constructor(e,t={},n){super(e,t,n)}from(e){return new IB(this.url,this.headers,e,this.fetch)}}const jB="2.50.2";let Ig="";typeof Deno<"u"?Ig="deno":typeof document<"u"?Ig="web":typeof navigator<"u"&&navigator.product==="ReactNative"?Ig="react-native":Ig="node";const FB={"X-Client-Info":`supabase-js-${Ig}/${jB}`},UB={headers:FB},BB={schema:"public"},zB={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},VB={};var HB=function(r,e,t,n){function s(i){return i instanceof t?i:new t(function(o){o(i)})}return new(t||(t=Promise))(function(i,o){function a(f){try{d(n.next(f))}catch(m){o(m)}}function c(f){try{d(n.throw(f))}catch(m){o(m)}}function d(f){f.done?i(f.value):s(f.value).then(a,c)}d((n=n.apply(r,e||[])).next())})};const GB=r=>{let e;return r?e=r:typeof fetch>"u"?e=f3:e=fetch,(...t)=>e(...t)},WB=()=>typeof Headers>"u"?p3:Headers,$B=(r,e,t)=>{const n=GB(t),s=WB();return(i,o)=>HB(void 0,void 0,void 0,function*(){var a;const c=(a=yield e())!==null&&a!==void 0?a:r;let d=new s(o==null?void 0:o.headers);return d.has("apikey")||d.set("apikey",r),d.has("Authorization")||d.set("Authorization",`Bearer ${c}`),n(i,Object.assign(Object.assign({},o),{headers:d}))})};var qB=function(r,e,t,n){function s(i){return i instanceof t?i:new t(function(o){o(i)})}return new(t||(t=Promise))(function(i,o){function a(f){try{d(n.next(f))}catch(m){o(m)}}function c(f){try{d(n.throw(f))}catch(m){o(m)}}function d(f){f.done?i(f.value):s(f.value).then(a,c)}d((n=n.apply(r,e||[])).next())})};function XB(r){return r.endsWith("/")?r:r+"/"}function YB(r,e){var t,n;const{db:s,auth:i,realtime:o,global:a}=r,{db:c,auth:d,realtime:f,global:m}=e,v={db:Object.assign(Object.assign({},c),s),auth:Object.assign(Object.assign({},d),i),realtime:Object.assign(Object.assign({},f),o),global:Object.assign(Object.assign(Object.assign({},m),a),{headers:Object.assign(Object.assign({},(t=m==null?void 0:m.headers)!==null&&t!==void 0?t:{}),(n=a==null?void 0:a.headers)!==null&&n!==void 0?n:{})}),accessToken:()=>qB(this,void 0,void 0,function*(){return""})};return r.accessToken?v.accessToken=r.accessToken:delete v.accessToken,v}const M3="2.70.0",dp=30*1e3,xb=3,S1=xb*dp,KB="http://localhost:9999",QB="supabase.auth.token",JB={"X-Client-Info":`gotrue-js/${M3}`},yb="X-Supabase-Api-Version",T3={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},ZB=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,ez=6e5;class IE extends Error{constructor(e,t,n){super(e),this.__isAuthError=!0,this.name="AuthError",this.status=t,this.code=n}}function fn(r){return typeof r=="object"&&r!==null&&"__isAuthError"in r}class tz extends IE{constructor(e,t,n){super(e,t,n),this.name="AuthApiError",this.status=t,this.code=n}}function nz(r){return fn(r)&&r.name==="AuthApiError"}class C3 extends IE{constructor(e,t){super(e),this.name="AuthUnknownError",this.originalError=t}}class wu extends IE{constructor(e,t,n,s){super(e,n,s),this.name=t,this.status=n}}class qc extends wu{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function rz(r){return fn(r)&&r.name==="AuthSessionMissingError"}class nx extends wu{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class rx extends wu{constructor(e){super(e,"AuthInvalidCredentialsError",400,void 0)}}class sx extends wu{constructor(e,t=null){super(e,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=t}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function sz(r){return fn(r)&&r.name==="AuthImplicitGrantRedirectError"}class jT extends wu{constructor(e,t=null){super(e,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=t}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class _b extends wu{constructor(e,t){super(e,"AuthRetryableFetchError",t,void 0)}}function b1(r){return fn(r)&&r.name==="AuthRetryableFetchError"}class FT extends wu{constructor(e,t,n){super(e,"AuthWeakPasswordError",t,"weak_password"),this.reasons=n}}class Hg extends wu{constructor(e){super(e,"AuthInvalidJwtError",400,"invalid_jwt")}}const Ty="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),UT=` 	
\r=`.split(""),iz=(()=>{const r=new Array(128);for(let e=0;e<r.length;e+=1)r[e]=-1;for(let e=0;e<UT.length;e+=1)r[UT[e].charCodeAt(0)]=-2;for(let e=0;e<Ty.length;e+=1)r[Ty[e].charCodeAt(0)]=e;return r})();function BT(r,e,t){if(r!==null)for(e.queue=e.queue<<8|r,e.queuedBits+=8;e.queuedBits>=6;){const n=e.queue>>e.queuedBits-6&63;t(Ty[n]),e.queuedBits-=6}else if(e.queuedBits>0)for(e.queue=e.queue<<6-e.queuedBits,e.queuedBits=6;e.queuedBits>=6;){const n=e.queue>>e.queuedBits-6&63;t(Ty[n]),e.queuedBits-=6}}function A3(r,e,t){const n=iz[r];if(n>-1)for(e.queue=e.queue<<6|n,e.queuedBits+=6;e.queuedBits>=8;)t(e.queue>>e.queuedBits-8&255),e.queuedBits-=8;else{if(n===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(r)}"`)}}function zT(r){const e=[],t=o=>{e.push(String.fromCodePoint(o))},n={utf8seq:0,codepoint:0},s={queue:0,queuedBits:0},i=o=>{lz(o,n,t)};for(let o=0;o<r.length;o+=1)A3(r.charCodeAt(o),s,i);return e.join("")}function oz(r,e){if(r<=127){e(r);return}else if(r<=2047){e(192|r>>6),e(128|r&63);return}else if(r<=65535){e(224|r>>12),e(128|r>>6&63),e(128|r&63);return}else if(r<=1114111){e(240|r>>18),e(128|r>>12&63),e(128|r>>6&63),e(128|r&63);return}throw new Error(`Unrecognized Unicode codepoint: ${r.toString(16)}`)}function az(r,e){for(let t=0;t<r.length;t+=1){let n=r.charCodeAt(t);if(n>55295&&n<=56319){const s=(n-55296)*1024&65535;n=(r.charCodeAt(t+1)-56320&65535|s)+65536,t+=1}oz(n,e)}}function lz(r,e,t){if(e.utf8seq===0){if(r<=127){t(r);return}for(let n=1;n<6;n+=1)if((r>>7-n&1)===0){e.utf8seq=n;break}if(e.utf8seq===2)e.codepoint=r&31;else if(e.utf8seq===3)e.codepoint=r&15;else if(e.utf8seq===4)e.codepoint=r&7;else throw new Error("Invalid UTF-8 sequence");e.utf8seq-=1}else if(e.utf8seq>0){if(r<=127)throw new Error("Invalid UTF-8 sequence");e.codepoint=e.codepoint<<6|r&63,e.utf8seq-=1,e.utf8seq===0&&t(e.codepoint)}}function cz(r){const e=[],t={queue:0,queuedBits:0},n=s=>{e.push(s)};for(let s=0;s<r.length;s+=1)A3(r.charCodeAt(s),t,n);return new Uint8Array(e)}function uz(r){const e=[];return az(r,t=>e.push(t)),new Uint8Array(e)}function dz(r){const e=[],t={queue:0,queuedBits:0},n=s=>{e.push(s)};return r.forEach(s=>BT(s,t,n)),BT(null,t,n),e.join("")}function hz(r){return Math.round(Date.now()/1e3)+r}function fz(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(r){const e=Math.random()*16|0;return(r=="x"?e:e&3|8).toString(16)})}const Qo=()=>typeof window<"u"&&typeof document<"u",pd={tested:!1,writable:!1},Gg=()=>{if(!Qo())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(pd.tested)return pd.writable;const r=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(r,r),globalThis.localStorage.removeItem(r),pd.tested=!0,pd.writable=!0}catch{pd.tested=!0,pd.writable=!1}return pd.writable};function pz(r){const e={},t=new URL(r);if(t.hash&&t.hash[0]==="#")try{new URLSearchParams(t.hash.substring(1)).forEach((s,i)=>{e[i]=s})}catch{}return t.searchParams.forEach((n,s)=>{e[s]=n}),e}const R3=r=>{let e;return r?e=r:typeof fetch>"u"?e=(...t)=>F0(async()=>{const{default:n}=await Promise.resolve().then(()=>am);return{default:n}},void 0).then(({default:n})=>n(...t)):e=fetch,(...t)=>e(...t)},mz=r=>typeof r=="object"&&r!==null&&"status"in r&&"ok"in r&&"json"in r&&typeof r.json=="function",N3=async(r,e,t)=>{await r.setItem(e,JSON.stringify(t))},ix=async(r,e)=>{const t=await r.getItem(e);if(!t)return null;try{return JSON.parse(t)}catch{return t}},ox=async(r,e)=>{await r.removeItem(e)};class D_{constructor(){this.promise=new D_.promiseConstructor((e,t)=>{this.resolve=e,this.reject=t})}}D_.promiseConstructor=Promise;function E1(r){const e=r.split(".");if(e.length!==3)throw new Hg("Invalid JWT structure");for(let n=0;n<e.length;n++)if(!ZB.test(e[n]))throw new Hg("JWT not in base64url format");return{header:JSON.parse(zT(e[0])),payload:JSON.parse(zT(e[1])),signature:cz(e[2]),raw:{header:e[0],payload:e[1]}}}async function gz(r){return await new Promise(e=>{setTimeout(()=>e(null),r)})}function vz(r,e){return new Promise((n,s)=>{(async()=>{for(let i=0;i<1/0;i++)try{const o=await r(i);if(!e(i,null,o)){n(o);return}}catch(o){if(!e(i,o)){s(o);return}}})()})}function xz(r){return("0"+r.toString(16)).substr(-2)}function yz(){const e=new Uint32Array(56);if(typeof crypto>"u"){const t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",n=t.length;let s="";for(let i=0;i<56;i++)s+=t.charAt(Math.floor(Math.random()*n));return s}return crypto.getRandomValues(e),Array.from(e,xz).join("")}async function _z(r){const t=new TextEncoder().encode(r),n=await crypto.subtle.digest("SHA-256",t),s=new Uint8Array(n);return Array.from(s).map(i=>String.fromCharCode(i)).join("")}async function wz(r){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),r;const t=await _z(r);return btoa(t).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function jf(r,e,t=!1){const n=yz();let s=n;t&&(s+="/PASSWORD_RECOVERY"),await N3(r,`${e}-code-verifier`,s);const i=await wz(n);return[i,n===i?"plain":"s256"]}const Sz=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function bz(r){const e=r.headers.get(yb);if(!e||!e.match(Sz))return null;try{return new Date(`${e}T00:00:00.0Z`)}catch{return null}}function Ez(r){if(!r)throw new Error("Missing exp claim");const e=Math.floor(Date.now()/1e3);if(r<=e)throw new Error("JWT has expired")}function Mz(r){switch(r){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}const Tz=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function Ff(r){if(!Tz.test(r))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}var Cz=function(r,e){var t={};for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&e.indexOf(n)<0&&(t[n]=r[n]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,n=Object.getOwnPropertySymbols(r);s<n.length;s++)e.indexOf(n[s])<0&&Object.prototype.propertyIsEnumerable.call(r,n[s])&&(t[n[s]]=r[n[s]]);return t};const Rd=r=>r.msg||r.message||r.error_description||r.error||JSON.stringify(r),Az=[502,503,504];async function VT(r){var e;if(!mz(r))throw new _b(Rd(r),0);if(Az.includes(r.status))throw new _b(Rd(r),r.status);let t;try{t=await r.json()}catch(i){throw new C3(Rd(i),i)}let n;const s=bz(r);if(s&&s.getTime()>=T3["2024-01-01"].timestamp&&typeof t=="object"&&t&&typeof t.code=="string"?n=t.code:typeof t=="object"&&t&&typeof t.error_code=="string"&&(n=t.error_code),n){if(n==="weak_password")throw new FT(Rd(t),r.status,((e=t.weak_password)===null||e===void 0?void 0:e.reasons)||[]);if(n==="session_not_found")throw new qc}else if(typeof t=="object"&&t&&typeof t.weak_password=="object"&&t.weak_password&&Array.isArray(t.weak_password.reasons)&&t.weak_password.reasons.length&&t.weak_password.reasons.reduce((i,o)=>i&&typeof o=="string",!0))throw new FT(Rd(t),r.status,t.weak_password.reasons);throw new tz(Rd(t),r.status||500,n)}const Rz=(r,e,t,n)=>{const s={method:r,headers:(e==null?void 0:e.headers)||{}};return r==="GET"?s:(s.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},e==null?void 0:e.headers),s.body=JSON.stringify(n),Object.assign(Object.assign({},s),t))};async function Mn(r,e,t,n){var s;const i=Object.assign({},n==null?void 0:n.headers);i[yb]||(i[yb]=T3["2024-01-01"].name),n!=null&&n.jwt&&(i.Authorization=`Bearer ${n.jwt}`);const o=(s=n==null?void 0:n.query)!==null&&s!==void 0?s:{};n!=null&&n.redirectTo&&(o.redirect_to=n.redirectTo);const a=Object.keys(o).length?"?"+new URLSearchParams(o).toString():"",c=await Nz(r,e,t+a,{headers:i,noResolveJson:n==null?void 0:n.noResolveJson},{},n==null?void 0:n.body);return n!=null&&n.xform?n==null?void 0:n.xform(c):{data:Object.assign({},c),error:null}}async function Nz(r,e,t,n,s,i){const o=Rz(e,n,s,i);let a;try{a=await r(t,Object.assign({},o))}catch(c){throw console.error(c),new _b(Rd(c),0)}if(a.ok||await VT(a),n!=null&&n.noResolveJson)return a;try{return await a.json()}catch(c){await VT(c)}}function jl(r){var e;let t=null;Dz(r)&&(t=Object.assign({},r),r.expires_at||(t.expires_at=hz(r.expires_in)));const n=(e=r.user)!==null&&e!==void 0?e:r;return{data:{session:t,user:n},error:null}}function HT(r){const e=jl(r);return!e.error&&r.weak_password&&typeof r.weak_password=="object"&&Array.isArray(r.weak_password.reasons)&&r.weak_password.reasons.length&&r.weak_password.message&&typeof r.weak_password.message=="string"&&r.weak_password.reasons.reduce((t,n)=>t&&typeof n=="string",!0)&&(e.data.weak_password=r.weak_password),e}function Kc(r){var e;return{data:{user:(e=r.user)!==null&&e!==void 0?e:r},error:null}}function Pz(r){return{data:r,error:null}}function Iz(r){const{action_link:e,email_otp:t,hashed_token:n,redirect_to:s,verification_type:i}=r,o=Cz(r,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),a={action_link:e,email_otp:t,hashed_token:n,redirect_to:s,verification_type:i},c=Object.assign({},o);return{data:{properties:a,user:c},error:null}}function kz(r){return r}function Dz(r){return r.access_token&&r.refresh_token&&r.expires_in}const M1=["global","local","others"];var Lz=function(r,e){var t={};for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&e.indexOf(n)<0&&(t[n]=r[n]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,n=Object.getOwnPropertySymbols(r);s<n.length;s++)e.indexOf(n[s])<0&&Object.prototype.propertyIsEnumerable.call(r,n[s])&&(t[n[s]]=r[n[s]]);return t};class Oz{constructor({url:e="",headers:t={},fetch:n}){this.url=e,this.headers=t,this.fetch=R3(n),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)}}async signOut(e,t=M1[0]){if(M1.indexOf(t)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${M1.join(", ")}`);try{return await Mn(this.fetch,"POST",`${this.url}/logout?scope=${t}`,{headers:this.headers,jwt:e,noResolveJson:!0}),{data:null,error:null}}catch(n){if(fn(n))return{data:null,error:n};throw n}}async inviteUserByEmail(e,t={}){try{return await Mn(this.fetch,"POST",`${this.url}/invite`,{body:{email:e,data:t.data},headers:this.headers,redirectTo:t.redirectTo,xform:Kc})}catch(n){if(fn(n))return{data:{user:null},error:n};throw n}}async generateLink(e){try{const{options:t}=e,n=Lz(e,["options"]),s=Object.assign(Object.assign({},n),t);return"newEmail"in n&&(s.new_email=n==null?void 0:n.newEmail,delete s.newEmail),await Mn(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:s,headers:this.headers,xform:Iz,redirectTo:t==null?void 0:t.redirectTo})}catch(t){if(fn(t))return{data:{properties:null,user:null},error:t};throw t}}async createUser(e){try{return await Mn(this.fetch,"POST",`${this.url}/admin/users`,{body:e,headers:this.headers,xform:Kc})}catch(t){if(fn(t))return{data:{user:null},error:t};throw t}}async listUsers(e){var t,n,s,i,o,a,c;try{const d={nextPage:null,lastPage:0,total:0},f=await Mn(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(n=(t=e==null?void 0:e.page)===null||t===void 0?void 0:t.toString())!==null&&n!==void 0?n:"",per_page:(i=(s=e==null?void 0:e.perPage)===null||s===void 0?void 0:s.toString())!==null&&i!==void 0?i:""},xform:kz});if(f.error)throw f.error;const m=await f.json(),v=(o=f.headers.get("x-total-count"))!==null&&o!==void 0?o:0,x=(c=(a=f.headers.get("link"))===null||a===void 0?void 0:a.split(","))!==null&&c!==void 0?c:[];return x.length>0&&(x.forEach(_=>{const b=parseInt(_.split(";")[0].split("=")[1].substring(0,1)),w=JSON.parse(_.split(";")[1].split("=")[1]);d[`${w}Page`]=b}),d.total=parseInt(v)),{data:Object.assign(Object.assign({},m),d),error:null}}catch(d){if(fn(d))return{data:{users:[]},error:d};throw d}}async getUserById(e){Ff(e);try{return await Mn(this.fetch,"GET",`${this.url}/admin/users/${e}`,{headers:this.headers,xform:Kc})}catch(t){if(fn(t))return{data:{user:null},error:t};throw t}}async updateUserById(e,t){Ff(e);try{return await Mn(this.fetch,"PUT",`${this.url}/admin/users/${e}`,{body:t,headers:this.headers,xform:Kc})}catch(n){if(fn(n))return{data:{user:null},error:n};throw n}}async deleteUser(e,t=!1){Ff(e);try{return await Mn(this.fetch,"DELETE",`${this.url}/admin/users/${e}`,{headers:this.headers,body:{should_soft_delete:t},xform:Kc})}catch(n){if(fn(n))return{data:{user:null},error:n};throw n}}async _listFactors(e){Ff(e.userId);try{const{data:t,error:n}=await Mn(this.fetch,"GET",`${this.url}/admin/users/${e.userId}/factors`,{headers:this.headers,xform:s=>({data:{factors:s},error:null})});return{data:t,error:n}}catch(t){if(fn(t))return{data:null,error:t};throw t}}async _deleteFactor(e){Ff(e.userId),Ff(e.id);try{return{data:await Mn(this.fetch,"DELETE",`${this.url}/admin/users/${e.userId}/factors/${e.id}`,{headers:this.headers}),error:null}}catch(t){if(fn(t))return{data:null,error:t};throw t}}}const jz={getItem:r=>Gg()?globalThis.localStorage.getItem(r):null,setItem:(r,e)=>{Gg()&&globalThis.localStorage.setItem(r,e)},removeItem:r=>{Gg()&&globalThis.localStorage.removeItem(r)}};function GT(r={}){return{getItem:e=>r[e]||null,setItem:(e,t)=>{r[e]=t},removeItem:e=>{delete r[e]}}}function Fz(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}const Uf={debug:!!(globalThis&&Gg()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class P3 extends Error{constructor(e){super(e),this.isAcquireTimeout=!0}}class Uz extends P3{}async function Bz(r,e,t){Uf.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",r,e);const n=new globalThis.AbortController;return e>0&&setTimeout(()=>{n.abort(),Uf.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",r)},e),await Promise.resolve().then(()=>globalThis.navigator.locks.request(r,e===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:n.signal},async s=>{if(s){Uf.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",r,s.name);try{return await t()}finally{Uf.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",r,s.name)}}else{if(e===0)throw Uf.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",r),new Uz(`Acquiring an exclusive Navigator LockManager lock "${r}" immediately failed`);if(Uf.debug)try{const i=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(i,null,"  "))}catch(i){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",i)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await t()}}))}Fz();const zz={url:KB,storageKey:QB,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:JB,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1};async function WT(r,e,t){return await t()}class u0{constructor(e){var t,n;this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log,this.instanceID=u0.nextInstanceID,u0.nextInstanceID+=1,this.instanceID>0&&Qo()&&console.warn("Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.");const s=Object.assign(Object.assign({},zz),e);if(this.logDebugMessages=!!s.debug,typeof s.debug=="function"&&(this.logger=s.debug),this.persistSession=s.persistSession,this.storageKey=s.storageKey,this.autoRefreshToken=s.autoRefreshToken,this.admin=new Oz({url:s.url,headers:s.headers,fetch:s.fetch}),this.url=s.url,this.headers=s.headers,this.fetch=R3(s.fetch),this.lock=s.lock||WT,this.detectSessionInUrl=s.detectSessionInUrl,this.flowType=s.flowType,this.hasCustomAuthorizationHeader=s.hasCustomAuthorizationHeader,s.lock?this.lock=s.lock:Qo()&&(!((t=globalThis==null?void 0:globalThis.navigator)===null||t===void 0)&&t.locks)?this.lock=Bz:this.lock=WT,this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER,this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this)},this.persistSession?s.storage?this.storage=s.storage:Gg()?this.storage=jz:(this.memoryStorage={},this.storage=GT(this.memoryStorage)):(this.memoryStorage={},this.storage=GT(this.memoryStorage)),Qo()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(i){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",i)}(n=this.broadcastChannel)===null||n===void 0||n.addEventListener("message",async i=>{this._debug("received broadcast notification from other tab or client",i),await this._notifyAllSubscribers(i.data.event,i.data.session,!1)})}this.initialize()}_debug(...e){return this.logDebugMessages&&this.logger(`GoTrueClient@${this.instanceID} (${M3}) ${new Date().toISOString()}`,...e),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var e;try{const t=pz(window.location.href);let n="none";if(this._isImplicitGrantCallback(t)?n="implicit":await this._isPKCECallback(t)&&(n="pkce"),Qo()&&this.detectSessionInUrl&&n!=="none"){const{data:s,error:i}=await this._getSessionFromURL(t,n);if(i){if(this._debug("#_initialize()","error detecting session from URL",i),sz(i)){const c=(e=i.details)===null||e===void 0?void 0:e.code;if(c==="identity_already_exists"||c==="identity_not_found"||c==="single_identity_not_deletable")return{error:i}}return await this._removeSession(),{error:i}}const{session:o,redirectType:a}=s;return this._debug("#_initialize()","detected session in URL",o,"redirect type",a),await this._saveSession(o),setTimeout(async()=>{a==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",o):await this._notifyAllSubscribers("SIGNED_IN",o)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(t){return fn(t)?{error:t}:{error:new C3("Unexpected error during initialization",t)}}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(e){var t,n,s;try{const i=await Mn(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(n=(t=e==null?void 0:e.options)===null||t===void 0?void 0:t.data)!==null&&n!==void 0?n:{},gotrue_meta_security:{captcha_token:(s=e==null?void 0:e.options)===null||s===void 0?void 0:s.captchaToken}},xform:jl}),{data:o,error:a}=i;if(a||!o)return{data:{user:null,session:null},error:a};const c=o.session,d=o.user;return o.session&&(await this._saveSession(o.session),await this._notifyAllSubscribers("SIGNED_IN",c)),{data:{user:d,session:c},error:null}}catch(i){if(fn(i))return{data:{user:null,session:null},error:i};throw i}}async signUp(e){var t,n,s;try{let i;if("email"in e){const{email:f,password:m,options:v}=e;let x=null,_=null;this.flowType==="pkce"&&([x,_]=await jf(this.storage,this.storageKey)),i=await Mn(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:v==null?void 0:v.emailRedirectTo,body:{email:f,password:m,data:(t=v==null?void 0:v.data)!==null&&t!==void 0?t:{},gotrue_meta_security:{captcha_token:v==null?void 0:v.captchaToken},code_challenge:x,code_challenge_method:_},xform:jl})}else if("phone"in e){const{phone:f,password:m,options:v}=e;i=await Mn(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:f,password:m,data:(n=v==null?void 0:v.data)!==null&&n!==void 0?n:{},channel:(s=v==null?void 0:v.channel)!==null&&s!==void 0?s:"sms",gotrue_meta_security:{captcha_token:v==null?void 0:v.captchaToken}},xform:jl})}else throw new rx("You must provide either an email or phone number and a password");const{data:o,error:a}=i;if(a||!o)return{data:{user:null,session:null},error:a};const c=o.session,d=o.user;return o.session&&(await this._saveSession(o.session),await this._notifyAllSubscribers("SIGNED_IN",c)),{data:{user:d,session:c},error:null}}catch(i){if(fn(i))return{data:{user:null,session:null},error:i};throw i}}async signInWithPassword(e){try{let t;if("email"in e){const{email:i,password:o,options:a}=e;t=await Mn(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:i,password:o,gotrue_meta_security:{captcha_token:a==null?void 0:a.captchaToken}},xform:HT})}else if("phone"in e){const{phone:i,password:o,options:a}=e;t=await Mn(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:i,password:o,gotrue_meta_security:{captcha_token:a==null?void 0:a.captchaToken}},xform:HT})}else throw new rx("You must provide either an email or phone number and a password");const{data:n,error:s}=t;return s?{data:{user:null,session:null},error:s}:!n||!n.session||!n.user?{data:{user:null,session:null},error:new nx}:(n.session&&(await this._saveSession(n.session),await this._notifyAllSubscribers("SIGNED_IN",n.session)),{data:Object.assign({user:n.user,session:n.session},n.weak_password?{weakPassword:n.weak_password}:null),error:s})}catch(t){if(fn(t))return{data:{user:null,session:null},error:t};throw t}}async signInWithOAuth(e){var t,n,s,i;return await this._handleProviderSignIn(e.provider,{redirectTo:(t=e.options)===null||t===void 0?void 0:t.redirectTo,scopes:(n=e.options)===null||n===void 0?void 0:n.scopes,queryParams:(s=e.options)===null||s===void 0?void 0:s.queryParams,skipBrowserRedirect:(i=e.options)===null||i===void 0?void 0:i.skipBrowserRedirect})}async exchangeCodeForSession(e){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(e))}async signInWithWeb3(e){const{chain:t}=e;if(t==="solana")return await this.signInWithSolana(e);throw new Error(`@supabase/auth-js: Unsupported chain "${t}"`)}async signInWithSolana(e){var t,n,s,i,o,a,c,d,f,m,v,x;let _,b;if("message"in e)_=e.message,b=e.signature;else{const{chain:w,wallet:S,statement:C,options:T}=e;let A;if(Qo())if(typeof S=="object")A=S;else{const j=window;if("solana"in j&&typeof j.solana=="object"&&("signIn"in j.solana&&typeof j.solana.signIn=="function"||"signMessage"in j.solana&&typeof j.solana.signMessage=="function"))A=j.solana;else throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}else{if(typeof S!="object"||!(T!=null&&T.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");A=S}const k=new URL((t=T==null?void 0:T.url)!==null&&t!==void 0?t:window.location.href);if("signIn"in A&&A.signIn){const j=await A.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},T==null?void 0:T.signInWithSolana),{version:"1",domain:k.host,uri:k.href}),C?{statement:C}:null));let D;if(Array.isArray(j)&&j[0]&&typeof j[0]=="object")D=j[0];else if(j&&typeof j=="object"&&"signedMessage"in j&&"signature"in j)D=j;else throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in D&&"signature"in D&&(typeof D.signedMessage=="string"||D.signedMessage instanceof Uint8Array)&&D.signature instanceof Uint8Array)_=typeof D.signedMessage=="string"?D.signedMessage:new TextDecoder().decode(D.signedMessage),b=D.signature;else throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in A)||typeof A.signMessage!="function"||!("publicKey"in A)||typeof A!="object"||!A.publicKey||!("toBase58"in A.publicKey)||typeof A.publicKey.toBase58!="function")throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");_=[`${k.host} wants you to sign in with your Solana account:`,A.publicKey.toBase58(),...C?["",C,""]:[""],"Version: 1",`URI: ${k.href}`,`Issued At: ${(s=(n=T==null?void 0:T.signInWithSolana)===null||n===void 0?void 0:n.issuedAt)!==null&&s!==void 0?s:new Date().toISOString()}`,...!((i=T==null?void 0:T.signInWithSolana)===null||i===void 0)&&i.notBefore?[`Not Before: ${T.signInWithSolana.notBefore}`]:[],...!((o=T==null?void 0:T.signInWithSolana)===null||o===void 0)&&o.expirationTime?[`Expiration Time: ${T.signInWithSolana.expirationTime}`]:[],...!((a=T==null?void 0:T.signInWithSolana)===null||a===void 0)&&a.chainId?[`Chain ID: ${T.signInWithSolana.chainId}`]:[],...!((c=T==null?void 0:T.signInWithSolana)===null||c===void 0)&&c.nonce?[`Nonce: ${T.signInWithSolana.nonce}`]:[],...!((d=T==null?void 0:T.signInWithSolana)===null||d===void 0)&&d.requestId?[`Request ID: ${T.signInWithSolana.requestId}`]:[],...!((m=(f=T==null?void 0:T.signInWithSolana)===null||f===void 0?void 0:f.resources)===null||m===void 0)&&m.length?["Resources",...T.signInWithSolana.resources.map(D=>`- ${D}`)]:[]].join(`
`);const j=await A.signMessage(new TextEncoder().encode(_),"utf8");if(!j||!(j instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");b=j}}try{const{data:w,error:S}=await Mn(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:_,signature:dz(b)},!((v=e.options)===null||v===void 0)&&v.captchaToken?{gotrue_meta_security:{captcha_token:(x=e.options)===null||x===void 0?void 0:x.captchaToken}}:null),xform:jl});if(S)throw S;return!w||!w.session||!w.user?{data:{user:null,session:null},error:new nx}:(w.session&&(await this._saveSession(w.session),await this._notifyAllSubscribers("SIGNED_IN",w.session)),{data:Object.assign({},w),error:S})}catch(w){if(fn(w))return{data:{user:null,session:null},error:w};throw w}}async _exchangeCodeForSession(e){const t=await ix(this.storage,`${this.storageKey}-code-verifier`),[n,s]=(t??"").split("/");try{const{data:i,error:o}=await Mn(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:e,code_verifier:n},xform:jl});if(await ox(this.storage,`${this.storageKey}-code-verifier`),o)throw o;return!i||!i.session||!i.user?{data:{user:null,session:null,redirectType:null},error:new nx}:(i.session&&(await this._saveSession(i.session),await this._notifyAllSubscribers("SIGNED_IN",i.session)),{data:Object.assign(Object.assign({},i),{redirectType:s??null}),error:o})}catch(i){if(fn(i))return{data:{user:null,session:null,redirectType:null},error:i};throw i}}async signInWithIdToken(e){try{const{options:t,provider:n,token:s,access_token:i,nonce:o}=e,a=await Mn(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:n,id_token:s,access_token:i,nonce:o,gotrue_meta_security:{captcha_token:t==null?void 0:t.captchaToken}},xform:jl}),{data:c,error:d}=a;return d?{data:{user:null,session:null},error:d}:!c||!c.session||!c.user?{data:{user:null,session:null},error:new nx}:(c.session&&(await this._saveSession(c.session),await this._notifyAllSubscribers("SIGNED_IN",c.session)),{data:c,error:d})}catch(t){if(fn(t))return{data:{user:null,session:null},error:t};throw t}}async signInWithOtp(e){var t,n,s,i,o;try{if("email"in e){const{email:a,options:c}=e;let d=null,f=null;this.flowType==="pkce"&&([d,f]=await jf(this.storage,this.storageKey));const{error:m}=await Mn(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:a,data:(t=c==null?void 0:c.data)!==null&&t!==void 0?t:{},create_user:(n=c==null?void 0:c.shouldCreateUser)!==null&&n!==void 0?n:!0,gotrue_meta_security:{captcha_token:c==null?void 0:c.captchaToken},code_challenge:d,code_challenge_method:f},redirectTo:c==null?void 0:c.emailRedirectTo});return{data:{user:null,session:null},error:m}}if("phone"in e){const{phone:a,options:c}=e,{data:d,error:f}=await Mn(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:a,data:(s=c==null?void 0:c.data)!==null&&s!==void 0?s:{},create_user:(i=c==null?void 0:c.shouldCreateUser)!==null&&i!==void 0?i:!0,gotrue_meta_security:{captcha_token:c==null?void 0:c.captchaToken},channel:(o=c==null?void 0:c.channel)!==null&&o!==void 0?o:"sms"}});return{data:{user:null,session:null,messageId:d==null?void 0:d.message_id},error:f}}throw new rx("You must provide either an email or phone number.")}catch(a){if(fn(a))return{data:{user:null,session:null},error:a};throw a}}async verifyOtp(e){var t,n;try{let s,i;"options"in e&&(s=(t=e.options)===null||t===void 0?void 0:t.redirectTo,i=(n=e.options)===null||n===void 0?void 0:n.captchaToken);const{data:o,error:a}=await Mn(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},e),{gotrue_meta_security:{captcha_token:i}}),redirectTo:s,xform:jl});if(a)throw a;if(!o)throw new Error("An error occurred on token verification.");const c=o.session,d=o.user;return c!=null&&c.access_token&&(await this._saveSession(c),await this._notifyAllSubscribers(e.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",c)),{data:{user:d,session:c},error:null}}catch(s){if(fn(s))return{data:{user:null,session:null},error:s};throw s}}async signInWithSSO(e){var t,n,s;try{let i=null,o=null;return this.flowType==="pkce"&&([i,o]=await jf(this.storage,this.storageKey)),await Mn(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in e?{provider_id:e.providerId}:null),"domain"in e?{domain:e.domain}:null),{redirect_to:(n=(t=e.options)===null||t===void 0?void 0:t.redirectTo)!==null&&n!==void 0?n:void 0}),!((s=e==null?void 0:e.options)===null||s===void 0)&&s.captchaToken?{gotrue_meta_security:{captcha_token:e.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:i,code_challenge_method:o}),headers:this.headers,xform:Pz})}catch(i){if(fn(i))return{data:null,error:i};throw i}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async e=>{const{data:{session:t},error:n}=e;if(n)throw n;if(!t)throw new qc;const{error:s}=await Mn(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:t.access_token});return{data:{user:null,session:null},error:s}})}catch(e){if(fn(e))return{data:{user:null,session:null},error:e};throw e}}async resend(e){try{const t=`${this.url}/resend`;if("email"in e){const{email:n,type:s,options:i}=e,{error:o}=await Mn(this.fetch,"POST",t,{headers:this.headers,body:{email:n,type:s,gotrue_meta_security:{captcha_token:i==null?void 0:i.captchaToken}},redirectTo:i==null?void 0:i.emailRedirectTo});return{data:{user:null,session:null},error:o}}else if("phone"in e){const{phone:n,type:s,options:i}=e,{data:o,error:a}=await Mn(this.fetch,"POST",t,{headers:this.headers,body:{phone:n,type:s,gotrue_meta_security:{captcha_token:i==null?void 0:i.captchaToken}}});return{data:{user:null,session:null,messageId:o==null?void 0:o.message_id},error:a}}throw new rx("You must provide either an email or phone number and a type")}catch(t){if(fn(t))return{data:{user:null,session:null},error:t};throw t}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async t=>t))}async _acquireLock(e,t){this._debug("#_acquireLock","begin",e);try{if(this.lockAcquired){const n=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),s=(async()=>(await n,await t()))();return this.pendingInLock.push((async()=>{try{await s}catch{}})()),s}return await this.lock(`lock:${this.storageKey}`,e,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const n=t();for(this.pendingInLock.push((async()=>{try{await n}catch{}})()),await n;this.pendingInLock.length;){const s=[...this.pendingInLock];await Promise.all(s),this.pendingInLock.splice(0,s.length)}return await n}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(e){this._debug("#_useSession","begin");try{const t=await this.__loadSession();return await e(t)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let e=null;const t=await ix(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",t),t!==null&&(this._isValidSession(t)?e=t:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!e)return{data:{session:null},error:null};const n=e.expires_at?e.expires_at*1e3-Date.now()<S1:!1;if(this._debug("#__loadSession()",`session has${n?"":" not"} expired`,"expires_at",e.expires_at),!n){if(this.storage.isServer){let o=this.suppressGetSessionWarning;e=new Proxy(e,{get:(c,d,f)=>(!o&&d==="user"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),o=!0,this.suppressGetSessionWarning=!0),Reflect.get(c,d,f))})}return{data:{session:e},error:null}}const{session:s,error:i}=await this._callRefreshToken(e.refresh_token);return i?{data:{session:null},error:i}:{data:{session:s},error:null}}finally{this._debug("#__loadSession()","end")}}async getUser(e){return e?await this._getUser(e):(await this.initializePromise,await this._acquireLock(-1,async()=>await this._getUser()))}async _getUser(e){try{return e?await Mn(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:e,xform:Kc}):await this._useSession(async t=>{var n,s,i;const{data:o,error:a}=t;if(a)throw a;return!(!((n=o.session)===null||n===void 0)&&n.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new qc}:await Mn(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(i=(s=o.session)===null||s===void 0?void 0:s.access_token)!==null&&i!==void 0?i:void 0,xform:Kc})})}catch(t){if(fn(t))return rz(t)&&(await this._removeSession(),await ox(this.storage,`${this.storageKey}-code-verifier`)),{data:{user:null},error:t};throw t}}async updateUser(e,t={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(e,t))}async _updateUser(e,t={}){try{return await this._useSession(async n=>{const{data:s,error:i}=n;if(i)throw i;if(!s.session)throw new qc;const o=s.session;let a=null,c=null;this.flowType==="pkce"&&e.email!=null&&([a,c]=await jf(this.storage,this.storageKey));const{data:d,error:f}=await Mn(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:t==null?void 0:t.emailRedirectTo,body:Object.assign(Object.assign({},e),{code_challenge:a,code_challenge_method:c}),jwt:o.access_token,xform:Kc});if(f)throw f;return o.user=d.user,await this._saveSession(o),await this._notifyAllSubscribers("USER_UPDATED",o),{data:{user:o.user},error:null}})}catch(n){if(fn(n))return{data:{user:null},error:n};throw n}}async setSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(e))}async _setSession(e){try{if(!e.access_token||!e.refresh_token)throw new qc;const t=Date.now()/1e3;let n=t,s=!0,i=null;const{payload:o}=E1(e.access_token);if(o.exp&&(n=o.exp,s=n<=t),s){const{session:a,error:c}=await this._callRefreshToken(e.refresh_token);if(c)return{data:{user:null,session:null},error:c};if(!a)return{data:{user:null,session:null},error:null};i=a}else{const{data:a,error:c}=await this._getUser(e.access_token);if(c)throw c;i={access_token:e.access_token,refresh_token:e.refresh_token,user:a.user,token_type:"bearer",expires_in:n-t,expires_at:n},await this._saveSession(i),await this._notifyAllSubscribers("SIGNED_IN",i)}return{data:{user:i.user,session:i},error:null}}catch(t){if(fn(t))return{data:{session:null,user:null},error:t};throw t}}async refreshSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(e))}async _refreshSession(e){try{return await this._useSession(async t=>{var n;if(!e){const{data:o,error:a}=t;if(a)throw a;e=(n=o.session)!==null&&n!==void 0?n:void 0}if(!(e!=null&&e.refresh_token))throw new qc;const{session:s,error:i}=await this._callRefreshToken(e.refresh_token);return i?{data:{user:null,session:null},error:i}:s?{data:{user:s.user,session:s},error:null}:{data:{user:null,session:null},error:null}})}catch(t){if(fn(t))return{data:{user:null,session:null},error:t};throw t}}async _getSessionFromURL(e,t){try{if(!Qo())throw new sx("No browser detected.");if(e.error||e.error_description||e.error_code)throw new sx(e.error_description||"Error in URL with unspecified error_description",{error:e.error||"unspecified_error",code:e.error_code||"unspecified_code"});switch(t){case"implicit":if(this.flowType==="pkce")throw new jT("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new sx("Not a valid implicit grant flow url.");break;default:}if(t==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!e.code)throw new jT("No code detected.");const{data:C,error:T}=await this._exchangeCodeForSession(e.code);if(T)throw T;const A=new URL(window.location.href);return A.searchParams.delete("code"),window.history.replaceState(window.history.state,"",A.toString()),{data:{session:C.session,redirectType:null},error:null}}const{provider_token:n,provider_refresh_token:s,access_token:i,refresh_token:o,expires_in:a,expires_at:c,token_type:d}=e;if(!i||!a||!o||!d)throw new sx("No session defined in URL");const f=Math.round(Date.now()/1e3),m=parseInt(a);let v=f+m;c&&(v=parseInt(c));const x=v-f;x*1e3<=dp&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${x}s, should have been closer to ${m}s`);const _=v-m;f-_>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",_,v,f):f-_<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",_,v,f);const{data:b,error:w}=await this._getUser(i);if(w)throw w;const S={provider_token:n,provider_refresh_token:s,access_token:i,expires_in:m,expires_at:v,refresh_token:o,token_type:d,user:b.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),{data:{session:S,redirectType:e.type},error:null}}catch(n){if(fn(n))return{data:{session:null,redirectType:null},error:n};throw n}}_isImplicitGrantCallback(e){return!!(e.access_token||e.error_description)}async _isPKCECallback(e){const t=await ix(this.storage,`${this.storageKey}-code-verifier`);return!!(e.code&&t)}async signOut(e={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(e))}async _signOut({scope:e}={scope:"global"}){return await this._useSession(async t=>{var n;const{data:s,error:i}=t;if(i)return{error:i};const o=(n=s.session)===null||n===void 0?void 0:n.access_token;if(o){const{error:a}=await this.admin.signOut(o,e);if(a&&!(nz(a)&&(a.status===404||a.status===401||a.status===403)))return{error:a}}return e!=="others"&&(await this._removeSession(),await ox(this.storage,`${this.storageKey}-code-verifier`)),{error:null}})}onAuthStateChange(e){const t=fz(),n={id:t,callback:e,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",t),this.stateChangeEmitters.delete(t)}};return this._debug("#onAuthStateChange()","registered callback with id",t),this.stateChangeEmitters.set(t,n),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(t)})))(),{data:{subscription:n}}}async _emitInitialSession(e){return await this._useSession(async t=>{var n,s;try{const{data:{session:i},error:o}=t;if(o)throw o;await((n=this.stateChangeEmitters.get(e))===null||n===void 0?void 0:n.callback("INITIAL_SESSION",i)),this._debug("INITIAL_SESSION","callback id",e,"session",i)}catch(i){await((s=this.stateChangeEmitters.get(e))===null||s===void 0?void 0:s.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",e,"error",i),console.error(i)}})}async resetPasswordForEmail(e,t={}){let n=null,s=null;this.flowType==="pkce"&&([n,s]=await jf(this.storage,this.storageKey,!0));try{return await Mn(this.fetch,"POST",`${this.url}/recover`,{body:{email:e,code_challenge:n,code_challenge_method:s,gotrue_meta_security:{captcha_token:t.captchaToken}},headers:this.headers,redirectTo:t.redirectTo})}catch(i){if(fn(i))return{data:null,error:i};throw i}}async getUserIdentities(){var e;try{const{data:t,error:n}=await this.getUser();if(n)throw n;return{data:{identities:(e=t.user.identities)!==null&&e!==void 0?e:[]},error:null}}catch(t){if(fn(t))return{data:null,error:t};throw t}}async linkIdentity(e){var t;try{const{data:n,error:s}=await this._useSession(async i=>{var o,a,c,d,f;const{data:m,error:v}=i;if(v)throw v;const x=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,e.provider,{redirectTo:(o=e.options)===null||o===void 0?void 0:o.redirectTo,scopes:(a=e.options)===null||a===void 0?void 0:a.scopes,queryParams:(c=e.options)===null||c===void 0?void 0:c.queryParams,skipBrowserRedirect:!0});return await Mn(this.fetch,"GET",x,{headers:this.headers,jwt:(f=(d=m.session)===null||d===void 0?void 0:d.access_token)!==null&&f!==void 0?f:void 0})});if(s)throw s;return Qo()&&!(!((t=e.options)===null||t===void 0)&&t.skipBrowserRedirect)&&window.location.assign(n==null?void 0:n.url),{data:{provider:e.provider,url:n==null?void 0:n.url},error:null}}catch(n){if(fn(n))return{data:{provider:e.provider,url:null},error:n};throw n}}async unlinkIdentity(e){try{return await this._useSession(async t=>{var n,s;const{data:i,error:o}=t;if(o)throw o;return await Mn(this.fetch,"DELETE",`${this.url}/user/identities/${e.identity_id}`,{headers:this.headers,jwt:(s=(n=i.session)===null||n===void 0?void 0:n.access_token)!==null&&s!==void 0?s:void 0})})}catch(t){if(fn(t))return{data:null,error:t};throw t}}async _refreshAccessToken(e){const t=`#_refreshAccessToken(${e.substring(0,5)}...)`;this._debug(t,"begin");try{const n=Date.now();return await vz(async s=>(s>0&&await gz(200*Math.pow(2,s-1)),this._debug(t,"refreshing attempt",s),await Mn(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:e},headers:this.headers,xform:jl})),(s,i)=>{const o=200*Math.pow(2,s);return i&&b1(i)&&Date.now()+o-n<dp})}catch(n){if(this._debug(t,"error",n),fn(n))return{data:{session:null,user:null},error:n};throw n}finally{this._debug(t,"end")}}_isValidSession(e){return typeof e=="object"&&e!==null&&"access_token"in e&&"refresh_token"in e&&"expires_at"in e}async _handleProviderSignIn(e,t){const n=await this._getUrlForProvider(`${this.url}/authorize`,e,{redirectTo:t.redirectTo,scopes:t.scopes,queryParams:t.queryParams});return this._debug("#_handleProviderSignIn()","provider",e,"options",t,"url",n),Qo()&&!t.skipBrowserRedirect&&window.location.assign(n),{data:{provider:e,url:n},error:null}}async _recoverAndRefresh(){var e;const t="#_recoverAndRefresh()";this._debug(t,"begin");try{const n=await ix(this.storage,this.storageKey);if(this._debug(t,"session from storage",n),!this._isValidSession(n)){this._debug(t,"session is not valid"),n!==null&&await this._removeSession();return}const s=((e=n.expires_at)!==null&&e!==void 0?e:1/0)*1e3-Date.now()<S1;if(this._debug(t,`session has${s?"":" not"} expired with margin of ${S1}s`),s){if(this.autoRefreshToken&&n.refresh_token){const{error:i}=await this._callRefreshToken(n.refresh_token);i&&(console.error(i),b1(i)||(this._debug(t,"refresh failed with a non-retryable error, removing the session",i),await this._removeSession()))}}else await this._notifyAllSubscribers("SIGNED_IN",n)}catch(n){this._debug(t,"error",n),console.error(n);return}finally{this._debug(t,"end")}}async _callRefreshToken(e){var t,n;if(!e)throw new qc;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const s=`#_callRefreshToken(${e.substring(0,5)}...)`;this._debug(s,"begin");try{this.refreshingDeferred=new D_;const{data:i,error:o}=await this._refreshAccessToken(e);if(o)throw o;if(!i.session)throw new qc;await this._saveSession(i.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",i.session);const a={session:i.session,error:null};return this.refreshingDeferred.resolve(a),a}catch(i){if(this._debug(s,"error",i),fn(i)){const o={session:null,error:i};return b1(i)||await this._removeSession(),(t=this.refreshingDeferred)===null||t===void 0||t.resolve(o),o}throw(n=this.refreshingDeferred)===null||n===void 0||n.reject(i),i}finally{this.refreshingDeferred=null,this._debug(s,"end")}}async _notifyAllSubscribers(e,t,n=!0){const s=`#_notifyAllSubscribers(${e})`;this._debug(s,"begin",t,`broadcast = ${n}`);try{this.broadcastChannel&&n&&this.broadcastChannel.postMessage({event:e,session:t});const i=[],o=Array.from(this.stateChangeEmitters.values()).map(async a=>{try{await a.callback(e,t)}catch(c){i.push(c)}});if(await Promise.all(o),i.length>0){for(let a=0;a<i.length;a+=1)console.error(i[a]);throw i[0]}}finally{this._debug(s,"end")}}async _saveSession(e){this._debug("#_saveSession()",e),this.suppressGetSessionWarning=!0,await N3(this.storage,this.storageKey,e)}async _removeSession(){this._debug("#_removeSession()"),await ox(this.storage,this.storageKey),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const e=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{e&&Qo()&&(window!=null&&window.removeEventListener)&&window.removeEventListener("visibilitychange",e)}catch(t){console.error("removing visibilitychange callback failed",t)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const e=setInterval(()=>this._autoRefreshTokenTick(),dp);this.autoRefreshTicker=e,e&&typeof e=="object"&&typeof e.unref=="function"?e.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(e),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const e=this.autoRefreshTicker;this.autoRefreshTicker=null,e&&clearInterval(e)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const e=Date.now();try{return await this._useSession(async t=>{const{data:{session:n}}=t;if(!n||!n.refresh_token||!n.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const s=Math.floor((n.expires_at*1e3-e)/dp);this._debug("#_autoRefreshTokenTick()",`access token expires in ${s} ticks, a tick lasts ${dp}ms, refresh threshold is ${xb} ticks`),s<=xb&&await this._callRefreshToken(n.refresh_token)})}catch(t){console.error("Auto refresh tick failed with error. This is likely a transient error.",t)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(e){if(e.isAcquireTimeout||e instanceof P3)this._debug("auto refresh token tick lock not available");else throw e}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!Qo()||!(window!=null&&window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window==null||window.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(e){console.error("_handleVisibilityChange",e)}}async _onVisibilityChanged(e){const t=`#_onVisibilityChanged(${e})`;this._debug(t,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),e||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!=="visible"){this._debug(t,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(e,t,n){const s=[`provider=${encodeURIComponent(t)}`];if(n!=null&&n.redirectTo&&s.push(`redirect_to=${encodeURIComponent(n.redirectTo)}`),n!=null&&n.scopes&&s.push(`scopes=${encodeURIComponent(n.scopes)}`),this.flowType==="pkce"){const[i,o]=await jf(this.storage,this.storageKey),a=new URLSearchParams({code_challenge:`${encodeURIComponent(i)}`,code_challenge_method:`${encodeURIComponent(o)}`});s.push(a.toString())}if(n!=null&&n.queryParams){const i=new URLSearchParams(n.queryParams);s.push(i.toString())}return n!=null&&n.skipBrowserRedirect&&s.push(`skip_http_redirect=${n.skipBrowserRedirect}`),`${e}?${s.join("&")}`}async _unenroll(e){try{return await this._useSession(async t=>{var n;const{data:s,error:i}=t;return i?{data:null,error:i}:await Mn(this.fetch,"DELETE",`${this.url}/factors/${e.factorId}`,{headers:this.headers,jwt:(n=s==null?void 0:s.session)===null||n===void 0?void 0:n.access_token})})}catch(t){if(fn(t))return{data:null,error:t};throw t}}async _enroll(e){try{return await this._useSession(async t=>{var n,s;const{data:i,error:o}=t;if(o)return{data:null,error:o};const a=Object.assign({friendly_name:e.friendlyName,factor_type:e.factorType},e.factorType==="phone"?{phone:e.phone}:{issuer:e.issuer}),{data:c,error:d}=await Mn(this.fetch,"POST",`${this.url}/factors`,{body:a,headers:this.headers,jwt:(n=i==null?void 0:i.session)===null||n===void 0?void 0:n.access_token});return d?{data:null,error:d}:(e.factorType==="totp"&&(!((s=c==null?void 0:c.totp)===null||s===void 0)&&s.qr_code)&&(c.totp.qr_code=`data:image/svg+xml;utf-8,${c.totp.qr_code}`),{data:c,error:null})})}catch(t){if(fn(t))return{data:null,error:t};throw t}}async _verify(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async t=>{var n;const{data:s,error:i}=t;if(i)return{data:null,error:i};const{data:o,error:a}=await Mn(this.fetch,"POST",`${this.url}/factors/${e.factorId}/verify`,{body:{code:e.code,challenge_id:e.challengeId},headers:this.headers,jwt:(n=s==null?void 0:s.session)===null||n===void 0?void 0:n.access_token});return a?{data:null,error:a}:(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+o.expires_in},o)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",o),{data:o,error:a})})}catch(t){if(fn(t))return{data:null,error:t};throw t}})}async _challenge(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async t=>{var n;const{data:s,error:i}=t;return i?{data:null,error:i}:await Mn(this.fetch,"POST",`${this.url}/factors/${e.factorId}/challenge`,{body:{channel:e.channel},headers:this.headers,jwt:(n=s==null?void 0:s.session)===null||n===void 0?void 0:n.access_token})})}catch(t){if(fn(t))return{data:null,error:t};throw t}})}async _challengeAndVerify(e){const{data:t,error:n}=await this._challenge({factorId:e.factorId});return n?{data:null,error:n}:await this._verify({factorId:e.factorId,challengeId:t.id,code:e.code})}async _listFactors(){const{data:{user:e},error:t}=await this.getUser();if(t)return{data:null,error:t};const n=(e==null?void 0:e.factors)||[],s=n.filter(o=>o.factor_type==="totp"&&o.status==="verified"),i=n.filter(o=>o.factor_type==="phone"&&o.status==="verified");return{data:{all:n,totp:s,phone:i},error:null}}async _getAuthenticatorAssuranceLevel(){return this._acquireLock(-1,async()=>await this._useSession(async e=>{var t,n;const{data:{session:s},error:i}=e;if(i)return{data:null,error:i};if(!s)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:o}=E1(s.access_token);let a=null;o.aal&&(a=o.aal);let c=a;((n=(t=s.user.factors)===null||t===void 0?void 0:t.filter(m=>m.status==="verified"))!==null&&n!==void 0?n:[]).length>0&&(c="aal2");const f=o.amr||[];return{data:{currentLevel:a,nextLevel:c,currentAuthenticationMethods:f},error:null}}))}async fetchJwk(e,t={keys:[]}){let n=t.keys.find(o=>o.kid===e);if(n||(n=this.jwks.keys.find(o=>o.kid===e),n&&this.jwks_cached_at+ez>Date.now()))return n;const{data:s,error:i}=await Mn(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(i)throw i;if(!s.keys||s.keys.length===0)throw new Hg("JWKS is empty");if(this.jwks=s,this.jwks_cached_at=Date.now(),n=s.keys.find(o=>o.kid===e),!n)throw new Hg("No matching signing key found in JWKS");return n}async getClaims(e,t={keys:[]}){try{let n=e;if(!n){const{data:x,error:_}=await this.getSession();if(_||!x.session)return{data:null,error:_};n=x.session.access_token}const{header:s,payload:i,signature:o,raw:{header:a,payload:c}}=E1(n);if(Ez(i.exp),!s.kid||s.alg==="HS256"||!("crypto"in globalThis&&"subtle"in globalThis.crypto)){const{error:x}=await this.getUser(n);if(x)throw x;return{data:{claims:i,header:s,signature:o},error:null}}const d=Mz(s.alg),f=await this.fetchJwk(s.kid,t),m=await crypto.subtle.importKey("jwk",f,d,!0,["verify"]);if(!await crypto.subtle.verify(d,m,o,uz(`${a}.${c}`)))throw new Hg("Invalid JWT signature");return{data:{claims:i,header:s,signature:o},error:null}}catch(n){if(fn(n))return{data:null,error:n};throw n}}}u0.nextInstanceID=0;const Vz=u0;class Hz extends Vz{constructor(e){super(e)}}var Gz=function(r,e,t,n){function s(i){return i instanceof t?i:new t(function(o){o(i)})}return new(t||(t=Promise))(function(i,o){function a(f){try{d(n.next(f))}catch(m){o(m)}}function c(f){try{d(n.throw(f))}catch(m){o(m)}}function d(f){f.done?i(f.value):s(f.value).then(a,c)}d((n=n.apply(r,e||[])).next())})};class Wz{constructor(e,t,n){var s,i,o;if(this.supabaseUrl=e,this.supabaseKey=t,!e)throw new Error("supabaseUrl is required.");if(!t)throw new Error("supabaseKey is required.");const a=XB(e),c=new URL(a);this.realtimeUrl=new URL("realtime/v1",c),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",c),this.storageUrl=new URL("storage/v1",c),this.functionsUrl=new URL("functions/v1",c);const d=`sb-${c.hostname.split(".")[0]}-auth-token`,f={db:BB,realtime:VB,auth:Object.assign(Object.assign({},zB),{storageKey:d}),global:UB},m=YB(n??{},f);this.storageKey=(s=m.auth.storageKey)!==null&&s!==void 0?s:"",this.headers=(i=m.global.headers)!==null&&i!==void 0?i:{},m.accessToken?(this.accessToken=m.accessToken,this.auth=new Proxy({},{get:(v,x)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(x)} is not possible`)}})):this.auth=this._initSupabaseAuthClient((o=m.auth)!==null&&o!==void 0?o:{},this.headers,m.global.fetch),this.fetch=$B(t,this._getAccessToken.bind(this),m.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers,accessToken:this._getAccessToken.bind(this)},m.realtime)),this.rest=new lB(new URL("rest/v1",c).href,{headers:this.headers,schema:m.db.schema,fetch:this.fetch}),m.accessToken||this._listenForAuthEvents()}get functions(){return new K6(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}get storage(){return new OB(this.storageUrl.href,this.headers,this.fetch)}from(e){return this.rest.from(e)}schema(e){return this.rest.schema(e)}rpc(e,t={},n={}){return this.rest.rpc(e,t,n)}channel(e,t={config:{}}){return this.realtime.channel(e,t)}getChannels(){return this.realtime.getChannels()}removeChannel(e){return this.realtime.removeChannel(e)}removeAllChannels(){return this.realtime.removeAllChannels()}_getAccessToken(){var e,t;return Gz(this,void 0,void 0,function*(){if(this.accessToken)return yield this.accessToken();const{data:n}=yield this.auth.getSession();return(t=(e=n.session)===null||e===void 0?void 0:e.access_token)!==null&&t!==void 0?t:null})}_initSupabaseAuthClient({autoRefreshToken:e,persistSession:t,detectSessionInUrl:n,storage:s,storageKey:i,flowType:o,lock:a,debug:c},d,f){const m={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new Hz({url:this.authUrl.href,headers:Object.assign(Object.assign({},m),d),storageKey:i,autoRefreshToken:e,persistSession:t,detectSessionInUrl:n,storage:s,flowType:o,lock:a,debug:c,fetch:f,hasCustomAuthorizationHeader:"Authorization"in this.headers})}_initRealtimeClient(e){return new bB(this.realtimeUrl.href,Object.assign(Object.assign({},e),{params:Object.assign({apikey:this.supabaseKey},e==null?void 0:e.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((t,n)=>{this._handleTokenChanged(t,"CLIENT",n==null?void 0:n.access_token)})}_handleTokenChanged(e,t,n){(e==="TOKEN_REFRESHED"||e==="SIGNED_IN")&&this.changedAccessToken!==n?this.changedAccessToken=n:e==="SIGNED_OUT"&&(this.realtime.setAuth(),t=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}}const $z=(r,e,t)=>new Wz(r,e,t),qz="https://jbjjpgmyvgsflwqtlxcw.supabase.co",Xz=`eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImpiampwZ215dmdzZmx3cXRseGN3Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTUxODk0MTEsImV4cCI6MjA3MDc2NTQxMX0.B95aWumabCyLi8TC7spPcZ5zdmYgNxC-LfcV7h1PmZQ
`,Un=$z(qz,Xz),Yz=M_("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),zt=R.forwardRef(({className:r,variant:e,size:t,asChild:n=!1,...s},i)=>{const o=n?rO:"button";return h.jsx(o,{className:Zt(Yz({variant:e,size:t,className:r})),ref:i,...s})});zt.displayName="Button";const Kz=({session:r})=>{const e=async()=>{await Un.auth.signOut()};return r?h.jsxs("div",{className:"min-h-screen bg-background",children:[h.jsxs("header",{className:"flex justify-between items-center p-4 border-b",children:[h.jsx("h1",{className:"text-2xl font-bold",children:"CandyStore"}),h.jsxs(zt,{variant:"ghost",onClick:e,children:[h.jsx(r5,{className:"mr-2 h-4 w-4"}),"Logout"]})]}),h.jsx("main",{children:h.jsx(R6,{context:{session:r}})})]}):h.jsx(TE,{to:"/login",replace:!0})};function ca(){return f6()}class _s extends Error{constructor(e,t){super(e),this.status=t,this.name="APIError"}}const Su=r=>new Promise(e=>setTimeout(e,r));async function I3(r,e={}){const n=await fetch(`http://localhost:3001${r}`,{headers:{"Content-Type":"application/json",...e.headers},...e});if(!n.ok){const s=await n.json().catch(()=>({}));throw new _s(s.error||`HTTP ${n.status}: ${n.statusText}`,n.status)}return n.json()}const Cy={Calculator:re.createElement(KO,{className:"h-8 w-8 text-muted-foreground"}),FlaskConical:re.createElement(t5,{className:"h-8 w-8 text-muted-foreground"}),Sigma:re.createElement(c5,{className:"h-8 w-8 text-muted-foreground"}),BookOpen:re.createElement(za,{className:"h-8 w-8 text-muted-foreground"}),PenSquare:re.createElement(u5,{className:"h-8 w-8 text-muted-foreground"})};async function Qz(r){try{await Su(500);const{data:e,error:t}=await Un.from("teachers").select("id").eq("email",r).single();if(t||!e)throw new _s("Teacher not found");const{data:n,error:s}=await Un.from("teacher_classes").select(`
        classes (
          id,
          name,
          icon_name
        )
      `).eq("teacher_id",e.id);if(s)throw new _s("Failed to fetch teacher classes");return(n==null?void 0:n.map(i=>({id:i.classes.id,name:i.classes.name,icon:Cy[i.classes.icon_name]||Cy.BookOpen})))||[]}catch(e){throw e instanceof _s?e:new _s("Failed to fetch teacher classes")}}async function k3(r){try{await Su(500);const{data:e,error:t}=await Un.from("class_students").select(`
        students (
          id,
          name,
          email
        )
      `).eq("class_id",r).order("students(name)");if(t)throw new _s("Failed to fetch class roster");return(e==null?void 0:e.map(n=>({id:n.students.id,name:n.students.name,email:n.students.email})))||[]}catch(e){throw e instanceof _s?e:new _s("Failed to fetch class roster")}}async function L_(r){try{await Su(200);const{data:e,error:t}=await Un.from("students").select("id, name, email").eq("id",r).single();return t||!e?null:{id:e.id,name:e.name,email:e.email}}catch(e){return console.error("Error fetching student:",e),null}}async function Jz(r){try{await Su(200);const{data:e,error:t}=await Un.from("students").select("id, name, email").eq("email",r).single();return t||!e?null:{id:e.id,name:e.name,email:e.email}}catch(e){return console.error("Error fetching student by email:",e),null}}async function Zz(r){try{await Su(500);const{data:e,error:t}=await Un.from("classes").select("name, icon_name").eq("id",r).single();return t||!e?null:{name:e.name,icon:Cy[e.icon_name]||Cy.BookOpen}}catch(e){return console.error("Error fetching class info:",e),null}}async function e8(r){try{await Su(200);const e=await fetch(`http://localhost:3001/api/students/${r}/performance`);if(!e.ok)throw new _s("Failed to fetch game results");return await e.json()}catch(e){throw e instanceof _s?e:new _s("Failed to fetch game results")}}async function D3(r){try{await Su(200);const{data:e,error:t}=await Un.from("game_room_assignments").select("*").eq("student_id",r).eq("status","active").order("created_at",{ascending:!1});if(t)throw new _s("Failed to fetch assigned games");return e||[]}catch(e){throw e instanceof _s?e:new _s("Failed to fetch assigned games")}}async function L3(r,e){try{await Su(200);const{data:t,error:n}=await Un.from("game_room_assignments").select("student_id").eq("room_id",r).eq("status","active").neq("student_id",e);if(n)throw new _s("Failed to fetch roommates");if(!t||t.length===0)return[];const s=t.map(o=>o.student_id),i=[];for(const o of s){const a=await L_(o);a&&i.push(a)}return i}catch(t){throw t instanceof _s?t:new _s("Failed to fetch roommates")}}async function t8(r){return I3("/api/question-attempts",{method:"POST",body:JSON.stringify(r)})}async function n8(r){return I3("/api/game-results",{method:"POST",body:JSON.stringify(r)})}function Kr({className:r,...e}){return h.jsx("div",{className:Zt("animate-pulse rounded-md bg-muted",r),...e})}const r8=()=>{const{session:r}=ca(),e=r.user.email,{data:t,isLoading:n,isError:s}=ki({queryKey:["teacherClasses",e],queryFn:()=>Qz(e),enabled:!!e});return n?h.jsxs("div",{className:"space-y-4",children:[h.jsxs("div",{children:[h.jsx("h2",{className:"text-3xl font-bold tracking-tight",children:"Your Classes"}),h.jsx("p",{className:"text-muted-foreground",children:"Loading your classes..."})]}),h.jsx("div",{className:"mt-6 grid gap-4 sm:grid-cols-2 lg:grid-cols-3",children:[...Array(3)].map((i,o)=>h.jsx(Kr,{className:"h-24 rounded-lg"},o))})]}):s?h.jsx("div",{children:"Error loading your classes. Please try again later."}):h.jsxs("div",{className:"space-y-4",children:[h.jsxs("div",{children:[h.jsx("h2",{className:"text-3xl font-bold tracking-tight",children:"Your Classes"}),h.jsx("p",{className:"text-muted-foreground",children:"Welcome! Select a class to get started."})]}),t&&t.length>0?h.jsx("div",{className:"mt-6 grid gap-4 sm:grid-cols-2 lg:grid-cols-3",children:t.map(i=>h.jsx(qa,{to:`/class/${i.id}`,children:h.jsx(Wt,{className:"cursor-pointer hover:bg-accent transition-colors h-full",children:h.jsx(or,{className:"flex flex-row items-center gap-4 space-y-0 p-4",children:h.jsx(ws,{children:i.name})})})},i.id))}):h.jsx(Wt,{className:"mt-6 p-8 flex justify-center items-center",children:h.jsx("p",{className:"text-muted-foreground",children:"You are not currently assigned to any classes."})})]})},O3=()=>{const{session:r}=ca(),{data:e,isLoading:t,isError:n}=ki({queryKey:["studentByEmail",r.user.email],queryFn:()=>Jz(r.user.email),enabled:!!r.user.email,retry:!1});return t?h.jsxs("div",{className:"p-8 space-y-4",children:[h.jsx(Kr,{className:"h-8 w-48"}),h.jsx(Kr,{className:"h-6 w-1/4"})]}):n||!e?(console.error(`No student record found for authenticated user: ${r.user.email}`),h.jsx("div",{className:"min-h-screen flex items-center justify-center bg-background p-4",children:h.jsxs("div",{className:"text-center",children:[h.jsx("h1",{className:"text-2xl font-bold mb-4",children:"Account Not Linked"}),h.jsx("p",{className:"text-muted-foreground mb-4",children:"We couldn't find a student profile associated with your account."}),h.jsx("p",{className:"text-sm text-muted-foreground",children:"Please contact your teacher if you believe this is an error."})]})})):h.jsx(TE,{to:`/dashboard/student/${e.id}`,replace:!0})},s8=["lane.cane@candystore.app","holly.pine@candystore.app"],i8=()=>{const{session:r}=ca();return s8.includes(r.user.email)?h.jsx(r8,{}):h.jsx(O3,{})};var $T,Yn="colors",ri="sizes",Rt="space",o8={gap:Rt,gridGap:Rt,columnGap:Rt,gridColumnGap:Rt,rowGap:Rt,gridRowGap:Rt,inset:Rt,insetBlock:Rt,insetBlockEnd:Rt,insetBlockStart:Rt,insetInline:Rt,insetInlineEnd:Rt,insetInlineStart:Rt,margin:Rt,marginTop:Rt,marginRight:Rt,marginBottom:Rt,marginLeft:Rt,marginBlock:Rt,marginBlockEnd:Rt,marginBlockStart:Rt,marginInline:Rt,marginInlineEnd:Rt,marginInlineStart:Rt,padding:Rt,paddingTop:Rt,paddingRight:Rt,paddingBottom:Rt,paddingLeft:Rt,paddingBlock:Rt,paddingBlockEnd:Rt,paddingBlockStart:Rt,paddingInline:Rt,paddingInlineEnd:Rt,paddingInlineStart:Rt,top:Rt,right:Rt,bottom:Rt,left:Rt,scrollMargin:Rt,scrollMarginTop:Rt,scrollMarginRight:Rt,scrollMarginBottom:Rt,scrollMarginLeft:Rt,scrollMarginX:Rt,scrollMarginY:Rt,scrollMarginBlock:Rt,scrollMarginBlockEnd:Rt,scrollMarginBlockStart:Rt,scrollMarginInline:Rt,scrollMarginInlineEnd:Rt,scrollMarginInlineStart:Rt,scrollPadding:Rt,scrollPaddingTop:Rt,scrollPaddingRight:Rt,scrollPaddingBottom:Rt,scrollPaddingLeft:Rt,scrollPaddingX:Rt,scrollPaddingY:Rt,scrollPaddingBlock:Rt,scrollPaddingBlockEnd:Rt,scrollPaddingBlockStart:Rt,scrollPaddingInline:Rt,scrollPaddingInlineEnd:Rt,scrollPaddingInlineStart:Rt,fontSize:"fontSizes",background:Yn,backgroundColor:Yn,backgroundImage:Yn,borderImage:Yn,border:Yn,borderBlock:Yn,borderBlockEnd:Yn,borderBlockStart:Yn,borderBottom:Yn,borderBottomColor:Yn,borderColor:Yn,borderInline:Yn,borderInlineEnd:Yn,borderInlineStart:Yn,borderLeft:Yn,borderLeftColor:Yn,borderRight:Yn,borderRightColor:Yn,borderTop:Yn,borderTopColor:Yn,caretColor:Yn,color:Yn,columnRuleColor:Yn,fill:Yn,outline:Yn,outlineColor:Yn,stroke:Yn,textDecorationColor:Yn,fontFamily:"fonts",fontWeight:"fontWeights",lineHeight:"lineHeights",letterSpacing:"letterSpacings",blockSize:ri,minBlockSize:ri,maxBlockSize:ri,inlineSize:ri,minInlineSize:ri,maxInlineSize:ri,width:ri,minWidth:ri,maxWidth:ri,height:ri,minHeight:ri,maxHeight:ri,flexBasis:ri,gridTemplateColumns:ri,gridTemplateRows:ri,borderWidth:"borderWidths",borderTopWidth:"borderWidths",borderRightWidth:"borderWidths",borderBottomWidth:"borderWidths",borderLeftWidth:"borderWidths",borderStyle:"borderStyles",borderTopStyle:"borderStyles",borderRightStyle:"borderStyles",borderBottomStyle:"borderStyles",borderLeftStyle:"borderStyles",borderRadius:"radii",borderTopLeftRadius:"radii",borderTopRightRadius:"radii",borderBottomRightRadius:"radii",borderBottomLeftRadius:"radii",boxShadow:"shadows",textShadow:"shadows",transition:"transitions",zIndex:"zIndices"},a8=(r,e)=>typeof e=="function"?{"()":Function.prototype.toString.call(e)}:e,B0=()=>{const r=Object.create(null);return(e,t,...n)=>{const s=(i=>JSON.stringify(i,a8))(e);return s in r?r[s]:r[s]=t(e,...n)}},uy=Symbol.for("sxs.internal"),kE=(r,e)=>Object.defineProperties(r,Object.getOwnPropertyDescriptors(e)),qT=r=>{for(const e in r)return!0;return!1},{hasOwnProperty:l8}=Object.prototype,wb=r=>r.includes("-")?r:r.replace(/[A-Z]/g,e=>"-"+e.toLowerCase()),c8=/\s+(?![^()]*\))/,Bf=r=>e=>r(...typeof e=="string"?String(e).split(c8):[e]),XT={appearance:r=>({WebkitAppearance:r,appearance:r}),backfaceVisibility:r=>({WebkitBackfaceVisibility:r,backfaceVisibility:r}),backdropFilter:r=>({WebkitBackdropFilter:r,backdropFilter:r}),backgroundClip:r=>({WebkitBackgroundClip:r,backgroundClip:r}),boxDecorationBreak:r=>({WebkitBoxDecorationBreak:r,boxDecorationBreak:r}),clipPath:r=>({WebkitClipPath:r,clipPath:r}),content:r=>({content:r.includes('"')||r.includes("'")||/^([A-Za-z]+\([^]*|[^]*-quote|inherit|initial|none|normal|revert|unset)$/.test(r)?r:`"${r}"`}),hyphens:r=>({WebkitHyphens:r,hyphens:r}),maskImage:r=>({WebkitMaskImage:r,maskImage:r}),maskSize:r=>({WebkitMaskSize:r,maskSize:r}),tabSize:r=>({MozTabSize:r,tabSize:r}),textSizeAdjust:r=>({WebkitTextSizeAdjust:r,textSizeAdjust:r}),userSelect:r=>({WebkitUserSelect:r,userSelect:r}),marginBlock:Bf((r,e)=>({marginBlockStart:r,marginBlockEnd:e||r})),marginInline:Bf((r,e)=>({marginInlineStart:r,marginInlineEnd:e||r})),maxSize:Bf((r,e)=>({maxBlockSize:r,maxInlineSize:e||r})),minSize:Bf((r,e)=>({minBlockSize:r,minInlineSize:e||r})),paddingBlock:Bf((r,e)=>({paddingBlockStart:r,paddingBlockEnd:e||r})),paddingInline:Bf((r,e)=>({paddingInlineStart:r,paddingInlineEnd:e||r}))},T1=/([\d.]+)([^]*)/,u8=(r,e)=>r.length?r.reduce((t,n)=>(t.push(...e.map(s=>s.includes("&")?s.replace(/&/g,/[ +>|~]/.test(n)&&/&.*&/.test(s)?`:is(${n})`:n):n+" "+s)),t),[]):e,d8=(r,e)=>r in h8&&typeof e=="string"?e.replace(/^((?:[^]*[^\w-])?)(fit-content|stretch)((?:[^\w-][^]*)?)$/,(t,n,s,i)=>n+(s==="stretch"?`-moz-available${i};${wb(r)}:${n}-webkit-fill-available`:`-moz-fit-content${i};${wb(r)}:${n}fit-content`)+i):String(e),h8={blockSize:1,height:1,inlineSize:1,maxBlockSize:1,maxHeight:1,maxInlineSize:1,maxWidth:1,minBlockSize:1,minHeight:1,minInlineSize:1,minWidth:1,width:1},Ql=r=>r?r+"-":"",j3=(r,e,t)=>r.replace(/([+-])?((?:\d+(?:\.\d*)?|\.\d+)(?:[Ee][+-]?\d+)?)?(\$|--)([$\w-]+)/g,(n,s,i,o,a)=>o=="$"==!!i?n:(s||o=="--"?"calc(":"")+"var(--"+(o==="$"?Ql(e)+(a.includes("$")?"":Ql(t))+a.replace(/\$/g,"-"):a)+")"+(s||o=="--"?"*"+(s||"")+(i||"1")+")":"")),f8=/\s*,\s*(?![^()]*\))/,p8=Object.prototype.toString,pp=(r,e,t,n,s)=>{let i,o,a;const c=(d,f,m)=>{let v,x;const _=b=>{for(v in b){const C=v.charCodeAt(0)===64,T=C&&Array.isArray(b[v])?b[v]:[b[v]];for(x of T){const A=/[A-Z]/.test(S=v)?S:S.replace(/-[^]/g,j=>j[1].toUpperCase()),k=typeof x=="object"&&x&&x.toString===p8&&(!n.utils[A]||!f.length);if(A in n.utils&&!k){const j=n.utils[A];if(j!==o){o=j,_(j(x)),o=null;continue}}else if(A in XT){const j=XT[A];if(j!==a){a=j,_(j(x)),a=null;continue}}if(C&&(w=v.slice(1)in n.media?"@media "+n.media[v.slice(1)]:v,v=w.replace(/\(\s*([\w-]+)\s*(=|<|<=|>|>=)\s*([\w-]+)\s*(?:(<|<=|>|>=)\s*([\w-]+)\s*)?\)/g,(j,D,L,O,I,B)=>{const W=T1.test(D),K=.0625*(W?-1:1),[ee,oe]=W?[O,D]:[D,O];return"("+(L[0]==="="?"":L[0]===">"===W?"max-":"min-")+ee+":"+(L[0]!=="="&&L.length===1?oe.replace(T1,(ne,ce,V)=>Number(ce)+K*(L===">"?1:-1)+V):oe)+(I?") and ("+(I[0]===">"?"min-":"max-")+ee+":"+(I.length===1?B.replace(T1,(ne,ce,V)=>Number(ce)+K*(I===">"?-1:1)+V):B):"")+")"})),k){const j=C?m.concat(v):[...m],D=C?[...f]:u8(f,v.split(f8));i!==void 0&&s(YT(...i)),i=void 0,c(x,D,j)}else i===void 0&&(i=[[],f,m]),v=C||v.charCodeAt(0)!==36?v:`--${Ql(n.prefix)}${v.slice(1).replace(/\$/g,"-")}`,x=k?x:typeof x=="number"?x&&A in m8?String(x)+"px":String(x):j3(d8(A,x??""),n.prefix,n.themeMap[A]),i[0].push(`${C?`${v} `:`${wb(v)}:`}${x}`)}}var w,S};_(d),i!==void 0&&s(YT(...i)),i=void 0};c(r,e,t)},YT=(r,e,t)=>`${t.map(n=>`${n}{`).join("")}${e.length?`${e.join(",")}{`:""}${r.join(";")}${e.length?"}":""}${Array(t.length?t.length+1:0).join("}")}`,m8={animationDelay:1,animationDuration:1,backgroundSize:1,blockSize:1,border:1,borderBlock:1,borderBlockEnd:1,borderBlockEndWidth:1,borderBlockStart:1,borderBlockStartWidth:1,borderBlockWidth:1,borderBottom:1,borderBottomLeftRadius:1,borderBottomRightRadius:1,borderBottomWidth:1,borderEndEndRadius:1,borderEndStartRadius:1,borderInlineEnd:1,borderInlineEndWidth:1,borderInlineStart:1,borderInlineStartWidth:1,borderInlineWidth:1,borderLeft:1,borderLeftWidth:1,borderRadius:1,borderRight:1,borderRightWidth:1,borderSpacing:1,borderStartEndRadius:1,borderStartStartRadius:1,borderTop:1,borderTopLeftRadius:1,borderTopRightRadius:1,borderTopWidth:1,borderWidth:1,bottom:1,columnGap:1,columnRule:1,columnRuleWidth:1,columnWidth:1,containIntrinsicSize:1,flexBasis:1,fontSize:1,gap:1,gridAutoColumns:1,gridAutoRows:1,gridTemplateColumns:1,gridTemplateRows:1,height:1,inlineSize:1,inset:1,insetBlock:1,insetBlockEnd:1,insetBlockStart:1,insetInline:1,insetInlineEnd:1,insetInlineStart:1,left:1,letterSpacing:1,margin:1,marginBlock:1,marginBlockEnd:1,marginBlockStart:1,marginBottom:1,marginInline:1,marginInlineEnd:1,marginInlineStart:1,marginLeft:1,marginRight:1,marginTop:1,maxBlockSize:1,maxHeight:1,maxInlineSize:1,maxWidth:1,minBlockSize:1,minHeight:1,minInlineSize:1,minWidth:1,offsetDistance:1,offsetRotate:1,outline:1,outlineOffset:1,outlineWidth:1,overflowClipMargin:1,padding:1,paddingBlock:1,paddingBlockEnd:1,paddingBlockStart:1,paddingBottom:1,paddingInline:1,paddingInlineEnd:1,paddingInlineStart:1,paddingLeft:1,paddingRight:1,paddingTop:1,perspective:1,right:1,rowGap:1,scrollMargin:1,scrollMarginBlock:1,scrollMarginBlockEnd:1,scrollMarginBlockStart:1,scrollMarginBottom:1,scrollMarginInline:1,scrollMarginInlineEnd:1,scrollMarginInlineStart:1,scrollMarginLeft:1,scrollMarginRight:1,scrollMarginTop:1,scrollPadding:1,scrollPaddingBlock:1,scrollPaddingBlockEnd:1,scrollPaddingBlockStart:1,scrollPaddingBottom:1,scrollPaddingInline:1,scrollPaddingInlineEnd:1,scrollPaddingInlineStart:1,scrollPaddingLeft:1,scrollPaddingRight:1,scrollPaddingTop:1,shapeMargin:1,textDecoration:1,textDecorationThickness:1,textIndent:1,textUnderlineOffset:1,top:1,transitionDelay:1,transitionDuration:1,verticalAlign:1,width:1,wordSpacing:1},KT=r=>String.fromCharCode(r+(r>25?39:97)),Kd=r=>(e=>{let t,n="";for(t=Math.abs(e);t>52;t=t/52|0)n=KT(t%52)+n;return KT(t%52)+n})(((e,t)=>{let n=t.length;for(;n;)e=33*e^t.charCodeAt(--n);return e})(5381,JSON.stringify(r))>>>0),kg=["themed","global","styled","onevar","resonevar","allvar","inline"],g8=r=>{if(r.href&&!r.href.startsWith(location.origin))return!1;try{return!!r.cssRules}catch{return!1}},v8=r=>{let e;const t=()=>{const{cssRules:s}=e.sheet;return[].map.call(s,(i,o)=>{const{cssText:a}=i;let c="";if(a.startsWith("--sxs"))return"";if(s[o-1]&&(c=s[o-1].cssText).startsWith("--sxs")){if(!i.cssRules.length)return"";for(const d in e.rules)if(e.rules[d].group===i)return`--sxs{--sxs:${[...e.rules[d].cache].join(" ")}}${a}`;return i.cssRules.length?`${c}${a}`:""}return a}).join("")},n=()=>{if(e){const{rules:a,sheet:c}=e;if(!c.deleteRule){for(;Object(Object(c.cssRules)[0]).type===3;)c.cssRules.splice(0,1);c.cssRules=[]}for(const d in a)delete a[d]}const s=Object(r).styleSheets||[];for(const a of s)if(g8(a)){for(let c=0,d=a.cssRules;d[c];++c){const f=Object(d[c]);if(f.type!==1)continue;const m=Object(d[c+1]);if(m.type!==4)continue;++c;const{cssText:v}=f;if(!v.startsWith("--sxs"))continue;const x=v.slice(14,-3).trim().split(/\s+/),_=kg[x[0]];_&&(e||(e={sheet:a,reset:n,rules:{},toString:t}),e.rules[_]={group:m,index:c,cache:new Set(x)})}if(e)break}if(!e){const a=(c,d)=>({type:d,cssRules:[],insertRule(f,m){this.cssRules.splice(m,0,a(f,{import:3,undefined:1}[(f.toLowerCase().match(/^@([a-z]+)/)||[])[1]]||4))},get cssText(){return c==="@media{}"?`@media{${[].map.call(this.cssRules,f=>f.cssText).join("")}}`:c}});e={sheet:r?(r.head||r).appendChild(document.createElement("style")).sheet:a("","text/css"),rules:{},reset:n,toString:t}}const{sheet:i,rules:o}=e;for(let a=kg.length-1;a>=0;--a){const c=kg[a];if(!o[c]){const d=kg[a+1],f=o[d]?o[d].index:i.cssRules.length;i.insertRule("@media{}",f),i.insertRule(`--sxs{--sxs:${a}}`,f),o[c]={group:i.cssRules[f+1],index:f,cache:new Set([a])}}x8(o[c])}};return n(),e},x8=r=>{const e=r.group;let t=e.cssRules.length;r.apply=n=>{try{e.insertRule(n,t),++t}catch{}}},gg=Symbol(),y8=B0(),_8=(r,e)=>y8(r,()=>(...t)=>{let n={type:null,composers:new Set};for(const s of t)if(s!=null)if(s[uy]){n.type==null&&(n.type=s[uy].type);for(const i of s[uy].composers)n.composers.add(i)}else s.constructor!==Object||s.$$typeof?n.type==null&&(n.type=s):n.composers.add(w8(s,r));return n.type==null&&(n.type="span"),n.composers.size||n.composers.add(["PJLV",{},[],[],{},[]]),S8(r,n,e)}),w8=({variants:r,compoundVariants:e,defaultVariants:t,...n},s)=>{const i=`${Ql(s.prefix)}c-${Kd(n)}`,o=[],a=[],c=Object.create(null),d=[];for(const v in t)c[v]=String(t[v]);if(typeof r=="object"&&r)for(const v in r){f=c,m=v,l8.call(f,m)||(c[v]="undefined");const x=r[v];for(const _ in x){const b={[v]:String(_)};String(_)==="undefined"&&d.push(v);const w=x[_],S=[b,w,!qT(w)];o.push(S)}}var f,m;if(typeof e=="object"&&e)for(const v of e){let{css:x,..._}=v;x=typeof x=="object"&&x||{};for(const w in _)_[w]=String(_[w]);const b=[_,x,!qT(x)];a.push(b)}return[i,n,o,a,c,d]},S8=(r,e,t)=>{const[n,s,i,o]=b8(e.composers),a=typeof e.type=="function"||e.type.$$typeof?(m=>{function v(){for(let x=0;x<v[gg].length;x++){const[_,b]=v[gg][x];m.rules[_].apply(b)}return v[gg]=[],null}return v[gg]=[],v.rules={},kg.forEach(x=>v.rules[x]={apply:_=>v[gg].push([x,_])}),v})(t):null,c=(a||t).rules,d=`.${n}${s.length>1?`:where(.${s.slice(1).join(".")})`:""}`,f=m=>{m=typeof m=="object"&&m||E8;const{css:v,...x}=m,_={};for(const S in i)if(delete x[S],S in m){let C=m[S];typeof C=="object"&&C?_[S]={"@initial":i[S],...C}:(C=String(C),_[S]=C!=="undefined"||o.has(S)?C:i[S])}else _[S]=i[S];const b=new Set([...s]);for(const[S,C,T,A]of e.composers){t.rules.styled.cache.has(S)||(t.rules.styled.cache.add(S),pp(C,[`.${S}`],[],r,D=>{c.styled.apply(D)}));const k=QT(T,_,r.media),j=QT(A,_,r.media,!0);for(const D of k)if(D!==void 0)for(const[L,O,I]of D){const B=`${S}-${Kd(O)}-${L}`;b.add(B);const W=(I?t.rules.resonevar:t.rules.onevar).cache,K=I?c.resonevar:c.onevar;W.has(B)||(W.add(B),pp(O,[`.${B}`],[],r,ee=>{K.apply(ee)}))}for(const D of j)if(D!==void 0)for(const[L,O]of D){const I=`${S}-${Kd(O)}-${L}`;b.add(I),t.rules.allvar.cache.has(I)||(t.rules.allvar.cache.add(I),pp(O,[`.${I}`],[],r,B=>{c.allvar.apply(B)}))}}if(typeof v=="object"&&v){const S=`${n}-i${Kd(v)}-css`;b.add(S),t.rules.inline.cache.has(S)||(t.rules.inline.cache.add(S),pp(v,[`.${S}`],[],r,C=>{c.inline.apply(C)}))}for(const S of String(m.className||"").trim().split(/\s+/))S&&b.add(S);const w=x.className=[...b].join(" ");return{type:e.type,className:w,selector:d,props:x,toString:()=>w,deferredInjector:a}};return kE(f,{className:n,selector:d,[uy]:e,toString:()=>(t.rules.styled.cache.has(n)||f(),n)})},b8=r=>{let e="";const t=[],n={},s=[];for(const[i,,,,o,a]of r){e===""&&(e=i),t.push(i),s.push(...a);for(const c in o){const d=o[c];(n[c]===void 0||d!=="undefined"||a.includes(d))&&(n[c]=d)}}return[e,t,n,new Set(s)]},QT=(r,e,t,n)=>{const s=[];e:for(let[i,o,a]of r){if(a)continue;let c,d=0,f=!1;for(c in i){const m=i[c];let v=e[c];if(v!==m){if(typeof v!="object"||!v)continue e;{let x,_,b=0;for(const w in v){if(m===String(v[w])){if(w!=="@initial"){const S=w.slice(1);(_=_||[]).push(S in t?t[S]:w.replace(/^@media ?/,"")),f=!0}d+=b,x=!0}++b}if(_&&_.length&&(o={["@media "+_.join(", ")]:o}),!x)continue e}}}(s[d]=s[d]||[]).push([n?"cv":`${c}-${i[c]}`,o,f])}return s},E8={},M8=B0(),T8=(r,e)=>M8(r,()=>(...t)=>{const n=()=>{for(let s of t){s=typeof s=="object"&&s||{};let i=Kd(s);if(!e.rules.global.cache.has(i)){if(e.rules.global.cache.add(i),"@import"in s){let o=[].indexOf.call(e.sheet.cssRules,e.rules.themed.group)-1;for(let a of[].concat(s["@import"]))a=a.includes('"')||a.includes("'")?a:`"${a}"`,e.sheet.insertRule(`@import ${a};`,o++);delete s["@import"]}pp(s,[],[],r,o=>{e.rules.global.apply(o)})}}return""};return kE(n,{toString:n})}),C8=B0(),A8=(r,e)=>C8(r,()=>t=>{const n=`${Ql(r.prefix)}k-${Kd(t)}`,s=()=>{if(!e.rules.global.cache.has(n)){e.rules.global.cache.add(n);const i=[];pp(t,[],[],r,a=>i.push(a));const o=`@keyframes ${n}{${i.join("")}}`;e.rules.global.apply(o)}return n};return kE(s,{get name(){return s()},toString:s})}),R8=class{constructor(e,t,n,s){this.token=e==null?"":String(e),this.value=t==null?"":String(t),this.scale=n==null?"":String(n),this.prefix=s==null?"":String(s)}get computedValue(){return"var("+this.variable+")"}get variable(){return"--"+Ql(this.prefix)+Ql(this.scale)+this.token}toString(){return this.computedValue}},N8=B0(),P8=(r,e)=>N8(r,()=>(t,n)=>{n=typeof t=="object"&&t||Object(n);const s=`.${t=(t=typeof t=="string"?t:"")||`${Ql(r.prefix)}t-${Kd(n)}`}`,i={},o=[];for(const c in n){i[c]={};for(const d in n[c]){const f=`--${Ql(r.prefix)}${c}-${d}`,m=j3(String(n[c][d]),r.prefix,c);i[c][d]=new R8(d,m,c,r.prefix),o.push(`${f}:${m}`)}}const a=()=>{if(o.length&&!e.rules.themed.cache.has(t)){e.rules.themed.cache.add(t);const c=`${n===r.theme?":root,":""}.${t}{${o.join(";")}}`;e.rules.themed.apply(c)}return t};return{...i,get className(){return a()},selector:s,toString:a}}),I8=B0(),F3=r=>{let e=!1;const t=I8(r,n=>{e=!0;const s="prefix"in(n=typeof n=="object"&&n||{})?String(n.prefix):"",i=typeof n.media=="object"&&n.media||{},o=typeof n.root=="object"?n.root||null:globalThis.document||null,a=typeof n.theme=="object"&&n.theme||{},c={prefix:s,media:i,theme:a,themeMap:typeof n.themeMap=="object"&&n.themeMap||{...o8},utils:typeof n.utils=="object"&&n.utils||{}},d=v8(o),f={css:_8(c,d),globalCss:T8(c,d),keyframes:A8(c,d),createTheme:P8(c,d),reset(){d.reset(),f.theme.toString()},theme:{},sheet:d,config:c,prefix:s,getCssText:d.toString,toString:d.toString};return String(f.theme=f.createTheme(a)),f});return e||t.reset(),t},U3=()=>$T||($T=F3()),k8=(...r)=>U3().createTheme(...r),sc=(...r)=>U3().css(...r),D8={default:{colors:{brand:"hsl(153 60.0% 53.0%)",brandAccent:"hsl(154 54.8% 45.1%)",brandButtonText:"white",defaultButtonBackground:"white",defaultButtonBackgroundHover:"#eaeaea",defaultButtonBorder:"lightgray",defaultButtonText:"gray",dividerBackground:"#eaeaea",inputBackground:"transparent",inputBorder:"lightgray",inputBorderHover:"gray",inputBorderFocus:"gray",inputText:"black",inputLabelText:"gray",inputPlaceholder:"darkgray",messageText:"#2b805a",messageBackground:"#e7fcf1",messageBorder:"#d0f3e1",messageTextDanger:"#ff6369",messageBackgroundDanger:"#fff8f8",messageBorderDanger:"#822025",anchorTextColor:"gray",anchorTextHoverColor:"darkgray"},space:{spaceSmall:"4px",spaceMedium:"8px",spaceLarge:"16px",labelBottomMargin:"8px",anchorBottomMargin:"4px",emailInputSpacing:"4px",socialAuthSpacing:"4px",buttonPadding:"10px 15px",inputPadding:"10px 15px"},fontSizes:{baseBodySize:"13px",baseInputSize:"14px",baseLabelSize:"14px",baseButtonSize:"14px"},fonts:{bodyFontFamily:"ui-sans-serif, sans-serif",buttonFontFamily:"ui-sans-serif, sans-serif",inputFontFamily:"ui-sans-serif, sans-serif",labelFontFamily:"ui-sans-serif, sans-serif"},borderWidths:{buttonBorderWidth:"1px",inputBorderWidth:"1px"},radii:{borderRadiusButton:"4px",buttonBorderRadius:"4px",inputBorderRadius:"4px"}},dark:{colors:{brandButtonText:"white",defaultButtonBackground:"#2e2e2e",defaultButtonBackgroundHover:"#3e3e3e",defaultButtonBorder:"#3e3e3e",defaultButtonText:"white",dividerBackground:"#2e2e2e",inputBackground:"#1e1e1e",inputBorder:"#3e3e3e",inputBorderHover:"gray",inputBorderFocus:"gray",inputText:"white",inputPlaceholder:"darkgray",messageText:"#85e0b7",messageBackground:"#072719",messageBorder:"#2b805a",messageBackgroundDanger:"#1f1315"}}},Tr={SIGN_IN:"sign_in",SIGN_UP:"sign_up",FORGOTTEN_PASSWORD:"forgotten_password",MAGIC_LINK:"magic_link",UPDATE_PASSWORD:"update_password",VERIFY_OTP:"verify_otp"},L8="supabase-auth-ui",O8={ROOT:"root",SIGN_IN:Tr.SIGN_IN,SIGN_UP:Tr.SIGN_UP,FORGOTTEN_PASSWORD:Tr.FORGOTTEN_PASSWORD,MAGIC_LINK:Tr.MAGIC_LINK,UPDATE_PASSWORD:Tr.UPDATE_PASSWORD,anchor:"ui-anchor",button:"ui-button",container:"ui-container",divider:"ui-divider",input:"ui-input",label:"ui-label",loader:"ui-loader",message:"ui-message"};function xh(r,e,t){var n,s;const i=[],o=O8[r];return i.push(t!=null&&t.prependedClassName?(t==null?void 0:t.prependedClassName)+"_"+o:L8+"_"+o),(n=t==null?void 0:t.className)!=null&&n[r]&&i.push((s=t==null?void 0:t.className)==null?void 0:s[r]),((t==null?void 0:t.extend)===void 0||(t==null?void 0:t.extend)===!0)&&i.push(e),i}function Sb(r,e){let t;if(r&&e&&typeof r=="object"&&typeof e=="object"){if(Array.isArray(e))for(t=0;t<e.length;t++)r[t]=Sb(r[t],e[t]);else for(t in e)r[t]=Sb(r[t],e[t]);return r}return e}function C1(r,...e){let t=e.length;for(let n=0;n<t;n++)r=Sb(r,e[n]);return r}function j8(r,e){return r.replace(/{{(\w+)}}/g,(t,n)=>e.hasOwnProperty(n)?e[n]:t)}var F8={sign_up:{email_label:"Email address",password_label:"Create a Password",email_input_placeholder:"Your email address",password_input_placeholder:"Your password",button_label:"Sign up",loading_button_label:"Signing up ...",social_provider_text:"Sign in with {{provider}}",link_text:"Don't have an account? Sign up",confirmation_text:"Check your email for the confirmation link"},sign_in:{email_label:"Email address",password_label:"Your Password",email_input_placeholder:"Your email address",password_input_placeholder:"Your password",button_label:"Sign in",loading_button_label:"Signing in ...",social_provider_text:"Sign in with {{provider}}",link_text:"Already have an account? Sign in"},magic_link:{email_input_label:"Email address",email_input_placeholder:"Your email address",button_label:"Send Magic Link",loading_button_label:"Sending Magic Link ...",link_text:"Send a magic link email",confirmation_text:"Check your email for the magic link"},forgotten_password:{email_label:"Email address",password_label:"Your Password",email_input_placeholder:"Your email address",button_label:"Send reset password instructions",loading_button_label:"Sending reset instructions ...",link_text:"Forgot your password?",confirmation_text:"Check your email for the password reset link"},update_password:{password_label:"New password",password_input_placeholder:"Your new password",button_label:"Update password",loading_button_label:"Updating password ...",confirmation_text:"Your password has been updated"},verify_otp:{email_input_label:"Email address",email_input_placeholder:"Your email address",phone_input_label:"Phone number",phone_input_placeholder:"Your phone number",token_input_label:"Token",token_input_placeholder:"Your Otp token",button_label:"Verify token",loading_button_label:"Signing in ..."}};const U8=sc({fontFamily:"$bodyFontFamily",fontSize:"$baseBodySize",marginBottom:"$anchorBottomMargin",color:"$anchorTextColor",display:"block",textAlign:"center",textDecoration:"underline","&:hover":{color:"$anchorTextHoverColor"}}),Od=({children:r,appearance:e,...t})=>{var n;const s=xh("anchor",U8(),e);return re.createElement("a",{...t,style:(n=e==null?void 0:e.style)==null?void 0:n.anchor,className:s.join(" ")},r)},B8=sc({fontFamily:"$buttonFontFamily",display:"flex",alignItems:"center",justifyContent:"center",gap:"8px",borderRadius:"$borderRadiusButton",fontSize:"$baseButtonSize",padding:"$buttonPadding",cursor:"pointer",borderWidth:"$buttonBorderWidth",borderStyle:"solid",width:"100%",transitionProperty:"background-color",transitionTimingFunction:"cubic-bezier(0.4, 0, 0.2, 1)",transitionDuration:"100ms","&:disabled":{opacity:.7,cursor:"unset"},variants:{color:{default:{backgroundColor:"$defaultButtonBackground",color:"$defaultButtonText",borderColor:"$defaultButtonBorder","&:hover:not(:disabled)":{backgroundColor:"$defaultButtonBackgroundHover"}},primary:{backgroundColor:"$brand",color:"$brandButtonText",borderColor:"$brandAccent","&:hover:not(:disabled)":{backgroundColor:"$brandAccent"}}}}}),lm=({children:r,color:e="default",appearance:t,icon:n,loading:s=!1,...i})=>{var o;const a=xh("button",B8({color:e}),t);return re.createElement("button",{...i,style:(o=t==null?void 0:t.style)==null?void 0:o.button,className:a.join(" "),disabled:s},n,r)},z8=sc({display:"flex",gap:"4px",variants:{direction:{horizontal:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(48px, 1fr))"},vertical:{flexDirection:"column",margin:"8px 0"}},gap:{small:{gap:"4px"},medium:{gap:"8px"},large:{gap:"16px"}}}}),Fa=({children:r,appearance:e,...t})=>{var n;const s=xh("container",z8({direction:t.direction,gap:t.gap}),e);return re.createElement("div",{...t,style:(n=e==null?void 0:e.style)==null?void 0:n.container,className:s.join(" ")},r)},V8=sc({background:"$dividerBackground",display:"block",margin:"16px 0",height:"1px",width:"100%"}),H8=({children:r,appearance:e,...t})=>{var n;const s=xh("divider",V8(),e);return re.createElement("div",{...t,style:(n=e==null?void 0:e.style)==null?void 0:n.divider,className:s.join(" ")})},G8=sc({fontFamily:"$inputFontFamily",background:"$inputBackground",borderRadius:"$inputBorderRadius",padding:"$inputPadding",cursor:"text",borderWidth:"$inputBorderWidth",borderColor:"$inputBorder",borderStyle:"solid",fontSize:"$baseInputSize",width:"100%",color:"$inputText",boxSizing:"border-box","&:hover":{borderColor:"$inputBorderHover",outline:"none"},"&:focus":{borderColor:"$inputBorderFocus",outline:"none"},"&::placeholder":{color:"$inputPlaceholder",letterSpacing:"initial"},transitionProperty:"background-color, border",transitionTimingFunction:"cubic-bezier(0.4, 0, 0.2, 1)",transitionDuration:"100ms",variants:{type:{default:{letterSpacing:"0px"},password:{letterSpacing:"0px"}}}}),uu=({children:r,appearance:e,...t})=>{var n;const s=xh("input",G8({type:t.type==="password"?"password":"default"}),e);return re.createElement("input",{...t,style:(n=e==null?void 0:e.style)==null?void 0:n.input,className:s.join(" ")},r)},W8=sc({fontFamily:"$labelFontFamily",fontSize:"$baseLabelSize",marginBottom:"$labelBottomMargin",color:"$inputLabelText",display:"block"}),du=({children:r,appearance:e,...t})=>{var n;const s=xh("label",W8(),e);return re.createElement("label",{...t,style:(n=e==null?void 0:e.style)==null?void 0:n.label,className:s.join(" ")},r)},$8=sc({fontFamily:"$bodyFontFamily",fontSize:"$baseInputSize",marginBottom:"$labelBottomMargin",display:"block",textAlign:"center",borderRadius:"0.375rem",padding:"1.5rem 1rem",lineHeight:"1rem",color:"$messageText",backgroundColor:"$messageBackground",border:"1px solid $messageBorder",variants:{color:{danger:{color:"$messageTextDanger",backgroundColor:"$messageBackgroundDanger",border:"1px solid $messageBorderDanger"}}}}),Ha=({children:r,appearance:e,...t})=>{var n;const s=xh("message",$8({color:t.color}),e);return re.createElement("span",{...t,style:(n=e==null?void 0:e.style)==null?void 0:n.message,className:s.join(" ")},r)};function B3({setAuthView:r=()=>{},supabaseClient:e,redirectTo:t,i18n:n,appearance:s,showLinks:i=!1}){var o;const[a,c]=R.useState(""),[d,f]=R.useState(""),[m,v]=R.useState(""),[x,_]=R.useState(!1),b=async S=>{var C,T;if(S.preventDefault(),f(""),v(""),_(!0),a.length===0){f((C=n==null?void 0:n.magic_link)==null?void 0:C.empty_email_address),_(!1);return}const{error:A}=await e.auth.signInWithOtp({email:a,options:{emailRedirectTo:t}});A?f(A.message):v((T=n==null?void 0:n.magic_link)==null?void 0:T.confirmation_text),_(!1)},w=n==null?void 0:n.magic_link;return re.createElement("form",{id:"auth-magic-link",onSubmit:b},re.createElement(Fa,{gap:"large",direction:"vertical",appearance:s},re.createElement("div",null,re.createElement(du,{htmlFor:"email",appearance:s},w==null?void 0:w.email_input_label),re.createElement(uu,{id:"email",name:"email",type:"email",autoFocus:!0,placeholder:w==null?void 0:w.email_input_placeholder,onChange:S=>{f&&f(""),c(S.target.value)},appearance:s})),re.createElement(lm,{color:"primary",type:"submit",loading:x,appearance:s},x?w==null?void 0:w.loading_button_label:w==null?void 0:w.button_label),i&&re.createElement(Od,{href:"#auth-sign-in",onClick:S=>{S.preventDefault(),r(Tr.SIGN_IN)},appearance:s},(o=n==null?void 0:n.sign_in)==null?void 0:o.link_text),m&&re.createElement(Ha,{appearance:s},m),d&&re.createElement(Ha,{color:"danger",appearance:s},d)))}const Ms=sc({width:"21px",height:"21px"}),q8=({provider:r})=>r=="google"?X8():r=="facebook"?Y8():r=="twitter"?K8():r=="apple"?Q8():r=="github"?J8():r=="gitlab"?Z8():r=="bitbucket"?e9():r=="discord"?t9():r=="azure"?n9():r=="keycloak"?r9():r=="linkedin"?s9():r=="notion"?i9():r=="slack"?o9():r=="spotify"?a9():r=="twitch"?l9():r=="workos"?c9():r=="kakao"?u9():null,X8=()=>re.createElement("svg",{className:Ms(),xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 48 48",width:"21px",height:"21px"},re.createElement("path",{fill:"#FFC107",d:"M43.611,20.083H42V20H24v8h11.303c-1.649,4.657-6.08,8-11.303,8c-6.627,0-12-5.373-12-12c0-6.627,5.373-12,12-12c3.059,0,5.842,1.154,7.961,3.039l5.657-5.657C34.046,6.053,29.268,4,24,4C12.955,4,4,12.955,4,24c0,11.045,8.955,20,20,20c11.045,0,20-8.955,20-20C44,22.659,43.862,21.35,43.611,20.083z"}),re.createElement("path",{fill:"#FF3D00",d:"M6.306,14.691l6.571,4.819C14.655,15.108,18.961,12,24,12c3.059,0,5.842,1.154,7.961,3.039l5.657-5.657C34.046,6.053,29.268,4,24,4C16.318,4,9.656,8.337,6.306,14.691z"}),re.createElement("path",{fill:"#4CAF50",d:"M24,44c5.166,0,9.86-1.977,13.409-5.192l-6.19-5.238C29.211,35.091,26.715,36,24,36c-5.202,0-9.619-3.317-11.283-7.946l-6.522,5.025C9.505,39.556,16.227,44,24,44z"}),re.createElement("path",{fill:"#1976D2",d:"M43.611,20.083H42V20H24v8h11.303c-0.792,2.237-2.231,4.166-4.087,5.571c0.001-0.001,0.002-0.001,0.003-0.002l6.19,5.238C36.971,39.205,44,34,44,24C44,22.659,43.862,21.35,43.611,20.083z"})),Y8=()=>re.createElement("svg",{className:Ms(),xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 48 48",width:"21px",height:"21px"},re.createElement("path",{fill:"#039be5",d:"M24 5A19 19 0 1 0 24 43A19 19 0 1 0 24 5Z"}),re.createElement("path",{fill:"#fff",d:"M26.572,29.036h4.917l0.772-4.995h-5.69v-2.73c0-2.075,0.678-3.915,2.619-3.915h3.119v-4.359c-0.548-0.074-1.707-0.236-3.897-0.236c-4.573,0-7.254,2.415-7.254,7.917v3.323h-4.701v4.995h4.701v13.729C22.089,42.905,23.032,43,24,43c0.875,0,1.729-0.08,2.572-0.194V29.036z"})),K8=()=>re.createElement("svg",{className:Ms(),xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 48 48",width:"21px",height:"21px"},re.createElement("path",{fill:"#03A9F4",d:"M42,12.429c-1.323,0.586-2.746,0.977-4.247,1.162c1.526-0.906,2.7-2.351,3.251-4.058c-1.428,0.837-3.01,1.452-4.693,1.776C34.967,9.884,33.05,9,30.926,9c-4.08,0-7.387,3.278-7.387,7.32c0,0.572,0.067,1.129,0.193,1.67c-6.138-0.308-11.582-3.226-15.224-7.654c-0.64,1.082-1,2.349-1,3.686c0,2.541,1.301,4.778,3.285,6.096c-1.211-0.037-2.351-0.374-3.349-0.914c0,0.022,0,0.055,0,0.086c0,3.551,2.547,6.508,5.923,7.181c-0.617,0.169-1.269,0.263-1.941,0.263c-0.477,0-0.942-0.054-1.392-0.135c0.94,2.902,3.667,5.023,6.898,5.086c-2.528,1.96-5.712,3.134-9.174,3.134c-0.598,0-1.183-0.034-1.761-0.104C9.268,36.786,13.152,38,17.321,38c13.585,0,21.017-11.156,21.017-20.834c0-0.317-0.01-0.633-0.025-0.945C39.763,15.197,41.013,13.905,42,12.429"})),Q8=()=>re.createElement("svg",{className:Ms(),fill:"gray",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",width:"21px",height:"21px"}," ",re.createElement("path",{d:"M 15.904297 1.078125 C 15.843359 1.06875 15.774219 1.0746094 15.699219 1.0996094 C 14.699219 1.2996094 13.600391 1.8996094 12.900391 2.5996094 C 12.300391 3.1996094 11.800781 4.1996094 11.800781 5.0996094 C 11.800781 5.2996094 11.999219 5.5 12.199219 5.5 C 13.299219 5.4 14.399609 4.7996094 15.099609 4.0996094 C 15.699609 3.2996094 16.199219 2.4 16.199219 1.5 C 16.199219 1.275 16.087109 1.10625 15.904297 1.078125 z M 16.199219 5.4003906 C 14.399219 5.4003906 13.600391 6.5 12.400391 6.5 C 11.100391 6.5 9.9003906 5.5 8.4003906 5.5 C 6.3003906 5.5 3.0996094 7.4996094 3.0996094 12.099609 C 2.9996094 16.299609 6.8 21 9 21 C 10.3 21 10.600391 20.199219 12.400391 20.199219 C 14.200391 20.199219 14.600391 21 15.900391 21 C 17.400391 21 18.500391 19.399609 19.400391 18.099609 C 19.800391 17.399609 20.100391 17.000391 20.400391 16.400391 C 20.600391 16.000391 20.4 15.600391 20 15.400391 C 17.4 14.100391 16.900781 9.9003906 19.800781 8.4003906 C 20.300781 8.1003906 20.4 7.4992188 20 7.1992188 C 18.9 6.1992187 17.299219 5.4003906 16.199219 5.4003906 z"})),J8=()=>re.createElement("svg",{className:Ms(),fill:"gray",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 30 30",width:"21px",height:"21px"}," ",re.createElement("path",{d:"M15,3C8.373,3,3,8.373,3,15c0,5.623,3.872,10.328,9.092,11.63C12.036,26.468,12,26.28,12,26.047v-2.051 c-0.487,0-1.303,0-1.508,0c-0.821,0-1.551-0.353-1.905-1.009c-0.393-0.729-0.461-1.844-1.435-2.526 c-0.289-0.227-0.069-0.486,0.264-0.451c0.615,0.174,1.125,0.596,1.605,1.222c0.478,0.627,0.703,0.769,1.596,0.769 c0.433,0,1.081-0.025,1.691-0.121c0.328-0.833,0.895-1.6,1.588-1.962c-3.996-0.411-5.903-2.399-5.903-5.098 c0-1.162,0.495-2.286,1.336-3.233C9.053,10.647,8.706,8.73,9.435,8c1.798,0,2.885,1.166,3.146,1.481C13.477,9.174,14.461,9,15.495,9 c1.036,0,2.024,0.174,2.922,0.483C18.675,9.17,19.763,8,21.565,8c0.732,0.731,0.381,2.656,0.102,3.594 c0.836,0.945,1.328,2.066,1.328,3.226c0,2.697-1.904,4.684-5.894,5.097C18.199,20.49,19,22.1,19,23.313v2.734 c0,0.104-0.023,0.179-0.035,0.268C23.641,24.676,27,20.236,27,15C27,8.373,21.627,3,15,3z"})),Z8=()=>re.createElement("svg",{className:Ms(),xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 48 48",width:"21px",height:"21px"},re.createElement("path",{fill:"#e53935",d:"M24 43L16 20 32 20z"}),re.createElement("path",{fill:"#ff7043",d:"M24 43L42 20 32 20z"}),re.createElement("path",{fill:"#e53935",d:"M37 5L42 20 32 20z"}),re.createElement("path",{fill:"#ffa726",d:"M24 43L42 20 45 28z"}),re.createElement("path",{fill:"#ff7043",d:"M24 43L6 20 16 20z"}),re.createElement("path",{fill:"#e53935",d:"M11 5L6 20 16 20z"}),re.createElement("path",{fill:"#ffa726",d:"M24 43L6 20 3 28z"})),e9=()=>re.createElement("svg",{className:Ms(),xmlns:"http://www.w3.org/2000/svg",width:"512",height:"512",viewBox:"0 0 62.42 62.42"},re.createElement("defs",null,re.createElement("linearGradient",{id:"New_Gradient_Swatch_1",x1:"64.01",y1:"30.27",x2:"32.99",y2:"54.48",gradientUnits:"userSpaceOnUse"},re.createElement("stop",{offset:"0.18",stopColor:"#0052cc"}),re.createElement("stop",{offset:"1",stopColor:"#2684ff"}))),re.createElement("title",null,"Bitbucket-blue"),re.createElement("g",{id:"Layer_2","data-name":"Layer 2"},re.createElement("g",{id:"Blue",transform:"translate(0 -3.13)"},re.createElement("path",{d:"M2,6.26A2,2,0,0,0,0,8.58L8.49,60.12a2.72,2.72,0,0,0,2.66,2.27H51.88a2,2,0,0,0,2-1.68L62.37,8.59a2,2,0,0,0-2-2.32ZM37.75,43.51h-13L21.23,25.12H40.9Z",fill:"#2684ff"}),re.createElement("path",{d:"M59.67,25.12H40.9L37.75,43.51h-13L9.4,61.73a2.71,2.71,0,0,0,1.75.66H51.89a2,2,0,0,0,2-1.68Z",fill:"url(#New_Gradient_Swatch_1)"})))),t9=()=>re.createElement("svg",{className:Ms(),xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 48 48",width:"21px",height:"21px"},re.createElement("path",{fill:"#536dfe",d:"M39.248,10.177c-2.804-1.287-5.812-2.235-8.956-2.778c-0.057-0.01-0.114,0.016-0.144,0.068	c-0.387,0.688-0.815,1.585-1.115,2.291c-3.382-0.506-6.747-0.506-10.059,0c-0.3-0.721-0.744-1.603-1.133-2.291	c-0.03-0.051-0.087-0.077-0.144-0.068c-3.143,0.541-6.15,1.489-8.956,2.778c-0.024,0.01-0.045,0.028-0.059,0.051	c-5.704,8.522-7.267,16.835-6.5,25.044c0.003,0.04,0.026,0.079,0.057,0.103c3.763,2.764,7.409,4.442,10.987,5.554	c0.057,0.017,0.118-0.003,0.154-0.051c0.846-1.156,1.601-2.374,2.248-3.656c0.038-0.075,0.002-0.164-0.076-0.194	c-1.197-0.454-2.336-1.007-3.432-1.636c-0.087-0.051-0.094-0.175-0.014-0.234c0.231-0.173,0.461-0.353,0.682-0.534	c0.04-0.033,0.095-0.04,0.142-0.019c7.201,3.288,14.997,3.288,22.113,0c0.047-0.023,0.102-0.016,0.144,0.017	c0.22,0.182,0.451,0.363,0.683,0.536c0.08,0.059,0.075,0.183-0.012,0.234c-1.096,0.641-2.236,1.182-3.434,1.634	c-0.078,0.03-0.113,0.12-0.075,0.196c0.661,1.28,1.415,2.498,2.246,3.654c0.035,0.049,0.097,0.07,0.154,0.052	c3.595-1.112,7.241-2.79,11.004-5.554c0.033-0.024,0.054-0.061,0.057-0.101c0.917-9.491-1.537-17.735-6.505-25.044	C39.293,10.205,39.272,10.187,39.248,10.177z M16.703,30.273c-2.168,0-3.954-1.99-3.954-4.435s1.752-4.435,3.954-4.435	c2.22,0,3.989,2.008,3.954,4.435C20.658,28.282,18.906,30.273,16.703,30.273z M31.324,30.273c-2.168,0-3.954-1.99-3.954-4.435	s1.752-4.435,3.954-4.435c2.22,0,3.989,2.008,3.954,4.435C35.278,28.282,33.544,30.273,31.324,30.273z"})),n9=()=>re.createElement("svg",{className:Ms(),xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 48 48",width:"21px",height:"21px"},re.createElement("linearGradient",{id:"k8yl7~hDat~FaoWq8WjN6a",x1:"-1254.397",x2:"-1261.911",y1:"877.268",y2:"899.466",gradientTransform:"translate(1981.75 -1362.063) scale(1.5625)",gradientUnits:"userSpaceOnUse"},re.createElement("stop",{offset:"0",stopColor:"#114a8b"}),re.createElement("stop",{offset:"1",stopColor:"#0669bc"})),re.createElement("path",{fill:"url(#k8yl7~hDat~FaoWq8WjN6a)",d:"M17.634,6h11.305L17.203,40.773c-0.247,0.733-0.934,1.226-1.708,1.226H6.697 c-0.994,0-1.8-0.806-1.8-1.8c0-0.196,0.032-0.39,0.094-0.576L15.926,7.227C16.173,6.494,16.86,6,17.634,6L17.634,6z"}),re.createElement("path",{fill:"#0078d4",d:"M34.062,29.324H16.135c-0.458-0.001-0.83,0.371-0.831,0.829c0,0.231,0.095,0.451,0.264,0.608 l11.52,10.752C27.423,41.826,27.865,42,28.324,42h10.151L34.062,29.324z"}),re.createElement("linearGradient",{id:"k8yl7~hDat~FaoWq8WjN6b",x1:"-1252.05",x2:"-1253.788",y1:"887.612",y2:"888.2",gradientTransform:"translate(1981.75 -1362.063) scale(1.5625)",gradientUnits:"userSpaceOnUse"},re.createElement("stop",{offset:"0",stopOpacity:".3"}),re.createElement("stop",{offset:".071",stopOpacity:".2"}),re.createElement("stop",{offset:".321",stopOpacity:".1"}),re.createElement("stop",{offset:".623",stopOpacity:".05"}),re.createElement("stop",{offset:"1",stopOpacity:"0"})),re.createElement("path",{fill:"url(#k8yl7~hDat~FaoWq8WjN6b)",d:"M17.634,6c-0.783-0.003-1.476,0.504-1.712,1.25L5.005,39.595 c-0.335,0.934,0.151,1.964,1.085,2.299C6.286,41.964,6.493,42,6.702,42h9.026c0.684-0.122,1.25-0.603,1.481-1.259l2.177-6.416 l7.776,7.253c0.326,0.27,0.735,0.419,1.158,0.422h10.114l-4.436-12.676l-12.931,0.003L28.98,6H17.634z"}),re.createElement("linearGradient",{id:"k8yl7~hDat~FaoWq8WjN6c",x1:"-1252.952",x2:"-1244.704",y1:"876.6",y2:"898.575",gradientTransform:"translate(1981.75 -1362.063) scale(1.5625)",gradientUnits:"userSpaceOnUse"},re.createElement("stop",{offset:"0",stopColor:"#3ccbf4"}),re.createElement("stop",{offset:"1",stopColor:"#2892df"})),re.createElement("path",{fill:"url(#k8yl7~hDat~FaoWq8WjN6c)",d:"M32.074,7.225C31.827,6.493,31.141,6,30.368,6h-12.6c0.772,0,1.459,0.493,1.705,1.224 l10.935,32.399c0.318,0.942-0.188,1.963-1.13,2.281C29.093,41.968,28.899,42,28.703,42h12.6c0.994,0,1.8-0.806,1.8-1.801 c0-0.196-0.032-0.39-0.095-0.575L32.074,7.225z"})),r9=()=>re.createElement("svg",{className:Ms(),width:"512",height:"512",viewBox:"0 0 512 512",fill:"none",xmlns:"http://www.w3.org/2000/svg"},re.createElement("path",{d:"M472.136 163.959H408.584C407.401 163.959 406.218 163.327 405.666 162.3L354.651 73.6591C354.02 72.632 352.916 72 351.654 72H143.492C142.309 72 141.126 72.632 140.574 73.6591L87.5084 165.618L36.414 254.259C35.862 255.286 35.862 256.55 36.414 257.656L87.5084 346.297L140.495 438.335C141.047 439.362 142.23 440.073 143.413 439.994H351.654C352.837 439.994 354.02 439.362 354.651 438.335L405.745 349.694C406.297 348.667 407.48 347.956 408.663 348.035H472.215C474.344 348.035 476 346.297 476 344.243V167.83C475.921 165.697 474.186 163.959 472.136 163.959ZM228.728 349.694L212.721 377.345C212.485 377.74 212.091 378.135 211.696 378.372C211.223 378.609 210.75 378.767 210.198 378.767H178.422C177.318 378.767 176.293 378.214 175.82 377.187L128.431 294.787L123.779 286.65L106.748 257.498C106.511 257.103 106.353 256.629 106.432 256.076C106.432 255.602 106.59 255.049 106.827 254.654L123.937 224.949L175.899 134.886C176.451 133.938 177.476 133.306 178.501 133.306H210.198C210.75 133.306 211.302 133.464 211.854 133.701C212.248 133.938 212.643 134.254 212.879 134.728L228.886 162.537C229.359 163.485 229.28 164.67 228.728 165.539L177.397 254.654C177.16 255.049 177.081 255.523 177.081 255.918C177.081 256.392 177.239 256.787 177.397 257.182L228.728 346.218C229.438 347.403 229.359 348.667 228.728 349.694V349.694ZM388.083 257.498L371.051 286.65L366.399 294.787L319.011 377.187C318.459 378.135 317.512 378.767 316.409 378.767H284.632C284.08 378.767 283.607 378.609 283.134 378.372C282.74 378.135 282.346 377.819 282.109 377.345L266.103 349.694C265.393 348.667 265.393 347.403 266.024 346.376L317.355 257.34C317.591 256.945 317.67 256.471 317.67 256.076C317.67 255.602 317.513 255.207 317.355 254.812L266.024 165.697C265.472 164.749 265.393 163.643 265.866 162.695L281.873 134.886C282.109 134.491 282.503 134.096 282.898 133.859C283.371 133.543 283.923 133.464 284.553 133.464H316.409C317.512 133.464 318.538 134.017 319.011 135.044L370.972 225.107L388.083 254.812C388.319 255.286 388.477 255.76 388.477 256.234C388.477 256.55 388.319 257.024 388.083 257.498V257.498Z",fill:"#008AAA"})),s9=()=>re.createElement("svg",{className:Ms(),xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 48 48",width:"21px",height:"21px"},re.createElement("path",{fill:"#0288D1",d:"M42,37c0,2.762-2.238,5-5,5H11c-2.761,0-5-2.238-5-5V11c0-2.762,2.239-5,5-5h26c2.762,0,5,2.238,5,5V37z"}),re.createElement("path",{fill:"#FFF",d:"M12 19H17V36H12zM14.485 17h-.028C12.965 17 12 15.888 12 14.499 12 13.08 12.995 12 14.514 12c1.521 0 2.458 1.08 2.486 2.499C17 15.887 16.035 17 14.485 17zM36 36h-5v-9.099c0-2.198-1.225-3.698-3.192-3.698-1.501 0-2.313 1.012-2.707 1.99C24.957 25.543 25 26.511 25 27v9h-5V19h5v2.616C25.721 20.5 26.85 19 29.738 19c3.578 0 6.261 2.25 6.261 7.274L36 36 36 36z"})),i9=()=>re.createElement("svg",{className:Ms(),xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 48 48",width:"21px",height:"21px",fillRule:"evenodd",clipRule:"evenodd"},re.createElement("path",{fill:"#fff",fillRule:"evenodd",d:"M11.553,11.099c1.232,1.001,1.694,0.925,4.008,0.77 l21.812-1.31c0.463,0,0.078-0.461-0.076-0.538l-3.622-2.619c-0.694-0.539-1.619-1.156-3.391-1.002l-21.12,1.54 c-0.77,0.076-0.924,0.461-0.617,0.77L11.553,11.099z",clipRule:"evenodd"}),re.createElement("path",{fill:"#fff",fillRule:"evenodd",d:"M12.862,16.182v22.95c0,1.233,0.616,1.695,2.004,1.619 l23.971-1.387c1.388-0.076,1.543-0.925,1.543-1.927V14.641c0-1-0.385-1.54-1.234-1.463l-25.05,1.463 C13.171,14.718,12.862,15.181,12.862,16.182L12.862,16.182z",clipRule:"evenodd"}),re.createElement("path",{fill:"#424242",fillRule:"evenodd",d:"M11.553,11.099c1.232,1.001,1.694,0.925,4.008,0.77 l21.812-1.31c0.463,0,0.078-0.461-0.076-0.538l-3.622-2.619c-0.694-0.539-1.619-1.156-3.391-1.002l-21.12,1.54 c-0.77,0.076-0.924,0.461-0.617,0.77L11.553,11.099z M12.862,16.182v22.95c0,1.233,0.616,1.695,2.004,1.619l23.971-1.387 c1.388-0.076,1.543-0.925,1.543-1.927V14.641c0-1-0.385-1.54-1.234-1.463l-25.05,1.463C13.171,14.718,12.862,15.181,12.862,16.182 L12.862,16.182z M36.526,17.413c0.154,0.694,0,1.387-0.695,1.465l-1.155,0.23v16.943c-1.003,0.539-1.928,0.847-2.698,0.847 c-1.234,0-1.543-0.385-2.467-1.54l-7.555-11.86v11.475l2.391,0.539c0,0,0,1.386-1.929,1.386l-5.317,0.308 c-0.154-0.308,0-1.078,0.539-1.232l1.388-0.385V20.418l-1.927-0.154c-0.155-0.694,0.23-1.694,1.31-1.772l5.704-0.385l7.862,12.015 V19.493l-2.005-0.23c-0.154-0.848,0.462-1.464,1.233-1.54L36.526,17.413z M7.389,5.862l21.968-1.618 c2.698-0.231,3.392-0.076,5.087,1.155l7.013,4.929C42.614,11.176,43,11.407,43,12.33v27.032c0,1.694-0.617,2.696-2.775,2.849 l-25.512,1.541c-1.62,0.077-2.391-0.154-3.239-1.232l-5.164-6.7C5.385,34.587,5,33.664,5,32.585V8.556 C5,7.171,5.617,6.015,7.389,5.862z",clipRule:"evenodd"})),o9=()=>re.createElement("svg",{className:Ms(),xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 48 48",width:"21px",height:"21px"},re.createElement("path",{fill:"#33d375",d:"M33,8c0-2.209-1.791-4-4-4s-4,1.791-4,4c0,1.254,0,9.741,0,11c0,2.209,1.791,4,4,4s4-1.791,4-4	C33,17.741,33,9.254,33,8z"}),re.createElement("path",{fill:"#33d375",d:"M43,19c0,2.209-1.791,4-4,4c-1.195,0-4,0-4,0s0-2.986,0-4c0-2.209,1.791-4,4-4S43,16.791,43,19z"}),re.createElement("path",{fill:"#40c4ff",d:"M8,14c-2.209,0-4,1.791-4,4s1.791,4,4,4c1.254,0,9.741,0,11,0c2.209,0,4-1.791,4-4s-1.791-4-4-4	C17.741,14,9.254,14,8,14z"}),re.createElement("path",{fill:"#40c4ff",d:"M19,4c2.209,0,4,1.791,4,4c0,1.195,0,4,0,4s-2.986,0-4,0c-2.209,0-4-1.791-4-4S16.791,4,19,4z"}),re.createElement("path",{fill:"#e91e63",d:"M14,39.006C14,41.212,15.791,43,18,43s4-1.788,4-3.994c0-1.252,0-9.727,0-10.984	c0-2.206-1.791-3.994-4-3.994s-4,1.788-4,3.994C14,29.279,14,37.754,14,39.006z"}),re.createElement("path",{fill:"#e91e63",d:"M4,28.022c0-2.206,1.791-3.994,4-3.994c1.195,0,4,0,4,0s0,2.981,0,3.994c0,2.206-1.791,3.994-4,3.994	S4,30.228,4,28.022z"}),re.createElement("path",{fill:"#ffc107",d:"M39,33c2.209,0,4-1.791,4-4s-1.791-4-4-4c-1.254,0-9.741,0-11,0c-2.209,0-4,1.791-4,4s1.791,4,4,4	C29.258,33,37.746,33,39,33z"}),re.createElement("path",{fill:"#ffc107",d:"M28,43c-2.209,0-4-1.791-4-4c0-1.195,0-4,0-4s2.986,0,4,0c2.209,0,4,1.791,4,4S30.209,43,28,43z"})),a9=()=>re.createElement("svg",{className:Ms(),width:"512",height:"512",viewBox:"0 0 512 512",fill:"none",xmlns:"http://www.w3.org/2000/svg"},re.createElement("path",{d:"M255.498 31.0034C131.513 31.0034 31 131.515 31 255.502C31 379.492 131.513 480 255.498 480C379.497 480 480 379.495 480 255.502C480 131.522 379.497 31.0135 255.495 31.0135L255.498 31V31.0034ZM358.453 354.798C354.432 361.391 345.801 363.486 339.204 359.435C286.496 327.237 220.139 319.947 141.993 337.801C134.463 339.516 126.957 334.798 125.24 327.264C123.516 319.731 128.217 312.225 135.767 310.511C221.284 290.972 294.639 299.384 353.816 335.549C360.413 339.596 362.504 348.2 358.453 354.798ZM385.932 293.67C380.864 301.903 370.088 304.503 361.858 299.438C301.512 262.345 209.528 251.602 138.151 273.272C128.893 276.067 119.118 270.851 116.309 261.61C113.521 252.353 118.74 242.597 127.981 239.782C209.512 215.044 310.87 227.026 380.17 269.612C388.4 274.68 391 285.456 385.935 293.676V293.673L385.932 293.67ZM388.293 230.016C315.935 187.039 196.56 183.089 127.479 204.055C116.387 207.42 104.654 201.159 101.293 190.063C97.9326 178.964 104.189 167.241 115.289 163.87C194.59 139.796 326.418 144.446 409.723 193.902C419.722 199.826 422.995 212.71 417.068 222.675C411.168 232.653 398.247 235.943 388.303 230.016H388.293V230.016Z",fill:"#1ED760"})),l9=()=>re.createElement("svg",{className:Ms(),width:"512",height:"512",viewBox:"0 0 512 512",fill:"none",xmlns:"http://www.w3.org/2000/svg"},re.createElement("path",{d:"M416 240L352 304H288L232 360V304H160V64H416V240Z",fill:"white"}),re.createElement("path",{d:"M144 32L64 112V400H160V480L240 400H304L448 256V32H144ZM416 240L352 304H288L232 360V304H160V64H416V240Z",fill:"#9146FF"}),re.createElement("path",{d:"M368 120H336V216H368V120Z",fill:"#9146FF"}),re.createElement("path",{d:"M280 120H248V216H280V120Z",fill:"#9146FF"})),c9=()=>re.createElement("svg",{className:Ms(),width:"512",height:"512",viewBox:"0 0 512 512",fill:"none",xmlns:"http://www.w3.org/2000/svg"},re.createElement("path",{d:"M33 256.043C33 264.556 35.3159 273.069 39.4845 280.202L117.993 415.493C126.098 429.298 138.373 440.572 153.657 445.634C183.764 455.528 214.797 442.873 229.618 417.333L248.609 384.661L173.806 256.043L252.777 119.831L271.768 87.1591C277.557 77.2654 284.968 69.4424 294 63H285.894H172.185C150.878 63 131.193 74.2742 120.54 92.6812L39.7161 231.884C35.3159 239.016 33 247.53 33 256.043Z",fill:"#6363F1"}),re.createElement("path",{d:"M480 256.058C480 247.539 477.684 239.021 473.516 231.883L393.849 94.6596C379.028 69.3331 347.995 56.4396 317.888 66.34C302.603 71.4053 290.329 82.6871 282.224 96.5015L264.391 127.354L339.194 256.058L260.223 392.131L241.232 424.825C235.443 434.495 228.032 442.553 219 449H227.106H340.815C362.122 449 381.807 437.718 392.46 419.299L473.284 280.003C477.684 272.866 480 264.577 480 256.058Z",fill:"#6363F1"})),u9=()=>re.createElement("svg",{className:Ms(),xmlns:"http://www.w3.org/2000/svg",width:"2500",height:"2500",viewBox:"0 0 256 256"},re.createElement("path",{fill:"#FFE812",d:"M256 236c0 11.046-8.954 20-20 20H20c-11.046 0-20-8.954-20-20V20C0 8.954 8.954 0 20 0h216c11.046 0 20 8.954 20 20v216z"}),re.createElement("path",{d:"M128 36C70.562 36 24 72.713 24 118c0 29.279 19.466 54.97 48.748 69.477-1.593 5.494-10.237 35.344-10.581 37.689 0 0-.207 1.762.934 2.434s2.483.15 2.483.15c3.272-.457 37.943-24.811 43.944-29.04 5.995.849 12.168 1.29 18.472 1.29 57.438 0 104-36.712 104-82 0-45.287-46.562-82-104-82z"}),re.createElement("path",{fill:"#FFE812",d:"M70.5 146.625c-3.309 0-6-2.57-6-5.73V105.25h-9.362c-3.247 0-5.888-2.636-5.888-5.875s2.642-5.875 5.888-5.875h30.724c3.247 0 5.888 2.636 5.888 5.875s-2.642 5.875-5.888 5.875H76.5v35.645c0 3.16-2.691 5.73-6 5.73zM123.112 146.547c-2.502 0-4.416-1.016-4.993-2.65l-2.971-7.778-18.296-.001-2.973 7.783c-.575 1.631-2.488 2.646-4.99 2.646a9.155 9.155 0 0 1-3.814-.828c-1.654-.763-3.244-2.861-1.422-8.52l14.352-37.776c1.011-2.873 4.082-5.833 7.99-5.922 3.919.088 6.99 3.049 8.003 5.928l14.346 37.759c1.826 5.672.236 7.771-1.418 8.532a9.176 9.176 0 0 1-3.814.827c-.001 0 0 0 0 0zm-11.119-21.056L106 108.466l-5.993 17.025h11.986zM138 145.75c-3.171 0-5.75-2.468-5.75-5.5V99.5c0-3.309 2.748-6 6.125-6s6.125 2.691 6.125 6v35.25h12.75c3.171 0 5.75 2.468 5.75 5.5s-2.579 5.5-5.75 5.5H138zM171.334 146.547c-3.309 0-6-2.691-6-6V99.5c0-3.309 2.691-6 6-6s6 2.691 6 6v12.896l16.74-16.74c.861-.861 2.044-1.335 3.328-1.335 1.498 0 3.002.646 4.129 1.772 1.051 1.05 1.678 2.401 1.764 3.804.087 1.415-.384 2.712-1.324 3.653l-13.673 13.671 14.769 19.566a5.951 5.951 0 0 1 1.152 4.445 5.956 5.956 0 0 1-2.328 3.957 5.94 5.94 0 0 1-3.609 1.211 5.953 5.953 0 0 1-4.793-2.385l-14.071-18.644-2.082 2.082v13.091a6.01 6.01 0 0 1-6.002 6.003z"}));function d9({supabaseClient:r,socialLayout:e="vertical",providers:t=["github","google","azure"],providerScopes:n,queryParams:s,redirectTo:i,onlyThirdPartyProviders:o=!0,view:a="sign_in",i18n:c,appearance:d}){const[f,m]=R.useState(!1),[v,x]=R.useState(""),_=e==="vertical",b=a==="magic_link"?"sign_in":a,w=async C=>{m(!0);const{error:T}=await r.auth.signInWithOAuth({provider:C,options:{redirectTo:i,scopes:n==null?void 0:n[C],queryParams:s}});T&&x(T.message),m(!1)};function S(C){const T=C.toLowerCase();return C.charAt(0).toUpperCase()+T.slice(1)}return re.createElement(re.Fragment,null,t&&t.length>0&&re.createElement(re.Fragment,null,re.createElement(Fa,{gap:"large",direction:"vertical",appearance:d},re.createElement(Fa,{direction:_?"vertical":"horizontal",gap:_?"small":"medium",appearance:d},t.map(C=>{var T;return re.createElement(lm,{key:C,color:"default",loading:f,onClick:()=>w(C),appearance:d},re.createElement(q8,{provider:C}),_&&j8((T=c==null?void 0:c[b])==null?void 0:T.social_provider_text,{provider:S(C)}))}))),!o&&re.createElement(H8,{appearance:d})))}function JT({authView:r="sign_in",defaultEmail:e="",defaultPassword:t="",setAuthView:n=()=>{},setDefaultEmail:s=_=>{},setDefaultPassword:i=_=>{},supabaseClient:o,showLinks:a=!1,redirectTo:c,additionalData:d,magicLink:f,i18n:m,appearance:v,children:x}){var _,b,w,S;const C=R.useRef(!0),[T,A]=R.useState(e),[k,j]=R.useState(t),[D,L]=R.useState(""),[O,I]=R.useState(!1),[B,W]=R.useState("");R.useEffect(()=>(C.current=!0,A(e),j(t),()=>{C.current=!1}),[r]);const K=async ne=>{var ce;switch(ne.preventDefault(),L(""),I(!0),r){case"sign_in":const{error:V}=await o.auth.signInWithPassword({email:T,password:k});V&&L(V.message);break;case"sign_up":let q={emailRedirectTo:c};d&&(q.data=d);const{data:{user:Z,session:X},error:ie}=await o.auth.signUp({email:T,password:k,options:q});ie?L(ie.message):Z&&!X&&W((ce=m==null?void 0:m.sign_up)==null?void 0:ce.confirmation_text);break}C.current&&I(!1)},ee=ne=>{s(T),i(k),n(ne)},oe=m==null?void 0:m[r];return re.createElement("form",{id:r==="sign_in"?"auth-sign-in":"auth-sign-up",onSubmit:K,autoComplete:"on",style:{width:"100%"}},re.createElement(Fa,{direction:"vertical",gap:"large",appearance:v},re.createElement(Fa,{direction:"vertical",gap:"large",appearance:v},re.createElement("div",null,re.createElement(du,{htmlFor:"email",appearance:v},oe==null?void 0:oe.email_label),re.createElement(uu,{id:"email",type:"email",name:"email",placeholder:oe==null?void 0:oe.email_input_placeholder,defaultValue:T,onChange:ne=>A(ne.target.value),autoComplete:"email",appearance:v})),re.createElement("div",null,re.createElement(du,{htmlFor:"password",appearance:v},oe==null?void 0:oe.password_label),re.createElement(uu,{id:"password",type:"password",name:"password",placeholder:oe==null?void 0:oe.password_input_placeholder,defaultValue:k,onChange:ne=>j(ne.target.value),autoComplete:r==="sign_in"?"current-password":"new-password",appearance:v})),x),re.createElement(lm,{type:"submit",color:"primary",loading:O,appearance:v},O?oe==null?void 0:oe.loading_button_label:oe==null?void 0:oe.button_label),a&&re.createElement(Fa,{direction:"vertical",gap:"small",appearance:v},r===Tr.SIGN_IN&&f&&re.createElement(Od,{href:"#auth-magic-link",onClick:ne=>{ne.preventDefault(),n(Tr.MAGIC_LINK)},appearance:v},(_=m==null?void 0:m.magic_link)==null?void 0:_.link_text),r===Tr.SIGN_IN&&re.createElement(Od,{href:"#auth-forgot-password",onClick:ne=>{ne.preventDefault(),n(Tr.FORGOTTEN_PASSWORD)},appearance:v},(b=m==null?void 0:m.forgotten_password)==null?void 0:b.link_text),r===Tr.SIGN_IN?re.createElement(Od,{href:"#auth-sign-up",onClick:ne=>{ne.preventDefault(),ee(Tr.SIGN_UP)},appearance:v},(w=m==null?void 0:m.sign_up)==null?void 0:w.link_text):re.createElement(Od,{href:"#auth-sign-in",onClick:ne=>{ne.preventDefault(),ee(Tr.SIGN_IN)},appearance:v},(S=m==null?void 0:m.sign_in)==null?void 0:S.link_text))),B&&re.createElement(Ha,{appearance:v},B),D&&re.createElement(Ha,{color:"danger",appearance:v},D))}function z3({setAuthView:r=()=>{},supabaseClient:e,redirectTo:t,i18n:n,appearance:s,showLinks:i=!1}){var o;const[a,c]=R.useState(""),[d,f]=R.useState(""),[m,v]=R.useState(""),[x,_]=R.useState(!1),b=async S=>{var C;S.preventDefault(),f(""),v(""),_(!0);const{error:T}=await e.auth.resetPasswordForEmail(a,{redirectTo:t});T?f(T.message):v((C=n==null?void 0:n.forgotten_password)==null?void 0:C.confirmation_text),_(!1)},w=n==null?void 0:n.forgotten_password;return re.createElement("form",{id:"auth-forgot-password",onSubmit:b},re.createElement(Fa,{direction:"vertical",gap:"large",appearance:s},re.createElement(Fa,{gap:"large",direction:"vertical",appearance:s},re.createElement("div",null,re.createElement(du,{htmlFor:"email",appearance:s},w==null?void 0:w.email_label),re.createElement(uu,{id:"email",name:"email",type:"email",autoFocus:!0,placeholder:w==null?void 0:w.email_input_placeholder,onChange:S=>c(S.target.value),appearance:s})),re.createElement(lm,{type:"submit",color:"primary",loading:x,appearance:s},x?w==null?void 0:w.loading_button_label:w==null?void 0:w.button_label),i&&re.createElement(Od,{href:"#auth-sign-in",onClick:S=>{S.preventDefault(),r(Tr.SIGN_IN)},appearance:s},(o=n==null?void 0:n.sign_in)==null?void 0:o.link_text),m&&re.createElement(Ha,{appearance:s},m),d&&re.createElement(Ha,{color:"danger",appearance:s},d))))}function V3({supabaseClient:r,i18n:e,appearance:t}){const[n,s]=R.useState(""),[i,o]=R.useState(""),[a,c]=R.useState(""),[d,f]=R.useState(!1),m=async x=>{var _;x.preventDefault(),o(""),c(""),f(!0);const{error:b}=await r.auth.updateUser({password:n});b?o(b.message):c((_=e==null?void 0:e.update_password)==null?void 0:_.confirmation_text),f(!1)},v=e==null?void 0:e.update_password;return re.createElement("form",{id:"auth-update-password",onSubmit:m},re.createElement(Fa,{gap:"large",direction:"vertical",appearance:t},re.createElement("div",null,re.createElement(du,{htmlFor:"password",appearance:t},v==null?void 0:v.password_label),re.createElement(uu,{id:"password",name:"password",placeholder:v==null?void 0:v.password_input_placeholder,type:"password",autoFocus:!0,onChange:x=>s(x.target.value),appearance:t})),re.createElement(lm,{type:"submit",color:"primary",loading:d,appearance:t},d?v==null?void 0:v.loading_button_label:v==null?void 0:v.button_label),a&&re.createElement(Ha,{appearance:t},a),i&&re.createElement(Ha,{color:"danger",appearance:t},i)))}function h9({setAuthView:r=()=>{},supabaseClient:e,otpType:t="email",i18n:n,appearance:s,showLinks:i=!1}){var o;const[a,c]=R.useState(""),[d,f]=R.useState(""),[m,v]=R.useState(""),[x,_]=R.useState(""),[b,w]=R.useState(""),[S,C]=R.useState(!1),T=async k=>{k.preventDefault(),_(""),w(""),C(!0);let j={email:a,token:m,type:t};["sms","phone_change"].includes(t)&&(j={phone:d,token:m,type:t});const{error:D}=await e.auth.verifyOtp(j);D&&_(D.message),C(!1)},A=n==null?void 0:n.verify_otp;return re.createElement("form",{id:"auth-magic-link",onSubmit:T},re.createElement(Fa,{gap:"large",direction:"vertical",appearance:s},["sms","phone_change"].includes(t)?re.createElement("div",null,re.createElement(du,{htmlFor:"phone",appearance:s},A==null?void 0:A.phone_input_label),re.createElement(uu,{id:"phone",name:"phone",type:"text",autoFocus:!0,placeholder:A==null?void 0:A.phone_input_placeholder,onChange:k=>f(k.target.value),appearance:s})):re.createElement("div",null,re.createElement(du,{htmlFor:"email",appearance:s},A==null?void 0:A.email_input_label),re.createElement(uu,{id:"email",name:"email",type:"email",autoFocus:!0,placeholder:A==null?void 0:A.email_input_placeholder,onChange:k=>c(k.target.value),appearance:s})),re.createElement("div",null,re.createElement(du,{htmlFor:"token",appearance:s},A==null?void 0:A.token_input_label),re.createElement(uu,{id:"token",name:"token",type:"text",placeholder:A==null?void 0:A.token_input_placeholder,onChange:k=>v(k.target.value),appearance:s})),re.createElement(lm,{color:"primary",type:"submit",loading:S,appearance:s},S?A==null?void 0:A.loading_button_label:A==null?void 0:A.button_label),i&&re.createElement(Od,{href:"#auth-sign-in",onClick:k=>{k.preventDefault(),r(Tr.SIGN_IN)},appearance:s},(o=n==null?void 0:n.sign_in)==null?void 0:o.link_text),b&&re.createElement(Ha,{appearance:s},b),x&&re.createElement(Ha,{color:"danger",appearance:s},x)))}const H3=R.createContext({user:null,session:null}),f9=r=>{const{supabaseClient:e}=r,[t,n]=R.useState(null),[s,i]=R.useState((t==null?void 0:t.user)??null);R.useEffect(()=>{(async()=>{var c;const{data:d}=await e.auth.getSession();n(d.session),i(((c=d.session)==null?void 0:c.user)??null)})();const{data:a}=e.auth.onAuthStateChange(async(c,d)=>{n(d),i((d==null?void 0:d.user)??null)});return()=>{a==null||a.subscription.unsubscribe()}},[]);const o={session:t,user:s};return re.createElement(H3.Provider,{value:o,...r})},p9=()=>{const r=R.useContext(H3);if(r===void 0)throw new Error("useUser must be used within a UserContextProvider.");return r};function cm({supabaseClient:r,socialLayout:e="vertical",providers:t,providerScopes:n,queryParams:s,view:i="sign_in",redirectTo:o,onlyThirdPartyProviders:a=!1,magicLink:c=!1,showLinks:d=!0,appearance:f,theme:m="default",localization:v={variables:{}},otpType:x="email",additionalData:_,children:b}){const w=C1(F8,v.variables??{}),[S,C]=R.useState(i),[T,A]=R.useState(""),[k,j]=R.useState(""),D=S==="sign_in"||S==="sign_up"||S==="magic_link";R.useEffect(()=>{var I,B;F3({theme:C1(((I=f==null?void 0:f.theme)==null?void 0:I.default)??{},((B=f==null?void 0:f.variables)==null?void 0:B.default)??{})})},[f]);const L=({children:I})=>{var B;return re.createElement("div",{className:m!=="default"?k8(C1(f==null?void 0:f.theme[m],((B=f==null?void 0:f.variables)==null?void 0:B[m])??{})):""},D&&re.createElement(d9,{appearance:f,supabaseClient:r,providers:t,providerScopes:n,queryParams:s,socialLayout:e,redirectTo:o,onlyThirdPartyProviders:a,i18n:w,view:S}),!a&&I)};R.useEffect(()=>{const{data:I}=r.auth.onAuthStateChange(B=>{B==="PASSWORD_RECOVERY"?C("update_password"):B==="USER_UPDATED"&&C("sign_in")});return C(i),()=>I.subscription.unsubscribe()},[i]);const O={supabaseClient:r,setAuthView:C,defaultEmail:T,defaultPassword:k,setDefaultEmail:A,setDefaultPassword:j,redirectTo:o,magicLink:c,showLinks:d,i18n:w,appearance:f};switch(S){case Tr.SIGN_IN:return re.createElement(L,null,re.createElement(JT,{...O,authView:"sign_in"}));case Tr.SIGN_UP:return re.createElement(L,null,re.createElement(JT,{appearance:f,supabaseClient:r,authView:"sign_up",setAuthView:C,defaultEmail:T,defaultPassword:k,setDefaultEmail:A,setDefaultPassword:j,redirectTo:o,magicLink:c,showLinks:d,i18n:w,additionalData:_,children:b}));case Tr.FORGOTTEN_PASSWORD:return re.createElement(L,null,re.createElement(z3,{appearance:f,supabaseClient:r,setAuthView:C,redirectTo:o,showLinks:d,i18n:w}));case Tr.MAGIC_LINK:return re.createElement(L,null,re.createElement(B3,{appearance:f,supabaseClient:r,setAuthView:C,redirectTo:o,showLinks:d,i18n:w}));case Tr.UPDATE_PASSWORD:return re.createElement(V3,{appearance:f,supabaseClient:r,i18n:w});case Tr.VERIFY_OTP:return re.createElement(h9,{appearance:f,supabaseClient:r,otpType:x,i18n:w});default:return null}}cm.ForgottenPassword=z3;cm.UpdatePassword=V3;cm.MagicLink=B3;cm.UserContextProvider=f9;cm.useUser=p9;sc({borderRadius:"12px",boxShadow:"rgba(100, 100, 111, 0.2) 0px 7px 29px 0px",width:"360px",padding:"28px 32px"});const m9=()=>h.jsxs("div",{className:"min-h-screen flex items-center justify-center p-4",style:{background:"linear-gradient(135deg, #FFFACD 0%, #FFF8DC 50%, #FFFFE0 100%)"},children:[h.jsxs("div",{className:"absolute inset-0 overflow-hidden pointer-events-none",children:[h.jsx("div",{className:"absolute top-20 left-10 rounded-full opacity-20",style:{backgroundColor:"#DAA520",width:"clamp(4rem, 8vw, 12rem)",height:"clamp(4rem, 8vw, 12rem)"}}),h.jsx("div",{className:"absolute top-40 right-20 rounded-full opacity-20",style:{backgroundColor:"#DA70D6",width:"clamp(10rem, 18vw, 30rem)",height:"clamp(10rem, 18vw, 30rem)"}}),h.jsx("div",{className:"absolute bottom-32 left-20 rounded-full opacity-20",style:{backgroundColor:"#DA70D6",width:"clamp(10rem, 18vw, 30rem)",height:"clamp(10rem, 18vw, 28rem)"}}),h.jsx("div",{className:"absolute bottom-20 right-10 rounded-full opacity-20",style:{backgroundColor:"#DAA520",width:"clamp(3.5rem, 7vw, 10rem)",height:"clamp(3.5rem, 7vw, 10rem)"}}),h.jsx("div",{className:"absolute top-60 left-1/2 rounded-full opacity-20",style:{backgroundColor:"#DAA520",width:"clamp(2.5rem, 5vw, 7rem)",height:"clamp(2.5rem, 5vw, 7rem)"}})]}),h.jsxs("div",{className:"w-full max-w-md p-8 space-y-6 rounded-2xl shadow-2xl relative",style:{backgroundColor:"rgba(255, 255, 255, 0.9)",backdropFilter:"blur(10px)",border:"2px solid rgba(218, 165, 32, 0.3)"},children:[h.jsxs("div",{className:"text-center",children:[h.jsx("h1",{className:"text-5xl font-bold mb-2",style:{color:"#DA70D6",fontFamily:"SodaScript-Light, Georgia, serif",textShadow:"2px 2px 4px rgba(218, 165, 32, 0.3)",letterSpacing:"3px",fontSize:"100px"},children:"CandyStore"}),h.jsx("p",{className:"text-lg mt-4",style:{color:"#8B4B8B",fontFamily:"Sassoon, Comic Sans MS, cursive"},children:"Sign in to your sweet learning space"})]}),h.jsx(cm,{supabaseClient:Un,appearance:{theme:D8,variables:{default:{colors:{brand:"#DAA520",brandAccent:"#FFD700",brandButtonText:"white",defaultButtonBackground:"#DA70D6",defaultButtonBackgroundHover:"#8B4B8B",inputBackground:"rgba(255, 250, 205, 0.5)",inputBorder:"#DAA520",inputBorderHover:"#FFD700",inputBorderFocus:"#DA70D6"}}},style:{button:{borderRadius:"12px",fontFamily:"Sassoon, Comic Sans MS, cursive"},input:{borderRadius:"12px",fontFamily:"Sassoon, Comic Sans MS, cursive"}}},providers:[]}),h.jsx("div",{className:"absolute -top-3 -right-3 w-6 h-6 rounded-full",style:{backgroundColor:"#DAA520"}}),h.jsx("div",{className:"absolute -bottom-3 -left-3 w-6 h-6 rounded-full",style:{backgroundColor:"#DA70D6"}})]})]}),gu=()=>{const r=rc();return R.useEffect(()=>{console.error("404 Error: User attempted to access non-existent route:",r.pathname)},[r.pathname]),h.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-100",children:h.jsxs("div",{className:"text-center",children:[h.jsx("h1",{className:"text-4xl font-bold mb-4",children:"404"}),h.jsx("p",{className:"text-xl text-gray-600 mb-4",children:"Oops! Page not found"}),h.jsx("a",{href:"/",className:"text-blue-500 hover:text-blue-700 underline",children:"Return to Home"})]})})},g9=({classInfo:r,onBackClick:e,onGameRoomsClick:t,onSettingsClick:n})=>h.jsx("div",{className:"bg-white shadow-sm border-b",children:h.jsx("div",{className:"max-w-7xl mx-auto px-6 py-4",children:h.jsxs("div",{className:"flex items-center justify-between",children:[h.jsxs("div",{className:"flex items-center space-x-4",children:[h.jsxs("button",{onClick:e,className:"text-gray-500 hover:text-gray-700 transition-colors flex items-center gap-2",children:[h.jsx(em,{className:"h-4 w-4"}),"Back to Dashboard"]}),h.jsxs("div",{children:[h.jsx("h1",{className:"text-2xl font-bold text-gray-800",children:r.name}),r.description&&h.jsx("p",{className:"text-sm text-gray-600 mt-1",children:r.description})]})]}),h.jsxs("div",{className:"flex space-x-3",children:[h.jsxs(zt,{onClick:t,className:"bg-indigo-600 text-white hover:bg-indigo-700 transition-colors",children:[h.jsx(Qi,{className:"w-4 h-4 mr-2"}),"Game Rooms"]}),h.jsx(zt,{onClick:n,variant:"outline",className:"border-gray-300 text-gray-700 hover:bg-gray-50",children:h.jsx(r0,{className:"w-4 h-4"})})]})]})})});var v9=R.createContext(void 0);function z0(r){const e=R.useContext(v9);return r||e||"ltr"}var A1="rovingFocusGroup.onEntryFocus",x9={bubbles:!1,cancelable:!0},V0="RovingFocusGroup",[bb,G3,y9]=S_(V0),[_9,um]=to(V0,[y9]),[w9,S9]=_9(V0),W3=R.forwardRef((r,e)=>h.jsx(bb.Provider,{scope:r.__scopeRovingFocusGroup,children:h.jsx(bb.Slot,{scope:r.__scopeRovingFocusGroup,children:h.jsx(b9,{...r,ref:e})})}));W3.displayName=V0;var b9=R.forwardRef((r,e)=>{const{__scopeRovingFocusGroup:t,orientation:n,loop:s=!1,dir:i,currentTabStopId:o,defaultCurrentTabStopId:a,onCurrentTabStopIdChange:c,onEntryFocus:d,preventScrollOnEntryFocus:f=!1,...m}=r,v=R.useRef(null),x=Cn(e,v),_=z0(i),[b,w]=ql({prop:o,defaultProp:a??null,onChange:c,caller:V0}),[S,C]=R.useState(!1),T=Di(d),A=G3(t),k=R.useRef(!1),[j,D]=R.useState(0);return R.useEffect(()=>{const L=v.current;if(L)return L.addEventListener(A1,T),()=>L.removeEventListener(A1,T)},[T]),h.jsx(w9,{scope:t,orientation:n,dir:_,loop:s,currentTabStopId:b,onItemFocus:R.useCallback(L=>w(L),[w]),onItemShiftTab:R.useCallback(()=>C(!0),[]),onFocusableItemAdd:R.useCallback(()=>D(L=>L+1),[]),onFocusableItemRemove:R.useCallback(()=>D(L=>L-1),[]),children:h.jsx($t.div,{tabIndex:S||j===0?-1:0,"data-orientation":n,...m,ref:x,style:{outline:"none",...r.style},onMouseDown:mt(r.onMouseDown,()=>{k.current=!0}),onFocus:mt(r.onFocus,L=>{const O=!k.current;if(L.target===L.currentTarget&&O&&!S){const I=new CustomEvent(A1,x9);if(L.currentTarget.dispatchEvent(I),!I.defaultPrevented){const B=A().filter(ne=>ne.focusable),W=B.find(ne=>ne.active),K=B.find(ne=>ne.id===b),oe=[W,K,...B].filter(Boolean).map(ne=>ne.ref.current);X3(oe,f)}}k.current=!1}),onBlur:mt(r.onBlur,()=>C(!1))})})}),$3="RovingFocusGroupItem",q3=R.forwardRef((r,e)=>{const{__scopeRovingFocusGroup:t,focusable:n=!0,active:s=!1,tabStopId:i,children:o,...a}=r,c=Oa(),d=i||c,f=S9($3,t),m=f.currentTabStopId===d,v=G3(t),{onFocusableItemAdd:x,onFocusableItemRemove:_,currentTabStopId:b}=f;return R.useEffect(()=>{if(n)return x(),()=>_()},[n,x,_]),h.jsx(bb.ItemSlot,{scope:t,id:d,focusable:n,active:s,children:h.jsx($t.span,{tabIndex:m?0:-1,"data-orientation":f.orientation,...a,ref:e,onMouseDown:mt(r.onMouseDown,w=>{n?f.onItemFocus(d):w.preventDefault()}),onFocus:mt(r.onFocus,()=>f.onItemFocus(d)),onKeyDown:mt(r.onKeyDown,w=>{if(w.key==="Tab"&&w.shiftKey){f.onItemShiftTab();return}if(w.target!==w.currentTarget)return;const S=T9(w,f.orientation,f.dir);if(S!==void 0){if(w.metaKey||w.ctrlKey||w.altKey||w.shiftKey)return;w.preventDefault();let T=v().filter(A=>A.focusable).map(A=>A.ref.current);if(S==="last")T.reverse();else if(S==="prev"||S==="next"){S==="prev"&&T.reverse();const A=T.indexOf(w.currentTarget);T=f.loop?C9(T,A+1):T.slice(A+1)}setTimeout(()=>X3(T))}}),children:typeof o=="function"?o({isCurrentTabStop:m,hasTabStop:b!=null}):o})})});q3.displayName=$3;var E9={ArrowLeft:"prev",ArrowUp:"prev",ArrowRight:"next",ArrowDown:"next",PageUp:"first",Home:"first",PageDown:"last",End:"last"};function M9(r,e){return e!=="rtl"?r:r==="ArrowLeft"?"ArrowRight":r==="ArrowRight"?"ArrowLeft":r}function T9(r,e,t){const n=M9(r.key,t);if(!(e==="vertical"&&["ArrowLeft","ArrowRight"].includes(n))&&!(e==="horizontal"&&["ArrowUp","ArrowDown"].includes(n)))return E9[n]}function X3(r,e=!1){const t=document.activeElement;for(const n of r)if(n===t||(n.focus({preventScroll:e}),document.activeElement!==t))return}function C9(r,e){return r.map((t,n)=>r[(e+n)%r.length])}var DE=W3,LE=q3,O_="Tabs",[A9,Vee]=to(O_,[um]),Y3=um(),[R9,OE]=A9(O_),K3=R.forwardRef((r,e)=>{const{__scopeTabs:t,value:n,onValueChange:s,defaultValue:i,orientation:o="horizontal",dir:a,activationMode:c="automatic",...d}=r,f=z0(a),[m,v]=ql({prop:n,onChange:s,defaultProp:i??"",caller:O_});return h.jsx(R9,{scope:t,baseId:Oa(),value:m,onValueChange:v,orientation:o,dir:f,activationMode:c,children:h.jsx($t.div,{dir:f,"data-orientation":o,...d,ref:e})})});K3.displayName=O_;var Q3="TabsList",J3=R.forwardRef((r,e)=>{const{__scopeTabs:t,loop:n=!0,...s}=r,i=OE(Q3,t),o=Y3(t);return h.jsx(DE,{asChild:!0,...o,orientation:i.orientation,dir:i.dir,loop:n,children:h.jsx($t.div,{role:"tablist","aria-orientation":i.orientation,...s,ref:e})})});J3.displayName=Q3;var Z3="TabsTrigger",eP=R.forwardRef((r,e)=>{const{__scopeTabs:t,value:n,disabled:s=!1,...i}=r,o=OE(Z3,t),a=Y3(t),c=rP(o.baseId,n),d=sP(o.baseId,n),f=n===o.value;return h.jsx(LE,{asChild:!0,...a,focusable:!s,active:f,children:h.jsx($t.button,{type:"button",role:"tab","aria-selected":f,"aria-controls":d,"data-state":f?"active":"inactive","data-disabled":s?"":void 0,disabled:s,id:c,...i,ref:e,onMouseDown:mt(r.onMouseDown,m=>{!s&&m.button===0&&m.ctrlKey===!1?o.onValueChange(n):m.preventDefault()}),onKeyDown:mt(r.onKeyDown,m=>{[" ","Enter"].includes(m.key)&&o.onValueChange(n)}),onFocus:mt(r.onFocus,()=>{const m=o.activationMode!=="manual";!f&&!s&&m&&o.onValueChange(n)})})})});eP.displayName=Z3;var tP="TabsContent",nP=R.forwardRef((r,e)=>{const{__scopeTabs:t,value:n,forceMount:s,children:i,...o}=r,a=OE(tP,t),c=rP(a.baseId,n),d=sP(a.baseId,n),f=n===a.value,m=R.useRef(f);return R.useEffect(()=>{const v=requestAnimationFrame(()=>m.current=!1);return()=>cancelAnimationFrame(v)},[]),h.jsx(wo,{present:s||f,children:({present:v})=>h.jsx($t.div,{"data-state":f?"active":"inactive","data-orientation":a.orientation,role:"tabpanel","aria-labelledby":c,hidden:!v,id:d,tabIndex:0,...o,ref:e,style:{...r.style,animationDuration:m.current?"0s":void 0},children:v&&i})})});nP.displayName=tP;function rP(r,e){return`${r}-trigger-${e}`}function sP(r,e){return`${r}-content-${e}`}var N9=K3,iP=J3,oP=eP,aP=nP;const lP=N9,jE=R.forwardRef(({className:r,...e},t)=>h.jsx(iP,{ref:t,className:Zt("inline-flex h-10 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground",r),...e}));jE.displayName=iP.displayName;const Pa=R.forwardRef(({className:r,...e},t)=>h.jsx(oP,{ref:t,className:Zt("inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm",r),...e}));Pa.displayName=oP.displayName;const mp=R.forwardRef(({className:r,...e},t)=>h.jsx(aP,{ref:t,className:Zt("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",r),...e}));mp.displayName=aP.displayName;const ZT=[{name:"red",value:"#EF4444",label:"Red"},{name:"orange",value:"#F97316",label:"Orange"},{name:"yellow",value:"#EAB308",label:"Yellow"},{name:"green",value:"#22C55E",label:"Green"},{name:"blue",value:"#3B82F6",label:"Blue"},{name:"purple",value:"#A855F7",label:"Purple"},{name:"pink",value:"#EC4899",label:"Pink"},{name:"teal",value:"#14B8A6",label:"Teal"},{name:"indigo",value:"#6366F1",label:"Indigo"},{name:"brown",value:"#A3A3A3",label:"Gray"}],P9=({isOpen:r,onClose:e,selectedDate:t,classId:n,onLessonCreated:s})=>{var C,T;const{session:i}=ca(),[o,a]=R.useState(null),[c,d]=R.useState({title:"",description:"",content:"",color:"blue"}),[f,m]=R.useState(!1),[v,x]=R.useState(null),[_,b]=R.useState([]);R.useEffect(()=>{r&&(async()=>{var k;if((k=i==null?void 0:i.user)!=null&&k.email)try{const{data:j,error:D}=await Un.from("teachers").select("id").eq("email",i.user.email).single();if(D)throw D;a(j.id)}catch(j){console.error("Error fetching teacher ID:",j),x("Failed to get teacher information")}})()},[r,(C=i==null?void 0:i.user)==null?void 0:C.email]),R.useEffect(()=>{r&&o&&n&&w()},[r,o,n,t]);const w=async()=>{try{const A=new Date(t);A.setDate(A.getDate()-21);const k=new Date(t);k.setDate(k.getDate()+21);const j=new Date(t.getFullYear(),t.getMonth(),1),D=new Date(t.getFullYear(),t.getMonth()+1,0),{data:L,error:O}=await Un.from("lessons").select("color, created_at").eq("teacher_id",o).eq("class_id",n).eq("is_active",!0).or(`created_at.gte.${A.toISOString()},created_at.gte.${j.toISOString()}`).lte("created_at",k.toISOString());if(O)throw O;const{data:I,error:B}=await Un.from("lesson_instances").select("lessons!inner(color)").eq("lessons.teacher_id",o).eq("lessons.class_id",n).eq("lessons.is_active",!0).eq("is_active",!0).or(`date.gte.${A.toISOString().split("T")[0]},date.gte.${j.toISOString().split("T")[0]}`).lte("date",k.toISOString().split("T")[0]);if(B)throw B;const W=(L==null?void 0:L.map(oe=>oe.color))||[],K=(I==null?void 0:I.map(oe=>oe.lessons.color))||[],ee=[...new Set([...W,...K])];b(ee)}catch(A){console.error("Error fetching used colors:",A)}},S=async A=>{if(A.preventDefault(),!c.title.trim()){x("Title is required");return}if(!o){x("Teacher information not available");return}m(!0),x(null);try{const k={title:c.title.trim(),content:c.content.trim()||null,color:c.color,teacher_id:o,class_id:n},{data:j,error:D}=await Un.from("lessons").insert([k]).select().single();if(D)throw D;const L={lesson_id:j.id,date:t.toISOString().split("T")[0],status:"taught"},{data:O,error:I}=await Un.from("lesson_instances").insert([L]).select().single();if(I)throw I;s==null||s(j,O),e(),d({title:"",description:"",content:"",color:"blue"})}catch(k){x(k.message||"Failed to create lesson")}finally{m(!1)}};return r?h.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:h.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-2xl w-full max-h-[95vh] overflow-hidden",children:[h.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200",children:[h.jsxs("div",{children:[h.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Create New Lesson"}),h.jsxs("p",{className:"text-sm text-gray-600 mt-1",children:["For ",t.toLocaleDateString("en-US",{weekday:"long",month:"long",day:"numeric"})]})]}),h.jsx("button",{onClick:e,className:"p-2 hover:bg-gray-100 rounded-lg transition-colors",children:h.jsx(ih,{className:"w-5 h-5"})})]}),h.jsx("form",{onSubmit:S,className:"p-6 overflow-y-auto max-h-[calc(95vh-200px)]",children:h.jsxs("div",{className:"space-y-6",children:[h.jsxs("div",{children:[h.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Lesson Title *"}),h.jsx("input",{type:"text",value:c.title,onChange:A=>d(k=>({...k,title:A.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"e.g., Multiplication Tables",maxLength:100})]}),h.jsxs("div",{children:[h.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Lesson Content"}),h.jsx("textarea",{value:c.content,onChange:A=>d(k=>({...k,content:A.target.value})),rows:6,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent resize-none",placeholder:"Detailed lesson content, notes, objectives, etc. (optional)"})]}),h.jsxs("div",{children:[h.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[h.jsx(i5,{className:"w-4 h-4 inline mr-1"}),"Lesson Color"]}),_.length>0&&h.jsx("p",{className:"text-xs text-amber-600 mb-3",children:"Some colors are unavailable (used within 3 weeks or same month)"}),h.jsx("div",{className:"grid grid-cols-10 gap-2",children:ZT.map(A=>{const k=_.includes(A.name),j=c.color===A.name;return h.jsx("button",{type:"button",onClick:()=>!k&&d(D=>({...D,color:A.name})),disabled:k,className:`
                        relative w-8 h-8 rounded-lg border-2 transition-all
                        ${j?"border-gray-900 ring-2 ring-gray-900 ring-offset-2":"border-gray-200 hover:border-gray-400"}
                        ${k?"opacity-50 cursor-not-allowed":"cursor-pointer hover:scale-105"}
                      `,style:{backgroundColor:A.value},title:k?`${A.label} - Used recently`:A.label,children:k&&h.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:h.jsx(ih,{className:"w-3 h-3 text-white"})})},A.name)})}),h.jsxs("p",{className:"text-xs text-gray-500 mt-2",children:["Selected: ",(T=ZT.find(A=>A.name===c.color))==null?void 0:T.label]})]}),v&&h.jsx("div",{className:"p-3 bg-red-50 border border-red-200 rounded-lg",children:h.jsx("p",{className:"text-sm text-red-600",children:v})})]})}),h.jsxs("div",{className:"flex items-center justify-end gap-3 p-6 border-t border-gray-200 bg-gray-50",children:[h.jsx("button",{type:"button",onClick:e,className:"px-4 py-2 text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors",children:"Cancel"}),h.jsxs("button",{onClick:S,disabled:f||!c.title.trim(),className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors flex items-center gap-2",children:[h.jsx(C_,{className:"w-4 h-4"}),f?"Creating...":"Create Lesson"]})]})]})}):null},zf={red:"#EF4444",orange:"#F97316",yellow:"#EAB308",green:"#22C55E",blue:"#3B82F6",purple:"#A855F7",pink:"#EC4899",teal:"#14B8A6",indigo:"#6366F1",brown:"#A3A3A3"},I9=({classId:r,onLessonsChange:e})=>{var ht;const{session:t}=ca(),[n,s]=R.useState(new Date),[i,o]=R.useState("weekly"),[a,c]=R.useState(!1),[d,f]=R.useState(!1),[m,v]=R.useState(!1),[x,_]=R.useState(null),[b,w]=R.useState([]),[S,C]=R.useState(!1),[T,A]=R.useState(!1),[k,j]=R.useState(null),[D,L]=R.useState(null),[O,I]=R.useState(null),B=(Ie,$)=>{A(!0),j($),Ie.dataTransfer.effectAllowed="move";const Ce=new Image;Ie.dataTransfer.setDragImage(Ce,0,0)},W=(Ie,$,Ce)=>{Ie.preventDefault(),Ie.dataTransfer.dropEffect="move";const ke=$.toISOString().split("T")[0];L(ke),I(Ce)},K=Ie=>{Ie.preventDefault()},ee=Ie=>{const $=Ie.currentTarget.getBoundingClientRect(),Ce=Ie.clientX,ke=Ie.clientY;(Ce<$.left||Ce>$.right||ke<$.top||ke>$.bottom)&&(L(null),I(null))},oe=async(Ie,$,Ce)=>{if(Ie.preventDefault(),!k)return;const ke=$.toISOString().split("T")[0];if(b.find(Ae=>Ae.lesson_id===k.lesson_id&&Ae.date===ke&&Ae.status===Ce)){ne();return}try{const Ae={lesson_id:k.lesson_id,date:ke,status:Ce},{error:rt}=await Un.from("lesson_instances").insert([Ae]);if(rt)throw rt;ce()}catch(Ae){console.error("Error creating lesson instance:",Ae)}ne()},ne=()=>{A(!1),j(null),L(null),I(null)},ce=async()=>{var Ie;if(!(!((Ie=t==null?void 0:t.user)!=null&&Ie.email)||!r)){C(!0);try{const{data:$,error:Ce}=await Un.from("teachers").select("id").eq("email",t.user.email).single();if(Ce)throw Ce;const{data:ke,error:Ge}=await Un.from("lesson_instances").select(`
          *,
          lesson:lessons(*)
        `).eq("lesson.teacher_id",$.id).eq("lesson.class_id",r).eq("lesson.is_active",!0).eq("is_active",!0).order("date",{ascending:!0});if(Ge)throw Ge;w(ke||[])}catch($){console.error("Error fetching lessons:",$)}finally{C(!1)}}};R.useEffect(()=>{ce()},[(ht=t==null?void 0:t.user)==null?void 0:ht.email,r]);const V=Ie=>{const $=new Date(Ie),Ce=$.getDay(),ke=$.getDate()-Ce;return new Date($.setDate(ke))},q=R.useMemo(()=>{const Ie=V(n),$=[];if(a)for(let Ce=0;Ce<7;Ce++){const ke=new Date(Ie);ke.setDate(Ie.getDate()+Ce),$.push({date:ke,isWeekend:Ce===0||Ce===6,showGap:Ce===0||Ce===5})}else{const Ce=new Date(Ie);Ce.setDate(Ie.getDate()-2),$.push({date:Ce,isWeekend:!1,showGap:!0});for(let Ge=1;Ge<=5;Ge++){const Ae=new Date(Ie);Ae.setDate(Ie.getDate()+Ge),$.push({date:Ae,isWeekend:!1,showGap:Ge===5})}const ke=new Date(Ie);ke.setDate(Ie.getDate()+8),$.push({date:ke,isWeekend:!1,showGap:!1})}return $},[n,a]),Z=R.useMemo(()=>{const Ie=n.getFullYear(),$=n.getMonth(),Ce=new Date(Ie,$,1),ke=new Date(Ce);ke.setDate(ke.getDate()-Ce.getDay());const Ge=[],Ae=new Date(ke);for(let rt=0;rt<42;rt++)Ge.push({date:new Date(Ae),isCurrentMonth:Ae.getMonth()===$,isWeekend:Ae.getDay()===0||Ae.getDay()===6}),Ae.setDate(Ae.getDate()+1);return Ge},[n]),X=Ie=>{const $=new Date;return Ie.toDateString()===$.toDateString()},ie=()=>{var nt,jt;if(i!=="weekly")return n.toLocaleDateString("en-US",{month:"long",year:"numeric"});const Ie=q.filter(Q=>!Q.isWeekend||a),$=(nt=Ie[0])==null?void 0:nt.date,Ce=(jt=Ie[Ie.length-1])==null?void 0:jt.date;if(!$||!Ce)return n.toLocaleDateString("en-US",{month:"long",year:"numeric"});const ke={month:"short",day:"numeric"},Ge=$.toLocaleDateString("en-US",ke),Ae=Ce.toLocaleDateString("en-US",ke),rt=$.getFullYear();return`${Ge} - ${Ae}, ${rt}${a?"":" (weekdays)"}`},be=Ie=>{const $=new Date(n);i==="monthly"?$.setMonth($.getMonth()+Ie):$.setDate($.getDate()+Ie*7),s($)},ue=()=>{s(new Date)},Ee=Ie=>{_(Ie),v(!0)},Fe=()=>{v(!1),_(null)},me=(Ie,$)=>{ce(),e(),console.log("Lesson created:",Ie,$)},je=Ie=>{const $=Ie.toISOString().split("T")[0];return b.filter(Ce=>Ce.date===$)},Xe=(Ie,$)=>{const Ce=Ie.toISOString().split("T")[0];return b.filter(ke=>ke.date===Ce&&ke.status===$)},$e=({instance:Ie})=>{const $=Ie.lesson,Ce=zf[$.color]||zf.blue,ke=()=>{switch(Ie.status){case"taught":return h.jsx(t0,{className:"w-3 h-3 text-white"});case"assigned":return h.jsx(JO,{className:"w-3 h-3 text-white"});case"review":return h.jsx(t0,{className:"w-3 h-3 text-white"});default:return null}};return h.jsxs("div",{draggable:!0,onDragStart:Ge=>B(Ge,Ie),onDragEnd:ne,className:`
          flex items-center gap-2 p-2 rounded-md text-white text-xs font-medium mb-1 
          cursor-move hover:opacity-80 transition-opacity select-none
          ${T&&(k==null?void 0:k.id)===Ie.id?"opacity-50":""}
        `,style:{backgroundColor:Ce},title:`${$.title}${$.description?` - ${$.description}`:""}
Drag to create timeline`,children:[ke(),h.jsx("span",{className:"truncate flex-1",children:$.title})]})},dt=({dayInfo:Ie,isMonthly:$=!1})=>{const{date:Ce,isCurrentMonth:ke=!0,isWeekend:Ge,showGap:Ae}=Ie,rt=X(Ce),qe=Ce.toISOString().split("T")[0],nt=D===qe,jt=k?zf[k.lesson.color]||zf.blue:"";return $?h.jsxs("div",{className:`
            border border-gray-200 min-h-[120px] p-1
            ${ke?"bg-white":"text-gray-400 bg-gray-50"}
            ${rt?"ring-2 ring-blue-500":""}
            ${!a&&Ge?"hidden":""}
          `,children:[h.jsx("div",{className:"text-sm font-medium mb-1",children:Ce.getDate()}),h.jsxs("div",{className:"flex flex-wrap gap-1",children:[je(Ce).slice(0,3).map(Q=>h.jsx("div",{className:"w-2 h-2 rounded-full",style:{backgroundColor:zf[Q.lesson.color]||zf.blue},title:Q.lesson.title},Q.id)),je(Ce).length>3&&h.jsxs("div",{className:"text-xs text-gray-500",children:["+",je(Ce).length-3]})]})]}):h.jsx("div",{className:"flex flex-col",children:h.jsxs("div",{className:`
            border border-gray-200 min-h-[500px] flex flex-col flex-1
            ${rt?"ring-2 ring-blue-500":""}
            ${nt?"ring-2 ring-yellow-400":""}
            bg-white
          `,children:[h.jsxs("div",{className:"text-center py-3 border-b border-gray-200 bg-gray-50",children:[h.jsx("div",{className:"text-sm font-medium text-gray-600",children:Ce.toLocaleDateString("en-US",{weekday:"short"})}),h.jsx("div",{className:"text-xl font-bold text-gray-900",children:Ce.getDate()})]}),h.jsxs("div",{className:`
              h-[180px] border-b border-gray-300 p-3 cursor-pointer hover:bg-gray-50 overflow-y-auto
              ${nt&&O==="taught"?"bg-green-50 border-green-300":""}
            `,onClick:Q=>{T||Ee(Ce)},onDragOver:Q=>W(Q,Ce,"taught"),onDragEnter:K,onDragLeave:ee,onDrop:Q=>oe(Q,Ce,"taught"),children:[Xe(Ce,"taught").map(Q=>h.jsx($e,{instance:Q},Q.id)),nt&&O==="taught"&&h.jsx("div",{className:"text-xs text-green-600 font-medium",children:"Drop here for TAUGHT status"})]}),h.jsx("div",{className:`
              h-1 flex-shrink-0 transition-colors
              ${nt?"":"bg-gray-200"}
            `,style:{backgroundColor:nt?jt:void 0}}),h.jsxs("div",{className:`
              h-[180px] p-3 overflow-y-auto
              ${nt&&O==="assigned"?"bg-blue-50 border-blue-300 border":""}
            `,onDragOver:Q=>W(Q,Ce,"assigned"),onDragEnter:K,onDragLeave:ee,onDrop:Q=>oe(Q,Ce,"assigned"),children:[Xe(Ce,"assigned").map(Q=>h.jsx($e,{instance:Q},Q.id)),nt&&O==="assigned"&&h.jsx("div",{className:"text-xs text-blue-600 font-medium",children:"Drop here for ASSIGNED status"})]})]})})};return h.jsxs("div",{className:"space-y-4 relative",children:[h.jsxs("div",{className:"flex items-center justify-between",children:[h.jsx("div",{className:"flex items-center gap-4",children:h.jsx("h2",{className:"text-xl font-bold text-gray-900",children:"Lesson Calendar"})}),h.jsxs("div",{className:"flex items-center gap-4",children:[h.jsx("button",{onClick:()=>f(!d),className:"p-2 rounded-lg border border-gray-300 hover:bg-gray-100",children:h.jsx(r0,{className:"w-4 h-4"})}),h.jsxs("div",{className:"flex bg-gray-100 rounded-lg p-1",children:[h.jsx("button",{onClick:()=>o("weekly"),className:`px-4 py-2 rounded-md text-sm font-medium transition-colors ${i==="weekly"?"bg-white text-gray-900 shadow-sm":"text-gray-600 hover:text-gray-900"}`,children:" Weekly"}),h.jsx("button",{onClick:()=>o("monthly"),className:`px-4 py-2 rounded-md text-sm font-medium transition-colors ${i==="monthly"?"bg-white text-gray-900 shadow-sm":"text-gray-600 hover:text-gray-900"}`,children:" Monthly"})]})]})]}),d&&h.jsxs("div",{className:"p-4 bg-white rounded-lg border border-gray-200 shadow-sm",children:[h.jsx("h3",{className:"font-medium text-gray-900 mb-3",children:"Settings"}),h.jsx("div",{className:"flex flex-wrap gap-4",children:h.jsxs("label",{className:"flex items-center gap-2",children:[h.jsx("input",{type:"checkbox",checked:a,onChange:Ie=>c(Ie.target.checked),className:"rounded border-gray-300"}),h.jsx("span",{className:"text-sm text-gray-700",children:"Show weekends"})]})})]}),h.jsxs("div",{className:"flex items-center justify-between",children:[h.jsx("button",{onClick:()=>be(-1),className:"p-2 rounded-lg border border-gray-300 hover:bg-gray-100",children:h.jsx(QO,{className:"w-5 h-5"})}),h.jsx("h2",{className:"text-2xl font-semibold text-gray-900",children:ie()}),h.jsx("button",{onClick:()=>be(1),className:"p-2 rounded-lg border border-gray-300 hover:bg-gray-100",children:h.jsx(n0,{className:"w-5 h-5"})}),h.jsx("button",{onClick:ue,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50",children:" Today"})]}),i==="weekly"?h.jsxs("div",{className:`bg-white rounded-lg shadow-sm border border-gray-200 overflow-hidden ${T?"select-none":""}`,children:[h.jsx("div",{className:"flex gap-0",children:q.map((Ie,$)=>h.jsxs(re.Fragment,{children:[h.jsx("div",{className:"flex-1 min-w-0",children:h.jsx(dt,{dayInfo:Ie})}),Ie.showGap&&h.jsx("div",{className:"w-6 bg-gray-100 border-l border-r border-gray-200"})]},$))}),T&&h.jsx("div",{className:"absolute top-4 left-1/2 transform -translate-x-1/2 bg-black bg-opacity-75 text-white px-4 py-2 rounded-lg text-sm font-medium z-10",children:"Drag to create timeline  Drop in TAUGHT (top) or ASSIGNED (bottom) section"})]}):h.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 overflow-hidden",children:[h.jsx("div",{className:"grid grid-cols-7 gap-0 border-b border-gray-200 bg-gray-50",children:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"].map(Ie=>h.jsx("div",{className:"p-3 text-center font-medium text-gray-700",children:Ie},Ie))}),h.jsx("div",{className:"grid grid-cols-7 gap-0",children:Z.map((Ie,$)=>h.jsx(dt,{dayInfo:Ie,isMonthly:!0},$))})]}),x&&h.jsx(P9,{isOpen:m,onClose:Fe,selectedDate:x,classId:r,onLessonCreated:me})]})},vu=R.forwardRef(({className:r,...e},t)=>h.jsx("textarea",{className:Zt("flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",r),ref:t,...e}));vu.displayName="Textarea";var k9="Label",cP=R.forwardRef((r,e)=>h.jsx($t.label,{...r,ref:e,onMouseDown:t=>{var s;t.target.closest("button, input, select, textarea")||((s=r.onMouseDown)==null||s.call(r,t),!t.defaultPrevented&&t.detail>1&&t.preventDefault())}}));cP.displayName=k9;var uP=cP;const D9=M_("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),zs=R.forwardRef(({className:r,...e},t)=>h.jsx(uP,{ref:t,className:Zt(D9(),r),...e}));zs.displayName=uP.displayName;const Jl=R.forwardRef(({className:r,type:e,...t},n)=>h.jsx("input",{type:e,className:Zt("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",r),ref:n,...t}));Jl.displayName="Input";var R1=0;function FE(){R.useEffect(()=>{const r=document.querySelectorAll("[data-radix-focus-guard]");return document.body.insertAdjacentElement("afterbegin",r[0]??eC()),document.body.insertAdjacentElement("beforeend",r[1]??eC()),R1++,()=>{R1===1&&document.querySelectorAll("[data-radix-focus-guard]").forEach(e=>e.remove()),R1--}},[])}function eC(){const r=document.createElement("span");return r.setAttribute("data-radix-focus-guard",""),r.tabIndex=0,r.style.outline="none",r.style.opacity="0",r.style.position="fixed",r.style.pointerEvents="none",r}var N1="focusScope.autoFocusOnMount",P1="focusScope.autoFocusOnUnmount",tC={bubbles:!1,cancelable:!0},L9="FocusScope",j_=R.forwardRef((r,e)=>{const{loop:t=!1,trapped:n=!1,onMountAutoFocus:s,onUnmountAutoFocus:i,...o}=r,[a,c]=R.useState(null),d=Di(s),f=Di(i),m=R.useRef(null),v=Cn(e,b=>c(b)),x=R.useRef({paused:!1,pause(){this.paused=!0},resume(){this.paused=!1}}).current;R.useEffect(()=>{if(n){let b=function(T){if(x.paused||!a)return;const A=T.target;a.contains(A)?m.current=A:Xc(m.current,{select:!0})},w=function(T){if(x.paused||!a)return;const A=T.relatedTarget;A!==null&&(a.contains(A)||Xc(m.current,{select:!0}))},S=function(T){if(document.activeElement===document.body)for(const k of T)k.removedNodes.length>0&&Xc(a)};document.addEventListener("focusin",b),document.addEventListener("focusout",w);const C=new MutationObserver(S);return a&&C.observe(a,{childList:!0,subtree:!0}),()=>{document.removeEventListener("focusin",b),document.removeEventListener("focusout",w),C.disconnect()}}},[n,a,x.paused]),R.useEffect(()=>{if(a){rC.add(x);const b=document.activeElement;if(!a.contains(b)){const S=new CustomEvent(N1,tC);a.addEventListener(N1,d),a.dispatchEvent(S),S.defaultPrevented||(O9(z9(dP(a)),{select:!0}),document.activeElement===b&&Xc(a))}return()=>{a.removeEventListener(N1,d),setTimeout(()=>{const S=new CustomEvent(P1,tC);a.addEventListener(P1,f),a.dispatchEvent(S),S.defaultPrevented||Xc(b??document.body,{select:!0}),a.removeEventListener(P1,f),rC.remove(x)},0)}}},[a,d,f,x]);const _=R.useCallback(b=>{if(!t&&!n||x.paused)return;const w=b.key==="Tab"&&!b.altKey&&!b.ctrlKey&&!b.metaKey,S=document.activeElement;if(w&&S){const C=b.currentTarget,[T,A]=j9(C);T&&A?!b.shiftKey&&S===A?(b.preventDefault(),t&&Xc(T,{select:!0})):b.shiftKey&&S===T&&(b.preventDefault(),t&&Xc(A,{select:!0})):S===C&&b.preventDefault()}},[t,n,x.paused]);return h.jsx($t.div,{tabIndex:-1,...o,ref:v,onKeyDown:_})});j_.displayName=L9;function O9(r,{select:e=!1}={}){const t=document.activeElement;for(const n of r)if(Xc(n,{select:e}),document.activeElement!==t)return}function j9(r){const e=dP(r),t=nC(e,r),n=nC(e.reverse(),r);return[t,n]}function dP(r){const e=[],t=document.createTreeWalker(r,NodeFilter.SHOW_ELEMENT,{acceptNode:n=>{const s=n.tagName==="INPUT"&&n.type==="hidden";return n.disabled||n.hidden||s?NodeFilter.FILTER_SKIP:n.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;t.nextNode();)e.push(t.currentNode);return e}function nC(r,e){for(const t of r)if(!F9(t,{upTo:e}))return t}function F9(r,{upTo:e}){if(getComputedStyle(r).visibility==="hidden")return!0;for(;r;){if(e!==void 0&&r===e)return!1;if(getComputedStyle(r).display==="none")return!0;r=r.parentElement}return!1}function U9(r){return r instanceof HTMLInputElement&&"select"in r}function Xc(r,{select:e=!1}={}){if(r&&r.focus){const t=document.activeElement;r.focus({preventScroll:!0}),r!==t&&U9(r)&&e&&r.select()}}var rC=B9();function B9(){let r=[];return{add(e){const t=r[0];e!==t&&(t==null||t.pause()),r=sC(r,e),r.unshift(e)},remove(e){var t;r=sC(r,e),(t=r[0])==null||t.resume()}}}function sC(r,e){const t=[...r],n=t.indexOf(e);return n!==-1&&t.splice(n,1),t}function z9(r){return r.filter(e=>e.tagName!=="A")}var V9=function(r){if(typeof document>"u")return null;var e=Array.isArray(r)?r[0]:r;return e.ownerDocument.body},Vf=new WeakMap,ax=new WeakMap,lx={},I1=0,hP=function(r){return r&&(r.host||hP(r.parentNode))},H9=function(r,e){return e.map(function(t){if(r.contains(t))return t;var n=hP(t);return n&&r.contains(n)?n:(console.error("aria-hidden",t,"in not contained inside",r,". Doing nothing"),null)}).filter(function(t){return!!t})},G9=function(r,e,t,n){var s=H9(e,Array.isArray(r)?r:[r]);lx[t]||(lx[t]=new WeakMap);var i=lx[t],o=[],a=new Set,c=new Set(s),d=function(m){!m||a.has(m)||(a.add(m),d(m.parentNode))};s.forEach(d);var f=function(m){!m||c.has(m)||Array.prototype.forEach.call(m.children,function(v){if(a.has(v))f(v);else try{var x=v.getAttribute(n),_=x!==null&&x!=="false",b=(Vf.get(v)||0)+1,w=(i.get(v)||0)+1;Vf.set(v,b),i.set(v,w),o.push(v),b===1&&_&&ax.set(v,!0),w===1&&v.setAttribute(t,"true"),_||v.setAttribute(n,"true")}catch(S){console.error("aria-hidden: cannot operate on ",v,S)}})};return f(e),a.clear(),I1++,function(){o.forEach(function(m){var v=Vf.get(m)-1,x=i.get(m)-1;Vf.set(m,v),i.set(m,x),v||(ax.has(m)||m.removeAttribute(n),ax.delete(m)),x||m.removeAttribute(t)}),I1--,I1||(Vf=new WeakMap,Vf=new WeakMap,ax=new WeakMap,lx={})}},UE=function(r,e,t){t===void 0&&(t="data-aria-hidden");var n=Array.from(Array.isArray(r)?r:[r]),s=V9(r);return s?(n.push.apply(n,Array.from(s.querySelectorAll("[aria-live], script"))),G9(n,s,t,"aria-hidden")):function(){return null}},Ia=function(){return Ia=Object.assign||function(e){for(var t,n=1,s=arguments.length;n<s;n++){t=arguments[n];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])}return e},Ia.apply(this,arguments)};function fP(r,e){var t={};for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&e.indexOf(n)<0&&(t[n]=r[n]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,n=Object.getOwnPropertySymbols(r);s<n.length;s++)e.indexOf(n[s])<0&&Object.prototype.propertyIsEnumerable.call(r,n[s])&&(t[n[s]]=r[n[s]]);return t}function W9(r,e,t){if(t||arguments.length===2)for(var n=0,s=e.length,i;n<s;n++)(i||!(n in e))&&(i||(i=Array.prototype.slice.call(e,0,n)),i[n]=e[n]);return r.concat(i||Array.prototype.slice.call(e))}var dy="right-scroll-bar-position",hy="width-before-scroll-bar",$9="with-scroll-bars-hidden",q9="--removed-body-scroll-bar-size";function k1(r,e){return typeof r=="function"?r(e):r&&(r.current=e),r}function X9(r,e){var t=R.useState(function(){return{value:r,callback:e,facade:{get current(){return t.value},set current(n){var s=t.value;s!==n&&(t.value=n,t.callback(n,s))}}}})[0];return t.callback=e,t.facade}var Y9=typeof window<"u"?R.useLayoutEffect:R.useEffect,iC=new WeakMap;function K9(r,e){var t=X9(null,function(n){return r.forEach(function(s){return k1(s,n)})});return Y9(function(){var n=iC.get(t);if(n){var s=new Set(n),i=new Set(r),o=t.current;s.forEach(function(a){i.has(a)||k1(a,null)}),i.forEach(function(a){s.has(a)||k1(a,o)})}iC.set(t,r)},[r]),t}function Q9(r){return r}function J9(r,e){e===void 0&&(e=Q9);var t=[],n=!1,s={read:function(){if(n)throw new Error("Sidecar: could not `read` from an `assigned` medium. `read` could be used only with `useMedium`.");return t.length?t[t.length-1]:r},useMedium:function(i){var o=e(i,n);return t.push(o),function(){t=t.filter(function(a){return a!==o})}},assignSyncMedium:function(i){for(n=!0;t.length;){var o=t;t=[],o.forEach(i)}t={push:function(a){return i(a)},filter:function(){return t}}},assignMedium:function(i){n=!0;var o=[];if(t.length){var a=t;t=[],a.forEach(i),o=t}var c=function(){var f=o;o=[],f.forEach(i)},d=function(){return Promise.resolve().then(c)};d(),t={push:function(f){o.push(f),d()},filter:function(f){return o=o.filter(f),t}}}};return s}function Z9(r){r===void 0&&(r={});var e=J9(null);return e.options=Ia({async:!0,ssr:!1},r),e}var pP=function(r){var e=r.sideCar,t=fP(r,["sideCar"]);if(!e)throw new Error("Sidecar: please provide `sideCar` property to import the right car");var n=e.read();if(!n)throw new Error("Sidecar medium not found");return R.createElement(n,Ia({},t))};pP.isSideCarExport=!0;function e7(r,e){return r.useMedium(e),pP}var mP=Z9(),D1=function(){},F_=R.forwardRef(function(r,e){var t=R.useRef(null),n=R.useState({onScrollCapture:D1,onWheelCapture:D1,onTouchMoveCapture:D1}),s=n[0],i=n[1],o=r.forwardProps,a=r.children,c=r.className,d=r.removeScrollBar,f=r.enabled,m=r.shards,v=r.sideCar,x=r.noRelative,_=r.noIsolation,b=r.inert,w=r.allowPinchZoom,S=r.as,C=S===void 0?"div":S,T=r.gapMode,A=fP(r,["forwardProps","children","className","removeScrollBar","enabled","shards","sideCar","noRelative","noIsolation","inert","allowPinchZoom","as","gapMode"]),k=v,j=K9([t,e]),D=Ia(Ia({},A),s);return R.createElement(R.Fragment,null,f&&R.createElement(k,{sideCar:mP,removeScrollBar:d,shards:m,noRelative:x,noIsolation:_,inert:b,setCallbacks:i,allowPinchZoom:!!w,lockRef:t,gapMode:T}),o?R.cloneElement(R.Children.only(a),Ia(Ia({},D),{ref:j})):R.createElement(C,Ia({},D,{className:c,ref:j}),a))});F_.defaultProps={enabled:!0,removeScrollBar:!0,inert:!1};F_.classNames={fullWidth:hy,zeroRight:dy};var t7=function(){if(typeof __webpack_nonce__<"u")return __webpack_nonce__};function n7(){if(!document)return null;var r=document.createElement("style");r.type="text/css";var e=t7();return e&&r.setAttribute("nonce",e),r}function r7(r,e){r.styleSheet?r.styleSheet.cssText=e:r.appendChild(document.createTextNode(e))}function s7(r){var e=document.head||document.getElementsByTagName("head")[0];e.appendChild(r)}var i7=function(){var r=0,e=null;return{add:function(t){r==0&&(e=n7())&&(r7(e,t),s7(e)),r++},remove:function(){r--,!r&&e&&(e.parentNode&&e.parentNode.removeChild(e),e=null)}}},o7=function(){var r=i7();return function(e,t){R.useEffect(function(){return r.add(e),function(){r.remove()}},[e&&t])}},gP=function(){var r=o7(),e=function(t){var n=t.styles,s=t.dynamic;return r(n,s),null};return e},a7={left:0,top:0,right:0,gap:0},L1=function(r){return parseInt(r||"",10)||0},l7=function(r){var e=window.getComputedStyle(document.body),t=e[r==="padding"?"paddingLeft":"marginLeft"],n=e[r==="padding"?"paddingTop":"marginTop"],s=e[r==="padding"?"paddingRight":"marginRight"];return[L1(t),L1(n),L1(s)]},c7=function(r){if(r===void 0&&(r="margin"),typeof window>"u")return a7;var e=l7(r),t=document.documentElement.clientWidth,n=window.innerWidth;return{left:e[0],top:e[1],right:e[2],gap:Math.max(0,n-t+e[2]-e[0])}},u7=gP(),Mp="data-scroll-locked",d7=function(r,e,t,n){var s=r.left,i=r.top,o=r.right,a=r.gap;return t===void 0&&(t="margin"),`
  .`.concat($9,` {
   overflow: hidden `).concat(n,`;
   padding-right: `).concat(a,"px ").concat(n,`;
  }
  body[`).concat(Mp,`] {
    overflow: hidden `).concat(n,`;
    overscroll-behavior: contain;
    `).concat([e&&"position: relative ".concat(n,";"),t==="margin"&&`
    padding-left: `.concat(s,`px;
    padding-top: `).concat(i,`px;
    padding-right: `).concat(o,`px;
    margin-left:0;
    margin-top:0;
    margin-right: `).concat(a,"px ").concat(n,`;
    `),t==="padding"&&"padding-right: ".concat(a,"px ").concat(n,";")].filter(Boolean).join(""),`
  }
  
  .`).concat(dy,` {
    right: `).concat(a,"px ").concat(n,`;
  }
  
  .`).concat(hy,` {
    margin-right: `).concat(a,"px ").concat(n,`;
  }
  
  .`).concat(dy," .").concat(dy,` {
    right: 0 `).concat(n,`;
  }
  
  .`).concat(hy," .").concat(hy,` {
    margin-right: 0 `).concat(n,`;
  }
  
  body[`).concat(Mp,`] {
    `).concat(q9,": ").concat(a,`px;
  }
`)},oC=function(){var r=parseInt(document.body.getAttribute(Mp)||"0",10);return isFinite(r)?r:0},h7=function(){R.useEffect(function(){return document.body.setAttribute(Mp,(oC()+1).toString()),function(){var r=oC()-1;r<=0?document.body.removeAttribute(Mp):document.body.setAttribute(Mp,r.toString())}},[])},f7=function(r){var e=r.noRelative,t=r.noImportant,n=r.gapMode,s=n===void 0?"margin":n;h7();var i=R.useMemo(function(){return c7(s)},[s]);return R.createElement(u7,{styles:d7(i,!e,s,t?"":"!important")})},Eb=!1;if(typeof window<"u")try{var cx=Object.defineProperty({},"passive",{get:function(){return Eb=!0,!0}});window.addEventListener("test",cx,cx),window.removeEventListener("test",cx,cx)}catch{Eb=!1}var Hf=Eb?{passive:!1}:!1,p7=function(r){return r.tagName==="TEXTAREA"},vP=function(r,e){if(!(r instanceof Element))return!1;var t=window.getComputedStyle(r);return t[e]!=="hidden"&&!(t.overflowY===t.overflowX&&!p7(r)&&t[e]==="visible")},m7=function(r){return vP(r,"overflowY")},g7=function(r){return vP(r,"overflowX")},aC=function(r,e){var t=e.ownerDocument,n=e;do{typeof ShadowRoot<"u"&&n instanceof ShadowRoot&&(n=n.host);var s=xP(r,n);if(s){var i=yP(r,n),o=i[1],a=i[2];if(o>a)return!0}n=n.parentNode}while(n&&n!==t.body);return!1},v7=function(r){var e=r.scrollTop,t=r.scrollHeight,n=r.clientHeight;return[e,t,n]},x7=function(r){var e=r.scrollLeft,t=r.scrollWidth,n=r.clientWidth;return[e,t,n]},xP=function(r,e){return r==="v"?m7(e):g7(e)},yP=function(r,e){return r==="v"?v7(e):x7(e)},y7=function(r,e){return r==="h"&&e==="rtl"?-1:1},_7=function(r,e,t,n,s){var i=y7(r,window.getComputedStyle(e).direction),o=i*n,a=t.target,c=e.contains(a),d=!1,f=o>0,m=0,v=0;do{if(!a)break;var x=yP(r,a),_=x[0],b=x[1],w=x[2],S=b-w-i*_;(_||S)&&xP(r,a)&&(m+=S,v+=_);var C=a.parentNode;a=C&&C.nodeType===Node.DOCUMENT_FRAGMENT_NODE?C.host:C}while(!c&&a!==document.body||c&&(e.contains(a)||e===a));return(f&&Math.abs(m)<1||!f&&Math.abs(v)<1)&&(d=!0),d},ux=function(r){return"changedTouches"in r?[r.changedTouches[0].clientX,r.changedTouches[0].clientY]:[0,0]},lC=function(r){return[r.deltaX,r.deltaY]},cC=function(r){return r&&"current"in r?r.current:r},w7=function(r,e){return r[0]===e[0]&&r[1]===e[1]},S7=function(r){return`
  .block-interactivity-`.concat(r,` {pointer-events: none;}
  .allow-interactivity-`).concat(r,` {pointer-events: all;}
`)},b7=0,Gf=[];function E7(r){var e=R.useRef([]),t=R.useRef([0,0]),n=R.useRef(),s=R.useState(b7++)[0],i=R.useState(gP)[0],o=R.useRef(r);R.useEffect(function(){o.current=r},[r]),R.useEffect(function(){if(r.inert){document.body.classList.add("block-interactivity-".concat(s));var b=W9([r.lockRef.current],(r.shards||[]).map(cC),!0).filter(Boolean);return b.forEach(function(w){return w.classList.add("allow-interactivity-".concat(s))}),function(){document.body.classList.remove("block-interactivity-".concat(s)),b.forEach(function(w){return w.classList.remove("allow-interactivity-".concat(s))})}}},[r.inert,r.lockRef.current,r.shards]);var a=R.useCallback(function(b,w){if("touches"in b&&b.touches.length===2||b.type==="wheel"&&b.ctrlKey)return!o.current.allowPinchZoom;var S=ux(b),C=t.current,T="deltaX"in b?b.deltaX:C[0]-S[0],A="deltaY"in b?b.deltaY:C[1]-S[1],k,j=b.target,D=Math.abs(T)>Math.abs(A)?"h":"v";if("touches"in b&&D==="h"&&j.type==="range")return!1;var L=aC(D,j);if(!L)return!0;if(L?k=D:(k=D==="v"?"h":"v",L=aC(D,j)),!L)return!1;if(!n.current&&"changedTouches"in b&&(T||A)&&(n.current=k),!k)return!0;var O=n.current||k;return _7(O,w,b,O==="h"?T:A)},[]),c=R.useCallback(function(b){var w=b;if(!(!Gf.length||Gf[Gf.length-1]!==i)){var S="deltaY"in w?lC(w):ux(w),C=e.current.filter(function(k){return k.name===w.type&&(k.target===w.target||w.target===k.shadowParent)&&w7(k.delta,S)})[0];if(C&&C.should){w.cancelable&&w.preventDefault();return}if(!C){var T=(o.current.shards||[]).map(cC).filter(Boolean).filter(function(k){return k.contains(w.target)}),A=T.length>0?a(w,T[0]):!o.current.noIsolation;A&&w.cancelable&&w.preventDefault()}}},[]),d=R.useCallback(function(b,w,S,C){var T={name:b,delta:w,target:S,should:C,shadowParent:M7(S)};e.current.push(T),setTimeout(function(){e.current=e.current.filter(function(A){return A!==T})},1)},[]),f=R.useCallback(function(b){t.current=ux(b),n.current=void 0},[]),m=R.useCallback(function(b){d(b.type,lC(b),b.target,a(b,r.lockRef.current))},[]),v=R.useCallback(function(b){d(b.type,ux(b),b.target,a(b,r.lockRef.current))},[]);R.useEffect(function(){return Gf.push(i),r.setCallbacks({onScrollCapture:m,onWheelCapture:m,onTouchMoveCapture:v}),document.addEventListener("wheel",c,Hf),document.addEventListener("touchmove",c,Hf),document.addEventListener("touchstart",f,Hf),function(){Gf=Gf.filter(function(b){return b!==i}),document.removeEventListener("wheel",c,Hf),document.removeEventListener("touchmove",c,Hf),document.removeEventListener("touchstart",f,Hf)}},[]);var x=r.removeScrollBar,_=r.inert;return R.createElement(R.Fragment,null,_?R.createElement(i,{styles:S7(s)}):null,x?R.createElement(f7,{noRelative:r.noRelative,gapMode:r.gapMode}):null)}function M7(r){for(var e=null;r!==null;)r instanceof ShadowRoot&&(e=r.host,r=r.host),r=r.parentNode;return e}const T7=e7(mP,E7);var U_=R.forwardRef(function(r,e){return R.createElement(F_,Ia({},r,{ref:e,sideCar:T7}))});U_.classNames=F_.classNames;var Mb=["Enter"," "],C7=["ArrowDown","PageUp","Home"],_P=["ArrowUp","PageDown","End"],A7=[...C7,..._P],R7={ltr:[...Mb,"ArrowRight"],rtl:[...Mb,"ArrowLeft"]},N7={ltr:["ArrowLeft"],rtl:["ArrowRight"]},H0="Menu",[d0,P7,I7]=S_(H0),[yh,wP]=to(H0,[I7,sm,um]),B_=sm(),SP=um(),[k7,_h]=yh(H0),[D7,G0]=yh(H0),bP=r=>{const{__scopeMenu:e,open:t=!1,children:n,dir:s,onOpenChange:i,modal:o=!0}=r,a=B_(e),[c,d]=R.useState(null),f=R.useRef(!1),m=Di(i),v=z0(s);return R.useEffect(()=>{const x=()=>{f.current=!0,document.addEventListener("pointerdown",_,{capture:!0,once:!0}),document.addEventListener("pointermove",_,{capture:!0,once:!0})},_=()=>f.current=!1;return document.addEventListener("keydown",x,{capture:!0}),()=>{document.removeEventListener("keydown",x,{capture:!0}),document.removeEventListener("pointerdown",_,{capture:!0}),document.removeEventListener("pointermove",_,{capture:!0})}},[]),h.jsx(ON,{...a,children:h.jsx(k7,{scope:e,open:t,onOpenChange:m,content:c,onContentChange:d,children:h.jsx(D7,{scope:e,onClose:R.useCallback(()=>m(!1),[m]),isUsingKeyboardRef:f,dir:v,modal:o,children:n})})})};bP.displayName=H0;var L7="MenuAnchor",BE=R.forwardRef((r,e)=>{const{__scopeMenu:t,...n}=r,s=B_(t);return h.jsx(pE,{...s,...n,ref:e})});BE.displayName=L7;var zE="MenuPortal",[O7,EP]=yh(zE,{forceMount:void 0}),MP=r=>{const{__scopeMenu:e,forceMount:t,children:n,container:s}=r,i=_h(zE,e);return h.jsx(O7,{scope:e,forceMount:t,children:h.jsx(wo,{present:t||i.open,children:h.jsx(D0,{asChild:!0,container:s,children:n})})})};MP.displayName=zE;var yo="MenuContent",[j7,VE]=yh(yo),TP=R.forwardRef((r,e)=>{const t=EP(yo,r.__scopeMenu),{forceMount:n=t.forceMount,...s}=r,i=_h(yo,r.__scopeMenu),o=G0(yo,r.__scopeMenu);return h.jsx(d0.Provider,{scope:r.__scopeMenu,children:h.jsx(wo,{present:n||i.open,children:h.jsx(d0.Slot,{scope:r.__scopeMenu,children:o.modal?h.jsx(F7,{...s,ref:e}):h.jsx(U7,{...s,ref:e})})})})}),F7=R.forwardRef((r,e)=>{const t=_h(yo,r.__scopeMenu),n=R.useRef(null),s=Cn(e,n);return R.useEffect(()=>{const i=n.current;if(i)return UE(i)},[]),h.jsx(HE,{...r,ref:s,trapFocus:t.open,disableOutsidePointerEvents:t.open,disableOutsideScroll:!0,onFocusOutside:mt(r.onFocusOutside,i=>i.preventDefault(),{checkForDefaultPrevented:!1}),onDismiss:()=>t.onOpenChange(!1)})}),U7=R.forwardRef((r,e)=>{const t=_h(yo,r.__scopeMenu);return h.jsx(HE,{...r,ref:e,trapFocus:!1,disableOutsidePointerEvents:!1,disableOutsideScroll:!1,onDismiss:()=>t.onOpenChange(!1)})}),B7=th("MenuContent.ScrollLock"),HE=R.forwardRef((r,e)=>{const{__scopeMenu:t,loop:n=!1,trapFocus:s,onOpenAutoFocus:i,onCloseAutoFocus:o,disableOutsidePointerEvents:a,onEntryFocus:c,onEscapeKeyDown:d,onPointerDownOutside:f,onFocusOutside:m,onInteractOutside:v,onDismiss:x,disableOutsideScroll:_,...b}=r,w=_h(yo,t),S=G0(yo,t),C=B_(t),T=SP(t),A=P7(t),[k,j]=R.useState(null),D=R.useRef(null),L=Cn(e,D,w.onContentChange),O=R.useRef(0),I=R.useRef(""),B=R.useRef(0),W=R.useRef(null),K=R.useRef("right"),ee=R.useRef(0),oe=_?U_:R.Fragment,ne=_?{as:B7,allowPinchZoom:!0}:void 0,ce=q=>{var me,je;const Z=I.current+q,X=A().filter(Xe=>!Xe.disabled),ie=document.activeElement,be=(me=X.find(Xe=>Xe.ref.current===ie))==null?void 0:me.textValue,ue=X.map(Xe=>Xe.textValue),Ee=J7(ue,Z,be),Fe=(je=X.find(Xe=>Xe.textValue===Ee))==null?void 0:je.ref.current;(function Xe($e){I.current=$e,window.clearTimeout(O.current),$e!==""&&(O.current=window.setTimeout(()=>Xe(""),1e3))})(Z),Fe&&setTimeout(()=>Fe.focus())};R.useEffect(()=>()=>window.clearTimeout(O.current),[]),FE();const V=R.useCallback(q=>{var X,ie;return K.current===((X=W.current)==null?void 0:X.side)&&eV(q,(ie=W.current)==null?void 0:ie.area)},[]);return h.jsx(j7,{scope:t,searchRef:I,onItemEnter:R.useCallback(q=>{V(q)&&q.preventDefault()},[V]),onItemLeave:R.useCallback(q=>{var Z;V(q)||((Z=D.current)==null||Z.focus(),j(null))},[V]),onTriggerLeave:R.useCallback(q=>{V(q)&&q.preventDefault()},[V]),pointerGraceTimerRef:B,onPointerGraceIntentChange:R.useCallback(q=>{W.current=q},[]),children:h.jsx(oe,{...ne,children:h.jsx(j_,{asChild:!0,trapped:s,onMountAutoFocus:mt(i,q=>{var Z;q.preventDefault(),(Z=D.current)==null||Z.focus({preventScroll:!0})}),onUnmountAutoFocus:o,children:h.jsx(Zp,{asChild:!0,disableOutsidePointerEvents:a,onEscapeKeyDown:d,onPointerDownOutside:f,onFocusOutside:m,onInteractOutside:v,onDismiss:x,children:h.jsx(DE,{asChild:!0,...T,dir:S.dir,orientation:"vertical",loop:n,currentTabStopId:k,onCurrentTabStopIdChange:j,onEntryFocus:mt(c,q=>{S.isUsingKeyboardRef.current||q.preventDefault()}),preventScrollOnEntryFocus:!0,children:h.jsx(mE,{role:"menu","aria-orientation":"vertical","data-state":VP(w.open),"data-radix-menu-content":"",dir:S.dir,...C,...b,ref:L,style:{outline:"none",...b.style},onKeyDown:mt(b.onKeyDown,q=>{const X=q.target.closest("[data-radix-menu-content]")===q.currentTarget,ie=q.ctrlKey||q.altKey||q.metaKey,be=q.key.length===1;X&&(q.key==="Tab"&&q.preventDefault(),!ie&&be&&ce(q.key));const ue=D.current;if(q.target!==ue||!A7.includes(q.key))return;q.preventDefault();const Fe=A().filter(me=>!me.disabled).map(me=>me.ref.current);_P.includes(q.key)&&Fe.reverse(),K7(Fe)}),onBlur:mt(r.onBlur,q=>{q.currentTarget.contains(q.target)||(window.clearTimeout(O.current),I.current="")}),onPointerMove:mt(r.onPointerMove,h0(q=>{const Z=q.target,X=ee.current!==q.clientX;if(q.currentTarget.contains(Z)&&X){const ie=q.clientX>ee.current?"right":"left";K.current=ie,ee.current=q.clientX}}))})})})})})})});TP.displayName=yo;var z7="MenuGroup",GE=R.forwardRef((r,e)=>{const{__scopeMenu:t,...n}=r;return h.jsx($t.div,{role:"group",...n,ref:e})});GE.displayName=z7;var V7="MenuLabel",CP=R.forwardRef((r,e)=>{const{__scopeMenu:t,...n}=r;return h.jsx($t.div,{...n,ref:e})});CP.displayName=V7;var Ay="MenuItem",uC="menu.itemSelect",z_=R.forwardRef((r,e)=>{const{disabled:t=!1,onSelect:n,...s}=r,i=R.useRef(null),o=G0(Ay,r.__scopeMenu),a=VE(Ay,r.__scopeMenu),c=Cn(e,i),d=R.useRef(!1),f=()=>{const m=i.current;if(!t&&m){const v=new CustomEvent(uC,{bubbles:!0,cancelable:!0});m.addEventListener(uC,x=>n==null?void 0:n(x),{once:!0}),Jb(m,v),v.defaultPrevented?d.current=!1:o.onClose()}};return h.jsx(AP,{...s,ref:c,disabled:t,onClick:mt(r.onClick,f),onPointerDown:m=>{var v;(v=r.onPointerDown)==null||v.call(r,m),d.current=!0},onPointerUp:mt(r.onPointerUp,m=>{var v;d.current||(v=m.currentTarget)==null||v.click()}),onKeyDown:mt(r.onKeyDown,m=>{const v=a.searchRef.current!=="";t||v&&m.key===" "||Mb.includes(m.key)&&(m.currentTarget.click(),m.preventDefault())})})});z_.displayName=Ay;var AP=R.forwardRef((r,e)=>{const{__scopeMenu:t,disabled:n=!1,textValue:s,...i}=r,o=VE(Ay,t),a=SP(t),c=R.useRef(null),d=Cn(e,c),[f,m]=R.useState(!1),[v,x]=R.useState("");return R.useEffect(()=>{const _=c.current;_&&x((_.textContent??"").trim())},[i.children]),h.jsx(d0.ItemSlot,{scope:t,disabled:n,textValue:s??v,children:h.jsx(LE,{asChild:!0,...a,focusable:!n,children:h.jsx($t.div,{role:"menuitem","data-highlighted":f?"":void 0,"aria-disabled":n||void 0,"data-disabled":n?"":void 0,...i,ref:d,onPointerMove:mt(r.onPointerMove,h0(_=>{n?o.onItemLeave(_):(o.onItemEnter(_),_.defaultPrevented||_.currentTarget.focus({preventScroll:!0}))})),onPointerLeave:mt(r.onPointerLeave,h0(_=>o.onItemLeave(_))),onFocus:mt(r.onFocus,()=>m(!0)),onBlur:mt(r.onBlur,()=>m(!1))})})})}),H7="MenuCheckboxItem",RP=R.forwardRef((r,e)=>{const{checked:t=!1,onCheckedChange:n,...s}=r;return h.jsx(DP,{scope:r.__scopeMenu,checked:t,children:h.jsx(z_,{role:"menuitemcheckbox","aria-checked":Ry(t)?"mixed":t,...s,ref:e,"data-state":$E(t),onSelect:mt(s.onSelect,()=>n==null?void 0:n(Ry(t)?!0:!t),{checkForDefaultPrevented:!1})})})});RP.displayName=H7;var NP="MenuRadioGroup",[G7,W7]=yh(NP,{value:void 0,onValueChange:()=>{}}),PP=R.forwardRef((r,e)=>{const{value:t,onValueChange:n,...s}=r,i=Di(n);return h.jsx(G7,{scope:r.__scopeMenu,value:t,onValueChange:i,children:h.jsx(GE,{...s,ref:e})})});PP.displayName=NP;var IP="MenuRadioItem",kP=R.forwardRef((r,e)=>{const{value:t,...n}=r,s=W7(IP,r.__scopeMenu),i=t===s.value;return h.jsx(DP,{scope:r.__scopeMenu,checked:i,children:h.jsx(z_,{role:"menuitemradio","aria-checked":i,...n,ref:e,"data-state":$E(i),onSelect:mt(n.onSelect,()=>{var o;return(o=s.onValueChange)==null?void 0:o.call(s,t)},{checkForDefaultPrevented:!1})})})});kP.displayName=IP;var WE="MenuItemIndicator",[DP,$7]=yh(WE,{checked:!1}),LP=R.forwardRef((r,e)=>{const{__scopeMenu:t,forceMount:n,...s}=r,i=$7(WE,t);return h.jsx(wo,{present:n||Ry(i.checked)||i.checked===!0,children:h.jsx($t.span,{...s,ref:e,"data-state":$E(i.checked)})})});LP.displayName=WE;var q7="MenuSeparator",OP=R.forwardRef((r,e)=>{const{__scopeMenu:t,...n}=r;return h.jsx($t.div,{role:"separator","aria-orientation":"horizontal",...n,ref:e})});OP.displayName=q7;var X7="MenuArrow",jP=R.forwardRef((r,e)=>{const{__scopeMenu:t,...n}=r,s=B_(t);return h.jsx(gE,{...s,...n,ref:e})});jP.displayName=X7;var Y7="MenuSub",[Hee,FP]=yh(Y7),Dg="MenuSubTrigger",UP=R.forwardRef((r,e)=>{const t=_h(Dg,r.__scopeMenu),n=G0(Dg,r.__scopeMenu),s=FP(Dg,r.__scopeMenu),i=VE(Dg,r.__scopeMenu),o=R.useRef(null),{pointerGraceTimerRef:a,onPointerGraceIntentChange:c}=i,d={__scopeMenu:r.__scopeMenu},f=R.useCallback(()=>{o.current&&window.clearTimeout(o.current),o.current=null},[]);return R.useEffect(()=>f,[f]),R.useEffect(()=>{const m=a.current;return()=>{window.clearTimeout(m),c(null)}},[a,c]),h.jsx(BE,{asChild:!0,...d,children:h.jsx(AP,{id:s.triggerId,"aria-haspopup":"menu","aria-expanded":t.open,"aria-controls":s.contentId,"data-state":VP(t.open),...r,ref:w_(e,s.onTriggerChange),onClick:m=>{var v;(v=r.onClick)==null||v.call(r,m),!(r.disabled||m.defaultPrevented)&&(m.currentTarget.focus(),t.open||t.onOpenChange(!0))},onPointerMove:mt(r.onPointerMove,h0(m=>{i.onItemEnter(m),!m.defaultPrevented&&!r.disabled&&!t.open&&!o.current&&(i.onPointerGraceIntentChange(null),o.current=window.setTimeout(()=>{t.onOpenChange(!0),f()},100))})),onPointerLeave:mt(r.onPointerLeave,h0(m=>{var x,_;f();const v=(x=t.content)==null?void 0:x.getBoundingClientRect();if(v){const b=(_=t.content)==null?void 0:_.dataset.side,w=b==="right",S=w?-5:5,C=v[w?"left":"right"],T=v[w?"right":"left"];i.onPointerGraceIntentChange({area:[{x:m.clientX+S,y:m.clientY},{x:C,y:v.top},{x:T,y:v.top},{x:T,y:v.bottom},{x:C,y:v.bottom}],side:b}),window.clearTimeout(a.current),a.current=window.setTimeout(()=>i.onPointerGraceIntentChange(null),300)}else{if(i.onTriggerLeave(m),m.defaultPrevented)return;i.onPointerGraceIntentChange(null)}})),onKeyDown:mt(r.onKeyDown,m=>{var x;const v=i.searchRef.current!=="";r.disabled||v&&m.key===" "||R7[n.dir].includes(m.key)&&(t.onOpenChange(!0),(x=t.content)==null||x.focus(),m.preventDefault())})})})});UP.displayName=Dg;var BP="MenuSubContent",zP=R.forwardRef((r,e)=>{const t=EP(yo,r.__scopeMenu),{forceMount:n=t.forceMount,...s}=r,i=_h(yo,r.__scopeMenu),o=G0(yo,r.__scopeMenu),a=FP(BP,r.__scopeMenu),c=R.useRef(null),d=Cn(e,c);return h.jsx(d0.Provider,{scope:r.__scopeMenu,children:h.jsx(wo,{present:n||i.open,children:h.jsx(d0.Slot,{scope:r.__scopeMenu,children:h.jsx(HE,{id:a.contentId,"aria-labelledby":a.triggerId,...s,ref:d,align:"start",side:o.dir==="rtl"?"left":"right",disableOutsidePointerEvents:!1,disableOutsideScroll:!1,trapFocus:!1,onOpenAutoFocus:f=>{var m;o.isUsingKeyboardRef.current&&((m=c.current)==null||m.focus()),f.preventDefault()},onCloseAutoFocus:f=>f.preventDefault(),onFocusOutside:mt(r.onFocusOutside,f=>{f.target!==a.trigger&&i.onOpenChange(!1)}),onEscapeKeyDown:mt(r.onEscapeKeyDown,f=>{o.onClose(),f.preventDefault()}),onKeyDown:mt(r.onKeyDown,f=>{var x;const m=f.currentTarget.contains(f.target),v=N7[o.dir].includes(f.key);m&&v&&(i.onOpenChange(!1),(x=a.trigger)==null||x.focus(),f.preventDefault())})})})})})});zP.displayName=BP;function VP(r){return r?"open":"closed"}function Ry(r){return r==="indeterminate"}function $E(r){return Ry(r)?"indeterminate":r?"checked":"unchecked"}function K7(r){const e=document.activeElement;for(const t of r)if(t===e||(t.focus(),document.activeElement!==e))return}function Q7(r,e){return r.map((t,n)=>r[(e+n)%r.length])}function J7(r,e,t){const s=e.length>1&&Array.from(e).every(d=>d===e[0])?e[0]:e,i=t?r.indexOf(t):-1;let o=Q7(r,Math.max(i,0));s.length===1&&(o=o.filter(d=>d!==t));const c=o.find(d=>d.toLowerCase().startsWith(s.toLowerCase()));return c!==t?c:void 0}function Z7(r,e){const{x:t,y:n}=r;let s=!1;for(let i=0,o=e.length-1;i<e.length;o=i++){const a=e[i],c=e[o],d=a.x,f=a.y,m=c.x,v=c.y;f>n!=v>n&&t<(m-d)*(n-f)/(v-f)+d&&(s=!s)}return s}function eV(r,e){if(!e)return!1;const t={x:r.clientX,y:r.clientY};return Z7(t,e)}function h0(r){return e=>e.pointerType==="mouse"?r(e):void 0}var tV=bP,nV=BE,rV=MP,sV=TP,iV=GE,oV=CP,aV=z_,lV=RP,cV=PP,uV=kP,dV=LP,hV=OP,fV=jP,pV=UP,mV=zP,V_="DropdownMenu",[gV,Gee]=to(V_,[wP]),ui=wP(),[vV,HP]=gV(V_),GP=r=>{const{__scopeDropdownMenu:e,children:t,dir:n,open:s,defaultOpen:i,onOpenChange:o,modal:a=!0}=r,c=ui(e),d=R.useRef(null),[f,m]=ql({prop:s,defaultProp:i??!1,onChange:o,caller:V_});return h.jsx(vV,{scope:e,triggerId:Oa(),triggerRef:d,contentId:Oa(),open:f,onOpenChange:m,onOpenToggle:R.useCallback(()=>m(v=>!v),[m]),modal:a,children:h.jsx(tV,{...c,open:f,onOpenChange:m,dir:n,modal:a,children:t})})};GP.displayName=V_;var WP="DropdownMenuTrigger",$P=R.forwardRef((r,e)=>{const{__scopeDropdownMenu:t,disabled:n=!1,...s}=r,i=HP(WP,t),o=ui(t);return h.jsx(nV,{asChild:!0,...o,children:h.jsx($t.button,{type:"button",id:i.triggerId,"aria-haspopup":"menu","aria-expanded":i.open,"aria-controls":i.open?i.contentId:void 0,"data-state":i.open?"open":"closed","data-disabled":n?"":void 0,disabled:n,...s,ref:w_(e,i.triggerRef),onPointerDown:mt(r.onPointerDown,a=>{!n&&a.button===0&&a.ctrlKey===!1&&(i.onOpenToggle(),i.open||a.preventDefault())}),onKeyDown:mt(r.onKeyDown,a=>{n||(["Enter"," "].includes(a.key)&&i.onOpenToggle(),a.key==="ArrowDown"&&i.onOpenChange(!0),["Enter"," ","ArrowDown"].includes(a.key)&&a.preventDefault())})})})});$P.displayName=WP;var xV="DropdownMenuPortal",qP=r=>{const{__scopeDropdownMenu:e,...t}=r,n=ui(e);return h.jsx(rV,{...n,...t})};qP.displayName=xV;var XP="DropdownMenuContent",YP=R.forwardRef((r,e)=>{const{__scopeDropdownMenu:t,...n}=r,s=HP(XP,t),i=ui(t),o=R.useRef(!1);return h.jsx(sV,{id:s.contentId,"aria-labelledby":s.triggerId,...i,...n,ref:e,onCloseAutoFocus:mt(r.onCloseAutoFocus,a=>{var c;o.current||(c=s.triggerRef.current)==null||c.focus(),o.current=!1,a.preventDefault()}),onInteractOutside:mt(r.onInteractOutside,a=>{const c=a.detail.originalEvent,d=c.button===0&&c.ctrlKey===!0,f=c.button===2||d;(!s.modal||f)&&(o.current=!0)}),style:{...r.style,"--radix-dropdown-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-dropdown-menu-content-available-width":"var(--radix-popper-available-width)","--radix-dropdown-menu-content-available-height":"var(--radix-popper-available-height)","--radix-dropdown-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-dropdown-menu-trigger-height":"var(--radix-popper-anchor-height)"}})});YP.displayName=XP;var yV="DropdownMenuGroup",_V=R.forwardRef((r,e)=>{const{__scopeDropdownMenu:t,...n}=r,s=ui(t);return h.jsx(iV,{...s,...n,ref:e})});_V.displayName=yV;var wV="DropdownMenuLabel",KP=R.forwardRef((r,e)=>{const{__scopeDropdownMenu:t,...n}=r,s=ui(t);return h.jsx(oV,{...s,...n,ref:e})});KP.displayName=wV;var SV="DropdownMenuItem",QP=R.forwardRef((r,e)=>{const{__scopeDropdownMenu:t,...n}=r,s=ui(t);return h.jsx(aV,{...s,...n,ref:e})});QP.displayName=SV;var bV="DropdownMenuCheckboxItem",JP=R.forwardRef((r,e)=>{const{__scopeDropdownMenu:t,...n}=r,s=ui(t);return h.jsx(lV,{...s,...n,ref:e})});JP.displayName=bV;var EV="DropdownMenuRadioGroup",MV=R.forwardRef((r,e)=>{const{__scopeDropdownMenu:t,...n}=r,s=ui(t);return h.jsx(cV,{...s,...n,ref:e})});MV.displayName=EV;var TV="DropdownMenuRadioItem",ZP=R.forwardRef((r,e)=>{const{__scopeDropdownMenu:t,...n}=r,s=ui(t);return h.jsx(uV,{...s,...n,ref:e})});ZP.displayName=TV;var CV="DropdownMenuItemIndicator",eI=R.forwardRef((r,e)=>{const{__scopeDropdownMenu:t,...n}=r,s=ui(t);return h.jsx(dV,{...s,...n,ref:e})});eI.displayName=CV;var AV="DropdownMenuSeparator",tI=R.forwardRef((r,e)=>{const{__scopeDropdownMenu:t,...n}=r,s=ui(t);return h.jsx(hV,{...s,...n,ref:e})});tI.displayName=AV;var RV="DropdownMenuArrow",NV=R.forwardRef((r,e)=>{const{__scopeDropdownMenu:t,...n}=r,s=ui(t);return h.jsx(fV,{...s,...n,ref:e})});NV.displayName=RV;var PV="DropdownMenuSubTrigger",nI=R.forwardRef((r,e)=>{const{__scopeDropdownMenu:t,...n}=r,s=ui(t);return h.jsx(pV,{...s,...n,ref:e})});nI.displayName=PV;var IV="DropdownMenuSubContent",rI=R.forwardRef((r,e)=>{const{__scopeDropdownMenu:t,...n}=r,s=ui(t);return h.jsx(mV,{...s,...n,ref:e,style:{...r.style,"--radix-dropdown-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-dropdown-menu-content-available-width":"var(--radix-popper-available-width)","--radix-dropdown-menu-content-available-height":"var(--radix-popper-available-height)","--radix-dropdown-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-dropdown-menu-trigger-height":"var(--radix-popper-anchor-height)"}})});rI.displayName=IV;var kV=GP,DV=$P,LV=qP,sI=YP,iI=KP,oI=QP,aI=JP,lI=ZP,cI=eI,uI=tI,dI=nI,hI=rI;const OV=kV,jV=DV,FV=R.forwardRef(({className:r,inset:e,children:t,...n},s)=>h.jsxs(dI,{ref:s,className:Zt("flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent data-[state=open]:bg-accent",e&&"pl-8",r),...n,children:[t,h.jsx(n0,{className:"ml-auto h-4 w-4"})]}));FV.displayName=dI.displayName;const UV=R.forwardRef(({className:r,...e},t)=>h.jsx(hI,{ref:t,className:Zt("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",r),...e}));UV.displayName=hI.displayName;const fI=R.forwardRef(({className:r,sideOffset:e=4,...t},n)=>h.jsx(LV,{children:h.jsx(sI,{ref:n,sideOffset:e,className:Zt("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",r),...t})}));fI.displayName=sI.displayName;const pI=R.forwardRef(({className:r,inset:e,...t},n)=>h.jsx(oI,{ref:n,className:Zt("relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",e&&"pl-8",r),...t}));pI.displayName=oI.displayName;const BV=R.forwardRef(({className:r,children:e,checked:t,...n},s)=>h.jsxs(aI,{ref:s,className:Zt("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",r),checked:t,...n,children:[h.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:h.jsx(cI,{children:h.jsx(t0,{className:"h-4 w-4"})})}),e]}));BV.displayName=aI.displayName;const zV=R.forwardRef(({className:r,children:e,...t},n)=>h.jsxs(lI,{ref:n,className:Zt("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",r),...t,children:[h.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:h.jsx(cI,{children:h.jsx(tN,{className:"h-2 w-2 fill-current"})})}),e]}));zV.displayName=lI.displayName;const VV=R.forwardRef(({className:r,inset:e,...t},n)=>h.jsx(iI,{ref:n,className:Zt("px-2 py-1.5 text-sm font-semibold",e&&"pl-8",r),...t}));VV.displayName=iI.displayName;const HV=R.forwardRef(({className:r,...e},t)=>h.jsx(uI,{ref:t,className:Zt("-mx-1 my-1 h-px bg-muted",r),...e}));HV.displayName=uI.displayName;const H_=({classId:r,selectedLesson:e,onLessonSelect:t,lessons:n,isLoadingLessons:s})=>{const[i,o]=R.useState(""),[a,c]=R.useState(!1),d=n.map(x=>({id:x.id,title:x.title,topic:x.topic||x.title,createdAt:new Date(x.created_at),hasGeneralPool:!1,questionCount:0})),f=d.filter(x=>x.title.toLowerCase().includes(i.toLowerCase())||x.topic.toLowerCase().includes(i.toLowerCase())),m=d.find(x=>x.id===e),v=x=>x.toLocaleDateString("en-US",{month:"short",day:"numeric"});return h.jsxs("div",{className:"space-y-4",children:[h.jsx("div",{children:h.jsx("p",{className:"text-sm text-gray-600 mb-4",children:"Choose the lesson you want to create personalized question assignments for."})}),h.jsxs("div",{className:"flex items-center space-x-4",children:[h.jsx("div",{className:"flex-1",children:h.jsxs(OV,{open:a,onOpenChange:c,children:[h.jsx(jV,{asChild:!0,children:h.jsxs(zt,{variant:"outline",className:"w-full justify-between h-12 text-left",disabled:s,children:[s?"Loading lessons...":m?h.jsxs("div",{className:"flex items-center space-x-3",children:[h.jsx(za,{className:"w-4 h-4 text-blue-600"}),h.jsxs("div",{children:[h.jsx("div",{className:"font-medium",children:m.title}),h.jsxs("div",{className:"text-xs text-gray-500",children:[m.topic,"  ",v(m.createdAt),m.hasGeneralPool&&h.jsxs("span",{className:"ml-2 text-green-600",children:[" ",m.questionCount," pool questions"]})]})]})]}):h.jsx("span",{className:"text-gray-500",children:"Select a lesson..."}),h.jsx(nh,{className:"h-4 w-4 opacity-50"})]})}),h.jsxs(fI,{className:"w-[600px] p-0",children:[h.jsx("div",{className:"p-3 border-b",children:h.jsxs("div",{className:"relative",children:[h.jsx(o5,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-gray-400"}),h.jsx(Jl,{placeholder:"Search lessons...",value:i,onChange:x=>o(x.target.value),className:"pl-10"})]})}),h.jsx("div",{className:"max-h-80 overflow-y-auto",children:f.length===0?h.jsx("div",{className:"p-4 text-center text-gray-500",children:i?"No lessons match your search":"No lessons found"}):f.map(x=>h.jsx(pI,{onClick:()=>{t(x.id),c(!1)},className:"p-4 cursor-pointer hover:bg-gray-50",children:h.jsxs("div",{className:"flex items-center space-x-3 w-full",children:[h.jsx(za,{className:"w-4 h-4 text-blue-600 flex-shrink-0"}),h.jsxs("div",{className:"flex-1 min-w-0",children:[h.jsxs("div",{className:"flex items-center justify-between",children:[h.jsx("div",{className:"font-medium text-gray-900 truncate",children:x.title}),h.jsxs("div",{className:"flex items-center space-x-2 text-xs text-gray-500 ml-2",children:[h.jsx(T_,{className:"w-3 h-3"}),h.jsx("span",{children:v(x.createdAt)})]})]}),h.jsxs("div",{className:"flex items-center justify-between mt-1",children:[h.jsx("span",{className:"text-sm text-gray-600",children:x.topic}),x.hasGeneralPool?h.jsxs("span",{className:"text-xs text-green-600 bg-green-50 px-2 py-1 rounded-full",children:[x.questionCount," pool questions"]}):h.jsx("span",{className:"text-xs text-amber-600 bg-amber-50 px-2 py-1 rounded-full",children:"No pool yet"})]})]})]})},x.id))})]})]})}),e&&h.jsx(zt,{variant:"outline",onClick:()=>t(null),className:"px-3",children:"Clear"})]}),m&&!m.hasGeneralPool&&h.jsx("div",{className:"bg-amber-50 border border-amber-200 rounded-lg p-4",children:h.jsxs("div",{className:"flex items-start space-x-3",children:[h.jsx("div",{className:"w-5 h-5 text-amber-600 mt-0.5",children:""}),h.jsxs("div",{children:[h.jsx("p",{className:"text-sm font-medium text-amber-800",children:"No General Pool Questions"}),h.jsx("p",{className:"text-xs text-amber-700 mt-1",children:"This lesson doesn't have a general pool of questions yet. You'll need to create one before assigning personalized questions."})]})]})})]})},GV=M_("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function Bs({className:r,variant:e,...t}){return h.jsx("div",{className:Zt(GV({variant:e}),r),...t})}function gp(r){const e=[];(!r.text||r.text.trim()==="")&&e.push("Question text cannot be empty"),r.choices.forEach((n,s)=>{(!n.text||n.text.trim()==="")&&e.push(`Choice ${n.id.toUpperCase()} cannot be empty`)}),r.correctAnswer||e.push("Must select a correct answer");const t=r.choices.some(n=>n.id===r.correctAnswer);return r.correctAnswer&&!t&&e.push("Selected correct answer does not match available choices"),{isValid:e.length===0,errors:e}}function WV(r){const e=r.length,t=r.filter(i=>i.status==="approved").length,n=r.filter(i=>i.status==="pending").length,s=r.filter(i=>!gp(i).isValid).length;return{total:e,approved:t,pending:n,invalid:s}}const $V=({question:r,questionNumber:e,onUpdate:t,onApprove:n,onRegenerate:s,autoSave:i=!0})=>{const[o,a]=R.useState({isValid:!0,errors:[]}),[c,d]=R.useState(!1);R.useEffect(()=>{const A=gp(r);a(A),A.isValid&&r.status==="invalid"?t({status:"pending"}):!A.isValid&&r.status!=="invalid"&&t({status:"invalid"})},[r,t]);const f=(A,k)=>{const j=r.status==="approved"?"pending":r.status;t({[A]:k,status:j})},m=(A,k)=>{const j=r.choices.map(L=>L.id===A?{...L,text:k}:L),D=r.status==="approved"?"pending":r.status;t({choices:j,status:D})},v=A=>{const k=r.status==="approved"?"pending":r.status;t({correctAnswer:A,status:k})},x=A=>{A.dataTransfer.setData("text/plain","correct-answer"),d(!0)},_=()=>{d(!1)},b=(A,k)=>{A.preventDefault(),A.dataTransfer.getData("text/plain")==="correct-answer"&&v(k),d(!1)},w=A=>{A.preventDefault()},S=()=>{switch(r.status){case"approved":return"text-green-700 bg-green-50 border-green-200";case"pending":return"text-amber-700 bg-amber-50 border-amber-200";case"invalid":return"text-red-700 bg-red-50 border-red-200";default:return"text-gray-700 bg-gray-50 border-gray-200"}},C=()=>{switch(r.status){case"approved":return h.jsx(Ar,{className:"w-4 h-4 text-green-600"});case"invalid":return h.jsx(Hs,{className:"w-4 h-4 text-red-600"});default:return h.jsx(sh,{className:"w-4 h-4 text-amber-600"})}},T=!o.isValid||r.status==="approved";return h.jsx(Wt,{className:`${r.status==="invalid"?"border-red-200 bg-red-50":""} transition-colors`,children:h.jsxs(nn,{className:"p-6 space-y-4",children:[h.jsxs("div",{className:"flex items-center justify-between",children:[h.jsxs("div",{className:"flex items-center space-x-3",children:[h.jsxs("span",{className:"text-lg font-semibold text-gray-700",children:["Question ",e]}),h.jsx(Bs,{variant:"outline",className:S(),children:h.jsxs("div",{className:"flex items-center space-x-1",children:[C(),h.jsx("span",{className:"capitalize",children:r.status})]})}),r.type&&h.jsx(Bs,{variant:r.type==="adaptive"?"default":"secondary",children:r.type==="adaptive"?"Personalized":"General Pool"})]}),h.jsxs("div",{className:"flex items-center space-x-2",children:[h.jsxs(zt,{variant:"outline",size:"sm",onClick:n,disabled:T,className:r.status==="approved"?"opacity-50":"",children:[h.jsx(Ar,{className:"w-4 h-4 mr-1"}),"Approve"]}),h.jsxs(zt,{variant:"outline",size:"sm",onClick:s,children:[h.jsx(nE,{className:"w-4 h-4 mr-1"}),"Regenerate"]})]})]}),o.errors.length>0&&h.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-3",children:h.jsxs("div",{className:"flex items-start space-x-2",children:[h.jsx(Hs,{className:"w-4 h-4 text-red-600 mt-0.5 flex-shrink-0"}),h.jsxs("div",{className:"text-sm",children:[h.jsx("p",{className:"text-red-800 font-medium",children:"Validation Errors:"}),h.jsx("ul",{className:"text-red-700 mt-1 space-y-1",children:o.errors.map((A,k)=>h.jsxs("li",{children:[" ",A]},k))})]})]})}),h.jsxs("div",{className:"space-y-2",children:[h.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Question Text"}),h.jsx(vu,{value:r.text,onChange:A=>f("text",A.target.value),placeholder:"Enter your question here...",className:"min-h-[80px] resize-y"})]}),h.jsxs("div",{className:"space-y-3",children:[h.jsxs("label",{className:"block text-sm font-medium text-gray-700",children:["Answer Choices",h.jsx("span",{className:"text-xs text-gray-500 ml-2",children:"(Drag the green highlight to set correct answer)"})]}),r.choices.map(A=>h.jsxs("div",{className:`flex items-center space-x-3 p-3 rounded-lg border transition-colors ${r.correctAnswer===A.id?"bg-green-50 border-green-200":"bg-gray-50 border-gray-200 hover:bg-gray-100"}`,onDrop:k=>b(k,A.id),onDragOver:w,children:[h.jsx("div",{className:"flex-shrink-0",children:h.jsx("span",{className:"inline-flex items-center justify-center w-8 h-8 rounded-full bg-white border border-gray-300 text-sm font-medium",children:A.id.toUpperCase()})}),h.jsx("div",{className:"flex-shrink-0",children:r.correctAnswer===A.id?h.jsx("div",{draggable:!0,onDragStart:x,onDragEnd:_,className:`w-6 h-6 bg-green-500 rounded-full cursor-move hover:bg-green-600 transition-colors ${c?"opacity-50":""}`,title:"Drag to move correct answer"}):h.jsx("div",{className:"w-6 h-6 border-2 border-dashed border-gray-300 rounded-full cursor-pointer hover:border-green-400 transition-colors",onClick:()=>v(A.id),title:"Click to set as correct answer"})}),h.jsx("div",{className:"flex-1",children:h.jsx(Jl,{value:A.text,onChange:k=>m(A.id,k.target.value),placeholder:`Enter choice ${A.id.toUpperCase()}...`,className:"border-0 bg-transparent focus:ring-1 focus:ring-blue-500"})})]},A.id))]}),r.source&&h.jsxs("div",{className:"text-xs text-gray-500 bg-gray-100 p-2 rounded",children:["Source: ",r.source]})]})})},G_=({title:r,questions:e,onQuestionsUpdate:t,onRegenerateAll:n,onRegenerateQuestion:s,onSaveChanges:i,isLoading:o=!1,className:a=""})=>{const[c,d]=R.useState(!1),[f,m]=R.useState(!1),[v,x]=R.useState(new Set),_=WV(e),b=e.filter(D=>!gp(D).isValid),w=e.filter(D=>gp(D).isValid),S=R.useCallback(async(D,L,O=!1)=>{const I=e.map(B=>B.id===D?{...B,...L}:B);if(t(I),O&&i)try{await i(I),console.log("Auto-saved after update")}catch(B){console.error("Auto-save failed:",B)}},[e,t,i]),C=R.useCallback(D=>{S(D,{status:"approved"},!0)},[S]),T=R.useCallback(async D=>{if(s){x(L=>new Set([...L,D]));try{await s(D)}catch(L){console.error("Failed to regenerate question:",L)}finally{x(L=>{const O=new Set(L);return O.delete(D),O})}}},[s]),A=R.useCallback(async()=>{if(n){m(!0);try{await n()}catch(D){console.error("Failed to regenerate all questions:",D)}finally{m(!1)}}},[n]),k=R.useCallback(async()=>{const D=e.map(L=>gp(L).isValid&&L.status!=="approved"?{...L,status:"approved"}:L);if(t(D),i)try{await i(D),console.log("Auto-saved after bulk approval")}catch(L){console.error("Auto-save failed:",L)}},[e,t,i,gp]),j=()=>{const D=[];return _.approved>0&&D.push(`${_.approved} approved`),_.pending>0&&D.push(`${_.pending} pending`),_.invalid>0&&D.push(`${_.invalid} invalid`),D.join(", ")};return h.jsxs(Wt,{className:`transition-all duration-200 ${a}`,children:[h.jsx(or,{className:"cursor-pointer hover:bg-gray-50 transition-colors",onClick:()=>d(!c),children:h.jsxs("div",{className:"flex items-center justify-between",children:[h.jsxs("div",{className:"flex items-center space-x-3",children:[c?h.jsx(nh,{className:"w-5 h-5 text-gray-500"}):h.jsx(n0,{className:"w-5 h-5 text-gray-500"}),h.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:r}),h.jsxs(Bs,{variant:"outline",className:"text-sm",children:[_.total," questions"]}),_.total>0&&h.jsx("span",{className:"text-sm text-gray-600",children:j()})]}),h.jsxs("div",{className:"flex items-center space-x-2",children:[_.approved>0&&h.jsxs(Bs,{variant:"default",className:"bg-green-100 text-green-800 border-green-200",children:[h.jsx(Ar,{className:"w-3 h-3 mr-1"}),_.approved]}),_.invalid>0&&h.jsxs(Bs,{variant:"destructive",className:"bg-red-100 text-red-800 border-red-200",children:[h.jsx(Hs,{className:"w-3 h-3 mr-1"}),_.invalid]}),o&&h.jsx("div",{className:"w-4 h-4 border-2 border-blue-600 border-t-transparent rounded-full animate-spin"})]})]})}),c&&h.jsxs(nn,{className:"pt-0 space-y-6",children:[h.jsx("div",{className:"space-y-4",children:e.map((D,L)=>h.jsx($V,{question:D,questionNumber:L+1,onUpdate:O=>S(D.id,O),onApprove:()=>C(D.id),onRegenerate:()=>T(D.id)},D.id))}),e.length===0&&h.jsx("div",{className:"text-center py-8 text-gray-500",children:h.jsx("p",{children:"No questions generated yet."})}),b.length>0&&h.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:h.jsxs("div",{className:"flex items-start space-x-2",children:[h.jsx(Hs,{className:"w-5 h-5 text-red-600 mt-0.5 flex-shrink-0"}),h.jsxs("div",{children:[h.jsxs("h4",{className:"font-medium text-red-800",children:[b.length," question",b.length!==1?"s":""," need",b.length===1?"s":""," attention"]}),h.jsx("p",{className:"text-sm text-red-700 mt-1",children:"Questions highlighted above have validation errors that must be fixed before approval."})]})]})}),e.length>0&&h.jsxs("div",{className:"flex items-center justify-between pt-4 border-t border-gray-200",children:[h.jsx("div",{className:"flex items-center space-x-3",children:n&&h.jsxs(zt,{variant:"outline",onClick:A,disabled:f,className:"text-amber-700 border-amber-200 hover:bg-amber-50",children:[h.jsx(nE,{className:"w-4 h-4 mr-2"}),f?"Regenerating All...":"Regenerate All Questions"]})}),h.jsxs("div",{className:"flex items-center space-x-3",children:[w.length>0&&h.jsxs(zt,{onClick:k,disabled:w.every(D=>D.status==="approved"),className:"bg-green-600 hover:bg-green-700",children:[h.jsx(Ar,{className:"w-4 h-4 mr-2"}),"Approve All Valid Questions (",w.length,")"]}),i&&h.jsx(zt,{variant:"outline",onClick:()=>i(e),children:"Save Changes"})]})]})]})]})},qV=({classId:r,selectedLesson:e,teacherId:t})=>{var k;const[n,s]=R.useState([]),[i,o]=R.useState(10),[a,c]=R.useState(!1),[d,f]=R.useState(!1),[m,v]=R.useState(null),[x,_]=R.useState(null),b=(j,D)=>j.map((L,O)=>{var I,B,W,K,ee,oe,ne,ce,V,q;return{id:L.id||`general_${D||"unknown"}_${O}_${Date.now()}`,text:L.text||"",choices:[{id:"a",text:((B=(I=L.choices)==null?void 0:I[0])==null?void 0:B.text)||""},{id:"b",text:((K=(W=L.choices)==null?void 0:W[1])==null?void 0:K.text)||""},{id:"c",text:((oe=(ee=L.choices)==null?void 0:ee[2])==null?void 0:oe.text)||""},{id:"d",text:((ce=(ne=L.choices)==null?void 0:ne[3])==null?void 0:ce.text)||""},{id:"e",text:((q=(V=L.choices)==null?void 0:V[4])==null?void 0:q.text)||""}],correctAnswer:L.correctAnswer||"a",explanation:L.explanation,status:L.status||"pending",type:"general",source:"General Pool"}});R.useEffect(()=>{e?w():(s([]),f(!1),v(null))},[e==null?void 0:e.id]);const w=async()=>{if(e)try{const j=await fetch(`http://localhost:3001/api/classes/${r}/general-pools?lessonId=${e.id}`);if(j.ok){const D=await j.json();if(D.pools&&D.pools.length>0){const L=D.pools[0],O=b(L.questions||[],e.id);s(O),f(!0),v(L.id)}else s([]),f(!1),v(null)}}catch(j){console.error("Error checking existing pool:",j),s([]),f(!1),v(null)}},S=async()=>{var j;if(!(!e||!e.content.trim())){c(!0),_(null);try{const D=await fetch(`http://localhost:3001/api/classes/${r}/generate-general-pool`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({topicName:e.title,lessonContent:e.content||"",lessonId:e.id,teacherId:t,questionCount:i})});if(!D.ok){const O=await D.json();throw new Error(O.error||`HTTP ${D.status}: ${D.statusText}`)}const L=await D.json();if(L.success&&((j=L.generalPool)!=null&&j.questions)){const O=b(L.generalPool.questions,e.id);s(O),f(!0),v(L.generalPool.id)}else throw new Error("Invalid response format - no questions found")}catch(D){console.error("Generation error:",D),_(D instanceof Error?D.message:"Failed to generate questions")}finally{c(!1)}}},C=j=>{s([...j])},T=async()=>{await S()},A=async j=>{if(!m){console.error("No pool ID to save to");return}try{if(!(await fetch(`http://localhost:3001/api/classes/${r}/general-pools/${m}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({questions:j.map(L=>({text:L.text,choices:L.choices,correctAnswer:L.correctAnswer,explanation:L.explanation,status:L.status}))})})).ok)throw new Error("Failed to save changes");console.log("Questions saved successfully")}catch(D){console.error("Error saving questions:",D)}};return e?(k=e.content)!=null&&k.trim()?h.jsxs("div",{className:"space-y-6",children:[h.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:[h.jsxs("h4",{className:"font-medium text-blue-800 mb-3 flex items-center",children:['General Question Pool for "',e.title,'"']}),x&&h.jsx("div",{className:"mb-3 p-2 bg-red-50 border border-red-200 rounded text-sm text-red-700",children:x}),h.jsx("div",{className:"flex items-center space-x-4 mb-4",children:h.jsxs("div",{className:"flex items-center space-x-2",children:[h.jsx(zs,{className:"text-sm text-blue-700",children:"Question Count:"}),h.jsx(Jl,{type:"number",min:"3",max:"15",value:i,onChange:j=>o(parseInt(j.target.value)||10),className:"w-20",disabled:a}),h.jsx("span",{className:"text-xs text-blue-600",children:"(3-15)"})]})}),h.jsx("div",{className:"flex space-x-3",children:d?h.jsx(zt,{onClick:T,disabled:a,variant:"outline",className:"border-blue-300 text-blue-700 hover:bg-blue-50",children:a?h.jsxs(h.Fragment,{children:[h.jsx(Xl,{className:"w-4 h-4 mr-2 animate-spin"}),"Regenerating..."]}):h.jsxs(h.Fragment,{children:[h.jsx(nE,{className:"w-4 h-4 mr-2"}),"Regenerate (",i," questions)"]})}):h.jsx(zt,{onClick:S,disabled:a,className:"bg-blue-600 hover:bg-blue-700",children:a?h.jsxs(h.Fragment,{children:[h.jsx(Xl,{className:"w-4 h-4 mr-2 animate-spin"}),"Generating..."]}):h.jsxs(h.Fragment,{children:["Generate ",i," Questions"]})})}),d&&h.jsxs("p",{className:"text-xs text-blue-600 mt-2",children:["Pool exists with ",n.length," questions. You can regenerate with a different count."]})]}),n.length>0&&h.jsx(G_,{title:`Question Pool: ${e.title}`,questions:n,onQuestionsUpdate:C,onRegenerateAll:T,onSaveChanges:A,isLoading:a})]}):h.jsx("div",{className:"bg-amber-50 border border-amber-200 rounded-lg p-6 text-center",children:h.jsxs("p",{className:"text-amber-800",children:['Add content to "',e.title,'" before generating questions']})}):h.jsx("div",{className:"bg-gray-50 border border-gray-200 rounded-lg p-6 text-center",children:h.jsx("p",{className:"text-gray-600",children:"Select a lesson to generate question pool"})})},XV=({classId:r,onGenerateForAll:e,studentsCount:t=0,lessons:n,isLoadingLessons:s,onLessonsChange:i})=>{var D;const{session:o}=ca(),[a,c]=R.useState(null),[d,f]=R.useState(""),[m,v]=R.useState(""),[x,_]=R.useState(!1),[b,w]=R.useState([]);R.useEffect(()=>{const L=sessionStorage.getItem(`preselect-lesson-${r}`);L&&(S(L),sessionStorage.removeItem(`preselect-lesson-${r}`))},[r]);const S=async L=>{const O=n.find(I=>I.id===L);O&&(c(O),f(O.content||""),v(O.content||""))},C=async()=>{if(a){_(!0);try{const{error:L}=await Un.from("lessons").update({content:d,updated_at:new Date().toISOString()}).eq("id",a.id);if(L)throw L;v(d),console.log("Content saved successfully"),i()}catch(L){console.error("Error saving content:",L)}finally{_(!1)}}},T=L=>{if(L.target.files){const O=Array.from(L.target.files).map(I=>({id:Date.now()+Math.random().toString(),name:I.name,size:I.size}));w(I=>[...I,...O])}},A=L=>{w(O=>O.filter(I=>I.id!==L))},k=d!==m,j=d.trim()!=="";return h.jsxs("div",{className:"bg-white rounded-xl shadow-sm","data-section":"lesson-content",children:[h.jsxs("div",{className:"p-6 border-b border-gray-200",children:[h.jsxs("h2",{className:"text-xl font-bold text-gray-800 flex items-center",children:[h.jsx(Sp,{className:"w-5 h-5 mr-2"}),"Lesson Content Management"]}),h.jsx("p",{className:"text-gray-600 text-sm mt-1",children:"Select a lesson and edit its content"})]}),h.jsxs("div",{className:"p-6 space-y-6",children:[h.jsxs("div",{children:[h.jsx(zs,{className:"text-sm font-medium text-gray-700 mb-2 block",children:"Select Lesson"}),h.jsx(H_,{classId:r,selectedLesson:a?a.id:null,onLessonSelect:S,lessons:n,isLoadingLessons:s})]}),a&&h.jsxs("div",{children:[h.jsxs("div",{className:"flex items-center justify-between mb-2",children:[h.jsxs(zs,{className:"text-sm font-medium text-gray-700",children:['Content for "',a.title,'"']}),h.jsxs(zt,{onClick:C,disabled:!k||x,size:"sm",children:[h.jsx(C_,{className:"w-4 h-4 mr-1"}),x?"Saving...":"Save"]})]}),h.jsx(vu,{value:d,onChange:L=>f(L.target.value),placeholder:`Add content for ${a.title}...`,className:"w-full min-h-[200px] resize-y"}),h.jsxs("div",{className:"flex items-center justify-between mt-2",children:[h.jsx("p",{className:"text-xs text-gray-500",children:k?"You have unsaved changes":"Content saved"}),d.length>0&&h.jsxs("p",{className:"text-xs text-gray-400",children:[d.length," characters"]})]})]}),a&&h.jsxs("div",{children:[h.jsxs(zs,{className:"block text-sm font-medium text-gray-700 mb-2",children:['Upload Files for "',a.title,'"']}),h.jsxs("div",{className:"border-2 border-dashed rounded-lg p-6 text-center border-gray-300 hover:border-indigo-400",children:[h.jsx(p5,{className:"w-8 h-8 text-gray-400 mx-auto mb-2"}),h.jsx("p",{className:"text-gray-600 mb-2",children:"Upload lesson files"}),h.jsx("input",{type:"file",multiple:!0,onChange:T,className:"hidden",id:"file-upload"}),h.jsx(zt,{variant:"outline",onClick:()=>{var L;return(L=document.getElementById("file-upload"))==null?void 0:L.click()},children:"Choose Files"})]}),b.length>0&&h.jsx("div",{className:"mt-4 space-y-2",children:b.map(L=>h.jsxs("div",{className:"flex items-center justify-between bg-gray-50 p-3 rounded-lg",children:[h.jsx("span",{className:"text-sm text-gray-700",children:L.name}),h.jsx(zt,{variant:"ghost",size:"sm",onClick:()=>A(L.id),children:h.jsx(ih,{className:"w-4 h-4"})})]},L.id))})]}),a&&j&&h.jsx(qV,{classId:r,selectedLesson:a,teacherId:((D=o==null?void 0:o.user)==null?void 0:D.id)||""})]})]})},YV=({classId:r,studentsCount:e})=>{var d;const{session:t}=ca(),[n,s]=R.useState([]),[i,o]=R.useState(!0),a=async()=>{var f;if(!(!((f=t==null?void 0:t.user)!=null&&f.email)||!r)){o(!0);try{const{data:m,error:v}=await Un.from("teachers").select("id").eq("email",t.user.email).single();if(v)throw v;const{data:x,error:_}=await Un.from("lessons").select("*").eq("teacher_id",m.id).eq("class_id",r).eq("is_active",!0).order("created_at",{ascending:!1});if(_)throw _;s(x||[])}catch(m){console.error("Error fetching lessons:",m),s([])}finally{o(!1)}}};R.useEffect(()=>{a()},[(d=t==null?void 0:t.user)==null?void 0:d.email,r]);const c=()=>{a()};return h.jsxs("div",{className:"space-y-6",children:[h.jsx(Wt,{children:h.jsx(nn,{className:"p-6",children:h.jsx(I9,{classId:r,onLessonsChange:c})})}),h.jsx(XV,{classId:r,studentsCount:e,lessons:n,isLoadingLessons:i,onLessonsChange:c})]})},mI=({totalStudents:r,studentsWithNotes:e,hasGeneralContent:t})=>h.jsx("div",{className:"p-6 border-b border-gray-200",children:h.jsx("div",{className:"flex items-center justify-between",children:h.jsxs("div",{children:[h.jsxs("h2",{className:"text-xl font-bold text-gray-800 flex items-center",children:[h.jsx(Qi,{className:"w-5 h-5 mr-2"}),"Students (",r,")"]}),h.jsxs("div",{className:"flex items-center space-x-4 mt-1 text-sm",children:[t&&h.jsxs("span",{className:"text-green-600 flex items-center",children:[h.jsx(Ar,{className:"w-4 h-4 mr-1"}),"General lesson content synced"]}),h.jsxs("span",{className:"text-gray-600",children:[e," of ",r," have notes"]})]})]})})}),KV=({student:r,classId:e,isExpanded:t,onToggleExpanded:n,hasGeneralContent:s=!1,selectedLesson:i=null,onAutoCreateLesson:o})=>{var O;const{session:a}=ca(),[c,d]=R.useState(""),[f,m]=R.useState(""),[v,x]=R.useState(!1),[_,b]=R.useState(!1),[w,S]=R.useState("");R.useCallback(async()=>{var I,B;if(!((I=a==null?void 0:a.user)!=null&&I.email))return null;try{const W=await fetch("http://localhost:3001/api/teachers",{method:"GET",headers:{Authorization:`Bearer ${(B=a==null?void 0:a.user)==null?void 0:B.email}`}});if(!W.ok)return console.warn("Could not fetch teacher ID, using fallback"),null;const ee=(await W.json()).id,oe=await fetch(`http://localhost:3001/api/classes/${e}/auto-create-lesson`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({teacherId:ee})});if(oe.ok)return(await oe.json()).lesson.id}catch(W){console.error("Error auto-creating lesson:",W)}return null},[(O=a==null?void 0:a.user)==null?void 0:O.email,e]);const C=R.useCallback(async()=>{if(i)try{const I=await fetch(`http://localhost:3001/api/students/${r.id}/lessons/${i}/focus-goals?classId=${e}`);if(I.ok){const B=await I.json();d(B.focusGoals||"")}else d("")}catch(I){console.error("Error loading lesson focus goals:",I),d("")}else d("")},[i,r.id,e]),T=R.useCallback(async()=>{try{const I=await fetch(`http://localhost:3001/api/students/${r.id}/general-notes?classId=${e}`);if(I.ok){const B=await I.json();m(B.generalNotes||"")}}catch(I){console.error("Error loading general notes:",I)}},[r.id,e]);R.useEffect(()=>{C(),T()},[i,r.id,e,C,T]);const A=R.useCallback(async I=>{if(i){x(!0);try{if(!(await fetch(`http://localhost:3001/api/students/${r.id}/lessons/${i}/focus-goals`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({classId:e,focusGoals:I})})).ok)throw new Error("Failed to save focus goals")}catch(B){console.error("Error saving lesson focus goals:",B)}finally{x(!1)}}else console.log("Focus goals typed without lesson - need auto-creation:",I),localStorage.setItem(`temp-focus-goals-${e}-${r.id}`,I)},[i,r.id,e]),k=R.useCallback(async I=>{b(!0);try{if(!(await fetch(`http://localhost:3001/api/students/${r.id}/general-notes`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({classId:e,generalNotes:I})})).ok)throw new Error("Failed to save notes")}catch(B){console.error("Error saving general notes:",B)}finally{b(!1)}},[r.id,e]),j=async I=>{d(I),!i&&I.trim()&&o&&await o(),setTimeout(()=>A(I),1e3)},D=I=>{m(I),setTimeout(()=>k(I),1e3)},L=c.trim()||f.trim();return h.jsxs("div",{className:"p-6 border-b border-gray-200 last:border-b-0",children:[h.jsxs("div",{className:"flex items-center justify-between",children:[h.jsxs("div",{className:"flex-1",children:[h.jsx(qa,{to:`/student/${r.id}`,state:{fromClass:e},className:"text-lg font-bold text-indigo-600 hover:text-indigo-800 transition-colors block text-left",children:r.name}),h.jsx("p",{className:"text-gray-600 text-sm mt-1 text-left",children:r.email}),h.jsxs("div",{className:"flex items-center space-x-3 mt-2 ",children:[s&&h.jsxs("span",{className:"text-xs text-green-600 bg-green-50 px-2 py-1 rounded-full flex items-center",children:[h.jsx("span",{className:"w-1.5 h-1.5 bg-green-500 rounded-full mr-1.5"}),"General lesson synced"]}),L&&h.jsx("span",{className:"text-xs text-blue-600 bg-blue-50 px-2 py-1 rounded-full flex items-center",children:"Has personalized notes"}),i&&h.jsxs("span",{className:"text-xs text-purple-600 bg-purple-50 px-2 py-1 rounded-full flex items-center",children:[h.jsx(sh,{className:"w-3 h-3 mr-1"}),"Lesson selected"]})]})]}),h.jsxs("button",{onClick:n,className:"flex items-center space-x-2 text-gray-500 hover:text-indigo-600 transition-colors group",children:[t?h.jsx(ih,{className:"w-4 h-4 group-hover:rotate-90 transition-transform"}):h.jsx(sN,{className:"w-4 h-4 group-hover:rotate-90 transition-transform"}),h.jsx("span",{className:"text-sm",children:t?"Hide Notes":"Add Notes"})]})]}),t&&h.jsxs("div",{className:"mt-6 space-y-4 animate-in slide-in-from-top-2 duration-200",children:[h.jsxs("div",{children:[h.jsxs("label",{className:"flex items-center text-sm font-medium text-gray-700 mb-2",children:[h.jsx(sh,{className:"w-4 h-4 mr-2 text-indigo-600"}),"Learning Focus Goals",i&&h.jsx("span",{className:"ml-2 text-xs text-purple-600",children:"(for selected lesson)"})]}),h.jsx(vu,{value:c,onChange:I=>j(I.target.value),placeholder:i?`Add focus goals for ${r.name} in this lesson...`:`Add focus goals for ${r.name} (will auto-create lesson)...`,className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent resize-y min-h-16"}),h.jsxs("div",{className:"flex items-center justify-between mt-1",children:[h.jsx("p",{className:"text-xs text-gray-500",children:i?v?"Saving to lesson...":"Auto-saves to lesson":"Auto-saves (creates lesson when needed)"}),c.length>0&&h.jsxs("p",{className:"text-xs text-gray-400",children:[c.length," characters"]})]})]}),h.jsxs("div",{children:[h.jsxs("label",{className:"flex items-center text-sm font-medium text-gray-700 mb-2",children:[h.jsx(Bg,{className:"w-4 h-4 mr-2 text-indigo-600"}),"General Notes"]}),h.jsx(vu,{value:f,onChange:I=>D(I.target.value),placeholder:`Add general notes for ${r.name}...`,className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent resize-y min-h-20"}),h.jsxs("div",{className:"flex items-center justify-between mt-1",children:[h.jsx("p",{className:"text-xs text-gray-500",children:_?"Saving...":"Auto-saves to database"}),f.length>0&&h.jsxs("p",{className:"text-xs text-gray-400",children:[f.length," characters"]})]})]}),h.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-3",children:h.jsx("div",{className:"flex items-start",children:h.jsxs("div",{children:[h.jsx("p",{className:"text-sm text-blue-700 font-medium",children:"Notes will be used for personalization"}),h.jsx("p",{className:"text-xs text-blue-600 mt-1",children:i?`Focus goals are tied to this lesson. General notes apply across all lessons for ${r.name}.`:`Focus goals will create a new lesson automatically. General notes are saved immediately for ${r.name}.`})]})})})]})]})},QV=({students:r,classId:e,hasGeneralContent:t,selectedLesson:n=null,onAutoCreateLesson:s})=>{const[i,o]=R.useState(null),[a,c]=R.useState(0),d=f=>{o(m=>m===f?null:f)};return R.useEffect(()=>{(async()=>{if(!r.length){c(0);return}if(n){let m=0;for(const v of r)try{const x=await fetch(`http://localhost:3001/api/students/${v.id}/lessons/${n}/focus-goals?classId=${e}`),_=await fetch(`http://localhost:3001/api/students/${v.id}/general-notes?classId=${e}`),[b,w]=await Promise.all([x.ok?x.json():{focusGoals:""},_.ok?_.json():{generalNotes:""}]),S=(b.focusGoals||"").trim(),C=(w.generalNotes||"").trim();(S||C)&&m++}catch(x){console.error(`Error checking notes for student ${v.id}:`,x)}c(m)}else{const m=r.filter(v=>{const x=localStorage.getItem(`focus-goals-${e}-${v.id}`)||"",_=localStorage.getItem(`general-notes-${e}-${v.id}`)||"";return x.trim()||_.trim()}).length;c(m)}})()},[r,e,n]),h.jsxs("div",{className:"bg-white rounded-xl shadow-sm",children:[h.jsx(mI,{totalStudents:r.length,studentsWithNotes:a,hasGeneralContent:t}),h.jsxs("div",{className:"divide-y divide-gray-200",children:[r.map(f=>h.jsx(KV,{student:f,classId:e,isExpanded:i===f.id,onToggleExpanded:()=>d(f.id),hasGeneralContent:t,selectedLesson:n,onAutoCreateLesson:s},f.id)),r.length===0&&h.jsxs("div",{className:"p-8 text-center text-gray-500",children:[h.jsx(Qi,{className:"w-12 h-12 mx-auto mb-4 text-gray-300"}),h.jsx("p",{children:"No students found in this class."})]})]})]})},JV=({totalStudents:r,studentsWithNotes:e,hasGeneralContent:t,recentActivity:n,students:s,classId:i,lessons:o,isLoadingLessons:a,onLessonsChange:c})=>{const{session:d}=ca(),[f,m]=R.useState(!1),[v,x]=R.useState(null),[_,b]=R.useState(!1),w=T=>{x(T),T&&!o.find(A=>A.id===T)&&c()},S=async()=>{var T;if(!((T=d==null?void 0:d.user)!=null&&T.email)||_)return null;b(!0);try{const A=d.user.id,k=await fetch(`http://localhost:3001/api/classes/${i}/auto-create-lesson`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({teacherId:A})});if(k.ok){const D=(await k.json()).lesson.id;return x(D),c(),await C(D),D}else return console.error("Failed to auto-create lesson"),null}catch(A){return console.error("Error auto-creating lesson:",A),null}finally{b(!1)}},C=async T=>{for(const A of s){const k=`temp-focus-goals-${i}-${A.id}`,j=localStorage.getItem(k);if(j!=null&&j.trim())try{await fetch(`http://localhost:3001/api/students/${A.id}/lessons/${T}/focus-goals`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({classId:i,focusGoals:j})}),localStorage.removeItem(k)}catch(D){console.error(`Error migrating focus goals for student ${A.id}:`,D)}}};return h.jsxs("div",{className:"space-y-6",children:[h.jsx(Wt,{children:h.jsxs("div",{className:"p-4",children:[h.jsx("h2",{className:"text-lg font-bold mb-4",children:"Teaching Session"}),h.jsx(H_,{classId:i,selectedLesson:v,onLessonSelect:w,lessons:o,isLoadingLessons:a}),_&&h.jsx("div",{className:"mt-2 text-sm text-blue-600",children:"Creating lesson for today..."})]})}),h.jsx(QV,{students:s,classId:i,hasGeneralContent:t,selectedLesson:v,onAutoCreateLesson:S}),";"]})};function dC(r,[e,t]){return Math.min(t,Math.max(e,r))}function qE(r){const e=R.useRef({value:r,previous:r});return R.useMemo(()=>(e.current.value!==r&&(e.current.previous=e.current.value,e.current.value=r),e.current.previous),[r])}var ZV=[" ","Enter","ArrowUp","ArrowDown"],eH=[" ","Enter"],lh="Select",[W_,$_,tH]=S_(lh),[dm,Wee]=to(lh,[tH,sm]),q_=sm(),[nH,bu]=dm(lh),[rH,sH]=dm(lh),gI=r=>{const{__scopeSelect:e,children:t,open:n,defaultOpen:s,onOpenChange:i,value:o,defaultValue:a,onValueChange:c,dir:d,name:f,autoComplete:m,disabled:v,required:x,form:_}=r,b=q_(e),[w,S]=R.useState(null),[C,T]=R.useState(null),[A,k]=R.useState(!1),j=z0(d),[D,L]=ql({prop:n,defaultProp:s??!1,onChange:i,caller:lh}),[O,I]=ql({prop:o,defaultProp:a,onChange:c,caller:lh}),B=R.useRef(null),W=w?_||!!w.closest("form"):!0,[K,ee]=R.useState(new Set),oe=Array.from(K).map(ne=>ne.props.value).join(";");return h.jsx(ON,{...b,children:h.jsxs(nH,{required:x,scope:e,trigger:w,onTriggerChange:S,valueNode:C,onValueNodeChange:T,valueNodeHasChildren:A,onValueNodeHasChildrenChange:k,contentId:Oa(),value:O,onValueChange:I,open:D,onOpenChange:L,dir:j,triggerPointerDownPosRef:B,disabled:v,children:[h.jsx(W_.Provider,{scope:e,children:h.jsx(rH,{scope:r.__scopeSelect,onNativeOptionAdd:R.useCallback(ne=>{ee(ce=>new Set(ce).add(ne))},[]),onNativeOptionRemove:R.useCallback(ne=>{ee(ce=>{const V=new Set(ce);return V.delete(ne),V})},[]),children:t})}),W?h.jsxs(BI,{"aria-hidden":!0,required:x,tabIndex:-1,name:f,autoComplete:m,value:O,onChange:ne=>I(ne.target.value),disabled:v,form:_,children:[O===void 0?h.jsx("option",{value:""}):null,Array.from(K)]},oe):null]})})};gI.displayName=lh;var vI="SelectTrigger",xI=R.forwardRef((r,e)=>{const{__scopeSelect:t,disabled:n=!1,...s}=r,i=q_(t),o=bu(vI,t),a=o.disabled||n,c=Cn(e,o.onTriggerChange),d=$_(t),f=R.useRef("touch"),[m,v,x]=VI(b=>{const w=d().filter(T=>!T.disabled),S=w.find(T=>T.value===o.value),C=HI(w,b,S);C!==void 0&&o.onValueChange(C.value)}),_=b=>{a||(o.onOpenChange(!0),x()),b&&(o.triggerPointerDownPosRef.current={x:Math.round(b.pageX),y:Math.round(b.pageY)})};return h.jsx(pE,{asChild:!0,...i,children:h.jsx($t.button,{type:"button",role:"combobox","aria-controls":o.contentId,"aria-expanded":o.open,"aria-required":o.required,"aria-autocomplete":"none",dir:o.dir,"data-state":o.open?"open":"closed",disabled:a,"data-disabled":a?"":void 0,"data-placeholder":zI(o.value)?"":void 0,...s,ref:c,onClick:mt(s.onClick,b=>{b.currentTarget.focus(),f.current!=="mouse"&&_(b)}),onPointerDown:mt(s.onPointerDown,b=>{f.current=b.pointerType;const w=b.target;w.hasPointerCapture(b.pointerId)&&w.releasePointerCapture(b.pointerId),b.button===0&&b.ctrlKey===!1&&b.pointerType==="mouse"&&(_(b),b.preventDefault())}),onKeyDown:mt(s.onKeyDown,b=>{const w=m.current!=="";!(b.ctrlKey||b.altKey||b.metaKey)&&b.key.length===1&&v(b.key),!(w&&b.key===" ")&&ZV.includes(b.key)&&(_(),b.preventDefault())})})})});xI.displayName=vI;var yI="SelectValue",_I=R.forwardRef((r,e)=>{const{__scopeSelect:t,className:n,style:s,children:i,placeholder:o="",...a}=r,c=bu(yI,t),{onValueNodeHasChildrenChange:d}=c,f=i!==void 0,m=Cn(e,c.onValueNodeChange);return Es(()=>{d(f)},[d,f]),h.jsx($t.span,{...a,ref:m,style:{pointerEvents:"none"},children:zI(c.value)?h.jsx(h.Fragment,{children:o}):i})});_I.displayName=yI;var iH="SelectIcon",wI=R.forwardRef((r,e)=>{const{__scopeSelect:t,children:n,...s}=r;return h.jsx($t.span,{"aria-hidden":!0,...s,ref:e,children:n||""})});wI.displayName=iH;var oH="SelectPortal",SI=r=>h.jsx(D0,{asChild:!0,...r});SI.displayName=oH;var ch="SelectContent",bI=R.forwardRef((r,e)=>{const t=bu(ch,r.__scopeSelect),[n,s]=R.useState();if(Es(()=>{s(new DocumentFragment)},[]),!t.open){const i=n;return i?Jp.createPortal(h.jsx(EI,{scope:r.__scopeSelect,children:h.jsx(W_.Slot,{scope:r.__scopeSelect,children:h.jsx("div",{children:r.children})})}),i):null}return h.jsx(MI,{...r,ref:e})});bI.displayName=ch;var Jo=10,[EI,Eu]=dm(ch),aH="SelectContentImpl",lH=th("SelectContent.RemoveScroll"),MI=R.forwardRef((r,e)=>{const{__scopeSelect:t,position:n="item-aligned",onCloseAutoFocus:s,onEscapeKeyDown:i,onPointerDownOutside:o,side:a,sideOffset:c,align:d,alignOffset:f,arrowPadding:m,collisionBoundary:v,collisionPadding:x,sticky:_,hideWhenDetached:b,avoidCollisions:w,...S}=r,C=bu(ch,t),[T,A]=R.useState(null),[k,j]=R.useState(null),D=Cn(e,me=>A(me)),[L,O]=R.useState(null),[I,B]=R.useState(null),W=$_(t),[K,ee]=R.useState(!1),oe=R.useRef(!1);R.useEffect(()=>{if(T)return UE(T)},[T]),FE();const ne=R.useCallback(me=>{const[je,...Xe]=W().map(ht=>ht.ref.current),[$e]=Xe.slice(-1),dt=document.activeElement;for(const ht of me)if(ht===dt||(ht==null||ht.scrollIntoView({block:"nearest"}),ht===je&&k&&(k.scrollTop=0),ht===$e&&k&&(k.scrollTop=k.scrollHeight),ht==null||ht.focus(),document.activeElement!==dt))return},[W,k]),ce=R.useCallback(()=>ne([L,T]),[ne,L,T]);R.useEffect(()=>{K&&ce()},[K,ce]);const{onOpenChange:V,triggerPointerDownPosRef:q}=C;R.useEffect(()=>{if(T){let me={x:0,y:0};const je=$e=>{var dt,ht;me={x:Math.abs(Math.round($e.pageX)-(((dt=q.current)==null?void 0:dt.x)??0)),y:Math.abs(Math.round($e.pageY)-(((ht=q.current)==null?void 0:ht.y)??0))}},Xe=$e=>{me.x<=10&&me.y<=10?$e.preventDefault():T.contains($e.target)||V(!1),document.removeEventListener("pointermove",je),q.current=null};return q.current!==null&&(document.addEventListener("pointermove",je),document.addEventListener("pointerup",Xe,{capture:!0,once:!0})),()=>{document.removeEventListener("pointermove",je),document.removeEventListener("pointerup",Xe,{capture:!0})}}},[T,V,q]),R.useEffect(()=>{const me=()=>V(!1);return window.addEventListener("blur",me),window.addEventListener("resize",me),()=>{window.removeEventListener("blur",me),window.removeEventListener("resize",me)}},[V]);const[Z,X]=VI(me=>{const je=W().filter(dt=>!dt.disabled),Xe=je.find(dt=>dt.ref.current===document.activeElement),$e=HI(je,me,Xe);$e&&setTimeout(()=>$e.ref.current.focus())}),ie=R.useCallback((me,je,Xe)=>{const $e=!oe.current&&!Xe;(C.value!==void 0&&C.value===je||$e)&&(O(me),$e&&(oe.current=!0))},[C.value]),be=R.useCallback(()=>T==null?void 0:T.focus(),[T]),ue=R.useCallback((me,je,Xe)=>{const $e=!oe.current&&!Xe;(C.value!==void 0&&C.value===je||$e)&&B(me)},[C.value]),Ee=n==="popper"?Tb:TI,Fe=Ee===Tb?{side:a,sideOffset:c,align:d,alignOffset:f,arrowPadding:m,collisionBoundary:v,collisionPadding:x,sticky:_,hideWhenDetached:b,avoidCollisions:w}:{};return h.jsx(EI,{scope:t,content:T,viewport:k,onViewportChange:j,itemRefCallback:ie,selectedItem:L,onItemLeave:be,itemTextRefCallback:ue,focusSelectedItem:ce,selectedItemText:I,position:n,isPositioned:K,searchRef:Z,children:h.jsx(U_,{as:lH,allowPinchZoom:!0,children:h.jsx(j_,{asChild:!0,trapped:C.open,onMountAutoFocus:me=>{me.preventDefault()},onUnmountAutoFocus:mt(s,me=>{var je;(je=C.trigger)==null||je.focus({preventScroll:!0}),me.preventDefault()}),children:h.jsx(Zp,{asChild:!0,disableOutsidePointerEvents:!0,onEscapeKeyDown:i,onPointerDownOutside:o,onFocusOutside:me=>me.preventDefault(),onDismiss:()=>C.onOpenChange(!1),children:h.jsx(Ee,{role:"listbox",id:C.contentId,"data-state":C.open?"open":"closed",dir:C.dir,onContextMenu:me=>me.preventDefault(),...S,...Fe,onPlaced:()=>ee(!0),ref:D,style:{display:"flex",flexDirection:"column",outline:"none",...S.style},onKeyDown:mt(S.onKeyDown,me=>{const je=me.ctrlKey||me.altKey||me.metaKey;if(me.key==="Tab"&&me.preventDefault(),!je&&me.key.length===1&&X(me.key),["ArrowUp","ArrowDown","Home","End"].includes(me.key)){let $e=W().filter(dt=>!dt.disabled).map(dt=>dt.ref.current);if(["ArrowUp","End"].includes(me.key)&&($e=$e.slice().reverse()),["ArrowUp","ArrowDown"].includes(me.key)){const dt=me.target,ht=$e.indexOf(dt);$e=$e.slice(ht+1)}setTimeout(()=>ne($e)),me.preventDefault()}})})})})})})});MI.displayName=aH;var cH="SelectItemAlignedPosition",TI=R.forwardRef((r,e)=>{const{__scopeSelect:t,onPlaced:n,...s}=r,i=bu(ch,t),o=Eu(ch,t),[a,c]=R.useState(null),[d,f]=R.useState(null),m=Cn(e,D=>f(D)),v=$_(t),x=R.useRef(!1),_=R.useRef(!0),{viewport:b,selectedItem:w,selectedItemText:S,focusSelectedItem:C}=o,T=R.useCallback(()=>{if(i.trigger&&i.valueNode&&a&&d&&b&&w&&S){const D=i.trigger.getBoundingClientRect(),L=d.getBoundingClientRect(),O=i.valueNode.getBoundingClientRect(),I=S.getBoundingClientRect();if(i.dir!=="rtl"){const dt=I.left-L.left,ht=O.left-dt,Ie=D.left-ht,$=D.width+Ie,Ce=Math.max($,L.width),ke=window.innerWidth-Jo,Ge=dC(ht,[Jo,Math.max(Jo,ke-Ce)]);a.style.minWidth=$+"px",a.style.left=Ge+"px"}else{const dt=L.right-I.right,ht=window.innerWidth-O.right-dt,Ie=window.innerWidth-D.right-ht,$=D.width+Ie,Ce=Math.max($,L.width),ke=window.innerWidth-Jo,Ge=dC(ht,[Jo,Math.max(Jo,ke-Ce)]);a.style.minWidth=$+"px",a.style.right=Ge+"px"}const B=v(),W=window.innerHeight-Jo*2,K=b.scrollHeight,ee=window.getComputedStyle(d),oe=parseInt(ee.borderTopWidth,10),ne=parseInt(ee.paddingTop,10),ce=parseInt(ee.borderBottomWidth,10),V=parseInt(ee.paddingBottom,10),q=oe+ne+K+V+ce,Z=Math.min(w.offsetHeight*5,q),X=window.getComputedStyle(b),ie=parseInt(X.paddingTop,10),be=parseInt(X.paddingBottom,10),ue=D.top+D.height/2-Jo,Ee=W-ue,Fe=w.offsetHeight/2,me=w.offsetTop+Fe,je=oe+ne+me,Xe=q-je;if(je<=ue){const dt=B.length>0&&w===B[B.length-1].ref.current;a.style.bottom="0px";const ht=d.clientHeight-b.offsetTop-b.offsetHeight,Ie=Math.max(Ee,Fe+(dt?be:0)+ht+ce),$=je+Ie;a.style.height=$+"px"}else{const dt=B.length>0&&w===B[0].ref.current;a.style.top="0px";const Ie=Math.max(ue,oe+b.offsetTop+(dt?ie:0)+Fe)+Xe;a.style.height=Ie+"px",b.scrollTop=je-ue+b.offsetTop}a.style.margin=`${Jo}px 0`,a.style.minHeight=Z+"px",a.style.maxHeight=W+"px",n==null||n(),requestAnimationFrame(()=>x.current=!0)}},[v,i.trigger,i.valueNode,a,d,b,w,S,i.dir,n]);Es(()=>T(),[T]);const[A,k]=R.useState();Es(()=>{d&&k(window.getComputedStyle(d).zIndex)},[d]);const j=R.useCallback(D=>{D&&_.current===!0&&(T(),C==null||C(),_.current=!1)},[T,C]);return h.jsx(dH,{scope:t,contentWrapper:a,shouldExpandOnScrollRef:x,onScrollButtonChange:j,children:h.jsx("div",{ref:c,style:{display:"flex",flexDirection:"column",position:"fixed",zIndex:A},children:h.jsx($t.div,{...s,ref:m,style:{boxSizing:"border-box",maxHeight:"100%",...s.style}})})})});TI.displayName=cH;var uH="SelectPopperPosition",Tb=R.forwardRef((r,e)=>{const{__scopeSelect:t,align:n="start",collisionPadding:s=Jo,...i}=r,o=q_(t);return h.jsx(mE,{...o,...i,ref:e,align:n,collisionPadding:s,style:{boxSizing:"border-box",...i.style,"--radix-select-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-select-content-available-width":"var(--radix-popper-available-width)","--radix-select-content-available-height":"var(--radix-popper-available-height)","--radix-select-trigger-width":"var(--radix-popper-anchor-width)","--radix-select-trigger-height":"var(--radix-popper-anchor-height)"}})});Tb.displayName=uH;var[dH,XE]=dm(ch,{}),Cb="SelectViewport",CI=R.forwardRef((r,e)=>{const{__scopeSelect:t,nonce:n,...s}=r,i=Eu(Cb,t),o=XE(Cb,t),a=Cn(e,i.onViewportChange),c=R.useRef(0);return h.jsxs(h.Fragment,{children:[h.jsx("style",{dangerouslySetInnerHTML:{__html:"[data-radix-select-viewport]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}[data-radix-select-viewport]::-webkit-scrollbar{display:none}"},nonce:n}),h.jsx(W_.Slot,{scope:t,children:h.jsx($t.div,{"data-radix-select-viewport":"",role:"presentation",...s,ref:a,style:{position:"relative",flex:1,overflow:"hidden auto",...s.style},onScroll:mt(s.onScroll,d=>{const f=d.currentTarget,{contentWrapper:m,shouldExpandOnScrollRef:v}=o;if(v!=null&&v.current&&m){const x=Math.abs(c.current-f.scrollTop);if(x>0){const _=window.innerHeight-Jo*2,b=parseFloat(m.style.minHeight),w=parseFloat(m.style.height),S=Math.max(b,w);if(S<_){const C=S+x,T=Math.min(_,C),A=C-T;m.style.height=T+"px",m.style.bottom==="0px"&&(f.scrollTop=A>0?A:0,m.style.justifyContent="flex-end")}}}c.current=f.scrollTop})})})]})});CI.displayName=Cb;var AI="SelectGroup",[hH,fH]=dm(AI),pH=R.forwardRef((r,e)=>{const{__scopeSelect:t,...n}=r,s=Oa();return h.jsx(hH,{scope:t,id:s,children:h.jsx($t.div,{role:"group","aria-labelledby":s,...n,ref:e})})});pH.displayName=AI;var RI="SelectLabel",NI=R.forwardRef((r,e)=>{const{__scopeSelect:t,...n}=r,s=fH(RI,t);return h.jsx($t.div,{id:s.id,...n,ref:e})});NI.displayName=RI;var Ny="SelectItem",[mH,PI]=dm(Ny),II=R.forwardRef((r,e)=>{const{__scopeSelect:t,value:n,disabled:s=!1,textValue:i,...o}=r,a=bu(Ny,t),c=Eu(Ny,t),d=a.value===n,[f,m]=R.useState(i??""),[v,x]=R.useState(!1),_=Cn(e,C=>{var T;return(T=c.itemRefCallback)==null?void 0:T.call(c,C,n,s)}),b=Oa(),w=R.useRef("touch"),S=()=>{s||(a.onValueChange(n),a.onOpenChange(!1))};if(n==="")throw new Error("A <Select.Item /> must have a value prop that is not an empty string. This is because the Select value can be set to an empty string to clear the selection and show the placeholder.");return h.jsx(mH,{scope:t,value:n,disabled:s,textId:b,isSelected:d,onItemTextChange:R.useCallback(C=>{m(T=>T||((C==null?void 0:C.textContent)??"").trim())},[]),children:h.jsx(W_.ItemSlot,{scope:t,value:n,disabled:s,textValue:f,children:h.jsx($t.div,{role:"option","aria-labelledby":b,"data-highlighted":v?"":void 0,"aria-selected":d&&v,"data-state":d?"checked":"unchecked","aria-disabled":s||void 0,"data-disabled":s?"":void 0,tabIndex:s?void 0:-1,...o,ref:_,onFocus:mt(o.onFocus,()=>x(!0)),onBlur:mt(o.onBlur,()=>x(!1)),onClick:mt(o.onClick,()=>{w.current!=="mouse"&&S()}),onPointerUp:mt(o.onPointerUp,()=>{w.current==="mouse"&&S()}),onPointerDown:mt(o.onPointerDown,C=>{w.current=C.pointerType}),onPointerMove:mt(o.onPointerMove,C=>{var T;w.current=C.pointerType,s?(T=c.onItemLeave)==null||T.call(c):w.current==="mouse"&&C.currentTarget.focus({preventScroll:!0})}),onPointerLeave:mt(o.onPointerLeave,C=>{var T;C.currentTarget===document.activeElement&&((T=c.onItemLeave)==null||T.call(c))}),onKeyDown:mt(o.onKeyDown,C=>{var A;((A=c.searchRef)==null?void 0:A.current)!==""&&C.key===" "||(eH.includes(C.key)&&S(),C.key===" "&&C.preventDefault())})})})})});II.displayName=Ny;var Lg="SelectItemText",kI=R.forwardRef((r,e)=>{const{__scopeSelect:t,className:n,style:s,...i}=r,o=bu(Lg,t),a=Eu(Lg,t),c=PI(Lg,t),d=sH(Lg,t),[f,m]=R.useState(null),v=Cn(e,S=>m(S),c.onItemTextChange,S=>{var C;return(C=a.itemTextRefCallback)==null?void 0:C.call(a,S,c.value,c.disabled)}),x=f==null?void 0:f.textContent,_=R.useMemo(()=>h.jsx("option",{value:c.value,disabled:c.disabled,children:x},c.value),[c.disabled,c.value,x]),{onNativeOptionAdd:b,onNativeOptionRemove:w}=d;return Es(()=>(b(_),()=>w(_)),[b,w,_]),h.jsxs(h.Fragment,{children:[h.jsx($t.span,{id:c.textId,...i,ref:v}),c.isSelected&&o.valueNode&&!o.valueNodeHasChildren?Jp.createPortal(i.children,o.valueNode):null]})});kI.displayName=Lg;var DI="SelectItemIndicator",LI=R.forwardRef((r,e)=>{const{__scopeSelect:t,...n}=r;return PI(DI,t).isSelected?h.jsx($t.span,{"aria-hidden":!0,...n,ref:e}):null});LI.displayName=DI;var Ab="SelectScrollUpButton",OI=R.forwardRef((r,e)=>{const t=Eu(Ab,r.__scopeSelect),n=XE(Ab,r.__scopeSelect),[s,i]=R.useState(!1),o=Cn(e,n.onScrollButtonChange);return Es(()=>{if(t.viewport&&t.isPositioned){let a=function(){const d=c.scrollTop>0;i(d)};const c=t.viewport;return a(),c.addEventListener("scroll",a),()=>c.removeEventListener("scroll",a)}},[t.viewport,t.isPositioned]),s?h.jsx(FI,{...r,ref:o,onAutoScroll:()=>{const{viewport:a,selectedItem:c}=t;a&&c&&(a.scrollTop=a.scrollTop-c.offsetHeight)}}):null});OI.displayName=Ab;var Rb="SelectScrollDownButton",jI=R.forwardRef((r,e)=>{const t=Eu(Rb,r.__scopeSelect),n=XE(Rb,r.__scopeSelect),[s,i]=R.useState(!1),o=Cn(e,n.onScrollButtonChange);return Es(()=>{if(t.viewport&&t.isPositioned){let a=function(){const d=c.scrollHeight-c.clientHeight,f=Math.ceil(c.scrollTop)<d;i(f)};const c=t.viewport;return a(),c.addEventListener("scroll",a),()=>c.removeEventListener("scroll",a)}},[t.viewport,t.isPositioned]),s?h.jsx(FI,{...r,ref:o,onAutoScroll:()=>{const{viewport:a,selectedItem:c}=t;a&&c&&(a.scrollTop=a.scrollTop+c.offsetHeight)}}):null});jI.displayName=Rb;var FI=R.forwardRef((r,e)=>{const{__scopeSelect:t,onAutoScroll:n,...s}=r,i=Eu("SelectScrollButton",t),o=R.useRef(null),a=$_(t),c=R.useCallback(()=>{o.current!==null&&(window.clearInterval(o.current),o.current=null)},[]);return R.useEffect(()=>()=>c(),[c]),Es(()=>{var f;const d=a().find(m=>m.ref.current===document.activeElement);(f=d==null?void 0:d.ref.current)==null||f.scrollIntoView({block:"nearest"})},[a]),h.jsx($t.div,{"aria-hidden":!0,...s,ref:e,style:{flexShrink:0,...s.style},onPointerDown:mt(s.onPointerDown,()=>{o.current===null&&(o.current=window.setInterval(n,50))}),onPointerMove:mt(s.onPointerMove,()=>{var d;(d=i.onItemLeave)==null||d.call(i),o.current===null&&(o.current=window.setInterval(n,50))}),onPointerLeave:mt(s.onPointerLeave,()=>{c()})})}),gH="SelectSeparator",UI=R.forwardRef((r,e)=>{const{__scopeSelect:t,...n}=r;return h.jsx($t.div,{"aria-hidden":!0,...n,ref:e})});UI.displayName=gH;var Nb="SelectArrow",vH=R.forwardRef((r,e)=>{const{__scopeSelect:t,...n}=r,s=q_(t),i=bu(Nb,t),o=Eu(Nb,t);return i.open&&o.position==="popper"?h.jsx(gE,{...s,...n,ref:e}):null});vH.displayName=Nb;var xH="SelectBubbleInput",BI=R.forwardRef(({__scopeSelect:r,value:e,...t},n)=>{const s=R.useRef(null),i=Cn(n,s),o=qE(e);return R.useEffect(()=>{const a=s.current;if(!a)return;const c=window.HTMLSelectElement.prototype,f=Object.getOwnPropertyDescriptor(c,"value").set;if(o!==e&&f){const m=new Event("change",{bubbles:!0});f.call(a,e),a.dispatchEvent(m)}},[o,e]),h.jsx($t.select,{...t,style:{...PR,...t.style},ref:i,defaultValue:e})});BI.displayName=xH;function zI(r){return r===""||r===void 0}function VI(r){const e=Di(r),t=R.useRef(""),n=R.useRef(0),s=R.useCallback(o=>{const a=t.current+o;e(a),function c(d){t.current=d,window.clearTimeout(n.current),d!==""&&(n.current=window.setTimeout(()=>c(""),1e3))}(a)},[e]),i=R.useCallback(()=>{t.current="",window.clearTimeout(n.current)},[]);return R.useEffect(()=>()=>window.clearTimeout(n.current),[]),[t,s,i]}function HI(r,e,t){const s=e.length>1&&Array.from(e).every(d=>d===e[0])?e[0]:e,i=t?r.indexOf(t):-1;let o=yH(r,Math.max(i,0));s.length===1&&(o=o.filter(d=>d!==t));const c=o.find(d=>d.textValue.toLowerCase().startsWith(s.toLowerCase()));return c!==t?c:void 0}function yH(r,e){return r.map((t,n)=>r[(e+n)%r.length])}var _H=gI,GI=xI,wH=_I,SH=wI,bH=SI,WI=bI,EH=CI,$I=NI,qI=II,MH=kI,TH=LI,XI=OI,YI=jI,KI=UI;const CH=_H,AH=wH,QI=R.forwardRef(({className:r,children:e,...t},n)=>h.jsxs(GI,{ref:n,className:Zt("flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",r),...t,children:[e,h.jsx(SH,{asChild:!0,children:h.jsx(nh,{className:"h-4 w-4 opacity-50"})})]}));QI.displayName=GI.displayName;const JI=R.forwardRef(({className:r,...e},t)=>h.jsx(XI,{ref:t,className:Zt("flex cursor-default items-center justify-center py-1",r),...e,children:h.jsx(eN,{className:"h-4 w-4"})}));JI.displayName=XI.displayName;const ZI=R.forwardRef(({className:r,...e},t)=>h.jsx(YI,{ref:t,className:Zt("flex cursor-default items-center justify-center py-1",r),...e,children:h.jsx(nh,{className:"h-4 w-4"})}));ZI.displayName=YI.displayName;const ek=R.forwardRef(({className:r,children:e,position:t="popper",...n},s)=>h.jsx(bH,{children:h.jsxs(WI,{ref:s,className:Zt("relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",t==="popper"&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",r),position:t,...n,children:[h.jsx(JI,{}),h.jsx(EH,{className:Zt("p-1",t==="popper"&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:e}),h.jsx(ZI,{})]})}));ek.displayName=WI.displayName;const RH=R.forwardRef(({className:r,...e},t)=>h.jsx($I,{ref:t,className:Zt("py-1.5 pl-8 pr-2 text-sm font-semibold",r),...e}));RH.displayName=$I.displayName;const tk=R.forwardRef(({className:r,children:e,...t},n)=>h.jsxs(qI,{ref:n,className:Zt("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",r),...t,children:[h.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:h.jsx(TH,{children:h.jsx(t0,{className:"h-4 w-4"})})}),h.jsx(MH,{children:e})]}));tk.displayName=qI.displayName;const NH=R.forwardRef(({className:r,...e},t)=>h.jsx(KI,{ref:t,className:Zt("-mx-1 my-1 h-px bg-muted",r),...e}));NH.displayName=KI.displayName;const PH=(r,e=90)=>{const[t,n]=R.useState([]),[s,i]=R.useState(null),[o,a]=R.useState(null),[c,d]=R.useState(!0),[f,m]=R.useState(!1),[v,x]=R.useState(null),_=R.useCallback(async()=>{try{const k=await(await fetch(`http://localhost:3001/api/analytics/class/${r}/assignments`)).json();if(!k.success)throw new Error(k.error);n(k.assignments),k.defaultAssignment&&!s&&i(k.defaultAssignment)}catch(A){console.error("Error fetching assignments:",A),x(A instanceof Error?A.message:"Failed to fetch assignments")}},[r,s]),b=R.useCallback(async A=>{try{const j=await(await fetch(`http://localhost:3001/api/analytics/assignment/${A}/report`)).json();j.success&&a(j.report)}catch(k){console.error("Error fetching report:",k)}},[]),w=R.useCallback(async A=>{try{const j=await(await fetch(`http://localhost:3001/api/analytics/assignment/${A}/status`)).json();if(!j.success)return;if(j.shouldAutoTrigger&&j.completion.percentage>=e){const D=j.completion.percentage>=100?"auto_100":j.completion.percentage>=95?"auto_95":"auto_90";await S(A,D)}}catch(k){console.error("Error checking status:",k)}},[e]),S=async(A,k="manual")=>{m(!0),x(null);try{const D=await(await fetch(`http://localhost:3001/api/analytics/assignment/${A}/analyze`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({triggerType:k})})).json();if(!D.success)throw new Error(D.error||"Analysis failed");a(D.report),Yr.success("Analysis completed successfully!"),await _()}catch(j){const D=j instanceof Error?j.message:"Failed to run analysis";x(D),Yr.error(D)}finally{m(!1)}},C=()=>{s&&S(s.id,"manual")},T=A=>{i(A),A.hasAnalysis?b(A.id):a(null)};return R.useEffect(()=>{r&&(d(!0),_().finally(()=>d(!1)))},[r,_]),R.useEffect(()=>{s!=null&&s.id&&(b(s.id),w(s.id))},[s==null?void 0:s.id,b,w]),R.useEffect(()=>{if(!(s!=null&&s.id))return;const A=setInterval(()=>{w(s.id)},3e4);return()=>clearInterval(A)},[s==null?void 0:s.id,w]),{assignments:t,selectedAssignment:s,report:o,isLoading:c,isAnalyzing:f,error:v,analyzeNow:C,selectAssignment:T,refreshAssignments:_}},IH=({report:r,assignmentId:e,isPreview:t=!1})=>{const[n,s]=R.useState(null),i=r.classroom_insights||{},o=r.question_breakdown||{};r.concept_performance;const a=r.chat_analysis||{},c=(r.flagged_students||[]).sort((d,f)=>{const m={red:0,orange:1,yellow:2};return m[d.flag_level]-m[f.flag_level]});return h.jsxs("div",{className:"space-y-4",children:[h.jsxs(Wt,{children:[h.jsx(or,{className:"pb-3",children:h.jsxs("h3",{className:"font-semibold flex items-center gap-2",children:[h.jsx(sh,{className:"h-5 w-5 text-blue-600"}),"Classroom Performance Overview"]})}),h.jsx(nn,{children:h.jsxs("div",{className:"space-y-3",children:[h.jsx("div",{className:"p-4 bg-green-50 rounded-lg",children:h.jsxs("div",{className:"flex items-start gap-2",children:[h.jsx(iN,{className:"h-5 w-5 text-green-600 mt-0.5"}),h.jsxs("div",{className:"flex-1",children:[h.jsx("p",{className:"font-medium text-green-900",children:"Strong Performance"}),h.jsx("p",{className:"text-sm text-green-700 mt-1",children:i.summary||"Overall strong performance"}),i.strengths&&i.strengths.length>0&&h.jsx("ul",{className:"text-sm text-green-700 mt-2 space-y-1",children:i.strengths.map((d,f)=>h.jsxs("li",{children:[" ",d]},f))}),i.averageScore&&h.jsxs("p",{className:"text-sm text-green-700 mt-2 font-medium",children:["Class Average: ",i.averageScore,"%"]})]})]})}),i.weaknesses&&i.weaknesses.length>0&&h.jsx("div",{className:"p-4 bg-orange-50 rounded-lg",children:h.jsxs("div",{className:"flex items-start gap-2",children:[h.jsx(f5,{className:"h-5 w-5 text-orange-600 mt-0.5"}),h.jsxs("div",{className:"flex-1",children:[h.jsx("p",{className:"font-medium text-orange-900",children:"Areas for Improvement"}),h.jsx("ul",{className:"text-sm text-orange-700 mt-2 space-y-1",children:i.weaknesses.map((d,f)=>h.jsxs("li",{children:[" ",d]},f))})]})]})})]})})]}),c.length>0&&h.jsxs(Wt,{children:[h.jsx(or,{className:"pb-3",children:h.jsxs("h3",{className:"font-semibold flex items-center gap-2",children:[h.jsx(Hs,{className:"h-5 w-5 text-red-600"}),"Students Needing Attention (",c.length,")"]})}),h.jsx(nn,{children:h.jsx("div",{className:"space-y-2",children:c.map((d,f)=>h.jsxs("div",{className:"border rounded-lg overflow-hidden",children:[h.jsxs("button",{onClick:()=>s(n===`student-${d.student_id}`?null:`student-${d.student_id}`),className:"w-full p-4 flex items-center justify-between hover:bg-gray-50 transition-colors",children:[h.jsxs("div",{className:"flex items-center gap-3",children:[h.jsx("div",{className:`w-2 h-2 rounded-full ${d.flag_level==="red"?"bg-red-500":d.flag_level==="orange"?"bg-orange-500":"bg-yellow-500"}`}),h.jsxs("div",{className:"text-left",children:[h.jsx("p",{className:"font-medium",children:d.student_name}),h.jsx("p",{className:"text-sm text-gray-600",children:d.flag_reason})]})]}),n===`student-${d.student_id}`?h.jsx(eN,{className:"h-4 w-4 text-gray-400"}):h.jsx(nh,{className:"h-4 w-4 text-gray-400"})]}),n===`student-${d.student_id}`&&h.jsxs("div",{className:"p-4 bg-gray-50 border-t space-y-3",children:[d.concerning_excerpt&&h.jsxs("div",{className:"p-3 bg-white rounded border-l-4 border-red-500",children:[h.jsx("p",{className:"text-xs text-gray-500 mb-1",children:"Concerning excerpt:"}),h.jsxs("p",{className:"text-sm italic",children:['"',d.concerning_excerpt,'"']})]}),d.performance_summary&&h.jsxs("div",{className:"text-sm text-gray-700",children:[h.jsx("p",{className:"font-medium mb-1",children:"Performance:"}),h.jsx("p",{children:d.performance_summary})]}),h.jsxs(zt,{variant:"outline",size:"sm",onClick:()=>{console.log("View chat for student:",d.id)},children:[h.jsx(GS,{className:"h-3 w-3 mr-2"}),"View Full Chat"]})]})]},d.student_id||f))})})]}),h.jsxs(Wt,{children:[h.jsx(or,{className:"pb-3",children:h.jsx("h3",{className:"font-semibold",children:"Question Performance Breakdown"})}),h.jsx(nn,{children:Object.keys(o).length>0?h.jsx("div",{className:"space-y-3",children:Object.entries(o).map(([d,f])=>h.jsxs("div",{className:"p-3 border rounded-lg",children:[h.jsxs("div",{className:"flex items-center justify-between mb-2",children:[h.jsxs("span",{className:"font-medium text-sm",children:["Question ",parseInt(d)+1]}),h.jsxs("span",{className:`text-sm font-semibold ${f.correctPercentage>=80?"text-green-600":f.correctPercentage>=60?"text-yellow-600":"text-red-600"}`,children:[f.correctPercentage,"% correct"]})]}),f.concept&&h.jsxs("p",{className:"text-xs text-gray-500 mb-1",children:["Concept: ",h.jsx("span",{className:"font-medium",children:f.concept})]}),f.analysis&&h.jsx("p",{className:"text-sm text-gray-700",children:f.analysis}),h.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2 mt-2",children:h.jsx("div",{className:`h-2 rounded-full ${f.correctPercentage>=80?"bg-green-500":f.correctPercentage>=60?"bg-yellow-500":"bg-red-500"}`,style:{width:`${f.correctPercentage}%`}})})]},d))}):h.jsx("p",{className:"text-sm text-gray-500",children:"No question breakdown data available yet."})})]}),a&&Object.keys(a).length>0&&h.jsxs(Wt,{children:[h.jsx(or,{className:"pb-3",children:h.jsxs("h3",{className:"font-semibold flex items-center gap-2",children:[h.jsx(GS,{className:"h-5 w-5 text-purple-600"}),"Chat Conversation Analysis"]})}),h.jsx(nn,{children:h.jsxs("div",{className:"space-y-3",children:[a.commonQuestions&&a.commonQuestions.length>0&&h.jsxs("div",{children:[h.jsx("p",{className:"text-sm font-medium text-gray-700 mb-2",children:"Common Questions:"}),h.jsx("ul",{className:"text-sm text-gray-600 space-y-1",children:a.commonQuestions.map((d,f)=>h.jsxs("li",{children:[" ",d]},f))})]}),a.concerningPatterns&&a.concerningPatterns.length>0&&h.jsxs("div",{className:"p-3 bg-orange-50 rounded border border-orange-200",children:[h.jsx("p",{className:"text-sm font-medium text-orange-900 mb-2",children:"Concerning Patterns:"}),h.jsx("ul",{className:"text-sm text-orange-700 space-y-1",children:a.concerningPatterns.map((d,f)=>h.jsxs("li",{children:[" ",d]},f))})]}),a.engagementLevel&&h.jsxs("div",{className:"text-sm",children:[h.jsx("span",{className:"text-gray-600",children:"Engagement Level: "}),h.jsx("span",{className:`font-medium ${a.engagementLevel==="high"?"text-green-600":a.engagementLevel==="medium"?"text-yellow-600":"text-red-600"}`,children:a.engagementLevel.charAt(0).toUpperCase()+a.engagementLevel.slice(1)})]})]})})]}),h.jsx(Wt,{children:h.jsx(nn,{className:"p-4",children:h.jsxs("div",{className:"flex items-center justify-between text-sm",children:[h.jsxs("span",{className:"text-gray-600",children:["Trigger Type: ",h.jsx("span",{className:"font-medium",children:r.trigger_type})]}),h.jsxs("span",{className:"text-gray-600",children:[r.students_completed," of ",r.students_total," students analyzed"]})]})})})]})};new Date().toISOString();new Date(Date.now()-2*60*60*1e3).toISOString(),new Date(Date.now()-7*24*60*60*1e3).toISOString(),new Date(Date.now()-3*24*60*60*1e3).toISOString();const kH=({classId:r,autoAnalyzeAt:e=90})=>{const{assignments:t,selectedAssignment:n,report:s,isLoading:i,isAnalyzing:o,error:a,analyzeNow:c,selectAssignment:d,refreshAssignments:f}=PH(r,e);if(i)return h.jsx(Wt,{children:h.jsx(nn,{className:"p-6",children:h.jsxs("div",{className:"flex items-center justify-center",children:[h.jsx(Yd,{className:"h-6 w-6 animate-spin text-gray-400"}),h.jsx("span",{className:"ml-2 text-gray-600",children:"Loading analytics..."})]})})});const m=t.filter(v=>v.hasAnalysis);return h.jsxs("div",{className:"space-y-4",children:[h.jsxs(Wt,{children:[h.jsx(or,{className:"pb-3",children:h.jsxs("div",{className:"flex items-center justify-between",children:[h.jsxs("div",{className:"flex items-center gap-2",children:[h.jsx(ly,{className:"h-5 w-5 text-purple-600"}),h.jsx("h3",{className:"font-semibold text-lg",children:"Assignment Analytics - Mock Data"})]}),h.jsx(zt,{onClick:f,variant:"outline",size:"sm",disabled:i,children:h.jsx(Yd,{className:`h-4 w-4 ${i?"animate-spin":""}`})})]})}),h.jsxs(nn,{className:"space-y-4",children:[h.jsxs("div",{className:"space-y-2",children:[h.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Select Assignment"}),m.length>0?h.jsxs(CH,{value:(n==null?void 0:n.id)||"",onValueChange:v=>{const x=t.find(_=>_.id===v);x&&d(x)},children:[h.jsx(QI,{children:h.jsx(AH,{placeholder:"Choose an assignment..."})}),h.jsx(ek,{children:m.map(v=>h.jsx(tk,{value:v.id,children:h.jsxs("div",{className:"flex items-center justify-between w-full",children:[h.jsx("span",{children:v.lessonTitle}),h.jsxs("span",{className:"text-xs text-gray-500 ml-4",children:[v.completion.percentage.toFixed(0),"% complete"]})]})},v.id))})]}):h.jsx("div",{className:"p-3 bg-gray-100 rounded border-2 border-dashed border-gray-300 text-gray-500 text-sm",children:"No analyzed assignments yet"})]}),n&&h.jsxs("div",{className:"flex items-center justify-between p-4 bg-gradient-to-r from-purple-50 to-blue-50 rounded-lg",children:[h.jsxs("div",{className:"space-y-1",children:[h.jsxs("div",{className:"flex items-center gap-2",children:[n.completion.percentage>=90?h.jsx(Ar,{className:"h-5 w-5 text-green-600"}):h.jsx(fu,{className:"h-5 w-5 text-orange-500"}),h.jsxs("span",{className:"font-medium",children:[n.completion.completed," / ",n.completion.total," Students Completed"]})]}),h.jsxs("p",{className:"text-sm text-gray-600",children:[n.completion.percentage.toFixed(1),"% completion rate"]}),s&&h.jsxs("p",{className:"text-xs text-gray-500",children:["Last analyzed: ",new Date(s.analyzed_at).toLocaleString()]})]}),h.jsx(zt,{onClick:c,disabled:o,className:"bg-purple-600 hover:bg-purple-700",children:o?h.jsxs(h.Fragment,{children:[h.jsx(Yd,{className:"h-4 w-4 mr-2 animate-spin"}),"Analyzing..."]}):h.jsxs(h.Fragment,{children:[h.jsx(ly,{className:"h-4 w-4 mr-2"}),"Analyze Now"]})})]}),a&&h.jsx("div",{className:"p-3 bg-red-50 border border-red-200 rounded text-sm text-red-700",children:a})]})]}),s&&n?h.jsx(IH,{report:s,assignmentId:n.id,isPreview:!1}):!s&&m.length===0?h.jsx(Wt,{children:h.jsxs(nn,{className:"p-12 text-center",children:[h.jsx(ly,{className:"h-16 w-16 mx-auto mb-4 text-gray-300"}),h.jsx("h3",{className:"text-lg font-semibold text-gray-700 mb-2",children:"No Analytics Available Yet"}),h.jsx("p",{className:"text-gray-500 max-w-md mx-auto",children:"Analytics will appear here once students complete assignments and you run analysis. The system will automatically analyze when 90%, 95%, and 100% of students complete their work."})]})}):null]})},DH=({classId:r})=>h.jsxs("div",{className:"space-y-6",children:[h.jsxs("div",{className:"mb-6",children:[h.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Assignment Analysis"}),h.jsx("p",{className:"text-gray-600 mt-1",children:"AI-powered insights into student performance, question difficulty, and chat interactions."})]}),h.jsx(kH,{classId:r,autoAnalyzeAt:90})]});var YE="Radio",[LH,nk]=to(YE),[OH,jH]=LH(YE),rk=R.forwardRef((r,e)=>{const{__scopeRadio:t,name:n,checked:s=!1,required:i,disabled:o,value:a="on",onCheck:c,form:d,...f}=r,[m,v]=R.useState(null),x=Cn(e,w=>v(w)),_=R.useRef(!1),b=m?d||!!m.closest("form"):!0;return h.jsxs(OH,{scope:t,checked:s,disabled:o,children:[h.jsx($t.button,{type:"button",role:"radio","aria-checked":s,"data-state":ak(s),"data-disabled":o?"":void 0,disabled:o,value:a,...f,ref:x,onClick:mt(r.onClick,w=>{s||c==null||c(),b&&(_.current=w.isPropagationStopped(),_.current||w.stopPropagation())})}),b&&h.jsx(ok,{control:m,bubbles:!_.current,name:n,value:a,checked:s,required:i,disabled:o,form:d,style:{transform:"translateX(-100%)"}})]})});rk.displayName=YE;var sk="RadioIndicator",ik=R.forwardRef((r,e)=>{const{__scopeRadio:t,forceMount:n,...s}=r,i=jH(sk,t);return h.jsx(wo,{present:n||i.checked,children:h.jsx($t.span,{"data-state":ak(i.checked),"data-disabled":i.disabled?"":void 0,...s,ref:e})})});ik.displayName=sk;var FH="RadioBubbleInput",ok=R.forwardRef(({__scopeRadio:r,control:e,checked:t,bubbles:n=!0,...s},i)=>{const o=R.useRef(null),a=Cn(o,i),c=qE(t),d=dE(e);return R.useEffect(()=>{const f=o.current;if(!f)return;const m=window.HTMLInputElement.prototype,x=Object.getOwnPropertyDescriptor(m,"checked").set;if(c!==t&&x){const _=new Event("click",{bubbles:n});x.call(f,t),f.dispatchEvent(_)}},[c,t,n]),h.jsx($t.input,{type:"radio","aria-hidden":!0,defaultChecked:t,...s,tabIndex:-1,ref:a,style:{...s.style,...d,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})});ok.displayName=FH;function ak(r){return r?"checked":"unchecked"}var UH=["ArrowUp","ArrowDown","ArrowLeft","ArrowRight"],X_="RadioGroup",[BH,$ee]=to(X_,[um,nk]),lk=um(),ck=nk(),[zH,VH]=BH(X_),uk=R.forwardRef((r,e)=>{const{__scopeRadioGroup:t,name:n,defaultValue:s,value:i,required:o=!1,disabled:a=!1,orientation:c,dir:d,loop:f=!0,onValueChange:m,...v}=r,x=lk(t),_=z0(d),[b,w]=ql({prop:i,defaultProp:s??null,onChange:m,caller:X_});return h.jsx(zH,{scope:t,name:n,required:o,disabled:a,value:b,onValueChange:w,children:h.jsx(DE,{asChild:!0,...x,orientation:c,dir:_,loop:f,children:h.jsx($t.div,{role:"radiogroup","aria-required":o,"aria-orientation":c,"data-disabled":a?"":void 0,dir:_,...v,ref:e})})})});uk.displayName=X_;var dk="RadioGroupItem",hk=R.forwardRef((r,e)=>{const{__scopeRadioGroup:t,disabled:n,...s}=r,i=VH(dk,t),o=i.disabled||n,a=lk(t),c=ck(t),d=R.useRef(null),f=Cn(e,d),m=i.value===s.value,v=R.useRef(!1);return R.useEffect(()=>{const x=b=>{UH.includes(b.key)&&(v.current=!0)},_=()=>v.current=!1;return document.addEventListener("keydown",x),document.addEventListener("keyup",_),()=>{document.removeEventListener("keydown",x),document.removeEventListener("keyup",_)}},[]),h.jsx(LE,{asChild:!0,...a,focusable:!o,active:m,children:h.jsx(rk,{disabled:o,required:i.required,checked:m,...c,...s,name:i.name,ref:f,onCheck:()=>i.onValueChange(s.value),onKeyDown:mt(x=>{x.key==="Enter"&&x.preventDefault()}),onFocus:mt(s.onFocus,()=>{var x;v.current&&((x=d.current)==null||x.click())})})})});hk.displayName=dk;var HH="RadioGroupIndicator",fk=R.forwardRef((r,e)=>{const{__scopeRadioGroup:t,...n}=r,s=ck(t);return h.jsx(ik,{...s,...n,ref:e})});fk.displayName=HH;var pk=uk,mk=hk,GH=fk;const gk=R.forwardRef(({className:r,...e},t)=>h.jsx(pk,{className:Zt("grid gap-2",r),...e,ref:t}));gk.displayName=pk.displayName;const fy=R.forwardRef(({className:r,...e},t)=>h.jsx(mk,{ref:t,className:Zt("aspect-square h-4 w-4 rounded-full border border-primary text-primary ring-offset-background focus:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",r),...e,children:h.jsx(GH,{className:"flex items-center justify-center",children:h.jsx(tN,{className:"h-2.5 w-2.5 fill-current text-current"})})}));fy.displayName=mk.displayName;const WH=({scheduleSettings:r,onScheduleChange:e,disabled:t=!1})=>{const n=c=>{e({...r,timing:c,...c!=="scheduled"&&{scheduledDate:void 0,scheduledTime:void 0}})},s=c=>{const d=c?new Date(c):void 0;e({...r,scheduledDate:d})},i=c=>{e({...r,scheduledTime:c})},o=c=>c?c.toISOString().split("T")[0]:"",a=()=>new Date().toISOString().split("T")[0];return h.jsxs("div",{className:"space-y-4",children:[h.jsxs("div",{children:[h.jsx(zs,{className:"text-lg font-semibold text-gray-800 mb-3 block",children:"Assignment Schedule"}),h.jsx("p",{className:"text-sm text-gray-600 mb-4",children:"Choose when students should be able to access their assigned questions."})]}),h.jsxs(gk,{value:r.timing,onValueChange:n,disabled:t,className:"space-y-4",children:[h.jsxs("div",{className:"flex items-start space-x-3 p-4 border rounded-lg hover:bg-gray-50 transition-colors",children:[h.jsx(fy,{value:"immediately",id:"immediately",className:"mt-1"}),h.jsxs("div",{className:"flex-1",children:[h.jsxs(zs,{htmlFor:"immediately",className:"flex items-center space-x-2 cursor-pointer",children:[h.jsx(fu,{className:"w-4 h-4 text-blue-600"}),h.jsx("span",{className:"font-medium",children:"Immediately"})]}),h.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Students can access questions as soon as they're assigned (one by one)"})]})]}),h.jsxs("div",{className:"flex items-start space-x-3 p-4 border rounded-lg hover:bg-gray-50 transition-colors",children:[h.jsx(fy,{value:"together",id:"together",className:"mt-1"}),h.jsxs("div",{className:"flex-1",children:[h.jsxs(zs,{htmlFor:"together",className:"flex items-center space-x-2 cursor-pointer",children:[h.jsx(Qi,{className:"w-4 h-4 text-green-600"}),h.jsx("span",{className:"font-medium",children:"Together"}),h.jsx("span",{className:"text-xs bg-green-100 text-green-700 px-2 py-1 rounded-full",children:"Default"})]}),h.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"All students get access at the same time, after everyone has been assigned"})]})]}),h.jsxs("div",{className:"flex items-start space-x-3 p-4 border rounded-lg hover:bg-gray-50 transition-colors",children:[h.jsx(fy,{value:"scheduled",id:"scheduled",className:"mt-1"}),h.jsxs("div",{className:"flex-1",children:[h.jsxs(zs,{htmlFor:"scheduled",className:"flex items-center space-x-2 cursor-pointer",children:[h.jsx(T_,{className:"w-4 h-4 text-purple-600"}),h.jsx("span",{className:"font-medium",children:"Scheduled"})]}),h.jsx("p",{className:"text-sm text-gray-600 mt-1 mb-3",children:"Students get access at a specific date and time"}),r.timing==="scheduled"&&h.jsxs("div",{className:"flex items-center space-x-3 mt-3",children:[h.jsxs("div",{className:"flex-1",children:[h.jsx(zs,{htmlFor:"schedule-date",className:"text-sm font-medium text-gray-700 mb-1 block",children:"Date"}),h.jsx(Jl,{id:"schedule-date",type:"date",value:o(r.scheduledDate),onChange:c=>s(c.target.value),min:a(),disabled:t,className:"w-full"})]}),h.jsxs("div",{className:"flex-1",children:[h.jsx(zs,{htmlFor:"schedule-time",className:"text-sm font-medium text-gray-700 mb-1 block",children:"Time"}),h.jsx(Jl,{id:"schedule-time",type:"time",value:r.scheduledTime||"",onChange:c=>i(c.target.value),disabled:t,className:"w-full"})]})]})]})]})]}),!t&&h.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:[h.jsx("h4",{className:"font-medium text-blue-800 mb-2",children:"Assignment Schedule Summary"}),h.jsxs("p",{className:"text-sm text-blue-700",children:[r.timing==="immediately"&&"Students will be able to access their questions immediately after assignment.",r.timing==="together"&&"Students will get access once all students in the class have been assigned questions.",r.timing==="scheduled"&&(r.scheduledDate&&r.scheduledTime?`Students will get access on ${r.scheduledDate.toLocaleDateString()} at ${r.scheduledTime}.`:"Please select a date and time for the scheduled assignment.")]})]})]})};var Y_="Dialog",[vk,qee]=to(Y_),[$H,ua]=vk(Y_),xk=r=>{const{__scopeDialog:e,children:t,open:n,defaultOpen:s,onOpenChange:i,modal:o=!0}=r,a=R.useRef(null),c=R.useRef(null),[d,f]=ql({prop:n,defaultProp:s??!1,onChange:i,caller:Y_});return h.jsx($H,{scope:e,triggerRef:a,contentRef:c,contentId:Oa(),titleId:Oa(),descriptionId:Oa(),open:d,onOpenChange:f,onOpenToggle:R.useCallback(()=>f(m=>!m),[f]),modal:o,children:t})};xk.displayName=Y_;var yk="DialogTrigger",qH=R.forwardRef((r,e)=>{const{__scopeDialog:t,...n}=r,s=ua(yk,t),i=Cn(e,s.triggerRef);return h.jsx($t.button,{type:"button","aria-haspopup":"dialog","aria-expanded":s.open,"aria-controls":s.contentId,"data-state":JE(s.open),...n,ref:i,onClick:mt(r.onClick,s.onOpenToggle)})});qH.displayName=yk;var KE="DialogPortal",[XH,_k]=vk(KE,{forceMount:void 0}),wk=r=>{const{__scopeDialog:e,forceMount:t,children:n,container:s}=r,i=ua(KE,e);return h.jsx(XH,{scope:e,forceMount:t,children:R.Children.map(n,o=>h.jsx(wo,{present:t||i.open,children:h.jsx(D0,{asChild:!0,container:s,children:o})}))})};wk.displayName=KE;var Py="DialogOverlay",Sk=R.forwardRef((r,e)=>{const t=_k(Py,r.__scopeDialog),{forceMount:n=t.forceMount,...s}=r,i=ua(Py,r.__scopeDialog);return i.modal?h.jsx(wo,{present:n||i.open,children:h.jsx(KH,{...s,ref:e})}):null});Sk.displayName=Py;var YH=th("DialogOverlay.RemoveScroll"),KH=R.forwardRef((r,e)=>{const{__scopeDialog:t,...n}=r,s=ua(Py,t);return h.jsx(U_,{as:YH,allowPinchZoom:!0,shards:[s.contentRef],children:h.jsx($t.div,{"data-state":JE(s.open),...n,ref:e,style:{pointerEvents:"auto",...n.style}})})}),uh="DialogContent",bk=R.forwardRef((r,e)=>{const t=_k(uh,r.__scopeDialog),{forceMount:n=t.forceMount,...s}=r,i=ua(uh,r.__scopeDialog);return h.jsx(wo,{present:n||i.open,children:i.modal?h.jsx(QH,{...s,ref:e}):h.jsx(JH,{...s,ref:e})})});bk.displayName=uh;var QH=R.forwardRef((r,e)=>{const t=ua(uh,r.__scopeDialog),n=R.useRef(null),s=Cn(e,t.contentRef,n);return R.useEffect(()=>{const i=n.current;if(i)return UE(i)},[]),h.jsx(Ek,{...r,ref:s,trapFocus:t.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:mt(r.onCloseAutoFocus,i=>{var o;i.preventDefault(),(o=t.triggerRef.current)==null||o.focus()}),onPointerDownOutside:mt(r.onPointerDownOutside,i=>{const o=i.detail.originalEvent,a=o.button===0&&o.ctrlKey===!0;(o.button===2||a)&&i.preventDefault()}),onFocusOutside:mt(r.onFocusOutside,i=>i.preventDefault())})}),JH=R.forwardRef((r,e)=>{const t=ua(uh,r.__scopeDialog),n=R.useRef(!1),s=R.useRef(!1);return h.jsx(Ek,{...r,ref:e,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:i=>{var o,a;(o=r.onCloseAutoFocus)==null||o.call(r,i),i.defaultPrevented||(n.current||(a=t.triggerRef.current)==null||a.focus(),i.preventDefault()),n.current=!1,s.current=!1},onInteractOutside:i=>{var c,d;(c=r.onInteractOutside)==null||c.call(r,i),i.defaultPrevented||(n.current=!0,i.detail.originalEvent.type==="pointerdown"&&(s.current=!0));const o=i.target;((d=t.triggerRef.current)==null?void 0:d.contains(o))&&i.preventDefault(),i.detail.originalEvent.type==="focusin"&&s.current&&i.preventDefault()}})}),Ek=R.forwardRef((r,e)=>{const{__scopeDialog:t,trapFocus:n,onOpenAutoFocus:s,onCloseAutoFocus:i,...o}=r,a=ua(uh,t),c=R.useRef(null),d=Cn(e,c);return FE(),h.jsxs(h.Fragment,{children:[h.jsx(j_,{asChild:!0,loop:!0,trapped:n,onMountAutoFocus:s,onUnmountAutoFocus:i,children:h.jsx(Zp,{role:"dialog",id:a.contentId,"aria-describedby":a.descriptionId,"aria-labelledby":a.titleId,"data-state":JE(a.open),...o,ref:d,onDismiss:()=>a.onOpenChange(!1)})}),h.jsxs(h.Fragment,{children:[h.jsx(ZH,{titleId:a.titleId}),h.jsx(tG,{contentRef:c,descriptionId:a.descriptionId})]})]})}),QE="DialogTitle",Mk=R.forwardRef((r,e)=>{const{__scopeDialog:t,...n}=r,s=ua(QE,t);return h.jsx($t.h2,{id:s.titleId,...n,ref:e})});Mk.displayName=QE;var Tk="DialogDescription",Ck=R.forwardRef((r,e)=>{const{__scopeDialog:t,...n}=r,s=ua(Tk,t);return h.jsx($t.p,{id:s.descriptionId,...n,ref:e})});Ck.displayName=Tk;var Ak="DialogClose",Rk=R.forwardRef((r,e)=>{const{__scopeDialog:t,...n}=r,s=ua(Ak,t);return h.jsx($t.button,{type:"button",...n,ref:e,onClick:mt(r.onClick,()=>s.onOpenChange(!1))})});Rk.displayName=Ak;function JE(r){return r?"open":"closed"}var Nk="DialogTitleWarning",[Xee,Pk]=tO(Nk,{contentName:uh,titleName:QE,docsSlug:"dialog"}),ZH=({titleId:r})=>{const e=Pk(Nk),t=`\`${e.contentName}\` requires a \`${e.titleName}\` for the component to be accessible for screen reader users.

If you want to hide the \`${e.titleName}\`, you can wrap it with our VisuallyHidden component.

For more information, see https://radix-ui.com/primitives/docs/components/${e.docsSlug}`;return R.useEffect(()=>{r&&(document.getElementById(r)||console.error(t))},[t,r]),null},eG="DialogDescriptionWarning",tG=({contentRef:r,descriptionId:e})=>{const n=`Warning: Missing \`Description\` or \`aria-describedby={undefined}\` for {${Pk(eG).contentName}}.`;return R.useEffect(()=>{var i;const s=(i=r.current)==null?void 0:i.getAttribute("aria-describedby");e&&s&&(document.getElementById(e)||console.warn(n))},[n,r,e]),null},nG=xk,rG=wk,Ik=Sk,kk=bk,Dk=Mk,Lk=Ck,sG=Rk;const Ok=nG,iG=rG,jk=R.forwardRef(({className:r,...e},t)=>h.jsx(Ik,{ref:t,className:Zt("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",r),...e}));jk.displayName=Ik.displayName;const ZE=R.forwardRef(({className:r,children:e,...t},n)=>h.jsxs(iG,{children:[h.jsx(jk,{}),h.jsxs(kk,{ref:n,className:Zt("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",r),...t,children:[e,h.jsxs(sG,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[h.jsx(ih,{className:"h-4 w-4"}),h.jsx("span",{className:"sr-only",children:"Close"})]})]})]}));ZE.displayName=kk.displayName;const eM=({className:r,...e})=>h.jsx("div",{className:Zt("flex flex-col space-y-1.5 text-center sm:text-left",r),...e});eM.displayName="DialogHeader";const tM=({className:r,...e})=>h.jsx("div",{className:Zt("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",r),...e});tM.displayName="DialogFooter";const nM=R.forwardRef(({className:r,...e},t)=>h.jsx(Dk,{ref:t,className:Zt("text-lg font-semibold leading-none tracking-tight",r),...e}));nM.displayName=Dk.displayName;const rM=R.forwardRef(({className:r,...e},t)=>h.jsx(Lk,{ref:t,className:Zt("text-sm text-muted-foreground",r),...e}));rM.displayName=Lk.displayName;const oG=({hasGeneralContent:r,selectedLesson:e,onNavigateToGeneralPool:t})=>{const[n,s]=R.useState(!1),i=r,o=()=>{i&&e?s(!0):t()},a=()=>{s(!1),t()},d=e?r?{status:"exists",message:"General pool exists for this lesson",canGenerate:!0}:{status:"needed",message:"No general pool exists for this lesson",canGenerate:!0}:{status:"no-lesson",message:"Select a lesson to manage general pool questions",canGenerate:!1};return h.jsxs(h.Fragment,{children:[h.jsx(Wt,{children:h.jsxs(nn,{className:"p-6",children:[h.jsxs("div",{className:"flex items-center justify-between",children:[h.jsxs("div",{className:"flex-1",children:[h.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-2",children:"General Pool Questions"}),h.jsxs("div",{className:"flex items-center space-x-2 mb-3",children:[d.status==="exists"?h.jsx(Ar,{className:"w-4 h-4 text-green-600"}):d.status==="no-content"||d.status==="no-lesson"?h.jsx(Hs,{className:"w-4 h-4 text-amber-600"}):h.jsx(Hs,{className:"w-4 h-4 text-red-600"}),h.jsx("span",{className:`text-sm ${d.status==="exists"?"text-green-700":d.status==="no-content"||d.status==="no-lesson"?"text-amber-700":"text-red-700"}`,children:d.message})]}),h.jsx("p",{className:"text-sm text-gray-600",children:d.status==="exists"?"You can regenerate the pool if needed, or proceed with student assignments.":d.status==="needed"?"Create a general pool of 15 questions that will be used for all student assignments.":"Complete the prerequisites above to generate general pool questions."})]}),h.jsx("div",{className:"ml-6",children:h.jsxs(zt,{onClick:o,disabled:!d.canGenerate,className:d.status==="exists"?"bg-amber-600 hover:bg-amber-700":"",children:[d.status==="exists"?h.jsx(h.Fragment,{children:"Regenerate Pool"}):h.jsx(h.Fragment,{children:"Generate Pool"}),h.jsx(YO,{className:"w-4 h-4 ml-2"})]})})]}),d.status==="exists"&&h.jsx("div",{className:"mt-4 bg-green-50 border border-green-200 rounded-lg p-3",children:h.jsxs("div",{className:"flex items-start space-x-2",children:[h.jsx(Ar,{className:"w-4 h-4 text-green-600 mt-0.5 flex-shrink-0"}),h.jsxs("div",{className:"text-sm",children:[h.jsx("p",{className:"text-green-800 font-medium",children:"Pool Ready"}),h.jsx("p",{className:"text-green-700 mt-1",children:"This lesson has 15 general questions ready. 2 random questions from this pool will be automatically added to each student's personalized assignment."})]})]})}),d.status==="needed"&&h.jsx("div",{className:"mt-4 bg-blue-50 border border-blue-200 rounded-lg p-3",children:h.jsx("div",{className:"flex items-start space-x-2",children:h.jsxs("div",{className:"text-sm",children:[h.jsx("p",{className:"text-blue-800 font-medium",children:"Pool Needed"}),h.jsx("p",{className:"text-blue-700 mt-1",children:"Generate 15 general questions from the lesson content. These will be used across all student assignments for consistency."})]})})})]})}),h.jsx(Ok,{open:n,onOpenChange:s,children:h.jsxs(ZE,{children:[h.jsxs(eM,{children:[h.jsx(nM,{children:"Regenerate General Pool?"}),h.jsx(rM,{children:"This lesson already has a general pool with 15 questions. Regenerating will replace all existing pool questions with new ones."})]}),h.jsx("div",{className:"bg-amber-50 border border-amber-200 rounded-lg p-4",children:h.jsxs("div",{className:"flex items-start space-x-2",children:[h.jsx(Hs,{className:"w-4 h-4 text-amber-600 mt-0.5 flex-shrink-0"}),h.jsxs("div",{className:"text-sm",children:[h.jsx("p",{className:"text-amber-800 font-medium",children:"Impact on Existing Assignments"}),h.jsx("p",{className:"text-amber-700 mt-1",children:"Students who already have assigned questions will keep their current assignments. Only new assignments will use the regenerated pool."})]})]})}),h.jsxs(tM,{children:[h.jsx(zt,{variant:"outline",onClick:()=>s(!1),children:"Cancel"}),h.jsx(zt,{onClick:a,className:"bg-amber-600 hover:bg-amber-700",children:"Regenerate Pool"})]})]})})]})},sM=({student:r,classId:e,selectedLesson:t,focusGoals:n,generalNotes:s})=>{const[i,o]=R.useState([]),[a,c]=R.useState(!1),[d,f]=R.useState(null),[m,v]=R.useState(null),x=j=>j.map((D,L)=>{var O,I,B,W,K,ee,oe,ne,ce,V,q,Z,X,ie,be;return{id:D.id||`adaptive_${r.id}_${L}_${Date.now()}`,text:D.text||D.question||"",choices:[{id:"a",text:((I=(O=D.choices)==null?void 0:O[0])==null?void 0:I.text)||((B=D.options)==null?void 0:B[0])||""},{id:"b",text:((K=(W=D.choices)==null?void 0:W[1])==null?void 0:K.text)||((ee=D.options)==null?void 0:ee[1])||""},{id:"c",text:((ne=(oe=D.choices)==null?void 0:oe[2])==null?void 0:ne.text)||((ce=D.options)==null?void 0:ce[2])||""},{id:"d",text:((q=(V=D.choices)==null?void 0:V[3])==null?void 0:q.text)||((Z=D.options)==null?void 0:Z[3])||""},{id:"e",text:((ie=(X=D.choices)==null?void 0:X[4])==null?void 0:ie.text)||((be=D.options)==null?void 0:be[4])||""}],correctAnswer:D.correctAnswer||"a",explanation:D.explanation,status:"pending",type:D.source==="general"?"general":"adaptive",source:D.source==="general"?"General Pool":`Adaptive for ${r.name}`}});R.useEffect(()=>{o([]),v(null),f(null)},[t]);const _=async j=>{if(!m)throw new Error("No assignment ID available");try{const D=await fetch(`http://localhost:3001/api/student-question-sets/${m}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({questions:j.map(L=>({text:L.text,choices:L.choices,correctAnswer:L.correctAnswer,explanation:L.explanation,status:L.status,type:L.type}))})});if(!D.ok)throw new Error("Failed to save questions");return await D.json()}catch(D){throw console.error("Error saving questions:",D),D}},b=async(j,D)=>{try{const L=await fetch(`http://localhost:3001/api/classes/${e}/assignments/${j}/${D}`,{method:"GET",headers:{"Content-Type":"application/json"}});if(!L.ok){if(L.status===404)throw new Error("Assignment not found");const B=await L.json();throw new Error(B.error||"Failed to load assignment")}const O=await L.json(),I=x(O.questions);return o(I),v(O.assignment.id),{assignment:O.assignment,questions:I,lessonTitle:O.lessonTitle}}catch(L){throw console.error("Error loading assignment:",L),L}},w=async j=>{try{const D=await fetch(`http://localhost:3001/api/classes/${e}/assignments?lessonId=${j}`,{method:"GET",headers:{"Content-Type":"application/json"}});if(!D.ok){const O=await D.json();throw new Error(O.error||"Failed to get class assignments")}return(await D.json()).assignments}catch(D){throw console.error("Error getting class assignments:",D),D}},S=async()=>{var j;if(t){c(!0),f(null),o([]),v(null);try{const D=`
      Lesson Focus Goals: ${n||""}
      
      General Student Notes: ${s||""}
      `.trim();console.log("Debug generate questions:"),console.log("selectedLesson:",t),console.log("focusGoals:",n),console.log("generalNotes:",s),console.log("combinedStudentFocus:",D);const L=await fetch("http://localhost:3001/api/question-sets/generate-adaptive",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({studentId:parseInt(r.id),studentName:r.name,teacherId:"current-teacher-id",classId:e,lessonId:t,studentFocus:n||""})});if(!L.ok){const I=await L.json();throw new Error(I.error||"Failed to generate adaptive questions")}const O=await L.json();if((j=O.questionSet)!=null&&j.questions&&Array.isArray(O.questionSet.questions)){const I=x(O.questionSet.questions);o(I),v(O.questionSet.id),console.log(" Questions generated successfully"),console.log("Context used:",O.contextUsed),console.log("Snapshot created:",O.snapshotCreated)}else throw new Error("Invalid response format - no questions array found")}catch(D){console.error("Error generating adaptive questions:",D),f(D instanceof Error?D.message:"Failed to generate questions")}finally{c(!1)}}},C=async j=>{if(!m){console.error("No current assignment ID to regenerate question");return}try{const D=i.findIndex(B=>B.id===j);if(D===-1)throw new Error("Question not found");const L=await fetch(`http://localhost:3001/api/student-question-sets/${m}/regenerate-question`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({questionIndex:D})});if(!L.ok){const B=await L.json();throw new Error(B.error||"Failed to regenerate question")}const O=await L.json(),I=x(O.allQuestions);o(I)}catch(D){console.error("Error regenerating question:",D),o(L=>L.map(O=>O.id===j?{...O,text:"[Regeneration failed - please edit manually]",status:"pending"}:O))}},T=async()=>{await S()},A=async j=>{try{if(m){if(!(await fetch(`http://localhost:3001/api/student-question-sets/${m}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({questions:j.map(O=>({id:O.id,text:O.text,choices:O.choices,correctAnswer:O.correctAnswer,explanation:O.explanation,type:O.type,source:O.source}))})})).ok)throw new Error("Failed to update assignment");if(!(await fetch(`http://localhost:3001/api/question-sets/${m}/assign`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({isAssigned:!0,questions:j})})).ok)throw new Error("Failed to assign questions")}else throw new Error("No current assignment to assign");return!0}catch(D){throw console.error("Failed to assign questions:",D),D}},k=async(j,D,L)=>{try{if(m)await A(L);else throw new Error("No assignment to save - generate questions first")}catch(O){throw console.error("Error saving assignment:",O),O}};return{generatedQuestions:i,setGeneratedQuestions:o,isGenerating:a,generationError:d,hasQuestions:i.length>0,currentAssignmentId:m,generateQuestions:S,regenerateAll:T,regenerateQuestion:C,assignQuestions:A,saveQuestionsOnly:_,loadExistingAssignment:b,getClassAssignments:w,saveAssignment:k}},hC=({student:r,classId:e,selectedLesson:t,focusGoals:n,generalNotes:s,scheduleSettings:i={timing:"immediately"},onAssignmentComplete:o,viewMode:a=!1,existingAssignment:c})=>{console.log("StudentQuestionGenerator received props:",{student:r,classId:e,selectedLesson:t,focusGoals:n,generalNotes:s,focusGoalsType:typeof n,generalNotesType:typeof s});const{generatedQuestions:d,setGeneratedQuestions:f,isGenerating:m,generationError:v,generateQuestions:x,regenerateAll:_,hasQuestions:b,loadExistingAssignment:w,currentAssignmentId:S}=sM({student:r,classId:e,selectedLesson:t,focusGoals:n||"",generalNotes:s||""}),[C,T]=R.useState(!1),[A,k]=R.useState(!1),[j,D]=R.useState(!0);R.useEffect(()=>{a&&c&&L()},[a,c]);const L=async()=>{if(!(!c||!t))try{const B=await w(r.id,t);console.log("Loaded existing questions for view mode:",B.questions.length)}catch(B){console.error("Error loading existing questions in view mode:",B)}},O=async()=>{try{if(k(!0),S&&b){if(!(await fetch(`http://localhost:3001/api/student-question-sets/${S}/questions`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({questions:d})})).ok)throw new Error("Failed to save questions");console.log("Questions saved successfully")}T(!0),D(!1),setTimeout(()=>{o()},500)}catch(B){console.error("Assignment failed:",B)}finally{k(!1)}},I=()=>{D(!0)};return b?h.jsxs("div",{className:"px-6 pb-6 bg-gray-50 space-y-6",children:[j&&h.jsx(G_,{title:`Generated Questions for ${r.name}`,questions:d,onQuestionsUpdate:B=>{console.log(" onQuestionsUpdate CALLED with questions:",B==null?void 0:B.length),f(B)},onSaveChanges:async B=>{if(console.log(" onSaveChanges CALLED with questions:",B==null?void 0:B.length),S)try{if(!(await fetch(`http://localhost:3001/api/student-question-sets/${S}/questions`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({questions:B})})).ok)throw new Error("Failed to save question approvals");console.log("Question approvals saved")}catch(W){console.error("Error saving question approvals:",W)}},onRegenerateAll:_,isLoading:m}),h.jsx(Wt,{children:h.jsx(nn,{className:"p-6",children:C&&!j?h.jsxs("div",{className:"text-center space-y-4",children:[h.jsxs("div",{className:"space-y-2",children:[h.jsx(Ar,{className:"w-12 h-12 mx-auto text-green-600"}),h.jsx("h3",{className:"text-lg font-medium text-green-800",children:"Assignment Complete!"}),h.jsxs("p",{className:"text-green-700",children:["10 questions assigned to ",r.name]}),h.jsx("p",{className:"text-sm text-green-600",children:i.timing==="immediately"?"Student can access questions immediately.":i.timing==="together"?"Student will get access once all students are assigned.":"Student will get access at the scheduled time."})]}),h.jsx(zt,{onClick:I,variant:"outline",children:"Review Questions"})]}):h.jsxs("div",{className:"text-center space-y-4",children:[h.jsxs("div",{children:[h.jsxs("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:["Ready to Assign to ",r.name]}),h.jsx("p",{className:"text-gray-600",children:"10 questions ready (8 adaptive + 2 general)"}),C&&h.jsx("p",{className:"text-sm text-green-600 mt-1",children:" Questions are assigned - you can continue editing"})]}),h.jsx(zt,{onClick:O,disabled:A,size:"lg",className:"px-8",children:A?h.jsxs(h.Fragment,{children:[h.jsx(Xl,{className:"w-4 h-4 mr-2 animate-spin"}),"Assigning..."]}):C?h.jsxs(h.Fragment,{children:[h.jsx(Ar,{className:"w-4 h-4 mr-2"}),"Update Assignment"]}):h.jsxs(h.Fragment,{children:[h.jsx(Ar,{className:"w-4 h-4 mr-2"}),"Complete Assignment"]})})]})})})]}):h.jsx("div",{className:"px-6 pb-6 bg-gray-50",children:h.jsxs("div",{className:"max-w-2xl",children:[h.jsxs("div",{className:"mb-6 p-4 bg-blue-50 border border-blue-200 rounded-lg",children:[h.jsxs("h4",{className:"font-medium text-blue-800 mb-2",children:["Generating Questions for ",r.name]}),h.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[h.jsxs("div",{children:[h.jsx("span",{className:"font-medium text-blue-700",children:"Focus Goals:"}),h.jsx("p",{className:"text-blue-600 mt-1",children:(n==null?void 0:n.trim())||"No specific focus goals set"})]}),h.jsxs("div",{children:[h.jsx("span",{className:"font-medium text-blue-700",children:"General Notes:"}),h.jsx("p",{className:"text-blue-600 mt-1",children:(s==null?void 0:s.trim())||"No additional notes"})]})]})]}),h.jsxs("div",{className:"text-center space-y-4",children:[m?h.jsxs("div",{className:"space-y-4",children:[h.jsxs("div",{className:"flex items-center justify-center space-x-3",children:[h.jsx(Xl,{className:"w-6 h-6 animate-spin text-blue-600"}),h.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Generating 10 Questions..."})]}),h.jsxs("div",{className:"space-y-2",children:[h.jsx("p",{className:"text-gray-600",children:"Creating 8 personalized questions using lesson content and student notes"}),h.jsx("p",{className:"text-sm text-gray-500",children:"Plus adding 2 questions from the general pool"})]})]}):h.jsx(zt,{onClick:x,disabled:!t,size:"lg",children:"Generate Adaptive Questions"}),!t&&!m&&h.jsx("p",{className:"text-sm text-gray-500 mt-2",children:"Please select a lesson first"})]}),v&&h.jsx("div",{className:"mt-6 p-4 bg-red-50 border border-red-200 rounded-lg",children:h.jsxs("div",{className:"flex items-start space-x-2",children:[h.jsx(Hs,{className:"w-5 h-5 text-red-600 mt-0.5 flex-shrink-0"}),h.jsxs("div",{children:[h.jsx("p",{className:"text-sm text-red-800 font-medium",children:"Failed to generate questions"}),h.jsx("p",{className:"text-sm text-red-600 mt-1",children:v}),h.jsx(zt,{variant:"outline",size:"sm",onClick:x,className:"mt-2",children:"Try Again"})]})]})})]})})},aG=({student:r,classId:e,hasGeneralContent:t,isActive:n,isProcessed:s,isInProgress:i,onClick:o,canStartAssignment:a,selectedLesson:c,assignment:d,onAssignmentComplete:f})=>{const[m,v]=R.useState(""),[x,_]=R.useState(""),[b,w]=R.useState(!1),S=m.trim()||x.trim();R.useEffect(()=>{(async()=>{try{const L=await fetch(`http://localhost:3001/api/students/${r.id}/general-notes?classId=${e}`);if(L.ok){const O=await L.json();_(O.generalNotes||"")}}catch(L){console.error("Error loading notes:",L)}if(c)try{const L=await fetch(`http://localhost:3001/api/students/${r.id}/lessons/${c}/focus-goals?classId=${e}`);if(L.ok){const O=await L.json();v(O.focusGoals||"")}}catch(L){console.error("Error loading lesson focus goals:",L),v("")}else{const L=localStorage.getItem(`focus-goals-${e}-${r.id}`)||"";v(L)}})()},[r.id,e,c]);const C=()=>{w(!0),o()},T=()=>{w(!1),f==null||f()},A=()=>s?h.jsx(Ar,{className:"w-5 h-5 text-green-600"}):i?h.jsx(fu,{className:"w-5 h-5 text-amber-600 animate-pulse"}):h.jsx(rh,{className:"w-5 h-5 text-blue-600"}),k=()=>s?"Assigned":i?"In Progress":"Generate",j=()=>s?"text-green-700 bg-green-50 border-green-200":i?"text-amber-700 bg-amber-50 border-amber-200":"text-blue-700 bg-blue-50 border-blue-200";return h.jsxs("div",{className:`p-6 border-b border-gray-200 last:border-b-0 transition-colors ${n?"bg-blue-50":"hover:bg-gray-50"}`,children:[h.jsxs("div",{className:"flex items-center justify-between",children:[h.jsxs("div",{className:"flex-1",children:[h.jsxs("div",{className:"flex items-center space-x-3 mb-2",children:[h.jsx("h3",{className:"text-lg font-bold text-gray-900",children:r.name}),h.jsx("div",{className:`px-3 py-1 rounded-full text-xs font-medium border ${j()}`,children:h.jsxs("div",{className:"flex items-center space-x-1",children:[A(),h.jsx("span",{children:k()})]})})]}),h.jsx("p",{className:"text-gray-600 text-sm mb-2",children:r.email}),h.jsxs("div",{className:"flex items-center space-x-3",children:[t&&h.jsxs("span",{className:"text-xs text-green-600 bg-green-50 px-2 py-1 rounded-full flex items-center",children:[h.jsx("span",{className:"w-1.5 h-1.5 bg-green-500 rounded-full mr-1.5"}),"General lesson synced"]}),S&&h.jsx("span",{className:"text-xs text-blue-600 bg-blue-50 px-2 py-1 rounded-full flex items-center",children:"Has personalized notes"})]})]}),h.jsx("div",{className:"ml-6 flex items-center space-x-3",children:s?h.jsxs(zt,{variant:"outline",size:"sm",onClick:o,className:"border-green-200 text-green-700 hover:bg-green-50",children:[h.jsx(Ar,{className:"w-4 h-4 mr-2"}),"View Assignment",n?h.jsx(nh,{className:"w-4 h-4 ml-2"}):h.jsx(n0,{className:"w-4 h-4 ml-2"})]}):h.jsxs(zt,{onClick:b?o:C,disabled:!a,size:"sm",className:i?"bg-amber-600 hover:bg-amber-700":"",children:[b?h.jsxs(h.Fragment,{children:[h.jsx(Ar,{className:"w-4 h-4 mr-2"}),"Review Questions"]}):i?h.jsxs(h.Fragment,{children:[h.jsx(fu,{className:"w-4 h-4 mr-2"}),"Continue Assignment"]}):h.jsx(h.Fragment,{children:"Generate Questions"}),n?h.jsx(nh,{className:"w-4 h-4 ml-2"}):h.jsx(n0,{className:"w-4 h-4 ml-2"})]})})]}),n&&!s&&(S||!S&&!i)&&h.jsx("div",{className:"mt-4 pt-4 border-t border-gray-200",children:h.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[h.jsxs("div",{children:[h.jsx("h4",{className:"font-medium text-gray-700 mb-1",children:"Focus Goals"}),h.jsx("p",{className:"text-gray-600 line-clamp-2",children:m.trim()||"No specific focus goals set"})]}),h.jsxs("div",{children:[h.jsx("h4",{className:"font-medium text-gray-700 mb-1",children:"General Notes"}),h.jsx("p",{className:"text-gray-600 line-clamp-2",children:x.trim()||"No additional notes"})]})]})}),n&&s&&d&&h.jsx(hC,{student:r,classId:e,selectedLesson:c,focusGoals:m||localStorage.getItem(`focus-goals-${e}-${r.id}`)||"",generalNotes:x||localStorage.getItem(`general-notes-${e}-${r.id}`)||"",onAssignmentComplete:f,viewMode:!0,existingAssignment:d}),n&&b&&!s&&h.jsx(hC,{student:r,classId:e,selectedLesson:c,focusGoals:m||localStorage.getItem(`focus-goals-${e}-${r.id}`)||"",generalNotes:x||localStorage.getItem(`general-notes-${e}-${r.id}`)||"",onAssignmentComplete:T,viewMode:!0,existingAssignment:d})]})},lG=({classId:r,students:e,selectedLesson:t,hasGeneralContent:n,canStartAssignments:s,processedStudents:i,assignmentsInProgress:o,onAssignmentStart:a,onAssignmentComplete:c,onExistingAssignmentsUpdate:d,scheduleSettings:f})=>{const[m,v]=R.useState(null),x=sM({student:{id:"",name:"",email:""},classId:r,selectedLesson:t,focusGoals:"",generalNotes:""}),[_,b]=R.useState({}),[w,S]=R.useState(!1);R.useEffect(()=>{t&&s?C():b({})},[t,s]);const C=async()=>{if(t)try{S(!0);const L=await x.getClassAssignments(t),O={};L.forEach(I=>{O[String(I.studentId)]=I}),b(O),d(O)}catch(L){console.error("Error loading existing assignments:",L),b({}),d({})}finally{S(!1)}},T=()=>e.filter(L=>{const O=localStorage.getItem(`focus-goals-${r}-${L.id}`)||"",I=localStorage.getItem(`general-notes-${r}-${L.id}`)||"";return O.trim()||I.trim()}).length,A=async L=>{if(!s)return;if(!!_[L]){if(e.find(B=>B.id===L))try{await x.loadExistingAssignment(L,t),v(L)}catch(B){console.error("Error loading assignment:",B)}return}if(i.has(L)){v(m===L?null:L);return}if(o.has(L)){v(L);return}v(L),a(L)},k=L=>{c(L);const O=e.findIndex(B=>B.id===L),I=e.slice(O+1).find(B=>!i.has(B.id)&&!o.has(B.id));I?(v(I.id),a(I.id)):v(null)},D=(()=>{const L=e.length,O=e.filter(B=>i.has(B.id)||!!_[B.id]).length,I=o.size;return{total:L,completed:O,inProgress:I}})();return s?h.jsxs("div",{className:"space-y-4",children:[D.total>0&&h.jsx(Wt,{children:h.jsxs(nn,{className:"p-4",children:[h.jsxs("div",{className:"flex items-center justify-between",children:[h.jsxs("div",{children:[h.jsx("h3",{className:"font-medium text-gray-900",children:"Assignment Progress"}),h.jsxs("p",{className:"text-sm text-gray-600",children:[D.completed," of ",D.total," students assigned",D.inProgress>0&&` (${D.inProgress} in progress)`]})]}),h.jsxs("div",{className:"flex items-center space-x-4",children:[h.jsxs("div",{className:"flex items-center space-x-2",children:[h.jsx(Ar,{className:"w-4 h-4 text-green-600"}),h.jsxs("span",{className:"text-sm text-green-700",children:[D.completed," Complete"]})]}),D.inProgress>0&&h.jsxs("div",{className:"flex items-center space-x-2",children:[h.jsx(fu,{className:"w-4 h-4 text-amber-600"}),h.jsxs("span",{className:"text-sm text-amber-700",children:[D.inProgress," In Progress"]})]})]})]}),h.jsx("div",{className:"mt-3",children:h.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:h.jsx("div",{className:"bg-green-600 h-2 rounded-full transition-all duration-500",style:{width:`${D.completed/D.total*100}%`}})})})]})}),h.jsxs(Wt,{children:[h.jsx(mI,{totalStudents:e.length,studentsWithNotes:T(),hasGeneralContent:n}),h.jsx(nn,{className:"p-0",children:h.jsx("div",{className:"divide-y divide-gray-200",children:w?h.jsx("div",{className:"p-8 text-center",children:h.jsxs("div",{className:"flex items-center justify-center space-x-3",children:[h.jsx("div",{className:"w-5 h-5 border-2 border-blue-600 border-t-transparent rounded-full animate-spin"}),h.jsx("span",{className:"text-gray-600",children:"Loading assignments..."})]})}):e.length===0?h.jsxs("div",{className:"p-8 text-center text-gray-500",children:[h.jsx(Qi,{className:"w-12 h-12 mx-auto mb-4 text-gray-300"}),h.jsx("p",{children:"No students found in this class."})]}):e.map(L=>h.jsx("div",{children:h.jsx(aG,{student:L,classId:r,hasGeneralContent:n,isActive:m===L.id,isProcessed:i.has(L.id)||!!_[L.id],isInProgress:o.has(L.id),onClick:()=>A(L.id),canStartAssignment:s,selectedLesson:t,assignment:_[L.id],onAssignmentComplete:()=>k(L.id)})},L.id))})})]}),D.completed===D.total&&D.total>0&&h.jsx(Wt,{className:"border-green-200 bg-green-50",children:h.jsxs(nn,{className:"p-6 text-center",children:[h.jsx(Ar,{className:"w-12 h-12 mx-auto mb-4 text-green-600"}),h.jsx("h3",{className:"text-lg font-medium text-green-800 mb-2",children:"All Students Assigned!"}),h.jsx("p",{className:"text-green-700",children:f.timing==="immediately"?"Students can now access their questions.":f.timing==="together"?"Students will get access to their questions now that everyone is assigned.":"Students will get access to their questions at the scheduled time."})]})})]}):h.jsx(Wt,{children:h.jsx(nn,{className:"p-6",children:h.jsxs("div",{className:"text-center py-8",children:[h.jsx(Hs,{className:"w-12 h-12 mx-auto mb-4 text-amber-500"}),h.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Prerequisites Required"}),h.jsx("p",{className:"text-gray-600 mb-4",children:"Complete the following before starting student assignments:"}),h.jsxs("div",{className:"space-y-2 text-sm text-gray-600",children:[!t&&h.jsxs("div",{className:"flex items-center justify-center space-x-2",children:[h.jsx("span",{className:"w-2 h-2 bg-red-500 rounded-full"}),h.jsx("span",{children:"Select a lesson"})]}),!n&&h.jsxs("div",{className:"flex items-center justify-center space-x-2",children:[h.jsx("span",{className:"w-2 h-2 bg-red-500 rounded-full"}),h.jsx("span",{children:"Generate general pool questions"})]})]})]})})})};var K_="Switch",[cG,Yee]=to(K_),[uG,dG]=cG(K_),Fk=R.forwardRef((r,e)=>{const{__scopeSwitch:t,name:n,checked:s,defaultChecked:i,required:o,disabled:a,value:c="on",onCheckedChange:d,form:f,...m}=r,[v,x]=R.useState(null),_=Cn(e,T=>x(T)),b=R.useRef(!1),w=v?f||!!v.closest("form"):!0,[S,C]=ql({prop:s,defaultProp:i??!1,onChange:d,caller:K_});return h.jsxs(uG,{scope:t,checked:S,disabled:a,children:[h.jsx($t.button,{type:"button",role:"switch","aria-checked":S,"aria-required":o,"data-state":Vk(S),"data-disabled":a?"":void 0,disabled:a,value:c,...m,ref:_,onClick:mt(r.onClick,T=>{C(A=>!A),w&&(b.current=T.isPropagationStopped(),b.current||T.stopPropagation())})}),w&&h.jsx(zk,{control:v,bubbles:!b.current,name:n,value:c,checked:S,required:o,disabled:a,form:f,style:{transform:"translateX(-100%)"}})]})});Fk.displayName=K_;var Uk="SwitchThumb",Bk=R.forwardRef((r,e)=>{const{__scopeSwitch:t,...n}=r,s=dG(Uk,t);return h.jsx($t.span,{"data-state":Vk(s.checked),"data-disabled":s.disabled?"":void 0,...n,ref:e})});Bk.displayName=Uk;var hG="SwitchBubbleInput",zk=R.forwardRef(({__scopeSwitch:r,control:e,checked:t,bubbles:n=!0,...s},i)=>{const o=R.useRef(null),a=Cn(o,i),c=qE(t),d=dE(e);return R.useEffect(()=>{const f=o.current;if(!f)return;const m=window.HTMLInputElement.prototype,x=Object.getOwnPropertyDescriptor(m,"checked").set;if(c!==t&&x){const _=new Event("click",{bubbles:n});x.call(f,t),f.dispatchEvent(_)}},[c,t,n]),h.jsx("input",{type:"checkbox","aria-hidden":!0,defaultChecked:t,...s,tabIndex:-1,ref:a,style:{...s.style,...d,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})});zk.displayName=hG;function Vk(r){return r?"checked":"unchecked"}var Hk=Fk,fG=Bk;const Gk=R.forwardRef(({className:r,...e},t)=>h.jsx(Hk,{className:Zt("peer inline-flex h-6 w-11 shrink-0 cursor-pointer items-center rounded-full border-2 border-transparent transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:ring-offset-background disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=unchecked]:bg-input",r),...e,ref:t,children:h.jsx(fG,{className:Zt("pointer-events-none block h-5 w-5 rounded-full bg-background shadow-lg ring-0 transition-transform data-[state=checked]:translate-x-5 data-[state=unchecked]:translate-x-0")})}));Gk.displayName=Hk.displayName;const pG=({classId:r,selectedLesson:e,scheduleSettings:t,totalStudents:n,completedStudents:s,allStudentsProcessed:i,onScheduleChange:o})=>{const[a,c]=R.useState(!1),[d,f]=R.useState(""),[m,v]=R.useState(""),[x,_]=R.useState(!1),[b,w]=R.useState(!1);R.useEffect(()=>{e&&i?S():c(!1)},[e,i]);const S=async()=>{if(e)try{const D=await fetch(`/api/classes/${r}/lessons/${e}/status`);if(D.ok){const{isActive:L}=await D.json();c(L)}}catch(D){console.error("Error checking lesson status:",D)}},C=async D=>{D?await T():_(!0)},T=async()=>{if(e){w(!0);try{(await fetch(`/api/classes/${r}/lessons/${e}/activate`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({availableDate:d||new Date().toISOString().split("T")[0],expirationDate:m||null,scheduleSettings:t})})).ok?c(!0):console.error("Failed to activate lesson")}catch(D){console.error("Error activating lesson:",D)}finally{w(!1)}}},A=async()=>{if(e){w(!0);try{(await fetch(`/api/classes/${r}/lessons/${e}/deactivate`,{method:"POST",headers:{"Content-Type":"application/json"}})).ok?(c(!1),_(!1)):console.error("Failed to deactivate lesson")}catch(D){console.error("Error deactivating lesson:",D)}finally{w(!1)}}},j=e?i?{status:"ready",message:"All students have question sets - ready to manage lesson availability",canManage:!0}:{status:"assignments-pending",message:`${s} of ${n} students have question sets ready`,canManage:!1}:{status:"no-lesson",message:"Select a lesson to manage availability",canManage:!1};return j.canManage?h.jsxs(h.Fragment,{children:[h.jsxs(Wt,{children:[h.jsx(or,{children:h.jsxs(ws,{className:"flex items-center",children:[h.jsx(r0,{className:"w-5 h-5 mr-2"}),"Lesson Availability Management"]})}),h.jsxs(nn,{className:"space-y-6",children:[h.jsxs("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4",children:[h.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[h.jsx(Qi,{className:"w-4 h-4 text-green-600"}),h.jsx("span",{className:"font-medium text-green-800",children:"All Students Ready"})]}),h.jsxs("p",{className:"text-sm text-green-700",children:[n," students have question sets prepared for this lesson."]})]}),h.jsx("div",{className:"border border-gray-200 rounded-lg p-4",children:h.jsxs("div",{className:"flex items-center justify-between",children:[h.jsxs("div",{children:[h.jsx(zs,{className:"text-sm font-medium text-gray-700",children:"Student Access"}),h.jsx("p",{className:"text-xs text-gray-600 mt-1",children:a?"Students can access their question sets now":"Questions are prepared but students cannot access them yet"})]}),h.jsxs("div",{className:"flex items-center space-x-3",children:[h.jsx(Gk,{checked:a,onCheckedChange:C,disabled:b}),h.jsx("div",{className:"flex items-center space-x-2",children:a?h.jsxs(h.Fragment,{children:[h.jsx(h5,{className:"w-5 h-5 text-green-600"}),h.jsx("span",{className:"text-sm font-medium text-green-700",children:"Active"})]}):h.jsxs(h.Fragment,{children:[h.jsx(d5,{className:"w-5 h-5 text-gray-400"}),h.jsx("span",{className:"text-sm text-gray-600",children:"Inactive"})]})})]})]})}),h.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:[h.jsxs("h4",{className:"font-medium text-blue-800 mb-2 flex items-center",children:[h.jsx(fu,{className:"w-4 h-4 mr-2"}),"Assignment Timing"]}),h.jsxs("p",{className:"text-sm text-blue-700",children:[t.timing==="immediately"&&"Questions become available immediately when lesson is activated.",t.timing==="together"&&"All students get access at the same time when lesson is activated.",t.timing==="scheduled"&&(t.scheduledDate&&t.scheduledTime?`Students get access on ${t.scheduledDate.toLocaleDateString()} at ${t.scheduledTime}.`:"Students get access at the scheduled time.")]})]}),!a&&h.jsx("div",{className:"flex justify-end",children:h.jsx(zt,{onClick:()=>C(!0),disabled:b,className:"bg-green-600 hover:bg-green-700",children:b?"Activating...":"Make Available to Students"})})]})]}),h.jsx(Ok,{open:x,onOpenChange:_,children:h.jsxs(ZE,{children:[h.jsxs(eM,{children:[h.jsx(nM,{children:"Temporarily Remove Student Access?"}),h.jsx(rM,{children:"This will make the lesson temporarily unavailable to all students. Their progress will be preserved and they can resume when reactivated."})]}),h.jsx("div",{className:"bg-amber-50 border border-amber-200 rounded-lg p-4",children:h.jsxs("div",{className:"flex items-start space-x-2",children:[h.jsx(Hs,{className:"w-4 h-4 text-amber-600 mt-0.5 flex-shrink-0"}),h.jsxs("div",{className:"text-sm",children:[h.jsx("p",{className:"text-amber-800 font-medium",children:"Impact"}),h.jsxs("ul",{className:"text-amber-700 mt-1 list-disc list-inside space-y-1",children:[h.jsxs("li",{children:["All ",n," students will temporarily lose access"]}),h.jsx("li",{children:"Student progress and answers will be preserved"}),h.jsx("li",{children:"You can reactivate the lesson anytime"})]})]})]})}),h.jsxs(tM,{children:[h.jsx(zt,{variant:"outline",onClick:()=>_(!1),children:"Cancel"}),h.jsx(zt,{variant:"destructive",onClick:A,disabled:b,children:b?"Removing Access...":"Remove Student Access"})]})]})})]}):h.jsxs(Wt,{className:"opacity-60",children:[h.jsx(or,{children:h.jsxs(ws,{className:"flex items-center text-gray-600",children:[h.jsx(r0,{className:"w-5 h-5 mr-2"}),"Lesson Availability Management"]})}),h.jsx(nn,{children:h.jsxs("div",{className:"text-center py-6",children:[h.jsx(Hs,{className:"w-8 h-8 mx-auto mb-3 text-gray-400"}),h.jsx("p",{className:"text-gray-600 mb-2",children:j.message}),h.jsx("p",{className:"text-sm text-gray-500",children:"Complete student assignments first to manage lesson availability"})]})})]})},mG=({students:r,selectedLesson:e,classId:t})=>{const[n,s]=R.useState(new Set),[i,o]=R.useState(new Set),[a,c]=R.useState({});R.useEffect(()=>{s(new Set),o(new Set),c({})},[e]);const f=r.filter(w=>n.has(w.id)||!!a[w.id]).length,m=f===r.length,v=w=>{s(S=>new Set([...S,w]))};return{processedStudents:n,assignmentsInProgress:i,existingAssignments:a,completedStudentsCount:f,allStudentsProcessed:m,handleStudentProcessed:v,handleAssignmentStart:w=>{o(S=>new Set([...S,w]))},handleAssignmentComplete:w=>{o(S=>{const C=new Set(S);return C.delete(w),C}),v(w)},handleExistingAssignmentsUpdate:w=>{c(w)}}},gG=({classId:r,totalStudents:e,studentsWithNotes:t,hasGeneralContent:n,students:s,onNavigateToGeneralPool:i,lessons:o,isLoadingLessons:a,onLessonsChange:c})=>{const[d,f]=R.useState(null),[m,v]=R.useState({timing:"together"}),x=mG({students:s,selectedLesson:d,classId:r}),[_,b]=R.useState(!1),[w,S]=R.useState(!1),C=d!==null;return R.useEffect(()=>{(async()=>{if(!d){b(!1);return}S(!0);try{const A=await fetch(`http://localhost:3001/api/classes/${r}/general-pools?lessonId=${d}`);if(A.ok){const k=await A.json();b(k.pools&&k.pools.length>0)}else b(!1)}catch(A){console.error("Error checking general pool:",A),b(!1)}finally{S(!1)}})()},[d,r]),h.jsxs("div",{className:"space-y-6",children:[h.jsx(Wt,{className:"p-6",children:h.jsx(H_,{classId:r,selectedLesson:d,onLessonSelect:f,lessons:o,isLoadingLessons:a})}),h.jsx(oG,{hasGeneralContent:_,selectedLesson:d,onNavigateToGeneralPool:()=>i(d)}),w&&h.jsxs("div",{className:"text-sm text-gray-600 flex items-center",children:[h.jsx("div",{className:"w-4 h-4 border-2 border-blue-600 border-t-transparent rounded-full animate-spin mr-2"}),"Checking for question pool..."]}),h.jsx(Wt,{className:"p-6",children:h.jsx(WH,{scheduleSettings:m,onScheduleChange:v,disabled:!d})}),h.jsx(lG,{classId:r,students:s,selectedLesson:d,hasGeneralContent:_,canStartAssignments:C,processedStudents:x.processedStudents,assignmentsInProgress:x.assignmentsInProgress,onAssignmentStart:x.handleAssignmentStart,onAssignmentComplete:x.handleAssignmentComplete,onExistingAssignmentsUpdate:x.handleExistingAssignmentsUpdate,scheduleSettings:m}),h.jsx(pG,{classId:r,selectedLesson:d,scheduleSettings:m,totalStudents:e,completedStudents:x.completedStudentsCount,allStudentsProcessed:x.allStudentsProcessed,onScheduleChange:v})]})},vG=({classId:r,totalStudents:e,studentsWithNotes:t,hasGeneralContent:n,recentActivity:s,students:i,studentsCount:o})=>{var A;const{session:a}=ca(),[c,d]=R.useState([]),[f,m]=R.useState(!0),[v,x]=R.useState("teaching"),[_,b]=R.useState("teaching-default"),w=async()=>{var k;if(!(!((k=a==null?void 0:a.user)!=null&&k.email)||!r)){m(!0);try{const{data:j,error:D}=await Un.from("teachers").select("id").eq("email",a.user.email).single();if(D)throw D;const{data:L,error:O}=await Un.from("lessons").select("*").eq("teacher_id",j.id).eq("class_id",r).eq("is_active",!0).order("created_at",{ascending:!1});if(O)throw O;d(L||[])}catch(j){console.error("Error fetching lessons:",j),d([])}finally{m(!1)}}};R.useEffect(()=>{w()},[(A=a==null?void 0:a.user)==null?void 0:A.email,r]);const S=()=>{w()};R.useEffect(()=>{const k=localStorage.getItem(`tab-behavior-${r}`)||"teaching-default";if(b(k),k==="tab-memory"){const j=localStorage.getItem(`active-tab-${r}`)||"teaching";x(j)}},[r]);const C=k=>{x(k),_==="tab-memory"&&localStorage.setItem(`active-tab-${r}`,k)},T=k=>{x("planning"),_==="tab-memory"&&localStorage.setItem(`active-tab-${r}`,"planning"),k&&sessionStorage.setItem(`preselect-lesson-${r}`,k),setTimeout(()=>{const j=document.querySelector('[data-section="lesson-content"]');j&&j.scrollIntoView({behavior:"smooth",block:"start"})},300)};return h.jsxs(lP,{value:v,onValueChange:C,className:"w-full",children:[h.jsxs(jE,{className:"grid w-full grid-cols-4 mb-8",children:[h.jsxs(Pa,{value:"planning",className:"flex items-center gap-2",children:[h.jsx(za,{className:"h-4 w-4"}),"Planning"]}),h.jsxs(Pa,{value:"assignment",className:"flex items-center gap-2",children:[h.jsx(m5,{className:"h-4 w-4"}),"Assignment"]}),h.jsxs(Pa,{value:"analysis",className:"flex items-center gap-2",children:[h.jsx(ly,{className:"h-4 w-4"}),"Analysis"]}),h.jsxs(Pa,{value:"teaching",className:"flex items-center gap-2",children:[h.jsx(Qi,{className:"h-4 w-4"}),"Teaching"]})]}),h.jsx(mp,{value:"planning",children:h.jsx("div",{"data-section":"general-lesson",children:h.jsx(YV,{classId:r,studentsCount:e,onLessonsChange:S,lessons:c,isLoadingLessons:f})})}),h.jsx(mp,{value:"assignment",children:h.jsx(gG,{classId:r,totalStudents:e,studentsWithNotes:t,hasGeneralContent:n,students:i,onNavigateToGeneralPool:T,lessons:c,isLoadingLessons:f,onLessonsChange:S})}),h.jsx(mp,{value:"analysis",children:h.jsx(DH,{classId:r})}),h.jsx(mp,{value:"teaching",children:h.jsx(JV,{totalStudents:e,studentsWithNotes:t,hasGeneralContent:n,recentActivity:s,students:i,classId:r,lessons:c,isLoadingLessons:f,onLessonsChange:S})})]})},xG=()=>{const[r,e]=R.useState(0),{classId:t}=gh(),{data:n,isLoading:s}=ki({queryKey:["classInfo",t],queryFn:()=>Zz(t),enabled:!!t}),{data:i,isLoading:o}=ki({queryKey:["classRoster",t],queryFn:()=>k3(t),enabled:!!t});if(R.useEffect(()=>{(async()=>{if(!i||!t){e(0);return}const d=i.filter(f=>{const m=localStorage.getItem(`focus-goals-${t}-${f.id}`)||"",v=localStorage.getItem(`general-notes-${t}-${f.id}`)||"";return m.trim()||v.trim()}).length;e(d)})()},[i,t]),!t)return h.jsx(gu,{});if(s||o)return h.jsxs("div",{className:"p-8 space-y-4",children:[h.jsx(qa,{to:"/",className:"inline-flex items-center gap-2 text-muted-foreground hover:text-foreground mb-4",children:" Back to Dashboard"}),h.jsxs(Wt,{children:[h.jsxs(or,{children:[h.jsx(Kr,{className:"h-7 w-1/2"}),h.jsx(Kr,{className:"h-5 w-1/4"})]}),h.jsx(nn,{children:h.jsxs("div",{className:"space-y-4",children:[h.jsx(Kr,{className:"h-32 w-full"}),h.jsx(Kr,{className:"h-48 w-full"}),h.jsx(Kr,{className:"h-64 w-full"})]})})]})]});if(!n||!i)return h.jsx(gu,{});const a={gamesCompleted:3,lessonsGenerated:0,averageAccuracy:78.4,studentsActive:i.length,newNotesThisWeek:2};return h.jsxs("div",{className:"min-h-screen bg-gray-50",children:[h.jsx(g9,{classInfo:n,onBackClick:()=>window.history.back(),onGameRoomsClick:()=>window.location.href=`/class/${t}/assign-rooms`,onSettingsClick:()=>console.log("Settings clicked")}),h.jsx("div",{className:"max-w-7xl mx-auto px-6 py-8",children:h.jsx(vG,{classId:t,totalStudents:i.length,studentsWithNotes:r,hasGeneralContent:!1,recentActivity:a,studentsCount:i.length,students:i})})]})},yG=R.createContext(void 0),_G=({children:r})=>{const[e,t]=R.useState({}),[n,s]=R.useState({}),i=R.useRef({}),o=R.useCallback((d,f)=>{t(m=>({...m,[d]:f})),i.current[d]&&clearTimeout(i.current[d]),s(m=>({...m,[d]:"saving"})),i.current[d]=setTimeout(async()=>{try{const m={...e,[d]:f};localStorage.setItem("class-notes",JSON.stringify(m)),s(v=>({...v,[d]:"saved"})),setTimeout(()=>{s(v=>({...v,[d]:"synced"})),setTimeout(()=>{s(v=>({...v,[d]:"idle"}))},2e3)},1e3)}catch(m){console.error("Failed to save note:",m),s(v=>({...v,[d]:"error"})),setTimeout(()=>{s(v=>({...v,[d]:"idle"}))},3e3)}},500)},[e]),a=R.useCallback(d=>n[d]||"idle",[n]),c=R.useCallback(d=>{switch(n[d]||"idle"){case"saving":return" Saving...";case"saved":return" Saved";case"synced":return" Synced";case"error":return" Save failed";default:return""}},[n]);return h.jsx(yG.Provider,{value:{notes:e,updateNote:o,getSyncStatus:a,getSyncIndicator:c},children:r})};var wG="Separator",fC="horizontal",SG=["horizontal","vertical"],Wk=R.forwardRef((r,e)=>{const{decorative:t,orientation:n=fC,...s}=r,i=bG(n)?n:fC,a=t?{role:"none"}:{"aria-orientation":i==="vertical"?i:void 0,role:"separator"};return h.jsx($t.div,{"data-orientation":i,...a,...s,ref:e})});Wk.displayName=wG;function bG(r){return SG.includes(r)}var $k=Wk;const py=R.forwardRef(({className:r,orientation:e="horizontal",decorative:t=!0,...n},s)=>h.jsx($k,{ref:s,decorative:t,orientation:e,className:Zt("shrink-0 bg-border",e==="horizontal"?"h-[1px] w-full":"h-full w-[1px]",r),...n}));py.displayName=$k.displayName;const EG=({student:r})=>h.jsx(or,{children:h.jsxs("div",{className:"flex justify-between items-center",children:[h.jsxs("div",{children:[h.jsx(ws,{children:r.name}),h.jsxs(CE,{children:["Student ID: ",String(r.id).padStart(3,"0")]})]}),h.jsx(zt,{asChild:!0,variant:"outline",children:h.jsxs(qa,{to:`/dashboard/student/${r.id}`,target:"_blank",rel:"noopener noreferrer",children:["View Student Dashboard ",h.jsx(e5,{className:"ml-2"})]})})]})});function MG(r,e){let t;return(...n)=>{clearTimeout(t),t=setTimeout(()=>r(...n),e)}}const TG=({classId:r,studentId:e,studentName:t,selectedLesson:n})=>{const[s,i]=R.useState(""),[o,a]=R.useState(!1),[c,d]=R.useState(!1),[f,m]=R.useState(null),[v,x]=R.useState(""),[_,b]=R.useState(!1);R.useEffect(()=>{(async()=>{a(!0);try{const k=await fetch(`http://localhost:3001/api/students/${e}/general-notes?classId=${r}`);if(k.ok){const j=await k.json();i(j.generalNotes)}else console.error("Failed to fetch general notes"),i("")}catch(k){console.error("Error fetching general notes:",k),i("")}finally{a(!1)}})()},[e,r]),R.useEffect(()=>{(async()=>{if(!n){x("");return}b(!0);try{const k=await fetch(`http://localhost:3001/api/students/${e}/lessons/${n}/focus?classId=${r}`);if(k.ok){const j=await k.json();x(j.focusGoals)}else console.error("Failed to fetch focus goals"),x("")}catch(k){console.error("Error fetching focus goals:",k),x("")}finally{b(!1)}})()},[n,e,r]);const w=async A=>{d(!0);try{(await fetch(`http://localhost:3001/api/students/${e}/general-notes`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({classId:r,generalNotes:A})})).ok?m(new Date):console.error("Failed to save general notes")}catch(k){console.error("Error saving general notes:",k)}finally{d(!1)}},S=R.useCallback(MG(A=>{w(A)},1e3),[e,r]),C=A=>{i(A),S(A)},T=A=>{x(A)};return h.jsxs("div",{children:[h.jsxs("div",{className:"flex items-center justify-between mb-4",children:[h.jsxs("div",{className:"flex items-center",children:[h.jsx(Bg,{className:"h-5 w-5 mr-2 text-blue-600"}),h.jsx("h2",{className:"text-xl font-bold text-gray-800",children:"Student Context"})]}),h.jsxs("div",{className:"flex items-center text-xs text-gray-500",children:[c&&h.jsxs(h.Fragment,{children:[h.jsx(Xl,{className:"w-3 h-3 mr-1 animate-spin"}),h.jsx("span",{children:"Saving..."})]}),f&&!c&&h.jsxs("span",{children:["Saved ",f.toLocaleTimeString()]})]})]}),h.jsxs("p",{className:"text-gray-600 text-sm mb-6",children:["Manage both persistent student information and lesson-specific focus goals for ",t,"."]}),h.jsxs("div",{className:"space-y-6",children:[h.jsxs("div",{children:[h.jsxs(zs,{className:"flex items-center mb-2",children:[h.jsx(Sp,{className:"w-4 h-4 mr-2 text-green-600"}),"General Student Notes (Persistent)"]}),h.jsxs("p",{className:"text-xs text-gray-500 mb-2",children:["These notes persist across all lessons and track ",t,`'s evolution over time. Example: "Learning ABCs"  "Counts on fingers"  "Uses mental math"`]}),o?h.jsx("div",{className:"animate-pulse",children:h.jsx("div",{className:"h-24 bg-gray-200 rounded"})}):h.jsx(vu,{value:s,onChange:A=>C(A.target.value),placeholder:`General notes about ${t}... (e.g., "Responds well to visual examples", "Needs extra encouragement", "Strong with patterns")`,className:"min-h-[100px] resize-y"})]}),h.jsxs("div",{children:[h.jsxs(zs,{className:"flex items-center mb-2",children:[h.jsx(sh,{className:"w-4 h-4 mr-2 text-blue-600"}),"Lesson Focus Goals",n?h.jsx("span",{className:"ml-2 text-xs text-gray-500",children:"(This Lesson)"}):h.jsx("span",{className:"ml-2 text-xs text-amber-600",children:"(Select a lesson first)"})]}),h.jsx("p",{className:"text-xs text-gray-500 mb-2",children:"Specific goals for this lesson. These are saved when you generate questions."}),n?_?h.jsx("div",{className:"animate-pulse",children:h.jsx("div",{className:"h-20 bg-gray-200 rounded"})}):h.jsx(vu,{value:v,onChange:A=>T(A.target.value),placeholder:`What should ${t} focus on in this specific lesson? (e.g., "Practice regrouping in addition", "Work on multiplication tables")`,className:"min-h-[80px] resize-y"}):h.jsxs("div",{className:"text-center py-8 text-gray-500 bg-gray-50 rounded-lg border-2 border-dashed border-gray-300",children:[h.jsx(za,{className:"h-8 w-8 mx-auto mb-2 text-gray-300"}),h.jsxs("p",{className:"text-sm",children:["Select a lesson to add focus goals for ",t]})]})]}),h.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-3",children:h.jsxs("div",{className:"text-sm text-blue-800",children:[h.jsx("p",{className:"font-medium",children:"How this works:"}),h.jsxs("ul",{className:"text-xs mt-1 space-y-1",children:[h.jsxs("li",{children:[" ",h.jsx("strong",{children:"General Notes:"})," Auto-save and persist across all lessons"]}),h.jsxs("li",{children:[" ",h.jsx("strong",{children:"Focus Goals:"})," Lesson-specific, saved when generating questions"]}),h.jsxs("li",{children:[" ",h.jsx("strong",{children:"AI Context:"})," Uses both general notes + focus goals for personalized questions"]}),h.jsxs("li",{children:[" ",h.jsx("strong",{children:"History:"})," Snapshots preserve student progression over time"]})]})]})})]})]})},CG=({student:r,classId:e,selectedLesson:t=null})=>{const[n,s]=R.useState(!1),[i,o]=R.useState({generalNotes:"",focusGoals:""}),[a,c]=R.useState(!1);R.useEffect(()=>{(async()=>{c(!0);try{const k=await fetch(`http://localhost:3001/api/students/${r.id}/general-notes?classId=${e}`);let j="";k.ok&&(j=(await k.json()).generalNotes);let D="";if(t){const L=await fetch(`http://localhost:3001/api/students/${r.id}/lessons/${t}/focus?classId=${e}`);L.ok&&(D=(await L.json()).focusGoals)}o({generalNotes:j,focusGoals:D})}catch(k){console.error("Error fetching student context:",k),o({generalNotes:"",focusGoals:""})}finally{c(!1)}})()},[t,r.id,e]);const{generatedQuestions:d,setGeneratedQuestions:f,isGenerating:m,generationError:v,generateQuestions:x,regenerateAll:_,regenerateQuestion:b,assignQuestions:w,hasQuestions:S}=sM({student:{id:String(r.id),name:r.name,email:r.email},classId:e,selectedLesson:t,focusGoals:i.focusGoals,generalNotes:i.generalNotes});R.useEffect(()=>{s(!1)},[t]);const C=async()=>{await x(),s(!0)},T=async()=>{try{await w(d),s(!1)}catch(A){console.error("Failed to assign questions:",A)}};return t?n&&S?h.jsxs(Wt,{children:[h.jsx(or,{children:h.jsxs(ws,{className:"flex items-center gap-2",children:[h.jsx(za,{className:"h-5 w-5"}),"Generated Questions for ",r.name]})}),h.jsxs(nn,{className:"space-y-4",children:[h.jsx("div",{className:"bg-green-50 border border-green-200 rounded-lg p-3",children:h.jsxs("div",{className:"text-sm text-green-800",children:[h.jsx("p",{className:"font-medium mb-2",children:"Questions generated using:"}),h.jsxs("div",{className:"space-y-1 text-xs",children:[i.generalNotes&&h.jsxs("div",{className:"flex items-start",children:[h.jsx(Bg,{className:"w-3 h-3 mr-1 mt-0.5 flex-shrink-0"}),h.jsxs("span",{children:[h.jsx("strong",{children:"General Notes:"})," ",i.generalNotes]})]}),i.focusGoals&&h.jsxs("div",{className:"flex items-start",children:[h.jsx(sh,{className:"w-3 h-3 mr-1 mt-0.5 flex-shrink-0"}),h.jsxs("span",{children:[h.jsx("strong",{children:"Focus Goals:"})," ",i.focusGoals]})]})]})]})}),h.jsx(G_,{title:`Questions for ${r.name}`,questions:d,onQuestionsUpdate:f,onRegenerateAll:_,onRegenerateQuestion:b,isLoading:m}),h.jsxs("div",{className:"flex gap-2",children:[h.jsxs(zt,{onClick:T,className:"flex-1",children:[h.jsx(Ar,{className:"h-4 w-4 mr-2"}),"Assign Questions"]}),h.jsx(zt,{variant:"outline",onClick:()=>s(!1),children:"Cancel"})]})]})]}):h.jsxs(Wt,{children:[h.jsx(or,{children:h.jsx(ws,{className:"flex items-center gap-2",children:"Adaptive Questions"})}),h.jsxs(nn,{children:[v&&h.jsx("div",{className:"mb-4 p-3 bg-red-50 border border-red-200 rounded-lg text-red-700 text-sm",children:v}),h.jsxs("div",{className:"space-y-4",children:[a?h.jsx("div",{className:"text-sm text-gray-600",children:h.jsxs("div",{className:"flex items-center",children:[h.jsx(Xl,{className:"w-4 h-4 mr-2 animate-spin"}),h.jsx("span",{children:"Loading student context..."})]})}):h.jsxs("div",{className:"space-y-3",children:[h.jsxs("div",{className:"text-sm",children:[h.jsxs("div",{className:"flex items-center text-gray-700 font-medium mb-1",children:[h.jsx(Bg,{className:"w-4 h-4 mr-1 text-blue-600"}),"General Student Notes"]}),h.jsx("p",{className:"text-gray-600 text-xs pl-5",children:i.generalNotes||"No general notes set"})]}),h.jsxs("div",{className:"text-sm",children:[h.jsxs("div",{className:"flex items-center text-gray-700 font-medium mb-1",children:[h.jsx(sh,{className:"w-4 h-4 mr-1 text-green-600"}),"Lesson Focus Goals"]}),h.jsx("p",{className:"text-gray-600 text-xs pl-5",children:i.focusGoals||"No specific goals set for this lesson"})]}),!i.generalNotes&&!i.focusGoals&&h.jsx("div",{className:"bg-amber-50 border border-amber-200 rounded-lg p-3",children:h.jsx("p",{className:"text-amber-800 text-xs",children:" Add general notes and focus goals above to generate more personalized questions"})})]}),h.jsx(zt,{onClick:C,disabled:m||!t||a,className:"w-full",children:m?h.jsxs(h.Fragment,{children:[h.jsx(Xl,{className:"w-4 h-4 mr-2 animate-spin"}),"Generating Questions..."]}):h.jsx(h.Fragment,{children:"Generate 10 Adaptive Questions"})}),h.jsx("div",{className:"text-xs text-gray-500 text-center",children:"Questions will use both general student notes and lesson-specific focus goals"})]})]})]}):h.jsxs(Wt,{children:[h.jsx(or,{children:h.jsx(ws,{className:"flex items-center gap-2",children:"Adaptive Questions"})}),h.jsx(nn,{children:h.jsxs("div",{className:"text-center py-8 text-gray-500",children:[h.jsx(za,{className:"h-12 w-12 mx-auto mb-4 text-gray-300"}),h.jsxs("p",{children:["Select a lesson to generate adaptive questions for ",r.name]}),i.generalNotes&&h.jsxs("div",{className:"mt-4 p-3 bg-blue-50 border border-blue-200 rounded-lg text-left",children:[h.jsxs("div",{className:"flex items-center text-sm font-medium text-blue-800 mb-1",children:[h.jsx(Bg,{className:"w-4 h-4 mr-1"}),"General Notes for ",r.name]}),h.jsx("p",{className:"text-xs text-blue-700",children:i.generalNotes})]})]})})]})},AG=({student:r,classId:e,selectedLesson:t})=>h.jsxs("div",{children:[h.jsx("div",{className:"flex items-center mb-4",children:h.jsx("h2",{className:"text-xl font-bold text-gray-800",children:"AI Question Generation"})}),h.jsxs("p",{className:"text-gray-600 text-sm mb-6",children:["Generate personalized questions for ",r.name," based on their focus goals, teacher notes, and the current lesson content."]}),h.jsx(CG,{student:r,classId:e,selectedLesson:t})]}),RG=({studentId:r,studentName:e,classId:t})=>{const[n,s]=R.useState([]),[i,o]=R.useState(!0),[a,c]=R.useState(null),[d,f]=R.useState("draft"),[m,v]=R.useState({}),[x,_]=R.useState({});R.useEffect(()=>{b()},[r,t]);const b=async()=>{o(!0),c(null);try{const O=await(await fetch(`http://localhost:3001/api/students/${r}/lesson-assignments?classId=${t}`)).json();if(O.success){const I=O.assignments.map(B=>({...B,questions:B.questions.map((W,K)=>({id:W.id||`q_${B.id}_${K}`,text:W.text,choices:W.choices,correctAnswer:W.correctAnswer,explanation:W.explanation||"",status:W.status||"pending",type:W.type||"adaptive"}))}));s(I)}else throw new Error(O.error||"Failed to fetch assignments")}catch(L){console.error("Error fetching assignments:",L),c(L instanceof Error?L.message:"Failed to load assignments")}finally{o(!1)}},w=async(L,O,I)=>{try{if((await fetch(`http://localhost:3001/api/students/${r}/lesson-assignments/${L}/status`,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({status:O,...I})})).ok)await b();else throw new Error("Failed to update status")}catch(B){console.error("Error updating assignment status:",B)}},S=(L,O)=>{s(B=>B.map(W=>W.id===L?{...W,questions:O,questionCount:O.length}:W)),x[L]&&clearTimeout(x[L]),v(B=>({...B,[L]:!0}));const I=setTimeout(async()=>{try{if(!(await fetch(`http://localhost:3001/api/students/${r}/lesson-assignments/${L}/questions`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({questions:O})})).ok)throw new Error("Failed to auto-save questions");console.log("Questions auto-saved successfully")}catch(B){console.error("Error auto-saving questions:",B)}finally{v(B=>({...B,[L]:!1})),_(B=>{const W={...B};return delete W[L],W})}},2e3);_(B=>({...B,[L]:I}))},C=async(L,O)=>{v(I=>({...I,[L]:!0}));try{if(!(await fetch(`http://localhost:3001/api/students/${r}/lesson-assignments/${L}/questions`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({questions:O})})).ok)throw new Error("Failed to save questions");console.log("Questions saved successfully")}catch(I){console.error("Error saving questions:",I)}finally{v(I=>({...I,[L]:!1}))}},T=()=>({draft:n.filter(L=>L.status==="draft").length,assigned:n.filter(L=>L.status==="assigned").length,accessible:n.filter(L=>L.status==="accessible").length,expired:n.filter(L=>L.status==="expired").length,completed:n.filter(L=>L.status==="completed").length}),A=L=>{switch(L){case"draft":return h.jsx(Sp,{className:"w-4 h-4"});case"assigned":return h.jsx(T_,{className:"w-4 h-4"});case"accessible":return h.jsx(rh,{className:"w-4 h-4"});case"expired":return h.jsx(fu,{className:"w-4 h-4"});case"completed":return h.jsx(Ar,{className:"w-4 h-4"});default:return h.jsx(Hs,{className:"w-4 h-4"})}},k=L=>{const O=[],I=L.questions.filter(K=>K.status==="approved"),B=I.length>0,W=I.length===L.questions.length;switch(L.status){case"draft":O.push(h.jsx(zt,{size:"sm",onClick:()=>w(L.id,"assigned"),disabled:!B,title:B?`Assign ${I.length} approved questions to student`:"No approved questions to assign",children:B?`Assign ${I.length} Questions`:"No Questions Ready"},"assign-approved")),B&&!W&&O.push(h.jsxs(Bs,{variant:"outline",className:"text-blue-600 border-blue-300 bg-blue-50",children:[I.length," of ",L.questions.length," ready"]},"partial"));break;case"assigned":O.push(h.jsx(zt,{size:"sm",onClick:()=>w(L.id,"accessible",{availableFrom:new Date().toISOString().split("T")[0]}),title:`Make ${I.length} approved questions accessible to student`,children:"Make Accessible"},"make-accessible")),O.push(h.jsx(zt,{size:"sm",variant:"outline",onClick:()=>w(L.id,"draft"),children:"Back to Draft"},"back-to-draft")),W||O.push(h.jsxs(Bs,{variant:"outline",className:"text-green-600 border-green-300 bg-green-50",children:[I.length," questions assigned, others in progress"]},"info"));break;case"accessible":O.push(h.jsx(zt,{size:"sm",variant:"outline",onClick:()=>w(L.id,"expired"),children:"Mark Expired"},"expire")),W||O.push(h.jsxs(Bs,{variant:"outline",className:"text-green-600 border-green-300 bg-green-50",children:[I.length," questions active"]},"active-info"));break}return O},j=({assignment:L})=>{const[O,I]=R.useState(L.availableFrom||""),[B,W]=R.useState(L.expiresAt||""),K=async()=>{await w(L.id,L.status,{availableFrom:O||void 0,expiresAt:B||void 0})};return L.status==="draft"?null:h.jsx(Wt,{className:"border-blue-200 bg-blue-50 mb-4",children:h.jsxs(nn,{className:"p-4",children:[h.jsxs("div",{className:"flex items-center space-x-2 mb-3",children:[h.jsx(r0,{className:"w-4 h-4 text-blue-600"}),h.jsx("h4",{className:"font-medium text-blue-800",children:"Date Management"})]}),h.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-3",children:[h.jsxs("div",{children:[h.jsx(zs,{htmlFor:`available-${L.id}`,className:"text-sm",children:"Available From"}),h.jsx(Jl,{id:`available-${L.id}`,type:"date",value:O,onChange:ee=>I(ee.target.value),className:"mt-1"})]}),h.jsxs("div",{children:[h.jsx(zs,{htmlFor:`expires-${L.id}`,className:"text-sm",children:"Expires At (Optional)"}),h.jsx(Jl,{id:`expires-${L.id}`,type:"date",value:B,onChange:ee=>W(ee.target.value),className:"mt-1"})]})]}),h.jsx(zt,{size:"sm",onClick:K,children:"Update Dates & Calendar"})]})})},D=T();return i?h.jsxs("div",{className:"space-y-4",children:[h.jsx("div",{className:"h-6 bg-gray-200 rounded animate-pulse"}),h.jsx("div",{className:"h-32 bg-gray-200 rounded animate-pulse"})]}):a?h.jsx(Wt,{className:"border-red-200",children:h.jsxs(nn,{className:"p-6 text-center",children:[h.jsx(Hs,{className:"w-8 h-8 mx-auto mb-3 text-red-500"}),h.jsx("h3",{className:"font-medium text-red-800 mb-2",children:"Failed to Load Assignments"}),h.jsx("p",{className:"text-sm text-red-600 mb-4",children:a}),h.jsxs(zt,{variant:"outline",onClick:b,children:[h.jsx(Yd,{className:"w-4 h-4 mr-2"}),"Try Again"]})]})}):h.jsxs("div",{className:"space-y-4",children:[h.jsxs("div",{className:"flex items-center justify-between",children:[h.jsxs("div",{className:"flex items-center space-x-2",children:[h.jsx(Sp,{className:"w-5 h-5 text-purple-600"}),h.jsxs("h2",{className:"text-xl font-bold text-gray-800",children:["Assigned Questions for ",e]})]}),h.jsxs(zt,{variant:"outline",size:"sm",onClick:b,children:[h.jsx(Yd,{className:"w-4 h-4 mr-2"}),"Refresh"]})]}),h.jsxs(lP,{value:d,onValueChange:f,children:[h.jsxs(jE,{className:"grid w-full grid-cols-5",children:[h.jsxs(Pa,{value:"draft",className:"flex items-center space-x-2",children:[A("draft"),h.jsxs("span",{children:["Draft (",D.draft,")"]})]}),h.jsxs(Pa,{value:"assigned",className:"flex items-center space-x-2",children:[A("assigned"),h.jsxs("span",{children:["Assigned (",D.assigned,")"]})]}),h.jsxs(Pa,{value:"accessible",className:"flex items-center space-x-2",children:[A("accessible"),h.jsxs("span",{children:["Active (",D.accessible,")"]})]}),h.jsxs(Pa,{value:"expired",className:"flex items-center space-x-2",children:[A("expired"),h.jsxs("span",{children:["Expired (",D.expired,")"]})]}),h.jsxs(Pa,{value:"completed",className:"flex items-center space-x-2",children:[A("completed"),h.jsxs("span",{children:["Completed (",D.completed,")"]})]})]}),["draft","assigned","accessible","expired","completed"].map(L=>h.jsxs(mp,{value:L,className:"space-y-6",children:[n.filter(O=>O.status===L).map(O=>h.jsxs("div",{className:"space-y-4",children:[h.jsx(Wt,{className:"border-l-4 border-l-purple-500",children:h.jsxs(or,{className:"pb-3",children:[h.jsxs("div",{className:"flex items-center justify-between",children:[h.jsxs("div",{className:"flex items-center space-x-3",children:[h.jsx(ws,{className:"text-lg",children:O.lessonTitle}),h.jsxs(Bs,{variant:"outline",children:[O.questionCount," questions"]}),(()=>{const I=O.questions.filter(K=>K.status==="approved").length,B=O.questions.filter(K=>K.status==="pending").length,W=O.questions.filter(K=>K.status==="invalid").length;return I===0?h.jsxs(Bs,{variant:"outline",className:"text-red-600 border-red-300 bg-red-50",children:[h.jsx(Hs,{className:"w-3 h-3 mr-1"}),"No questions approved"]}):I===O.questionCount?h.jsxs(Bs,{className:"bg-green-100 text-green-800 border-green-300",children:[h.jsx(Ar,{className:"w-3 h-3 mr-1"}),"All ",I," approved"]}):h.jsxs(Bs,{className:"bg-blue-100 text-blue-800 border-blue-300",children:[h.jsx(Ar,{className:"w-3 h-3 mr-1"}),I," approved, ",B+W," in progress"]})})(),m[O.id]&&h.jsxs(Bs,{className:"bg-blue-100 text-blue-800",children:[h.jsx(Yd,{className:"w-3 h-3 mr-1 animate-spin"}),"Saving..."]})]}),h.jsx("div",{className:"flex items-center space-x-2",children:k(O)})]}),h.jsxs("div",{className:"text-sm text-gray-600 space-y-1",children:[h.jsxs("div",{children:["Created: ",new Date(O.createdAt).toLocaleDateString()]}),O.assignedAt&&h.jsxs("div",{children:["Assigned: ",new Date(O.assignedAt).toLocaleDateString()]}),O.availableFrom&&h.jsxs("div",{children:["Available: ",new Date(O.availableFrom).toLocaleDateString()]}),O.expiresAt&&h.jsxs("div",{children:["Expires: ",new Date(O.expiresAt).toLocaleDateString()]})]})]})}),h.jsx(j,{assignment:O}),O.status==="assigned"&&h.jsx(Wt,{className:"border-green-200 bg-green-50 mb-4",children:h.jsxs(nn,{className:"p-4",children:[h.jsxs("div",{className:"flex items-center space-x-2 mb-3",children:[h.jsx(Ar,{className:"w-4 h-4 text-green-600"}),h.jsx("h4",{className:"font-medium text-green-800",children:"Progressive Assignment Active"})]}),h.jsxs("div",{className:"text-sm text-green-700 space-y-2",children:[h.jsx("p",{children:h.jsxs("strong",{children:[e," can currently access ",O.questions.filter(I=>I.status==="approved").length," approved questions."]})}),h.jsxs("div",{className:"ml-4 space-y-1",children:[h.jsx("p",{children:h.jsx("strong",{children:"How this works:"})}),h.jsxs("ul",{className:"list-disc list-inside space-y-1",children:[h.jsx("li",{children:"Only approved questions are visible to the student"}),h.jsx("li",{children:"Continue working on unapproved questions - they won't affect the student"}),h.jsxs("li",{children:["When you approve more questions, they automatically become available to ",e]}),h.jsx("li",{children:"Students see new questions as you approve them (progressive delivery)"})]})]})]})]})}),O.status==="draft"&&O.questions.filter(I=>I.status==="approved").length>0&&h.jsx(Wt,{className:"border-blue-200 bg-blue-50 mb-4",children:h.jsxs(nn,{className:"p-4",children:[h.jsxs("div",{className:"flex items-center space-x-2 mb-3",children:[h.jsx(Sp,{className:"w-4 h-4 text-blue-600"}),h.jsx("h4",{className:"font-medium text-blue-800",children:"Ready for Partial Assignment"})]}),h.jsx("div",{className:"text-sm text-blue-700",children:h.jsxs("p",{children:["You have ",O.questions.filter(I=>I.status==="approved").length," approved questions ready to assign to ",e,". You can assign these now while continuing to work on the remaining questions."]})})]})}),h.jsx(G_,{title:`Questions for ${O.lessonTitle}`,questions:O.questions,onQuestionsUpdate:I=>S(O.id,I),onSaveChanges:I=>C(O.id,I),className:"border-0 shadow-sm"})]},O.id)),n.filter(O=>O.status===L).length===0&&h.jsxs("div",{className:"text-center py-12 text-gray-500",children:[h.jsx("div",{className:"w-16 h-16 mx-auto mb-4 opacity-20",children:A(L)}),h.jsxs("h3",{className:"text-lg font-medium mb-2",children:["No ",L," assignments"]}),h.jsxs("p",{children:["No ",L," assignments found for ",e]})]})]},L))]})]})},NG=()=>{var I,B;const{studentId:r}=gh(),e=rc(),{session:t}=ca(),n=r?parseInt(r,10):void 0,s=(I=e.state)==null?void 0:I.fromClass,i=s?`/class/${s}`:"/",[o,a]=R.useState(null),[c,d]=R.useState(""),[f,m]=R.useState(""),[v,x]=R.useState(!1),[_,b]=R.useState(!1),[w,S]=R.useState([]),[C,T]=R.useState(!0),A=async()=>{var W;if(!(!((W=t==null?void 0:t.user)!=null&&W.email)||!s)){T(!0);try{const{data:K,error:ee}=await Un.from("teachers").select("id").eq("email",t.user.email).single();if(ee)throw ee;const{data:oe,error:ne}=await Un.from("lessons").select("*").eq("teacher_id",K.id).eq("class_id",s).eq("is_active",!0).order("created_at",{ascending:!1});if(ne)throw ne;S(oe||[])}catch(K){console.error("Error fetching lessons:",K),S([])}finally{T(!1)}}};R.useEffect(()=>{A()},[(B=t==null?void 0:t.user)==null?void 0:B.email,s]);const{data:k,isLoading:j}=ki({queryKey:["student",n],queryFn:()=>L_(n),enabled:!!n});R.useEffect(()=>{(async()=>{if(!o||!s||!n){d(""),m(""),x(!1);return}try{const{data:K,error:ee}=await Un.from("student_lesson_content").select("customized_content").eq("student_id",n).eq("lesson_id",o).eq("class_id",s);if(K&&K.length>0&&!ee){d(K[0].customized_content),m(K[0].customized_content),x(!0);return}const{data:oe,error:ne}=await Un.from("lessons").select("content").eq("id",o).eq("class_id",s).single();oe&&!ne?(d(oe.content||""),m(oe.content||""),x(!1)):(d(""),m(""),x(!1))}catch(K){console.error("Error loading lesson content:",K),d(""),m(""),x(!1)}})()},[o,s,n]);const D=async()=>{if(!(!o||!s||!n)){b(!0);try{const{error:W}=await Un.from("student_lesson_content").upsert({student_id:n,lesson_id:o,class_id:s,customized_content:c,updated_at:new Date().toISOString()},{onConflict:"student_id,lesson_id,class_id"});if(W)throw W;m(c),x(!0),console.log("Student lesson content saved")}catch(W){console.error("Error saving student content:",W)}finally{b(!1)}}},L=async()=>{if(!(!o||!s||!n)){b(!0);try{const{error:W}=await Un.from("student_lesson_content").delete().eq("student_id",n).eq("lesson_id",o).eq("class_id",s);if(W)throw W;const{data:K,error:ee}=await Un.from("lessons").select("content").eq("id",o).eq("class_id",s).single();K&&!ee&&(d(K.content||""),m(K.content||""),x(!1))}catch(W){console.error("Error resetting to general content:",W)}finally{b(!1)}}};if(!n)return h.jsx(gu,{});if(j)return h.jsxs("div",{className:"p-8 space-y-4",children:[h.jsx(Kr,{className:"h-6 w-48"}),h.jsx(Wt,{children:h.jsx(nn,{className:"p-6",children:h.jsxs("div",{className:"space-y-4",children:[h.jsx(Kr,{className:"h-32 w-full"}),h.jsx(Kr,{className:"h-40 w-full"})]})})})]});if(!k)return h.jsx(gu,{});const O=c!==f;return h.jsxs("div",{className:"p-8",children:[h.jsxs(qa,{to:i,className:"inline-flex gap-2 text-muted-foreground hover:text-foreground mb-4",children:[h.jsx(em,{className:"h-4 w-4"}),"Back to Class Roster"]}),h.jsx(Wt,{className:"mb-6",children:h.jsx(nn,{className:"p-6",children:h.jsx(H_,{classId:s||"",selectedLesson:o,onLessonSelect:a,lessons:w,isLoadingLessons:C})})}),h.jsxs(Wt,{children:[h.jsx(EG,{student:k}),h.jsxs(nn,{className:"space-y-6",children:[h.jsxs("div",{children:[h.jsxs("div",{className:"flex items-center justify-between mb-4",children:[h.jsxs("div",{className:"flex items-center",children:[h.jsx(za,{className:"h-5 w-5 mr-2 text-blue-600"}),h.jsxs("h2",{className:"text-xl font-bold text-gray-800",children:["Lesson Content for ",k.name]}),o&&h.jsx("span",{className:`ml-2 px-2 py-1 text-xs rounded-full ${v?"bg-blue-100 text-blue-800":"bg-gray-100 text-gray-600"}`,children:v?"Customized":"Using General"})]}),o&&h.jsxs("div",{className:"flex items-center space-x-2",children:[O&&h.jsxs(zt,{onClick:D,disabled:_,size:"sm",children:[h.jsx(C_,{className:"h-4 w-4 mr-1"}),_?"Saving...":"Save"]}),v&&!O&&h.jsx(zt,{onClick:L,disabled:_,variant:"outline",size:"sm",children:"Reset to General"})]})]}),o?h.jsxs(h.Fragment,{children:[h.jsx(vu,{value:c,onChange:W=>d(W.target.value),placeholder:`Customize lesson content for ${k.name}...`,className:"min-h-[200px] resize-vertical"}),h.jsxs("div",{className:"flex items-center justify-between text-sm text-gray-500",children:[h.jsx("span",{children:O?"You have unsaved changes":v?"Content customized for this student":"Using general lesson content"}),h.jsxs("span",{children:[c.length," characters"]})]})]}):h.jsxs("div",{className:"text-center py-8 text-gray-500",children:[h.jsx(za,{className:"h-8 w-8 mx-auto mb-2 text-gray-300"}),h.jsxs("p",{children:["Select a lesson to view and customize content for ",k.name]})]})]}),h.jsx(py,{}),h.jsx(TG,{classId:s||"",studentId:String(n),studentName:k.name,selectedLesson:o}),h.jsx(py,{}),h.jsx(AG,{student:k,classId:s||"",selectedLesson:o}),h.jsx(py,{}),h.jsx(RG,{studentId:n,studentName:k.name,classId:s||""})]})]})]})},qk=R.createContext(void 0),PG=({children:r})=>{const[e,t]=R.useState({}),n=(s,i)=>{t(o=>{const a=o[s]?[...o[s],i]:[i];return{...o,[s]:a}})};return h.jsx(qk.Provider,{value:{lessons:e,addLesson:n},children:r})},IG=()=>{const r=R.useContext(qk);if(!r)throw new Error("useLessons must be used within a LessonsProvider");return r},kG=r=>ki({queryKey:["student-performance",r],queryFn:async()=>{const e=await e8(r),t=e.gameResults||e,n=e.conceptMastery||[],s=t.length,i=t.reduce((f,m)=>f+m.questions_correct,0),o=t.reduce((f,m)=>f+m.questions_total,0);let a=0;if(t.length>=4){const f=t.slice(0,Math.floor(t.length/2)),m=t.slice(Math.floor(t.length/2)),v=f.reduce((_,b)=>_+b.questions_correct/b.questions_total*100,0)/f.length,x=m.reduce((_,b)=>_+b.questions_correct/b.questions_total*100,0)/m.length;a=Math.round(v-x)}const c=t.map(f=>({date:f.created_at.split("T")[0],questionsAnswered:f.questions_total})),d=t.slice(0,8).reverse().map(f=>Math.round(f.questions_correct/f.questions_total*100));return{gamesPlayed:s,totalCorrect:i,totalAttempts:o,improvementPercentage:a,gameActivity:c,conceptMastery:n,lessonPerformance:d}},enabled:!!r}),DG=({studentName:r,data:e,isLoading:t=!1})=>{const[n,s]=R.useState("games"),i=(e==null?void 0:e.gamesPlayed)||0,o=(e==null?void 0:e.totalCorrect)||0,a=(e==null?void 0:e.totalAttempts)||0,c=(e==null?void 0:e.improvementPercentage)||0,d=a>0?Math.round(o/a*100*10)/10:0,f=_=>({flex:1,padding:"16px",textAlign:"center",border:"none",borderBottom:_?"2px solid #4f46e5":"2px solid transparent",backgroundColor:_?"#eef2ff":"transparent",color:_?"#4f46e5":"#6b7280",cursor:"pointer"}),m=()=>{var b;const _=new Map;return(b=e==null?void 0:e.gameActivity)==null||b.forEach(w=>{_.set(w.date,w.questionsAnswered)}),h.jsxs("div",{children:[h.jsx("h4",{children:"Game Activity Calendar"}),h.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(7, 1fr)",gap:"8px"},children:[["Sun","Mon","Tue","Wed","Thu","Fri","Sat"].map(w=>h.jsx("div",{style:{textAlign:"center",padding:"8px",fontSize:"14px",color:"#6b7280"},children:w},w)),Array.from({length:28},(w,S)=>{const C=new Date;C.setDate(C.getDate()-(27-S));const T=C.toISOString().split("T")[0],A=_.get(T)||0,k=A>15?"#dc2626":A>10?"#fca5a5":A>0?"#fee2e2":"#f3f4f6";return h.jsxs("div",{style:{textAlign:"center",padding:"12px",borderRadius:"8px",backgroundColor:t?"#f9fafb":k,color:A>15?"white":"#1f2937",opacity:t?.5:1},children:[h.jsx("div",{style:{fontSize:"14px"},children:C.getDate()}),A>0&&!t&&h.jsxs("div",{style:{fontSize:"12px"},children:[A,"q"]})]},S)})]})]})},v=()=>h.jsxs("div",{style:{display:"flex"},children:[h.jsxs("div",{style:{width:"33%"},children:[h.jsxs("div",{children:[h.jsx("strong",{style:{fontSize:"24px",color:"#059669"},children:o}),h.jsx("br",{}),"Correct"]}),h.jsxs("div",{style:{marginTop:"16px"},children:[h.jsx("strong",{style:{fontSize:"24px"},children:a}),h.jsx("br",{}),"Total"]})]}),h.jsxs("div",{style:{flex:1,paddingLeft:"32px"},children:[h.jsx("h4",{children:"Concept Mastery"}),((e==null?void 0:e.conceptMastery)||["Math","Reading","Science"].map(_=>({topic:_,percentage:0}))).slice(0,3).map(_=>h.jsxs("div",{style:{marginBottom:"12px"},children:[h.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:"4px"},children:[h.jsx("span",{style:{opacity:t?.5:1},children:_.topic}),h.jsxs("span",{style:{opacity:t?.5:1},children:[_.percentage,"%"]})]}),h.jsx("div",{style:{width:"100%",backgroundColor:"#e5e7eb",borderRadius:"4px",height:"8px"},children:h.jsx("div",{style:{width:t?"0%":`${_.percentage}%`,height:"8px",borderRadius:"4px",backgroundColor:_.percentage>=80?"#10b981":_.percentage>=70?"#eab308":"#ef4444",transition:"width 0.3s ease"}})})]},_.topic))]})]}),x=()=>h.jsxs("div",{children:[h.jsx("h4",{children:"Lesson Performance"}),h.jsx("div",{style:{display:"flex",alignItems:"end",gap:"16px",height:"200px",padding:"16px"},children:((e==null?void 0:e.lessonPerformance)||Array(8).fill(0)).slice(0,8).map((_,b)=>h.jsxs("div",{style:{flex:1,display:"flex",flexDirection:"column",alignItems:"center"},children:[h.jsx("div",{style:{width:"40px",height:t?"20px":`${Math.max(_*1.5,10)}px`,backgroundColor:t?"#e5e7eb":"#4f46e5",borderRadius:"4px",marginBottom:"8px",transition:"height 0.3s ease, background-color 0.3s ease"}}),h.jsxs("span",{style:{fontSize:"12px",opacity:t?.5:1},children:["L",b+1]})]},b))}),h.jsxs("p",{style:{textAlign:"center",color:"#6b7280",opacity:t?.5:1},children:[r,"'s performance across recent lessons"]})]});return t?h.jsx("div",{style:{backgroundColor:"white",borderRadius:"12px",boxShadow:"0 1px 3px rgba(0,0,0,0.1)",border:"1px solid #e5e7eb"},children:h.jsx("div",{style:{padding:"24px",textAlign:"center",color:"#6b7280"},children:"Loading performance data..."})}):h.jsxs("div",{style:{backgroundColor:"white",borderRadius:"12px",boxShadow:"0 1px 3px rgba(0,0,0,0.1)",border:"1px solid #e5e7eb"},children:[h.jsxs("div",{style:{padding:"24px",paddingBottom:"0"},children:[h.jsx("h2",{style:{fontSize:"24px",fontWeight:"bold",marginBottom:"24px"},children:"Performance Analytics"}),h.jsxs("div",{style:{display:"flex",borderBottom:"1px solid #e5e7eb"},children:[h.jsxs("button",{onClick:()=>s("games"),style:f(n==="games"),children:[h.jsx("div",{style:{fontSize:"24px",fontWeight:"bold"},children:i}),h.jsx("div",{style:{fontSize:"14px"},children:"Games Played"})]}),h.jsxs("button",{onClick:()=>s("accuracy"),style:f(n==="accuracy"),children:[h.jsxs("div",{style:{fontSize:"24px",fontWeight:"bold"},children:[o,"/",a]}),h.jsxs("div",{style:{fontSize:"14px"},children:["Accuracy ",d,"%"]})]}),h.jsxs("button",{onClick:()=>s("improvement"),style:f(n==="improvement"),children:[h.jsxs("div",{style:{fontSize:"24px",fontWeight:"bold"},children:["+",c,"%"]}),h.jsx("div",{style:{fontSize:"14px"},children:"Improvement"})]})]})]}),h.jsxs("div",{style:{padding:"24px"},children:[n==="games"&&m(),n==="accuracy"&&v(),n==="improvement"&&x()]})]})},LG=({game:r,roommates:e,isLoadingRoommates:t,onJoin:n})=>h.jsxs(Wt,{className:"hover:shadow-md transition-shadow",children:[h.jsx(or,{className:"pb-3",children:h.jsxs("div",{className:"flex items-center justify-between",children:[h.jsx(ws,{className:"text-lg",children:r.room_name}),h.jsxs("div",{className:"flex items-center space-x-2 text-sm text-gray-600",children:[r.audio_video_mode==="off"?h.jsx(nN,{className:"w-4 h-4"}):h.jsx(rN,{className:"w-4 h-4"}),h.jsx("span",{className:"capitalize",children:r.audio_video_mode==="off"?"Mics Off":"Audio On"})]})]})}),h.jsxs(nn,{className:"space-y-4",children:[h.jsxs("div",{className:"flex items-center space-x-2 text-sm text-gray-600",children:[h.jsx(Qi,{className:"w-4 h-4"}),h.jsx("span",{children:t?"Loading teammates...":e.length>0?`Playing with: ${e.map(s=>s.name).join(", ")}`:"You're first to join!"})]}),h.jsxs("div",{className:"flex items-center space-x-2 text-xs text-gray-500",children:[h.jsx(fu,{className:"w-3 h-3"}),h.jsxs("span",{children:["Assigned ",new Date(r.created_at).toLocaleDateString()]})]}),h.jsxs(zt,{onClick:n,className:"w-full",children:[h.jsx(rh,{className:"w-4 h-4 mr-2"}),"Join Game Room"]})]})]}),OG=({studentId:r,onJoinGame:e})=>{const{data:t,isLoading:n}=ki({queryKey:["assignedGames",r],queryFn:()=>D3(r),enabled:!!r}),s=ki({queryKey:["roommates",t==null?void 0:t.map(i=>i.room_id)],queryFn:async()=>{if(!t)return{};const i={};for(const o of t){const a=await L3(o.room_id,r);i[o.room_id]=a}return i},enabled:!!t&&t.length>0});return n?h.jsxs(Wt,{children:[h.jsx(or,{children:h.jsx(ws,{children:"Multiplayer Games"})}),h.jsxs(nn,{className:"space-y-4",children:[h.jsx(Kr,{className:"h-32 w-full"}),h.jsx(Kr,{className:"h-32 w-full"})]})]}):!t||t.length===0?h.jsxs(Wt,{children:[h.jsx(or,{children:h.jsxs(ws,{className:"flex items-center space-x-2",children:[h.jsx(Qi,{className:"w-5 h-5"}),h.jsx("span",{children:"Multiplayer Games"})]})}),h.jsx(nn,{className:"text-center py-8",children:h.jsxs("div",{className:"text-gray-500",children:[h.jsx(Qi,{className:"w-12 h-12 mx-auto mb-4 opacity-50"}),h.jsx("p",{children:"No multiplayer games assigned yet"}),h.jsx("p",{className:"text-sm",children:"Your teacher will assign group games soon!"})]})})]}):h.jsxs(Wt,{children:[h.jsx(or,{children:h.jsxs(ws,{className:"flex items-center space-x-2",children:[h.jsx(Qi,{className:"w-5 h-5"}),h.jsxs("span",{children:["Multiplayer Games (",t.length,")"]})]})}),h.jsx(nn,{className:"space-y-4",children:t.map(i=>{var o;return h.jsx(LG,{game:i,roommates:((o=s.data)==null?void 0:o[i.room_id])||[],isLoadingRoommates:s.isLoading,onJoin:()=>e(i.room_id,i.room_name)},i.id)})})]})},jG=({studentId:r})=>{const e=mh(),[t,n]=R.useState([]),[s,i]=R.useState(!0),[o,a]=R.useState(null);R.useEffect(()=>{c()},[r]);const c=async()=>{i(!0),a(null);try{const v=await(await fetch(`http://localhost:3001/api/students/${r}/lesson-assignments?status=assigned`)).json();if(v.success)n(v.assignments),console.log(`Found ${v.assignments.length} assigned question sets for student ${r}`);else throw new Error(v.error||"Failed to fetch assigned questions")}catch(m){console.error("Error fetching assigned questions:",m),a(m instanceof Error?m.message:"Failed to load assigned questions")}finally{i(!1)}},d=async m=>{console.log(" Student clicked lesson assignment:",{assignmentId:m.id,lessonTitle:m.lessonTitle,questionCount:m.questionCount,lessonId:m.lessonId,studentId:m.studentId,status:m.status,assignedAt:m.assignedAt});try{const x=await(await fetch(`http://localhost:3001/api/students/${r}/constraints?mode=assignment&assignmentId=${m.id}`)).json();if(!x.success){console.error("Assignment constraints error:",x.error);return}const{personalizedCount:_,generalCount:b,minTiles:w,maxTiles:S}=x;if(console.log(" Assignment constraints:",{personalizedCount:_,generalCount:b,minTiles:w,maxTiles:S}),_+b===0){console.warn("No approved questions available for this assignment");return}e(`/play/student/${r}/assignment/${m.id}`,{state:{assignmentData:{...m,constraints:{personalizedCount:_,generalCount:b,minTiles:w,maxTiles:S}}}})}catch(v){console.error("Error checking assignment constraints:",v)}},f=m=>new Date(m).toLocaleDateString("en-US",{month:"short",day:"numeric"});return s?h.jsx("div",{className:"space-y-4",children:[1,2].map(m=>h.jsx(Wt,{className:"animate-pulse",children:h.jsx(nn,{className:"p-4",children:h.jsxs("div",{className:"space-y-3",children:[h.jsx("div",{className:"h-4 bg-gray-200 rounded w-3/4"}),h.jsx("div",{className:"h-3 bg-gray-200 rounded w-1/2"}),h.jsx("div",{className:"h-8 bg-gray-200 rounded w-24"})]})})},m))}):o?h.jsx(Wt,{className:"border-red-200",children:h.jsxs(nn,{className:"p-6 text-center",children:[h.jsx(Hs,{className:"w-8 h-8 mx-auto mb-3 text-red-500"}),h.jsx("h3",{className:"font-medium text-red-800 mb-2",children:"Unable to Load Questions"}),h.jsx("p",{className:"text-sm text-red-600 mb-4",children:o}),h.jsxs("button",{onClick:c,className:"inline-flex items-center space-x-2 px-3 py-2 border border-red-300 rounded-md text-sm text-red-700 hover:bg-red-50",children:[h.jsx(Yd,{className:"w-4 h-4"}),h.jsx("span",{children:"Try Again"})]})]})}):t.length===0?h.jsx(Wt,{className:"border-dashed border-gray-300",children:h.jsxs(nn,{className:"p-8 text-center",children:[h.jsx("h3",{className:"font-medium text-gray-900 mb-2",children:"No Questions Available"}),h.jsx("p",{className:"text-sm text-gray-600",children:"Your teacher will assign personalized questions for you to practice."}),h.jsx("p",{className:"text-xs text-gray-500 mt-2",children:'Questions need to be marked as "assigned" to appear here.'})]})}):h.jsxs("div",{className:"space-y-4",children:[t.map(m=>h.jsx(Wt,{className:"hover:shadow-md transition-shadow cursor-pointer border-green-200 hover:border-green-300 hover:bg-green-50",onClick:()=>d(m),children:h.jsx(nn,{className:"p-4",children:h.jsxs("div",{className:"flex items-center justify-between",children:[h.jsxs("div",{className:"flex-1",children:[h.jsxs("div",{className:"flex items-center space-x-3 mb-2",children:[h.jsxs("div",{className:"flex items-center space-x-2",children:[h.jsx(Sp,{className:"w-4 h-4 text-green-600"}),h.jsx("h3",{className:"font-semibold text-gray-900",children:m.lessonTitle})]}),h.jsx(Bs,{className:"bg-green-100 text-green-800 border-green-300",children:"Ready to Play"})]}),h.jsxs("div",{className:"space-y-1 text-sm text-gray-600",children:[h.jsx("div",{className:"flex items-center space-x-4",children:h.jsx("span",{className:"flex items-center space-x-1",children:h.jsxs("span",{children:[m.questionCount," personalized questions"]})})}),m.assignedAt&&h.jsxs("div",{className:"flex items-center space-x-1",children:[h.jsx(T_,{className:"w-3 h-3"}),h.jsxs("span",{children:["Assigned ",f(m.assignedAt)]})]})]})]}),h.jsx("div",{className:"flex items-center space-x-2",children:h.jsx("div",{className:"w-10 h-10 bg-green-100 rounded-full flex items-center justify-center hover:bg-green-200 transition-colors",children:h.jsx(rh,{className:"w-5 h-5 text-green-600"})})})]})})},m.id)),t.length>0&&h.jsx("div",{className:"bg-green-50 border border-green-200 rounded-lg p-3",children:h.jsxs("div",{className:"text-sm text-green-800",children:[h.jsxs("span",{className:"font-medium",children:[t.length," question set",t.length!==1?"s":""," ready to play!"]}),h.jsx("div",{className:"text-xs text-green-700 mt-1",children:"Click any card to start your personalized quiz"})]})})]})},FG=()=>{const{studentId:r}=gh(),e=r?parseInt(r,10):void 0,t=mh(),{lessons:n}=IG();e&&n[String(e)];const{data:s,isLoading:i}=ki({queryKey:["student",e],queryFn:()=>L_(e),enabled:!!e}),{data:o,isLoading:a}=kG(e||0),c=(d,f)=>{t(`/play/multiplayer/${d}/${e}`),console.log(`Joining room ${d}: ${f}`)};return i?h.jsxs("div",{className:"p-8 space-y-4",children:[h.jsx(Kr,{className:"h-8 w-48"}),h.jsx(Kr,{className:"h-6 w-1/4"}),h.jsx(Wt,{children:h.jsx(nn,{children:h.jsx(Kr,{className:"h-64 w-full"})})})]}):s?h.jsx("div",{className:"min-h-screen",style:{background:"linear-gradient(135deg, #FFFACD 0%, #FFF8DC 50%, #FFFFE0 100%)",fontFamily:"Sassoon, Comic Sans MS, cursive"},children:h.jsxs("div",{className:"p-8 max-w-6xl mx-auto",children:[h.jsx("header",{className:"mb-8",children:h.jsx("div",{className:"p-6 rounded-2xl shadow-lg mb-6",style:{backgroundColor:"rgba(255, 255, 255, 0.85)",backdropFilter:"blur(10px)",border:"2px solid rgba(218, 165, 32, 0.3)"},children:h.jsxs("div",{className:"flex justify-between items-center",children:[h.jsxs("div",{children:[h.jsxs("h1",{className:"text-4xl font-bold tracking-tight mb-2",style:{color:"#DA70D6"},children:["Welcome, ",s.name,"!"]}),h.jsx("p",{className:"text-lg",style:{color:"#8B4B8B"},children:"Ready to play, learn, and track your progress?"})]}),e&&h.jsx(qa,{to:`/play/student/${e}/lesson/1`,children:h.jsxs(zt,{size:"lg",style:{backgroundColor:"#DAA520",color:"white",borderRadius:"12px",fontFamily:"Sassoon, Comic Sans MS, cursive",padding:"12px 24px",fontSize:"16px",fontWeight:"600",border:"none",boxShadow:"0 4px 6px rgba(218, 165, 32, 0.3)",transition:"all 0.2s"},onMouseEnter:d=>{d.currentTarget.style.backgroundColor="#FFD700",d.currentTarget.style.transform="translateY(-2px)",d.currentTarget.style.boxShadow="0 6px 8px rgba(218, 165, 32, 0.4)"},onMouseLeave:d=>{d.currentTarget.style.backgroundColor="#DAA520",d.currentTarget.style.transform="translateY(0)",d.currentTarget.style.boxShadow="0 4px 6px rgba(218, 165, 32, 0.3)"},children:[h.jsx(rh,{className:"mr-2",style:{width:"20px",height:"20px"}}),"Solo Play"]})})]})})}),h.jsxs("main",{className:"space-y-8",children:[h.jsxs("section",{children:[h.jsxs("div",{className:"flex items-center space-x-2 mb-4",style:{color:"#DA70D6"},children:[h.jsx(za,{className:"w-6 h-6"}),h.jsx("h2",{className:"text-2xl font-bold",children:"Solo Lessons"})]}),h.jsx("div",{className:"space-y-6",children:e&&h.jsxs("div",{children:[h.jsx("h3",{className:"text-lg font-semibold mb-3",style:{color:"#8B4B8B"},children:"Personalized Questions"}),h.jsx("div",{className:"rounded-2xl shadow-lg overflow-hidden",style:{backgroundColor:"rgba(255, 255, 255, 0.85)",backdropFilter:"blur(10px)",border:"2px solid rgba(218, 165, 32, 0.3)"},children:h.jsx(jG,{studentId:e})})]})})]}),h.jsx("div",{style:{height:"2px",background:"linear-gradient(90deg, transparent, rgba(218, 165, 32, 0.3), transparent)",margin:"32px 0"}}),h.jsxs("section",{children:[h.jsxs("div",{className:"flex items-center space-x-2 mb-4",style:{color:"#DA70D6"},children:[h.jsx(rh,{className:"w-6 h-6"}),h.jsx("h2",{className:"text-2xl font-bold",children:"Team Games"})]}),h.jsx("div",{className:"rounded-2xl shadow-lg overflow-hidden",style:{backgroundColor:"rgba(255, 255, 255, 0.85)",backdropFilter:"blur(10px)",border:"2px solid rgba(218, 165, 32, 0.3)"},children:e&&h.jsx(OG,{studentId:e,onJoinGame:c})})]}),h.jsx("div",{style:{height:"2px",background:"linear-gradient(90deg, transparent, rgba(218, 165, 32, 0.3), transparent)",margin:"32px 0"}}),h.jsxs("section",{children:[h.jsxs("div",{className:"flex items-center space-x-2 mb-4",style:{color:"#DA70D6"},children:[h.jsx(iN,{className:"w-6 h-6"}),h.jsx("h2",{className:"text-2xl font-bold",children:"Your Progress"})]}),h.jsx("div",{className:"rounded-2xl shadow-lg overflow-hidden",style:{backgroundColor:"rgba(255, 255, 255, 0.85)",backdropFilter:"blur(10px)",border:"2px solid rgba(218, 165, 32, 0.3)"},children:h.jsx(DG,{studentName:s.name,data:o,isLoading:a})})]}),h.jsx("div",{className:"text-center mt-12 pb-8",children:h.jsxs("div",{className:"inline-flex space-x-2",children:[h.jsx("div",{className:"w-3 h-3 rounded-full",style:{backgroundColor:"#DAA520"}}),h.jsx("div",{className:"w-3 h-3 rounded-full",style:{backgroundColor:"#DA70D6"}}),h.jsx("div",{className:"w-3 h-3 rounded-full",style:{backgroundColor:"#DAA520"}})]})})]})]})}):h.jsx(gu,{})},UG=({assignmentMode:r,setAssignmentMode:e,audioVideoMode:t,setAudioVideoMode:n,numRooms:s,setNumRooms:i,studentsPerRoom:o,setStudentsPerRoom:a,autoAssignmentNote:c,autoPopulateRooms:d,lastInputType:f,totalStudents:m})=>{const v=x=>{e(x)};return h.jsxs("div",{className:"bg-white rounded-xl shadow-sm mb-8 p-6",children:[h.jsx("h2",{className:"text-xl font-bold text-gray-800 mb-4",children:"Game Configuration"}),h.jsxs("div",{className:"mb-6",children:[h.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-3",children:"Assignment Method"}),h.jsxs("div",{className:"flex space-x-4",children:[h.jsxs("button",{onClick:()=>v("auto"),className:`px-4 py-2 rounded-lg flex items-center space-x-2 transition-colors ${r==="auto"?"bg-indigo-600 text-white":"bg-gray-200 text-gray-700 hover:bg-gray-300"}`,children:[h.jsx(l5,{className:"w-4 h-4"}),h.jsx("span",{children:"Auto Populate"})]}),h.jsxs("button",{onClick:()=>v("manual"),className:`px-4 py-2 rounded-lg flex items-center space-x-2 transition-colors ${r==="manual"?"bg-indigo-600 text-white":"bg-gray-200 text-gray-700 hover:bg-gray-300"}`,children:[h.jsx(Qi,{className:"w-4 h-4"}),h.jsx("span",{children:"Manual Assignment"})]})]})]}),h.jsxs("div",{className:"mb-6",children:[h.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-3",children:"Audio/Video Settings (Default)"}),h.jsx("div",{className:"flex space-x-4",children:[{value:"off",label:"Off",desc:"Auto-transcription starts when someone unmutes"},{value:"audio-only",label:"Audio Only",desc:"Mics on, cameras optional"}].map(x=>h.jsxs("label",{className:"flex items-center space-x-2 cursor-pointer",children:[h.jsx("input",{type:"radio",value:x.value,checked:t===x.value,onChange:_=>n(_.target.value),className:"text-indigo-600"}),h.jsxs("div",{children:[h.jsx("span",{className:"font-medium",children:x.label}),h.jsx("p",{className:"text-xs text-gray-600",children:x.desc})]})]},x.value))})]}),r==="auto"&&h.jsxs("div",{className:"mb-6",children:[h.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-3",children:"Auto Assignment Controls"}),h.jsxs("div",{className:"flex items-center space-x-6",children:[h.jsxs("div",{className:"flex items-center space-x-2",children:[h.jsx("label",{className:"text-sm font-medium",children:"Number of Rooms:"}),h.jsx("select",{value:s,onChange:x=>{const _=parseInt(x.target.value);i(_),d(_,void 0,"rooms")},className:"border border-gray-300 rounded px-2 py-1 text-sm",children:[2,3,4,5,6,7,8].map(x=>h.jsx("option",{value:x,children:x},x))})]}),h.jsxs("div",{className:"flex items-center space-x-2",children:[h.jsx("label",{className:"text-sm font-medium",children:"Students per Room:"}),h.jsx("select",{value:o,onChange:x=>{const _=parseInt(x.target.value);a(_),d(void 0,_,"students")},className:"border border-gray-300 rounded px-2 py-1 text-sm",children:Array.from({length:Math.min(10,m)},(x,_)=>_+1).map(x=>h.jsx("option",{value:x,children:x},x))})]}),h.jsx("button",{onClick:()=>d(s,o,f),className:"bg-green-600 text-white px-3 py-1 rounded text-sm hover:bg-green-700 transition-colors",children:"Shuffle Again"})]}),c&&h.jsxs("div",{className:"mt-2 p-2 bg-yellow-50 border border-yellow-200 rounded text-sm text-yellow-800",children:[h.jsx("strong",{children:"Note:"})," ",c]})]})]})},BG=({rooms:r,setRooms:e,assignmentMode:t,selectedStudents:n,studentAssignments:s,setStudentAssignments:i,setSelectedStudents:o,roomColors:a,usedColors:c,setUsedColors:d})=>{const f=()=>{let _=0;for(;c.has(_)&&_<a.length;)_++;_>=a.length&&(_=r.length%a.length);const b={id:`room-${r.length+1}`,name:`Room ${r.length+1}`,color:a[_],students:[]};e([...r,b]),d(new Set([...c,_]))},m=_=>{const b=r[_],w={...s};b.students.forEach(C=>{delete w[C.id]});const S=a.findIndex(C=>C===b.color);e(r.filter((C,T)=>T!==_)),i(w),d(C=>{const T=new Set(C);return T.delete(S),T})},v=_=>{if(n.length===0)return;const b=[...r],w={...s};n.forEach(S=>{const C=w[S.id];C!==void 0&&(b[C].students=b[C].students.filter(T=>T.id!==S.id))}),n.forEach(S=>{b[_].students.push(S),w[S.id]=_}),e(b),i(w),o([])},x=(_,b)=>{const w=[...r];w[_].name=b,e(w)};return h.jsxs("div",{className:"bg-white rounded-xl shadow-sm p-6",children:[h.jsxs("div",{className:"flex items-center justify-between mb-4",children:[h.jsxs("h3",{className:"text-lg font-bold text-gray-800",children:["Game Rooms (",r.length,")"]}),t==="manual"&&h.jsxs("button",{onClick:f,className:"bg-indigo-600 text-white px-3 py-1 rounded text-sm hover:bg-indigo-700 transition-colors flex items-center space-x-1",children:[h.jsx(sN,{className:"w-4 h-4"}),h.jsx("span",{children:"Add Room"})]})]}),h.jsx("div",{className:"space-y-4 max-h-96 overflow-y-auto",children:r.map((_,b)=>h.jsxs("div",{className:`border-2 rounded-lg p-4 ${_.color} cursor-pointer hover:opacity-80 transition-opacity`,onClick:()=>t==="manual"&&v(b),children:[h.jsxs("div",{className:"flex items-center justify-between mb-2",children:[h.jsx("input",{type:"text",value:_.name,onChange:w=>x(b,w.target.value),className:"font-medium bg-transparent border-none outline-none text-lg",onClick:w=>w.stopPropagation()}),h.jsxs("div",{className:"flex items-center space-x-2",children:[h.jsxs("span",{className:"text-sm",children:["(",_.students.length," students)"]}),t==="manual"&&r.length>1&&h.jsx("button",{onClick:w=>{w.stopPropagation(),m(b)},className:"text-red-500 hover:text-red-700 text-xs",children:"Remove"})]})]}),h.jsx("div",{className:"flex flex-wrap gap-1",children:_.students.map(w=>h.jsx("span",{className:"inline-block bg-white bg-opacity-50 px-2 py-1 rounded text-xs",children:w.name},w.id))}),t==="manual"&&n.length>0&&h.jsxs("div",{className:"mt-2 text-xs opacity-75",children:["Click to assign ",n.length," selected student",n.length>1?"s":""]})]},_.id))})]})},zG=({students:r,selectedStudents:e,setSelectedStudents:t,studentAssignments:n,setStudentAssignments:s,assignmentMode:i,rooms:o,setRooms:a})=>{const c=m=>{t(v=>v.some(_=>_.id===m.id)?v.filter(_=>_.id!==m.id):[...v,m])},d=()=>{if(e.length===0)return;const m=[...o],v={...n};e.forEach(x=>{const _=v[x.id];_!==void 0&&(m[_].students=m[_].students.filter(b=>b.id!==x.id),delete v[x.id])}),a(m),s(v),t([])},f=m=>{var b;const v=n[m.id],x=e.some(w=>w.id===m.id);let _="p-3 rounded-lg border-2 cursor-pointer transition-all duration-200 ";return x&&(_+="ring-2 ring-blue-500 "),v!==void 0?_+=((b=o[v])==null?void 0:b.color)||"bg-gray-100 border-gray-300":_+="bg-white border-gray-300 hover:border-gray-400",_};return h.jsxs("div",{className:"bg-white rounded-xl shadow-sm p-6",children:[h.jsxs("div",{className:"flex items-center justify-between mb-4",children:[h.jsxs("h3",{className:"text-lg font-bold text-gray-800",children:["Students (",r.length,")"]}),i==="manual"&&e.length>0&&h.jsxs("div",{className:"flex space-x-2",children:[h.jsxs("span",{className:"text-sm text-gray-600",children:[e.length," selected"]}),h.jsx("button",{onClick:d,className:"bg-red-600 text-white px-2 py-1 rounded text-xs hover:bg-red-700 transition-colors",children:"Unassign"}),h.jsx("button",{onClick:()=>t([]),className:"bg-gray-600 text-white px-2 py-1 rounded text-xs hover:bg-gray-700 transition-colors",children:"Clear"})]})]}),r.length===0?h.jsx("div",{className:"text-center py-8 text-gray-500",children:h.jsx("p",{children:"No students found"})}):h.jsx("div",{className:"grid grid-cols-2 gap-3 max-h-96 overflow-y-auto",children:r.map(m=>{var v;return h.jsxs("div",{className:f(m),onClick:()=>i==="manual"&&c(m),children:[h.jsx("div",{className:"font-medium text-sm",children:m.name}),h.jsx("div",{className:"text-xs text-gray-600",children:m.email}),n[m.id]!==void 0&&h.jsx("div",{className:"text-xs mt-1 font-medium",children:(v=o[n[m.id]])==null?void 0:v.name})]},m.id)})}),i==="manual"&&r.length>0&&h.jsxs("div",{className:"mt-4 p-3 bg-blue-50 rounded-lg text-sm text-blue-800",children:[h.jsx("strong",{children:"Manual Assignment Instructions:"}),h.jsxs("ul",{className:"mt-1 space-y-1 text-xs",children:[h.jsx("li",{children:" Click students to select/deselect them"}),h.jsx("li",{children:" Click a room to assign selected students"}),h.jsx("li",{children:' Use "Unassign" to remove students from rooms'}),h.jsx("li",{children:" Students change color based on room assignment"})]})]})]})},VG=({totalStudents:r,assignedStudents:e,audioVideoMode:t,totalRooms:n})=>{const s=r-e,i=s===0&&r>0;return h.jsxs("div",{className:"mt-8 bg-white rounded-xl shadow-sm p-6",children:[h.jsx("h3",{className:"text-lg font-bold text-gray-800 mb-4",children:"Session Summary"}),h.jsxs("div",{className:"grid md:grid-cols-4 gap-4 text-sm",children:[h.jsxs("div",{className:"flex flex-col",children:[h.jsx("span",{className:"font-medium text-gray-600",children:"Total Students"}),h.jsx("span",{className:"text-2xl font-bold text-gray-800",children:r})]}),h.jsxs("div",{className:"flex flex-col",children:[h.jsx("span",{className:"font-medium text-gray-600",children:"Assigned Students"}),h.jsx("span",{className:`text-2xl font-bold ${i?"text-green-600":"text-blue-600"}`,children:e})]}),h.jsxs("div",{className:"flex flex-col",children:[h.jsx("span",{className:"font-medium text-gray-600",children:"Unassigned Students"}),h.jsx("span",{className:`text-2xl font-bold ${s>0?"text-orange-600":"text-green-600"}`,children:s})]}),h.jsxs("div",{className:"flex flex-col",children:[h.jsx("span",{className:"font-medium text-gray-600",children:"Total Rooms"}),h.jsx("span",{className:"text-2xl font-bold text-purple-600",children:n})]})]}),h.jsx("div",{className:"mt-4 pt-4 border-t border-gray-200",children:h.jsxs("div",{className:"flex items-center justify-between text-sm",children:[h.jsx("div",{className:"flex items-center space-x-4",children:h.jsxs("span",{className:"text-gray-600",children:[h.jsx("strong",{children:"Audio/Video:"})," ",t==="off"?"Off (Auto-transcription when unmuted)":"Audio Only"]})}),i&&h.jsxs("div",{className:"flex items-center space-x-2 text-green-600",children:[h.jsx("div",{className:"w-2 h-2 bg-green-600 rounded-full"}),h.jsx("span",{className:"font-medium",children:"Ready to start games!"})]}),s>0&&h.jsxs("div",{className:"flex items-center space-x-2 text-orange-600",children:[h.jsx("div",{className:"w-2 h-2 bg-orange-600 rounded-full"}),h.jsxs("span",{className:"font-medium",children:[s," student",s>1?"s":""," need assignment"]})]})]})})]})},dx=["bg-blue-100 border-blue-300 text-blue-800","bg-green-100 border-green-300 text-green-800","bg-purple-100 border-purple-300 text-purple-800","bg-orange-100 border-orange-300 text-orange-800","bg-pink-100 border-pink-300 text-pink-800","bg-yellow-100 border-yellow-300 text-yellow-800","bg-indigo-100 border-indigo-300 text-indigo-800","bg-red-100 border-red-300 text-red-800"],HG=({students:r=[],conceptSummary:e="",onCreateRooms:t,onBack:n})=>{const[s,i]=R.useState("auto"),[o,a]=R.useState("off"),[c,d]=R.useState([]),[f,m]=R.useState({}),[v,x]=R.useState([]),[_,b]=R.useState(3),[w,S]=R.useState(Math.ceil(r.length/3)),[C,T]=R.useState("rooms"),[A,k]=R.useState(""),[j,D]=R.useState(new Set),L=(O=null,I=null,B="rooms")=>{T(B);let W,K,ee="";B==="rooms"?(W=O||_,K=Math.ceil(r.length/W),I&&K!==I&&(ee=`Adjusted to ${K} students per room to accommodate ${W} rooms with ${r.length} total students.`),S(K)):(K=I||w,W=Math.ceil(r.length/K),O&&W!==O&&(ee=`Adjusted to ${W} rooms to accommodate ${K} students per room with ${r.length} total students.`),b(W)),k(ee);const oe=[...r].sort(()=>Math.random()-.5),ne=Array.from({length:W},(V,q)=>({id:`room-${q+1}`,name:`Room ${q+1}`,color:dx[q%dx.length],students:[]})),ce={};oe.forEach((V,q)=>{const Z=Math.floor(q/K);Z<W&&(ne[Z].students.push(V),ce[V.id]=Z)}),D(new Set(ne.map((V,q)=>q%dx.length))),d(ne),m(ce)};return R.useEffect(()=>{if(s==="auto"&&r.length>0&&c.length===0){const O=Math.ceil(r.length/_);S(O),L(_,O,"rooms")}},[r.length,s,c.length]),h.jsxs("div",{className:"min-h-screen bg-gray-50",children:[h.jsx("div",{className:"bg-white shadow-sm border-b",children:h.jsx("div",{className:"max-w-7xl mx-auto px-6 py-4",children:h.jsxs("div",{className:"flex items-center justify-between",children:[h.jsxs("div",{className:"flex items-center space-x-4",children:[h.jsx("button",{onClick:n,className:"text-gray-500 hover:text-gray-700 transition-colors flex items-center space-x-2"}),h.jsx("h1",{className:"text-2xl font-bold text-gray-800",children:"Create Game Rooms"})]}),h.jsxs("button",{onClick:()=>t({rooms:c,audioVideoMode:o,conceptSummary:e}),className:"bg-indigo-600 text-white px-4 py-2 rounded-lg hover:bg-indigo-700 transition-colors flex items-center space-x-2",children:[h.jsx(rh,{className:"w-4 h-4"}),h.jsx("span",{children:"Start Games"})]})]})})}),h.jsxs("div",{className:"max-w-7xl mx-auto px-6 py-8",children:[h.jsx(UG,{assignmentMode:s,setAssignmentMode:i,audioVideoMode:o,setAudioVideoMode:a,numRooms:_,setNumRooms:b,studentsPerRoom:w,setStudentsPerRoom:S,autoAssignmentNote:A,autoPopulateRooms:L,lastInputType:C,totalStudents:r.length}),h.jsxs("div",{className:"grid lg:grid-cols-2 gap-8",children:[h.jsx(BG,{rooms:c,setRooms:d,assignmentMode:s,selectedStudents:v,studentAssignments:f,setStudentAssignments:m,setSelectedStudents:x,roomColors:dx,usedColors:j,setUsedColors:D}),h.jsx(zG,{students:r,selectedStudents:v,setSelectedStudents:x,studentAssignments:f,setStudentAssignments:m,assignmentMode:s,rooms:c,setRooms:d})]}),h.jsx(VG,{totalStudents:r.length,assignedStudents:Object.keys(f).length,audioVideoMode:o,totalRooms:c.length})]})]})},GG=()=>{const{classId:r}=gh(),{data:e,isLoading:t}=ki({queryKey:["classRoster",r],queryFn:()=>k3(r),enabled:!!r}),n=i=>{Yr.success(`Starting games for ${i.rooms.length} rooms!`),console.log("Game rooms created:",i)},s=()=>{};return r?t?h.jsxs("div",{className:"p-8 space-y-4",children:[h.jsx(Kr,{className:"h-8 w-48"}),h.jsx(Kr,{className:"h-64 w-full"}),h.jsx(Kr,{className:"h-96 w-full"})]}):e?h.jsxs("div",{className:"p-8",children:[h.jsxs(qa,{to:`/class/${r}`,className:"inline-flex items-center gap-2 text-muted-foreground hover:text-foreground mb-4",children:[h.jsx(em,{className:"h-4 w-4"}),"Back to Class Roster"]}),h.jsx(HG,{students:e,onCreateRooms:n,onBack:s})]}):h.jsx(gu,{}):h.jsx(gu,{})},O1=()=>{var ce;const{studentId:r,lessonNumber:e,questionSetId:t,assignmentId:n}=gh(),s=mh(),i=rc(),o=R.useRef(null),a=R.useRef(null),[c,d]=R.useState(!1),[f,m]=R.useState(0),v=R.useRef([]),[x,_]=R.useState(null),[b,w]=R.useState(!0),[S,C]=R.useState(null),T=!!t,A=!!n,k=(ce=i.state)==null?void 0:ce.assignmentData,D=A&&k?{title:k.lessonTitle,subtitle:"Assignment Questions",color:"#9333ea"}:T?{title:"AI Questions",subtitle:"Personalized Practice",color:"#9333ea"}:{title:`Lesson ${e}`,subtitle:"Solo Practice",color:"#DAA520"};R.useEffect(()=>{r&&(async()=>{try{w(!0),C(null);let q;A&&n?q=`mode=assignment&assignmentId=${n}`:T&&t?q=`mode=questionset&setId=${t}`:q="mode=solo",console.log(`Fetching constraints: /api/students/${r}/constraints?${q}`);const X=await(await fetch(`http://localhost:3001/api/students/${r}/constraints?${q}`)).json();if(X.success)_(X),console.log("Constraints loaded:",X);else throw new Error(X.error||"Failed to fetch constraints")}catch(q){console.error("Error fetching constraints:",q),C(q.message),Yr.error("Failed to load path constraints. Using fallback limits."),_({minTiles:15,maxTiles:120,minQuestions:3,maxQuestions:24,personalizedCount:0,generalCount:0,mode:"fallback"})}finally{w(!1)}})()},[r,n,t,A,T]),R.useEffect(()=>{const V=o.current;if(!V)return;V.width=800,V.height=600;const q=V.getContext("2d");q&&(q.fillStyle="#f0f0f0",q.fillRect(0,0,V.width,V.height),q.lineCap="round",q.strokeStyle=D.color,q.lineWidth=5,a.current=q,Yr.info("Canvas ready. Draw the path!"))},[D.color]);const L=({nativeEvent:V})=>{const{offsetX:q,offsetY:Z}=V;a.current&&(v.current=[{x:q,y:Z}],m(1),a.current.beginPath(),a.current.moveTo(q,Z),d(!0))},O=()=>{a.current&&(a.current.closePath(),d(!1))},I=({nativeEvent:V})=>{if(!c||!a.current)return;const{offsetX:q,offsetY:Z}=V,X=v.current[v.current.length-1];X&&Math.sqrt(Math.pow(q-X.x,2)+Math.pow(Z-X.y,2))>15&&(v.current.push({x:q,y:Z}),m(v.current.length)),a.current.lineTo(q,Z),a.current.stroke()},W=b?{isValid:!1,message:"Loading path constraints...",color:"text-gray-500"}:S?{isValid:!1,message:`Error loading constraints: ${S}`,color:"text-red-500"}:x?f<x.minTiles?{isValid:!1,message:`Path too short. Need at least ${x.minTiles} tiles for your questions (you have ${f})`,color:"text-red-500"}:f>x.maxTiles?{isValid:!1,message:`Path too long. Maximum ${x.maxTiles} tiles for your questions (you have ${f})`,color:"text-red-500"}:{isValid:!0,message:`Perfect! ${f} tiles fits your question set (${x.minQuestions}-${x.maxQuestions} questions)`,color:"text-green-500"}:{isValid:!1,message:"Unable to load path constraints",color:"text-red-500"},K=()=>{if(!W.isValid){Yr.error(W.message);return}const V=o.current;if(!V)return;const q=V.toDataURL("image/png");console.log("Path confirmed with",v.current.length,"points."),Yr.success("Path confirmed! Entering game..."),A&&n?s(`/play/student/${r}/assignment/${n}/game`,{state:{pathImage:q,pathPoints:v.current,isAssignment:!0,assignmentId:n,assignmentData:k}}):T?s(`/play/student/${r}/ai-questions/${t}/game`,{state:{pathImage:q,pathPoints:v.current,isAIQuestions:!0,questionSetId:t}}):s(`/play/student/${r}/lesson/${e}/game`,{state:{pathImage:q,pathPoints:v.current}})},ee=()=>{const V=o.current,q=a.current;!V||!q||(q.clearRect(0,0,V.width,V.height),q.fillStyle="#f0f0f0",q.fillRect(0,0,V.width,V.height),v.current=[],m(0),Yr.info("Canvas cleared."))},oe=()=>A?`/dashboard/student/${r}`:`/dashboard/student/${r}`,ne=()=>{if(!x)return"Question Set";switch(x.mode){case"assignment":return"Your Assignment";case"questionset":return"Your Question Set";case"solo":return"Available Questions";case"fallback":return"Default Limits (Error Loading)";default:return"Question Set"}};return h.jsxs("div",{className:"min-h-screen p-4 md:p-8 flex flex-col items-center",style:{background:"linear-gradient(135deg, #FFFACD 0%, #FFF8DC 50%, #FFFFE0 100%)",fontFamily:"Sassoon, Comic Sans MS, cursive"},children:[h.jsxs("div",{className:"w-full max-w-[800px] mb-4",children:[h.jsxs(qa,{to:oe(),className:"inline-flex items-center gap-2 mb-4",style:{color:"#8B4B8B",textDecoration:"none",transition:"color 0.2s"},onMouseEnter:V=>V.currentTarget.style.color="#DA70D6",onMouseLeave:V=>V.currentTarget.style.color="#8B4B8B",children:[h.jsx(em,{className:"h-4 w-4"}),"Back to Dashboard"]}),h.jsx("div",{className:"p-6 rounded-2xl shadow-lg mb-4",style:{backgroundColor:"rgba(255, 255, 255, 0.85)",backdropFilter:"blur(10px)",border:"2px solid rgba(218, 165, 32, 0.3)"},children:h.jsxs("div",{className:"flex justify-between items-center",children:[h.jsxs("div",{children:[h.jsxs("h1",{className:"text-2xl font-bold flex items-center mb-1",style:{color:"#DA70D6"},children:[D.title,": Draw the Path"]}),h.jsx("p",{style:{color:"#8B4B8B"},className:"text-base mb-2",children:D.subtitle}),h.jsx("p",{className:"text-sm font-medium",style:{color:W.isValid?"#28a745":W.color==="text-gray-500"?"#6c757d":"#dc3545"},children:W.message})]}),h.jsxs("div",{className:"flex items-center gap-2",children:[h.jsxs(zt,{variant:"outline",onClick:ee,style:{backgroundColor:"white",color:"#8B4B8B",border:"2px solid #DAA520",borderRadius:"12px",fontFamily:"Sassoon, Comic Sans MS, cursive",padding:"8px 16px",fontSize:"14px",fontWeight:"600",transition:"all 0.2s"},onMouseEnter:V=>{V.currentTarget.style.backgroundColor="#FFF8DC",V.currentTarget.style.borderColor="#FFD700"},onMouseLeave:V=>{V.currentTarget.style.backgroundColor="white",V.currentTarget.style.borderColor="#DAA520"},children:[h.jsx(ZO,{style:{marginRight:"6px",width:"16px",height:"16px"}}),"Clear"]}),h.jsx(zt,{onClick:K,disabled:!W.isValid||b,style:{backgroundColor:W.isValid&&!b?"#DAA520":"#d3d3d3",color:"white",borderRadius:"12px",fontFamily:"Sassoon, Comic Sans MS, cursive",padding:"8px 16px",fontSize:"14px",fontWeight:"600",border:"none",boxShadow:W.isValid&&!b?"0 4px 6px rgba(218, 165, 32, 0.3)":"none",transition:"all 0.2s",cursor:W.isValid&&!b?"pointer":"not-allowed"},onMouseEnter:V=>{W.isValid&&!b&&(V.currentTarget.style.backgroundColor="#FFD700",V.currentTarget.style.transform="translateY(-2px)",V.currentTarget.style.boxShadow="0 6px 8px rgba(218, 165, 32, 0.4)")},onMouseLeave:V=>{W.isValid&&!b&&(V.currentTarget.style.backgroundColor="#DAA520",V.currentTarget.style.transform="translateY(0)",V.currentTarget.style.boxShadow="0 4px 6px rgba(218, 165, 32, 0.3)")},children:b?h.jsxs(h.Fragment,{children:[h.jsx(Xl,{className:"w-4 h-4 animate-spin",style:{marginRight:"6px"}}),"Loading..."]}):h.jsxs(h.Fragment,{children:[h.jsx(t0,{style:{marginRight:"6px",width:"16px",height:"16px"}}),"Confirm Path"]})})]})]})}),x&&!b&&h.jsx(Wt,{className:"mb-4",style:{backgroundColor:S?"rgba(255, 243, 205, 0.85)":"rgba(248, 235, 255, 0.85)",backdropFilter:"blur(10px)",border:S?"2px solid rgba(255, 193, 7, 0.4)":"2px solid rgba(218, 112, 214, 0.4)",borderRadius:"16px",boxShadow:"0 4px 6px rgba(0, 0, 0, 0.1)"},children:h.jsxs(nn,{className:"p-4",style:{fontFamily:"Sassoon, Comic Sans MS, cursive"},children:[h.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[h.jsx(n5,{className:"w-4 h-4",style:{color:S?"#ff9800":"#DA70D6"}}),h.jsx("h3",{className:"font-medium",style:{color:S?"#e65100":"#8B4B8B"},children:ne()})]}),h.jsxs("div",{className:"text-sm space-y-1",style:{color:S?"#e65100":"#8B4B8B"},children:[h.jsxs("div",{className:"flex justify-between",children:[h.jsx("span",{children:"Your questions:"}),h.jsx(Bs,{variant:"outline",style:{backgroundColor:"white",border:"1px solid #DAA520",color:"#8B4B8B",borderRadius:"8px",padding:"2px 8px"},children:x.personalizedCount||0})]}),h.jsxs("div",{className:"flex justify-between",children:[h.jsx("span",{children:"General questions available:"}),h.jsx(Bs,{variant:"outline",style:{backgroundColor:"white",border:"1px solid #DAA520",color:"#8B4B8B",borderRadius:"8px",padding:"2px 8px"},children:x.generalCount||0})]}),h.jsxs("div",{className:"flex justify-between",children:[h.jsx("span",{children:"Question range:"}),h.jsxs("span",{children:[x.minQuestions," - ",x.maxQuestions," questions"]})]}),h.jsxs("div",{className:"flex justify-between font-medium",children:[h.jsx("span",{children:"Path length needed:"}),h.jsxs("span",{children:[x.minTiles," - ",x.maxTiles," tiles"]})]}),x.mode==="fallback"&&h.jsx("div",{className:"text-xs mt-2",style:{color:"#ff9800"},children:"Using fallback limits due to error loading dynamic constraints"})]})]})}),b&&h.jsx(Wt,{className:"mb-4",style:{backgroundColor:"rgba(245, 245, 245, 0.85)",backdropFilter:"blur(10px)",border:"2px solid rgba(200, 200, 200, 0.4)",borderRadius:"16px",boxShadow:"0 4px 6px rgba(0, 0, 0, 0.1)"},children:h.jsx(nn,{className:"p-4",children:h.jsxs("div",{className:"flex items-center space-x-2",children:[h.jsx(Xl,{className:"w-4 h-4 animate-spin",style:{color:"#8B4B8B"}}),h.jsx("span",{style:{color:"#8B4B8B"},children:"Loading your question constraints..."})]})})})]}),h.jsx("div",{className:"rounded-2xl shadow-2xl overflow-hidden",style:{backgroundColor:"rgba(255, 255, 255, 0.9)",backdropFilter:"blur(10px)",border:"3px solid rgba(218, 165, 32, 0.4)",padding:"4px"},children:h.jsx("canvas",{ref:o,onMouseDown:L,onMouseUp:O,onMouseMove:I,onMouseLeave:O,style:{display:"block",borderRadius:"12px",cursor:"crosshair"}})}),h.jsx("div",{className:"text-center mt-8 pb-4",children:h.jsxs("div",{className:"inline-flex space-x-2",children:[h.jsx("div",{className:"w-3 h-3 rounded-full",style:{backgroundColor:"#DAA520"}}),h.jsx("div",{className:"w-3 h-3 rounded-full",style:{backgroundColor:"#DA70D6"}}),h.jsx("div",{className:"w-3 h-3 rounded-full",style:{backgroundColor:"#DAA520"}})]})})]})};/**
 * @license
 * Copyright 2010-2025 Three.js Authors
 * SPDX-License-Identifier: MIT
 */const Q_="177",Nd={LEFT:0,MIDDLE:1,RIGHT:2,ROTATE:0,DOLLY:1,PAN:2},Pd={ROTATE:0,PAN:1,DOLLY_PAN:2,DOLLY_ROTATE:3},Xk=0,Pb=1,Yk=2,WG=3,Kk=0,J_=1,Wg=2,Zo=3,Zl=0,ci=1,ka=2,Wl=0,Qd=1,Ib=2,kb=3,Db=4,Qk=5,Qc=100,Jk=101,Zk=102,e4=103,t4=104,n4=200,r4=201,s4=202,i4=203,Iy=204,ky=205,o4=206,a4=207,l4=208,c4=209,u4=210,d4=211,h4=212,f4=213,p4=214,Dy=0,Ly=1,Oy=2,dh=3,jy=4,Fy=5,Uy=6,By=7,W0=0,m4=1,g4=2,Ua=0,v4=1,x4=2,y4=3,iM=4,_4=5,w4=6,S4=7,Lb="attached",b4="detached",Z_=300,ec=301,xu=302,f0=303,p0=304,hm=306,m0=1e3,vo=1001,g0=1002,Ss=1003,oM=1004,$G=1004,vp=1005,qG=1005,Qr=1006,$g=1007,XG=1007,La=1008,YG=1008,_o=1009,aM=1010,lM=1011,Hp=1012,ew=1013,tc=1014,Ii=1015,fm=1016,tw=1017,nw=1018,Gp=1020,cM=35902,uM=1021,dM=1022,Vs=1023,Wp=1026,$p=1027,rw=1028,$0=1029,hM=1030,sw=1031,KG=1032,iw=1033,qg=33776,Xg=33777,Yg=33778,Kg=33779,zy=35840,Vy=35841,Hy=35842,Gy=35843,Wy=36196,$y=37492,qy=37496,Xy=37808,Yy=37809,Ky=37810,Qy=37811,Jy=37812,Zy=37813,e_=37814,t_=37815,n_=37816,r_=37817,s_=37818,i_=37819,o_=37820,a_=37821,Qg=36492,l_=36494,c_=36495,fM=36283,u_=36284,d_=36285,h_=36286,E4=2200,M4=2201,T4=2202,v0=2300,f_=2301,my=2302,jd=2400,Fd=2401,x0=2402,ow=2500,pM=2501,QG=0,JG=1,ZG=2,C4=3200,A4=3201,eW=3202,tW=3203,Mu=0,R4=1,Vl="",Ni="srgb",hh="srgb-linear",y0="linear",Wn="srgb",nW=0,Id=7680,rW=7681,sW=7682,iW=7683,oW=34055,aW=34056,lW=5386,cW=512,uW=513,dW=514,hW=515,fW=516,pW=517,mW=518,Ob=519,N4=512,P4=513,I4=514,mM=515,k4=516,D4=517,L4=518,O4=519,_0=35044,gW=35048,vW=35040,xW=35045,yW=35049,_W=35041,wW=35046,SW=35050,bW=35042,EW="100",jb="300 es",xo=2e3,w0=2001,MW={COMPUTE:"compute",RENDER:"render"},TW={PERSPECTIVE:"perspective",LINEAR:"linear",FLAT:"flat"},CW={NORMAL:"normal",CENTROID:"centroid",SAMPLE:"sample",FLAT_FIRST:"flat first",FLAT_EITHER:"flat either"};let Xa=class{addEventListener(e,t){this._listeners===void 0&&(this._listeners={});const n=this._listeners;n[e]===void 0&&(n[e]=[]),n[e].indexOf(t)===-1&&n[e].push(t)}hasEventListener(e,t){const n=this._listeners;return n===void 0?!1:n[e]!==void 0&&n[e].indexOf(t)!==-1}removeEventListener(e,t){const n=this._listeners;if(n===void 0)return;const s=n[e];if(s!==void 0){const i=s.indexOf(t);i!==-1&&s.splice(i,1)}}dispatchEvent(e){const t=this._listeners;if(t===void 0)return;const n=t[e.type];if(n!==void 0){e.target=this;const s=n.slice(0);for(let i=0,o=s.length;i<o;i++)s[i].call(this,e);e.target=null}}};const Ls=["00","01","02","03","04","05","06","07","08","09","0a","0b","0c","0d","0e","0f","10","11","12","13","14","15","16","17","18","19","1a","1b","1c","1d","1e","1f","20","21","22","23","24","25","26","27","28","29","2a","2b","2c","2d","2e","2f","30","31","32","33","34","35","36","37","38","39","3a","3b","3c","3d","3e","3f","40","41","42","43","44","45","46","47","48","49","4a","4b","4c","4d","4e","4f","50","51","52","53","54","55","56","57","58","59","5a","5b","5c","5d","5e","5f","60","61","62","63","64","65","66","67","68","69","6a","6b","6c","6d","6e","6f","70","71","72","73","74","75","76","77","78","79","7a","7b","7c","7d","7e","7f","80","81","82","83","84","85","86","87","88","89","8a","8b","8c","8d","8e","8f","90","91","92","93","94","95","96","97","98","99","9a","9b","9c","9d","9e","9f","a0","a1","a2","a3","a4","a5","a6","a7","a8","a9","aa","ab","ac","ad","ae","af","b0","b1","b2","b3","b4","b5","b6","b7","b8","b9","ba","bb","bc","bd","be","bf","c0","c1","c2","c3","c4","c5","c6","c7","c8","c9","ca","cb","cc","cd","ce","cf","d0","d1","d2","d3","d4","d5","d6","d7","d8","d9","da","db","dc","dd","de","df","e0","e1","e2","e3","e4","e5","e6","e7","e8","e9","ea","eb","ec","ed","ee","ef","f0","f1","f2","f3","f4","f5","f6","f7","f8","f9","fa","fb","fc","fd","fe","ff"];let pC=1234567;const Jd=Math.PI/180,qp=180/Math.PI;function Zi(){const r=Math.random()*4294967295|0,e=Math.random()*4294967295|0,t=Math.random()*4294967295|0,n=Math.random()*4294967295|0;return(Ls[r&255]+Ls[r>>8&255]+Ls[r>>16&255]+Ls[r>>24&255]+"-"+Ls[e&255]+Ls[e>>8&255]+"-"+Ls[e>>16&15|64]+Ls[e>>24&255]+"-"+Ls[t&63|128]+Ls[t>>8&255]+"-"+Ls[t>>16&255]+Ls[t>>24&255]+Ls[n&255]+Ls[n>>8&255]+Ls[n>>16&255]+Ls[n>>24&255]).toLowerCase()}function an(r,e,t){return Math.max(e,Math.min(t,r))}function gM(r,e){return(r%e+e)%e}function AW(r,e,t,n,s){return n+(r-e)*(s-n)/(t-e)}function RW(r,e,t){return r!==e?(t-r)/(e-r):0}function Jg(r,e,t){return(1-t)*r+t*e}function NW(r,e,t,n){return Jg(r,e,1-Math.exp(-t*n))}function PW(r,e=1){return e-Math.abs(gM(r,e*2)-e)}function IW(r,e,t){return r<=e?0:r>=t?1:(r=(r-e)/(t-e),r*r*(3-2*r))}function kW(r,e,t){return r<=e?0:r>=t?1:(r=(r-e)/(t-e),r*r*r*(r*(r*6-15)+10))}function DW(r,e){return r+Math.floor(Math.random()*(e-r+1))}function LW(r,e){return r+Math.random()*(e-r)}function OW(r){return r*(.5-Math.random())}function jW(r){r!==void 0&&(pC=r);let e=pC+=1831565813;return e=Math.imul(e^e>>>15,e|1),e^=e+Math.imul(e^e>>>7,e|61),((e^e>>>14)>>>0)/4294967296}function FW(r){return r*Jd}function UW(r){return r*qp}function BW(r){return(r&r-1)===0&&r!==0}function zW(r){return Math.pow(2,Math.ceil(Math.log(r)/Math.LN2))}function VW(r){return Math.pow(2,Math.floor(Math.log(r)/Math.LN2))}function HW(r,e,t,n,s){const i=Math.cos,o=Math.sin,a=i(t/2),c=o(t/2),d=i((e+n)/2),f=o((e+n)/2),m=i((e-n)/2),v=o((e-n)/2),x=i((n-e)/2),_=o((n-e)/2);switch(s){case"XYX":r.set(a*f,c*m,c*v,a*d);break;case"YZY":r.set(c*v,a*f,c*m,a*d);break;case"ZXZ":r.set(c*m,c*v,a*f,a*d);break;case"XZX":r.set(a*f,c*_,c*x,a*d);break;case"YXY":r.set(c*x,a*f,c*_,a*d);break;case"ZYZ":r.set(c*_,c*x,a*f,a*d);break;default:console.warn("THREE.MathUtils: .setQuaternionFromProperEuler() encountered an unknown order: "+s)}}function li(r,e){switch(e.constructor){case Float32Array:return r;case Uint32Array:return r/4294967295;case Uint16Array:return r/65535;case Uint8Array:return r/255;case Int32Array:return Math.max(r/2147483647,-1);case Int16Array:return Math.max(r/32767,-1);case Int8Array:return Math.max(r/127,-1);default:throw new Error("Invalid component type.")}}function pn(r,e){switch(e.constructor){case Float32Array:return r;case Uint32Array:return Math.round(r*4294967295);case Uint16Array:return Math.round(r*65535);case Uint8Array:return Math.round(r*255);case Int32Array:return Math.round(r*2147483647);case Int16Array:return Math.round(r*32767);case Int8Array:return Math.round(r*127);default:throw new Error("Invalid component type.")}}const GW={DEG2RAD:Jd,RAD2DEG:qp,generateUUID:Zi,clamp:an,euclideanModulo:gM,mapLinear:AW,inverseLerp:RW,lerp:Jg,damp:NW,pingpong:PW,smoothstep:IW,smootherstep:kW,randInt:DW,randFloat:LW,randFloatSpread:OW,seededRandom:jW,degToRad:FW,radToDeg:UW,isPowerOfTwo:BW,ceilPowerOfTwo:zW,floorPowerOfTwo:VW,setQuaternionFromProperEuler:HW,normalize:pn,denormalize:li};class Ve{constructor(e=0,t=0){Ve.prototype.isVector2=!0,this.x=e,this.y=t}get width(){return this.x}set width(e){this.x=e}get height(){return this.y}set height(e){this.y=e}set(e,t){return this.x=e,this.y=t,this}setScalar(e){return this.x=e,this.y=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y)}copy(e){return this.x=e.x,this.y=e.y,this}add(e){return this.x+=e.x,this.y+=e.y,this}addScalar(e){return this.x+=e,this.y+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this}subScalar(e){return this.x-=e,this.y-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this}multiply(e){return this.x*=e.x,this.y*=e.y,this}multiplyScalar(e){return this.x*=e,this.y*=e,this}divide(e){return this.x/=e.x,this.y/=e.y,this}divideScalar(e){return this.multiplyScalar(1/e)}applyMatrix3(e){const t=this.x,n=this.y,s=e.elements;return this.x=s[0]*t+s[3]*n+s[6],this.y=s[1]*t+s[4]*n+s[7],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this}clamp(e,t){return this.x=an(this.x,e.x,t.x),this.y=an(this.y,e.y,t.y),this}clampScalar(e,t){return this.x=an(this.x,e,t),this.y=an(this.y,e,t),this}clampLength(e,t){const n=this.length();return this.divideScalar(n||1).multiplyScalar(an(n,e,t))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(e){return this.x*e.x+this.y*e.y}cross(e){return this.x*e.y-this.y*e.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}angleTo(e){const t=Math.sqrt(this.lengthSq()*e.lengthSq());if(t===0)return Math.PI/2;const n=this.dot(e)/t;return Math.acos(an(n,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const t=this.x-e.x,n=this.y-e.y;return t*t+n*n}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this}lerpVectors(e,t,n){return this.x=e.x+(t.x-e.x)*n,this.y=e.y+(t.y-e.y)*n,this}equals(e){return e.x===this.x&&e.y===this.y}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this}rotateAround(e,t){const n=Math.cos(t),s=Math.sin(t),i=this.x-e.x,o=this.y-e.y;return this.x=i*n-o*s+e.x,this.y=i*s+o*n+e.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y}}class Gs{constructor(e=0,t=0,n=0,s=1){this.isQuaternion=!0,this._x=e,this._y=t,this._z=n,this._w=s}static slerpFlat(e,t,n,s,i,o,a){let c=n[s+0],d=n[s+1],f=n[s+2],m=n[s+3];const v=i[o+0],x=i[o+1],_=i[o+2],b=i[o+3];if(a===0){e[t+0]=c,e[t+1]=d,e[t+2]=f,e[t+3]=m;return}if(a===1){e[t+0]=v,e[t+1]=x,e[t+2]=_,e[t+3]=b;return}if(m!==b||c!==v||d!==x||f!==_){let w=1-a;const S=c*v+d*x+f*_+m*b,C=S>=0?1:-1,T=1-S*S;if(T>Number.EPSILON){const k=Math.sqrt(T),j=Math.atan2(k,S*C);w=Math.sin(w*j)/k,a=Math.sin(a*j)/k}const A=a*C;if(c=c*w+v*A,d=d*w+x*A,f=f*w+_*A,m=m*w+b*A,w===1-a){const k=1/Math.sqrt(c*c+d*d+f*f+m*m);c*=k,d*=k,f*=k,m*=k}}e[t]=c,e[t+1]=d,e[t+2]=f,e[t+3]=m}static multiplyQuaternionsFlat(e,t,n,s,i,o){const a=n[s],c=n[s+1],d=n[s+2],f=n[s+3],m=i[o],v=i[o+1],x=i[o+2],_=i[o+3];return e[t]=a*_+f*m+c*x-d*v,e[t+1]=c*_+f*v+d*m-a*x,e[t+2]=d*_+f*x+a*v-c*m,e[t+3]=f*_-a*m-c*v-d*x,e}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get w(){return this._w}set w(e){this._w=e,this._onChangeCallback()}set(e,t,n,s){return this._x=e,this._y=t,this._z=n,this._w=s,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(e){return this._x=e.x,this._y=e.y,this._z=e.z,this._w=e.w,this._onChangeCallback(),this}setFromEuler(e,t=!0){const n=e._x,s=e._y,i=e._z,o=e._order,a=Math.cos,c=Math.sin,d=a(n/2),f=a(s/2),m=a(i/2),v=c(n/2),x=c(s/2),_=c(i/2);switch(o){case"XYZ":this._x=v*f*m+d*x*_,this._y=d*x*m-v*f*_,this._z=d*f*_+v*x*m,this._w=d*f*m-v*x*_;break;case"YXZ":this._x=v*f*m+d*x*_,this._y=d*x*m-v*f*_,this._z=d*f*_-v*x*m,this._w=d*f*m+v*x*_;break;case"ZXY":this._x=v*f*m-d*x*_,this._y=d*x*m+v*f*_,this._z=d*f*_+v*x*m,this._w=d*f*m-v*x*_;break;case"ZYX":this._x=v*f*m-d*x*_,this._y=d*x*m+v*f*_,this._z=d*f*_-v*x*m,this._w=d*f*m+v*x*_;break;case"YZX":this._x=v*f*m+d*x*_,this._y=d*x*m+v*f*_,this._z=d*f*_-v*x*m,this._w=d*f*m-v*x*_;break;case"XZY":this._x=v*f*m-d*x*_,this._y=d*x*m-v*f*_,this._z=d*f*_+v*x*m,this._w=d*f*m+v*x*_;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+o)}return t===!0&&this._onChangeCallback(),this}setFromAxisAngle(e,t){const n=t/2,s=Math.sin(n);return this._x=e.x*s,this._y=e.y*s,this._z=e.z*s,this._w=Math.cos(n),this._onChangeCallback(),this}setFromRotationMatrix(e){const t=e.elements,n=t[0],s=t[4],i=t[8],o=t[1],a=t[5],c=t[9],d=t[2],f=t[6],m=t[10],v=n+a+m;if(v>0){const x=.5/Math.sqrt(v+1);this._w=.25/x,this._x=(f-c)*x,this._y=(i-d)*x,this._z=(o-s)*x}else if(n>a&&n>m){const x=2*Math.sqrt(1+n-a-m);this._w=(f-c)/x,this._x=.25*x,this._y=(s+o)/x,this._z=(i+d)/x}else if(a>m){const x=2*Math.sqrt(1+a-n-m);this._w=(i-d)/x,this._x=(s+o)/x,this._y=.25*x,this._z=(c+f)/x}else{const x=2*Math.sqrt(1+m-n-a);this._w=(o-s)/x,this._x=(i+d)/x,this._y=(c+f)/x,this._z=.25*x}return this._onChangeCallback(),this}setFromUnitVectors(e,t){let n=e.dot(t)+1;return n<Number.EPSILON?(n=0,Math.abs(e.x)>Math.abs(e.z)?(this._x=-e.y,this._y=e.x,this._z=0,this._w=n):(this._x=0,this._y=-e.z,this._z=e.y,this._w=n)):(this._x=e.y*t.z-e.z*t.y,this._y=e.z*t.x-e.x*t.z,this._z=e.x*t.y-e.y*t.x,this._w=n),this.normalize()}angleTo(e){return 2*Math.acos(Math.abs(an(this.dot(e),-1,1)))}rotateTowards(e,t){const n=this.angleTo(e);if(n===0)return this;const s=Math.min(1,t/n);return this.slerp(e,s),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(e){return this._x*e._x+this._y*e._y+this._z*e._z+this._w*e._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let e=this.length();return e===0?(this._x=0,this._y=0,this._z=0,this._w=1):(e=1/e,this._x=this._x*e,this._y=this._y*e,this._z=this._z*e,this._w=this._w*e),this._onChangeCallback(),this}multiply(e){return this.multiplyQuaternions(this,e)}premultiply(e){return this.multiplyQuaternions(e,this)}multiplyQuaternions(e,t){const n=e._x,s=e._y,i=e._z,o=e._w,a=t._x,c=t._y,d=t._z,f=t._w;return this._x=n*f+o*a+s*d-i*c,this._y=s*f+o*c+i*a-n*d,this._z=i*f+o*d+n*c-s*a,this._w=o*f-n*a-s*c-i*d,this._onChangeCallback(),this}slerp(e,t){if(t===0)return this;if(t===1)return this.copy(e);const n=this._x,s=this._y,i=this._z,o=this._w;let a=o*e._w+n*e._x+s*e._y+i*e._z;if(a<0?(this._w=-e._w,this._x=-e._x,this._y=-e._y,this._z=-e._z,a=-a):this.copy(e),a>=1)return this._w=o,this._x=n,this._y=s,this._z=i,this;const c=1-a*a;if(c<=Number.EPSILON){const x=1-t;return this._w=x*o+t*this._w,this._x=x*n+t*this._x,this._y=x*s+t*this._y,this._z=x*i+t*this._z,this.normalize(),this}const d=Math.sqrt(c),f=Math.atan2(d,a),m=Math.sin((1-t)*f)/d,v=Math.sin(t*f)/d;return this._w=o*m+this._w*v,this._x=n*m+this._x*v,this._y=s*m+this._y*v,this._z=i*m+this._z*v,this._onChangeCallback(),this}slerpQuaternions(e,t,n){return this.copy(e).slerp(t,n)}random(){const e=2*Math.PI*Math.random(),t=2*Math.PI*Math.random(),n=Math.random(),s=Math.sqrt(1-n),i=Math.sqrt(n);return this.set(s*Math.sin(e),s*Math.cos(e),i*Math.sin(t),i*Math.cos(t))}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._w===this._w}fromArray(e,t=0){return this._x=e[t],this._y=e[t+1],this._z=e[t+2],this._w=e[t+3],this._onChangeCallback(),this}toArray(e=[],t=0){return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._w,e}fromBufferAttribute(e,t){return this._x=e.getX(t),this._y=e.getY(t),this._z=e.getZ(t),this._w=e.getW(t),this._onChangeCallback(),this}toJSON(){return this.toArray()}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._w}}class J{constructor(e=0,t=0,n=0){J.prototype.isVector3=!0,this.x=e,this.y=t,this.z=n}set(e,t,n){return n===void 0&&(n=this.z),this.x=e,this.y=t,this.z=n,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this}multiplyVectors(e,t){return this.x=e.x*t.x,this.y=e.y*t.y,this.z=e.z*t.z,this}applyEuler(e){return this.applyQuaternion(mC.setFromEuler(e))}applyAxisAngle(e,t){return this.applyQuaternion(mC.setFromAxisAngle(e,t))}applyMatrix3(e){const t=this.x,n=this.y,s=this.z,i=e.elements;return this.x=i[0]*t+i[3]*n+i[6]*s,this.y=i[1]*t+i[4]*n+i[7]*s,this.z=i[2]*t+i[5]*n+i[8]*s,this}applyNormalMatrix(e){return this.applyMatrix3(e).normalize()}applyMatrix4(e){const t=this.x,n=this.y,s=this.z,i=e.elements,o=1/(i[3]*t+i[7]*n+i[11]*s+i[15]);return this.x=(i[0]*t+i[4]*n+i[8]*s+i[12])*o,this.y=(i[1]*t+i[5]*n+i[9]*s+i[13])*o,this.z=(i[2]*t+i[6]*n+i[10]*s+i[14])*o,this}applyQuaternion(e){const t=this.x,n=this.y,s=this.z,i=e.x,o=e.y,a=e.z,c=e.w,d=2*(o*s-a*n),f=2*(a*t-i*s),m=2*(i*n-o*t);return this.x=t+c*d+o*m-a*f,this.y=n+c*f+a*d-i*m,this.z=s+c*m+i*f-o*d,this}project(e){return this.applyMatrix4(e.matrixWorldInverse).applyMatrix4(e.projectionMatrix)}unproject(e){return this.applyMatrix4(e.projectionMatrixInverse).applyMatrix4(e.matrixWorld)}transformDirection(e){const t=this.x,n=this.y,s=this.z,i=e.elements;return this.x=i[0]*t+i[4]*n+i[8]*s,this.y=i[1]*t+i[5]*n+i[9]*s,this.z=i[2]*t+i[6]*n+i[10]*s,this.normalize()}divide(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this}divideScalar(e){return this.multiplyScalar(1/e)}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this}clamp(e,t){return this.x=an(this.x,e.x,t.x),this.y=an(this.y,e.y,t.y),this.z=an(this.z,e.z,t.z),this}clampScalar(e,t){return this.x=an(this.x,e,t),this.y=an(this.y,e,t),this.z=an(this.z,e,t),this}clampLength(e,t){const n=this.length();return this.divideScalar(n||1).multiplyScalar(an(n,e,t))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this}lerpVectors(e,t,n){return this.x=e.x+(t.x-e.x)*n,this.y=e.y+(t.y-e.y)*n,this.z=e.z+(t.z-e.z)*n,this}cross(e){return this.crossVectors(this,e)}crossVectors(e,t){const n=e.x,s=e.y,i=e.z,o=t.x,a=t.y,c=t.z;return this.x=s*c-i*a,this.y=i*o-n*c,this.z=n*a-s*o,this}projectOnVector(e){const t=e.lengthSq();if(t===0)return this.set(0,0,0);const n=e.dot(this)/t;return this.copy(e).multiplyScalar(n)}projectOnPlane(e){return j1.copy(this).projectOnVector(e),this.sub(j1)}reflect(e){return this.sub(j1.copy(e).multiplyScalar(2*this.dot(e)))}angleTo(e){const t=Math.sqrt(this.lengthSq()*e.lengthSq());if(t===0)return Math.PI/2;const n=this.dot(e)/t;return Math.acos(an(n,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const t=this.x-e.x,n=this.y-e.y,s=this.z-e.z;return t*t+n*n+s*s}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)+Math.abs(this.z-e.z)}setFromSpherical(e){return this.setFromSphericalCoords(e.radius,e.phi,e.theta)}setFromSphericalCoords(e,t,n){const s=Math.sin(t)*e;return this.x=s*Math.sin(n),this.y=Math.cos(t)*e,this.z=s*Math.cos(n),this}setFromCylindrical(e){return this.setFromCylindricalCoords(e.radius,e.theta,e.y)}setFromCylindricalCoords(e,t,n){return this.x=e*Math.sin(t),this.y=n,this.z=e*Math.cos(t),this}setFromMatrixPosition(e){const t=e.elements;return this.x=t[12],this.y=t[13],this.z=t[14],this}setFromMatrixScale(e){const t=this.setFromMatrixColumn(e,0).length(),n=this.setFromMatrixColumn(e,1).length(),s=this.setFromMatrixColumn(e,2).length();return this.x=t,this.y=n,this.z=s,this}setFromMatrixColumn(e,t){return this.fromArray(e.elements,t*4)}setFromMatrix3Column(e,t){return this.fromArray(e.elements,t*3)}setFromEuler(e){return this.x=e._x,this.y=e._y,this.z=e._z,this}setFromColor(e){return this.x=e.r,this.y=e.g,this.z=e.b,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}randomDirection(){const e=Math.random()*Math.PI*2,t=Math.random()*2-1,n=Math.sqrt(1-t*t);return this.x=n*Math.cos(e),this.y=t,this.z=n*Math.sin(e),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z}}const j1=new J,mC=new Gs;class cn{constructor(e,t,n,s,i,o,a,c,d){cn.prototype.isMatrix3=!0,this.elements=[1,0,0,0,1,0,0,0,1],e!==void 0&&this.set(e,t,n,s,i,o,a,c,d)}set(e,t,n,s,i,o,a,c,d){const f=this.elements;return f[0]=e,f[1]=s,f[2]=a,f[3]=t,f[4]=i,f[5]=c,f[6]=n,f[7]=o,f[8]=d,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(e){const t=this.elements,n=e.elements;return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[4]=n[4],t[5]=n[5],t[6]=n[6],t[7]=n[7],t[8]=n[8],this}extractBasis(e,t,n){return e.setFromMatrix3Column(this,0),t.setFromMatrix3Column(this,1),n.setFromMatrix3Column(this,2),this}setFromMatrix4(e){const t=e.elements;return this.set(t[0],t[4],t[8],t[1],t[5],t[9],t[2],t[6],t[10]),this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){const n=e.elements,s=t.elements,i=this.elements,o=n[0],a=n[3],c=n[6],d=n[1],f=n[4],m=n[7],v=n[2],x=n[5],_=n[8],b=s[0],w=s[3],S=s[6],C=s[1],T=s[4],A=s[7],k=s[2],j=s[5],D=s[8];return i[0]=o*b+a*C+c*k,i[3]=o*w+a*T+c*j,i[6]=o*S+a*A+c*D,i[1]=d*b+f*C+m*k,i[4]=d*w+f*T+m*j,i[7]=d*S+f*A+m*D,i[2]=v*b+x*C+_*k,i[5]=v*w+x*T+_*j,i[8]=v*S+x*A+_*D,this}multiplyScalar(e){const t=this.elements;return t[0]*=e,t[3]*=e,t[6]*=e,t[1]*=e,t[4]*=e,t[7]*=e,t[2]*=e,t[5]*=e,t[8]*=e,this}determinant(){const e=this.elements,t=e[0],n=e[1],s=e[2],i=e[3],o=e[4],a=e[5],c=e[6],d=e[7],f=e[8];return t*o*f-t*a*d-n*i*f+n*a*c+s*i*d-s*o*c}invert(){const e=this.elements,t=e[0],n=e[1],s=e[2],i=e[3],o=e[4],a=e[5],c=e[6],d=e[7],f=e[8],m=f*o-a*d,v=a*c-f*i,x=d*i-o*c,_=t*m+n*v+s*x;if(_===0)return this.set(0,0,0,0,0,0,0,0,0);const b=1/_;return e[0]=m*b,e[1]=(s*d-f*n)*b,e[2]=(a*n-s*o)*b,e[3]=v*b,e[4]=(f*t-s*c)*b,e[5]=(s*i-a*t)*b,e[6]=x*b,e[7]=(n*c-d*t)*b,e[8]=(o*t-n*i)*b,this}transpose(){let e;const t=this.elements;return e=t[1],t[1]=t[3],t[3]=e,e=t[2],t[2]=t[6],t[6]=e,e=t[5],t[5]=t[7],t[7]=e,this}getNormalMatrix(e){return this.setFromMatrix4(e).invert().transpose()}transposeIntoArray(e){const t=this.elements;return e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8],this}setUvTransform(e,t,n,s,i,o,a){const c=Math.cos(i),d=Math.sin(i);return this.set(n*c,n*d,-n*(c*o+d*a)+o+e,-s*d,s*c,-s*(-d*o+c*a)+a+t,0,0,1),this}scale(e,t){return this.premultiply(F1.makeScale(e,t)),this}rotate(e){return this.premultiply(F1.makeRotation(-e)),this}translate(e,t){return this.premultiply(F1.makeTranslation(e,t)),this}makeTranslation(e,t){return e.isVector2?this.set(1,0,e.x,0,1,e.y,0,0,1):this.set(1,0,e,0,1,t,0,0,1),this}makeRotation(e){const t=Math.cos(e),n=Math.sin(e);return this.set(t,-n,0,n,t,0,0,0,1),this}makeScale(e,t){return this.set(e,0,0,0,t,0,0,0,1),this}equals(e){const t=this.elements,n=e.elements;for(let s=0;s<9;s++)if(t[s]!==n[s])return!1;return!0}fromArray(e,t=0){for(let n=0;n<9;n++)this.elements[n]=e[n+t];return this}toArray(e=[],t=0){const n=this.elements;return e[t]=n[0],e[t+1]=n[1],e[t+2]=n[2],e[t+3]=n[3],e[t+4]=n[4],e[t+5]=n[5],e[t+6]=n[6],e[t+7]=n[7],e[t+8]=n[8],e}clone(){return new this.constructor().fromArray(this.elements)}}const F1=new cn;function j4(r){for(let e=r.length-1;e>=0;--e)if(r[e]>=65535)return!0;return!1}const WW={Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array};function xp(r,e){return new WW[r](e)}function S0(r){return document.createElementNS("http://www.w3.org/1999/xhtml",r)}function F4(){const r=S0("canvas");return r.style.display="block",r}const gC={};function Tp(r){r in gC||(gC[r]=!0,console.warn(r))}function $W(r,e,t){return new Promise(function(n,s){function i(){switch(r.clientWaitSync(e,r.SYNC_FLUSH_COMMANDS_BIT,0)){case r.WAIT_FAILED:s();break;case r.TIMEOUT_EXPIRED:setTimeout(i,t);break;default:n()}}setTimeout(i,t)})}function qW(r){const e=r.elements;e[2]=.5*e[2]+.5*e[3],e[6]=.5*e[6]+.5*e[7],e[10]=.5*e[10]+.5*e[11],e[14]=.5*e[14]+.5*e[15]}function XW(r){const e=r.elements;e[11]===-1?(e[10]=-e[10]-1,e[14]=-e[14]):(e[10]=-e[10],e[14]=-e[14]+1)}const vC=new cn().set(.4123908,.3575843,.1804808,.212639,.7151687,.0721923,.0193308,.1191948,.9505322),xC=new cn().set(3.2409699,-1.5373832,-.4986108,-.9692436,1.8759675,.0415551,.0556301,-.203977,1.0569715);function YW(){const r={enabled:!0,workingColorSpace:hh,spaces:{},convert:function(s,i,o){return this.enabled===!1||i===o||!i||!o||(this.spaces[i].transfer===Wn&&(s.r=$l(s.r),s.g=$l(s.g),s.b=$l(s.b)),this.spaces[i].primaries!==this.spaces[o].primaries&&(s.applyMatrix3(this.spaces[i].toXYZ),s.applyMatrix3(this.spaces[o].fromXYZ)),this.spaces[o].transfer===Wn&&(s.r=Cp(s.r),s.g=Cp(s.g),s.b=Cp(s.b))),s},workingToColorSpace:function(s,i){return this.convert(s,this.workingColorSpace,i)},colorSpaceToWorking:function(s,i){return this.convert(s,i,this.workingColorSpace)},getPrimaries:function(s){return this.spaces[s].primaries},getTransfer:function(s){return s===Vl?y0:this.spaces[s].transfer},getLuminanceCoefficients:function(s,i=this.workingColorSpace){return s.fromArray(this.spaces[i].luminanceCoefficients)},define:function(s){Object.assign(this.spaces,s)},_getMatrix:function(s,i,o){return s.copy(this.spaces[i].toXYZ).multiply(this.spaces[o].fromXYZ)},_getDrawingBufferColorSpace:function(s){return this.spaces[s].outputColorSpaceConfig.drawingBufferColorSpace},_getUnpackColorSpace:function(s=this.workingColorSpace){return this.spaces[s].workingColorSpaceConfig.unpackColorSpace},fromWorkingColorSpace:function(s,i){return Tp("THREE.ColorManagement: .fromWorkingColorSpace() has been renamed to .workingToColorSpace()."),r.workingToColorSpace(s,i)},toWorkingColorSpace:function(s,i){return Tp("THREE.ColorManagement: .toWorkingColorSpace() has been renamed to .colorSpaceToWorking()."),r.colorSpaceToWorking(s,i)}},e=[.64,.33,.3,.6,.15,.06],t=[.2126,.7152,.0722],n=[.3127,.329];return r.define({[hh]:{primaries:e,whitePoint:n,transfer:y0,toXYZ:vC,fromXYZ:xC,luminanceCoefficients:t,workingColorSpaceConfig:{unpackColorSpace:Ni},outputColorSpaceConfig:{drawingBufferColorSpace:Ni}},[Ni]:{primaries:e,whitePoint:n,transfer:Wn,toXYZ:vC,fromXYZ:xC,luminanceCoefficients:t,outputColorSpaceConfig:{drawingBufferColorSpace:Ni}}}),r}const kn=YW();function $l(r){return r<.04045?r*.0773993808:Math.pow(r*.9478672986+.0521327014,2.4)}function Cp(r){return r<.0031308?r*12.92:1.055*Math.pow(r,.41666)-.055}let Wf;class U4{static getDataURL(e,t="image/png"){if(/^data:/i.test(e.src)||typeof HTMLCanvasElement>"u")return e.src;let n;if(e instanceof HTMLCanvasElement)n=e;else{Wf===void 0&&(Wf=S0("canvas")),Wf.width=e.width,Wf.height=e.height;const s=Wf.getContext("2d");e instanceof ImageData?s.putImageData(e,0,0):s.drawImage(e,0,0,e.width,e.height),n=Wf}return n.toDataURL(t)}static sRGBToLinear(e){if(typeof HTMLImageElement<"u"&&e instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&e instanceof ImageBitmap){const t=S0("canvas");t.width=e.width,t.height=e.height;const n=t.getContext("2d");n.drawImage(e,0,0,e.width,e.height);const s=n.getImageData(0,0,e.width,e.height),i=s.data;for(let o=0;o<i.length;o++)i[o]=$l(i[o]/255)*255;return n.putImageData(s,0,0),t}else if(e.data){const t=e.data.slice(0);for(let n=0;n<t.length;n++)t instanceof Uint8Array||t instanceof Uint8ClampedArray?t[n]=Math.floor($l(t[n]/255)*255):t[n]=$l(t[n]);return{data:t,width:e.width,height:e.height}}else return console.warn("THREE.ImageUtils.sRGBToLinear(): Unsupported image type. No color space conversion applied."),e}}let KW=0;class au{constructor(e=null){this.isSource=!0,Object.defineProperty(this,"id",{value:KW++}),this.uuid=Zi(),this.data=e,this.dataReady=!0,this.version=0}getSize(e){const t=this.data;return t instanceof HTMLVideoElement?e.set(t.videoWidth,t.videoHeight):t!==null?e.set(t.width,t.height,t.depth||0):e.set(0,0,0),e}set needsUpdate(e){e===!0&&this.version++}toJSON(e){const t=e===void 0||typeof e=="string";if(!t&&e.images[this.uuid]!==void 0)return e.images[this.uuid];const n={uuid:this.uuid,url:""},s=this.data;if(s!==null){let i;if(Array.isArray(s)){i=[];for(let o=0,a=s.length;o<a;o++)s[o].isDataTexture?i.push(U1(s[o].image)):i.push(U1(s[o]))}else i=U1(s);n.url=i}return t||(e.images[this.uuid]=n),n}}function U1(r){return typeof HTMLImageElement<"u"&&r instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&r instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&r instanceof ImageBitmap?U4.getDataURL(r):r.data?{data:Array.from(r.data),width:r.width,height:r.height,type:r.data.constructor.name}:(console.warn("THREE.Texture: Unable to serialize Texture."),{})}let QW=0;const B1=new J;class _r extends Xa{constructor(e=_r.DEFAULT_IMAGE,t=_r.DEFAULT_MAPPING,n=vo,s=vo,i=Qr,o=La,a=Vs,c=_o,d=_r.DEFAULT_ANISOTROPY,f=Vl){super(),this.isTexture=!0,Object.defineProperty(this,"id",{value:QW++}),this.uuid=Zi(),this.name="",this.source=new au(e),this.mipmaps=[],this.mapping=t,this.channel=0,this.wrapS=n,this.wrapT=s,this.magFilter=i,this.minFilter=o,this.anisotropy=d,this.format=a,this.internalFormat=null,this.type=c,this.offset=new Ve(0,0),this.repeat=new Ve(1,1),this.center=new Ve(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new cn,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.colorSpace=f,this.userData={},this.updateRanges=[],this.version=0,this.onUpdate=null,this.renderTarget=null,this.isRenderTargetTexture=!1,this.isArrayTexture=!!(e&&e.depth&&e.depth>1),this.pmremVersion=0}get width(){return this.source.getSize(B1).x}get height(){return this.source.getSize(B1).y}get depth(){return this.source.getSize(B1).z}get image(){return this.source.data}set image(e=null){this.source.data=e}updateMatrix(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}addUpdateRange(e,t){this.updateRanges.push({start:e,count:t})}clearUpdateRanges(){this.updateRanges.length=0}clone(){return new this.constructor().copy(this)}copy(e){return this.name=e.name,this.source=e.source,this.mipmaps=e.mipmaps.slice(0),this.mapping=e.mapping,this.channel=e.channel,this.wrapS=e.wrapS,this.wrapT=e.wrapT,this.magFilter=e.magFilter,this.minFilter=e.minFilter,this.anisotropy=e.anisotropy,this.format=e.format,this.internalFormat=e.internalFormat,this.type=e.type,this.offset.copy(e.offset),this.repeat.copy(e.repeat),this.center.copy(e.center),this.rotation=e.rotation,this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrix.copy(e.matrix),this.generateMipmaps=e.generateMipmaps,this.premultiplyAlpha=e.premultiplyAlpha,this.flipY=e.flipY,this.unpackAlignment=e.unpackAlignment,this.colorSpace=e.colorSpace,this.renderTarget=e.renderTarget,this.isRenderTargetTexture=e.isRenderTargetTexture,this.isArrayTexture=e.isArrayTexture,this.userData=JSON.parse(JSON.stringify(e.userData)),this.needsUpdate=!0,this}setValues(e){for(const t in e){const n=e[t];if(n===void 0){console.warn(`THREE.Texture.setValues(): parameter '${t}' has value of undefined.`);continue}const s=this[t];if(s===void 0){console.warn(`THREE.Texture.setValues(): property '${t}' does not exist.`);continue}s&&n&&s.isVector2&&n.isVector2||s&&n&&s.isVector3&&n.isVector3||s&&n&&s.isMatrix3&&n.isMatrix3?s.copy(n):this[t]=n}}toJSON(e){const t=e===void 0||typeof e=="string";if(!t&&e.textures[this.uuid]!==void 0)return e.textures[this.uuid];const n={metadata:{version:4.7,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,image:this.source.toJSON(e).uuid,mapping:this.mapping,channel:this.channel,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,internalFormat:this.internalFormat,type:this.type,colorSpace:this.colorSpace,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,generateMipmaps:this.generateMipmaps,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};return Object.keys(this.userData).length>0&&(n.userData=this.userData),t||(e.textures[this.uuid]=n),n}dispose(){this.dispatchEvent({type:"dispose"})}transformUv(e){if(this.mapping!==Z_)return e;if(e.applyMatrix3(this.matrix),e.x<0||e.x>1)switch(this.wrapS){case m0:e.x=e.x-Math.floor(e.x);break;case vo:e.x=e.x<0?0:1;break;case g0:Math.abs(Math.floor(e.x)%2)===1?e.x=Math.ceil(e.x)-e.x:e.x=e.x-Math.floor(e.x);break}if(e.y<0||e.y>1)switch(this.wrapT){case m0:e.y=e.y-Math.floor(e.y);break;case vo:e.y=e.y<0?0:1;break;case g0:Math.abs(Math.floor(e.y)%2)===1?e.y=Math.ceil(e.y)-e.y:e.y=e.y-Math.floor(e.y);break}return this.flipY&&(e.y=1-e.y),e}set needsUpdate(e){e===!0&&(this.version++,this.source.needsUpdate=!0)}set needsPMREMUpdate(e){e===!0&&this.pmremVersion++}}_r.DEFAULT_IMAGE=null;_r.DEFAULT_MAPPING=Z_;_r.DEFAULT_ANISOTROPY=1;class On{constructor(e=0,t=0,n=0,s=1){On.prototype.isVector4=!0,this.x=e,this.y=t,this.z=n,this.w=s}get width(){return this.z}set width(e){this.z=e}get height(){return this.w}set height(e){this.w=e}set(e,t,n,s){return this.x=e,this.y=t,this.z=n,this.w=s,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this.w=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setW(e){return this.w=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;case 3:this.w=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=e.w!==void 0?e.w:1,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this.w+=e.w,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this.w+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this.w=e.w+t.w,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this.w+=e.w*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this.w-=e.w,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this.w-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this.w=e.w-t.w,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this.w*=e.w,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this.w*=e,this}applyMatrix4(e){const t=this.x,n=this.y,s=this.z,i=this.w,o=e.elements;return this.x=o[0]*t+o[4]*n+o[8]*s+o[12]*i,this.y=o[1]*t+o[5]*n+o[9]*s+o[13]*i,this.z=o[2]*t+o[6]*n+o[10]*s+o[14]*i,this.w=o[3]*t+o[7]*n+o[11]*s+o[15]*i,this}divide(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this.w/=e.w,this}divideScalar(e){return this.multiplyScalar(1/e)}setAxisAngleFromQuaternion(e){this.w=2*Math.acos(e.w);const t=Math.sqrt(1-e.w*e.w);return t<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=e.x/t,this.y=e.y/t,this.z=e.z/t),this}setAxisAngleFromRotationMatrix(e){let t,n,s,i;const c=e.elements,d=c[0],f=c[4],m=c[8],v=c[1],x=c[5],_=c[9],b=c[2],w=c[6],S=c[10];if(Math.abs(f-v)<.01&&Math.abs(m-b)<.01&&Math.abs(_-w)<.01){if(Math.abs(f+v)<.1&&Math.abs(m+b)<.1&&Math.abs(_+w)<.1&&Math.abs(d+x+S-3)<.1)return this.set(1,0,0,0),this;t=Math.PI;const T=(d+1)/2,A=(x+1)/2,k=(S+1)/2,j=(f+v)/4,D=(m+b)/4,L=(_+w)/4;return T>A&&T>k?T<.01?(n=0,s=.707106781,i=.707106781):(n=Math.sqrt(T),s=j/n,i=D/n):A>k?A<.01?(n=.707106781,s=0,i=.707106781):(s=Math.sqrt(A),n=j/s,i=L/s):k<.01?(n=.707106781,s=.707106781,i=0):(i=Math.sqrt(k),n=D/i,s=L/i),this.set(n,s,i,t),this}let C=Math.sqrt((w-_)*(w-_)+(m-b)*(m-b)+(v-f)*(v-f));return Math.abs(C)<.001&&(C=1),this.x=(w-_)/C,this.y=(m-b)/C,this.z=(v-f)/C,this.w=Math.acos((d+x+S-1)/2),this}setFromMatrixPosition(e){const t=e.elements;return this.x=t[12],this.y=t[13],this.z=t[14],this.w=t[15],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this.w=Math.min(this.w,e.w),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this.w=Math.max(this.w,e.w),this}clamp(e,t){return this.x=an(this.x,e.x,t.x),this.y=an(this.y,e.y,t.y),this.z=an(this.z,e.z,t.z),this.w=an(this.w,e.w,t.w),this}clampScalar(e,t){return this.x=an(this.x,e,t),this.y=an(this.y,e,t),this.z=an(this.z,e,t),this.w=an(this.w,e,t),this}clampLength(e,t){const n=this.length();return this.divideScalar(n||1).multiplyScalar(an(n,e,t))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this.w=Math.trunc(this.w),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z+this.w*e.w}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this.w+=(e.w-this.w)*t,this}lerpVectors(e,t,n){return this.x=e.x+(t.x-e.x)*n,this.y=e.y+(t.y-e.y)*n,this.z=e.z+(t.z-e.z)*n,this.w=e.w+(t.w-e.w)*n,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z&&e.w===this.w}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this.w=e[t+3],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e[t+3]=this.w,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this.w=e.getW(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z,yield this.w}}class vM extends Xa{constructor(e=1,t=1,n={}){super(),n=Object.assign({generateMipmaps:!1,internalFormat:null,minFilter:Qr,depthBuffer:!0,stencilBuffer:!1,resolveDepthBuffer:!0,resolveStencilBuffer:!0,depthTexture:null,samples:0,count:1,depth:1,multiview:!1},n),this.isRenderTarget=!0,this.width=e,this.height=t,this.depth=n.depth,this.scissor=new On(0,0,e,t),this.scissorTest=!1,this.viewport=new On(0,0,e,t);const s={width:e,height:t,depth:n.depth},i=new _r(s);this.textures=[];const o=n.count;for(let a=0;a<o;a++)this.textures[a]=i.clone(),this.textures[a].isRenderTargetTexture=!0,this.textures[a].renderTarget=this;this._setTextureOptions(n),this.depthBuffer=n.depthBuffer,this.stencilBuffer=n.stencilBuffer,this.resolveDepthBuffer=n.resolveDepthBuffer,this.resolveStencilBuffer=n.resolveStencilBuffer,this._depthTexture=null,this.depthTexture=n.depthTexture,this.samples=n.samples,this.multiview=n.multiview}_setTextureOptions(e={}){const t={minFilter:Qr,generateMipmaps:!1,flipY:!1,internalFormat:null};e.mapping!==void 0&&(t.mapping=e.mapping),e.wrapS!==void 0&&(t.wrapS=e.wrapS),e.wrapT!==void 0&&(t.wrapT=e.wrapT),e.wrapR!==void 0&&(t.wrapR=e.wrapR),e.magFilter!==void 0&&(t.magFilter=e.magFilter),e.minFilter!==void 0&&(t.minFilter=e.minFilter),e.format!==void 0&&(t.format=e.format),e.type!==void 0&&(t.type=e.type),e.anisotropy!==void 0&&(t.anisotropy=e.anisotropy),e.colorSpace!==void 0&&(t.colorSpace=e.colorSpace),e.flipY!==void 0&&(t.flipY=e.flipY),e.generateMipmaps!==void 0&&(t.generateMipmaps=e.generateMipmaps),e.internalFormat!==void 0&&(t.internalFormat=e.internalFormat);for(let n=0;n<this.textures.length;n++)this.textures[n].setValues(t)}get texture(){return this.textures[0]}set texture(e){this.textures[0]=e}set depthTexture(e){this._depthTexture!==null&&(this._depthTexture.renderTarget=null),e!==null&&(e.renderTarget=this),this._depthTexture=e}get depthTexture(){return this._depthTexture}setSize(e,t,n=1){if(this.width!==e||this.height!==t||this.depth!==n){this.width=e,this.height=t,this.depth=n;for(let s=0,i=this.textures.length;s<i;s++)this.textures[s].image.width=e,this.textures[s].image.height=t,this.textures[s].image.depth=n,this.textures[s].isArrayTexture=this.textures[s].image.depth>1;this.dispose()}this.viewport.set(0,0,e,t),this.scissor.set(0,0,e,t)}clone(){return new this.constructor().copy(this)}copy(e){this.width=e.width,this.height=e.height,this.depth=e.depth,this.scissor.copy(e.scissor),this.scissorTest=e.scissorTest,this.viewport.copy(e.viewport),this.textures.length=0;for(let t=0,n=e.textures.length;t<n;t++){this.textures[t]=e.textures[t].clone(),this.textures[t].isRenderTargetTexture=!0,this.textures[t].renderTarget=this;const s=Object.assign({},e.textures[t].image);this.textures[t].source=new au(s)}return this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,this.resolveDepthBuffer=e.resolveDepthBuffer,this.resolveStencilBuffer=e.resolveStencilBuffer,e.depthTexture!==null&&(this.depthTexture=e.depthTexture.clone()),this.samples=e.samples,this}dispose(){this.dispatchEvent({type:"dispose"})}}class Ga extends vM{constructor(e=1,t=1,n={}){super(e,t,n),this.isWebGLRenderTarget=!0}}class aw extends _r{constructor(e=null,t=1,n=1,s=1){super(null),this.isDataArrayTexture=!0,this.image={data:e,width:t,height:n,depth:s},this.magFilter=Ss,this.minFilter=Ss,this.wrapR=vo,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1,this.layerUpdates=new Set}addLayerUpdate(e){this.layerUpdates.add(e)}clearLayerUpdates(){this.layerUpdates.clear()}}class JW extends Ga{constructor(e=1,t=1,n=1,s={}){super(e,t,s),this.isWebGLArrayRenderTarget=!0,this.depth=n,this.texture=new aw(null,e,t,n),this._setTextureOptions(s),this.texture.isRenderTargetTexture=!0}}class lw extends _r{constructor(e=null,t=1,n=1,s=1){super(null),this.isData3DTexture=!0,this.image={data:e,width:t,height:n,depth:s},this.magFilter=Ss,this.minFilter=Ss,this.wrapR=vo,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}class ZW extends Ga{constructor(e=1,t=1,n=1,s={}){super(e,t,s),this.isWebGL3DRenderTarget=!0,this.depth=n,this.texture=new lw(null,e,t,n),this._setTextureOptions(s),this.texture.isRenderTargetTexture=!0}}class Ws{constructor(e=new J(1/0,1/0,1/0),t=new J(-1/0,-1/0,-1/0)){this.isBox3=!0,this.min=e,this.max=t}set(e,t){return this.min.copy(e),this.max.copy(t),this}setFromArray(e){this.makeEmpty();for(let t=0,n=e.length;t<n;t+=3)this.expandByPoint(Xo.fromArray(e,t));return this}setFromBufferAttribute(e){this.makeEmpty();for(let t=0,n=e.count;t<n;t++)this.expandByPoint(Xo.fromBufferAttribute(e,t));return this}setFromPoints(e){this.makeEmpty();for(let t=0,n=e.length;t<n;t++)this.expandByPoint(e[t]);return this}setFromCenterAndSize(e,t){const n=Xo.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(n),this.max.copy(e).add(n),this}setFromObject(e,t=!1){return this.makeEmpty(),this.expandByObject(e,t)}clone(){return new this.constructor().copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(e){return this.isEmpty()?e.set(0,0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}expandByObject(e,t=!1){e.updateWorldMatrix(!1,!1);const n=e.geometry;if(n!==void 0){const i=n.getAttribute("position");if(t===!0&&i!==void 0&&e.isInstancedMesh!==!0)for(let o=0,a=i.count;o<a;o++)e.isMesh===!0?e.getVertexPosition(o,Xo):Xo.fromBufferAttribute(i,o),Xo.applyMatrix4(e.matrixWorld),this.expandByPoint(Xo);else e.boundingBox!==void 0?(e.boundingBox===null&&e.computeBoundingBox(),hx.copy(e.boundingBox)):(n.boundingBox===null&&n.computeBoundingBox(),hx.copy(n.boundingBox)),hx.applyMatrix4(e.matrixWorld),this.union(hx)}const s=e.children;for(let i=0,o=s.length;i<o;i++)this.expandByObject(s[i],t);return this}containsPoint(e){return e.x>=this.min.x&&e.x<=this.max.x&&e.y>=this.min.y&&e.y<=this.max.y&&e.z>=this.min.z&&e.z<=this.max.z}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y&&this.min.z<=e.min.z&&e.max.z<=this.max.z}getParameter(e,t){return t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y),(e.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(e){return e.max.x>=this.min.x&&e.min.x<=this.max.x&&e.max.y>=this.min.y&&e.min.y<=this.max.y&&e.max.z>=this.min.z&&e.min.z<=this.max.z}intersectsSphere(e){return this.clampPoint(e.center,Xo),Xo.distanceToSquared(e.center)<=e.radius*e.radius}intersectsPlane(e){let t,n;return e.normal.x>0?(t=e.normal.x*this.min.x,n=e.normal.x*this.max.x):(t=e.normal.x*this.max.x,n=e.normal.x*this.min.x),e.normal.y>0?(t+=e.normal.y*this.min.y,n+=e.normal.y*this.max.y):(t+=e.normal.y*this.max.y,n+=e.normal.y*this.min.y),e.normal.z>0?(t+=e.normal.z*this.min.z,n+=e.normal.z*this.max.z):(t+=e.normal.z*this.max.z,n+=e.normal.z*this.min.z),t<=-e.constant&&n>=-e.constant}intersectsTriangle(e){if(this.isEmpty())return!1;this.getCenter(vg),fx.subVectors(this.max,vg),$f.subVectors(e.a,vg),qf.subVectors(e.b,vg),Xf.subVectors(e.c,vg),Fc.subVectors(qf,$f),Uc.subVectors(Xf,qf),md.subVectors($f,Xf);let t=[0,-Fc.z,Fc.y,0,-Uc.z,Uc.y,0,-md.z,md.y,Fc.z,0,-Fc.x,Uc.z,0,-Uc.x,md.z,0,-md.x,-Fc.y,Fc.x,0,-Uc.y,Uc.x,0,-md.y,md.x,0];return!z1(t,$f,qf,Xf,fx)||(t=[1,0,0,0,1,0,0,0,1],!z1(t,$f,qf,Xf,fx))?!1:(px.crossVectors(Fc,Uc),t=[px.x,px.y,px.z],z1(t,$f,qf,Xf,fx))}clampPoint(e,t){return t.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return this.clampPoint(e,Xo).distanceTo(e)}getBoundingSphere(e){return this.isEmpty()?e.makeEmpty():(this.getCenter(e.center),e.radius=this.getSize(Xo).length()*.5),e}intersect(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}applyMatrix4(e){return this.isEmpty()?this:(Nl[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(e),Nl[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(e),Nl[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(e),Nl[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(e),Nl[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(e),Nl[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(e),Nl[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(e),Nl[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(e),this.setFromPoints(Nl),this)}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}toJSON(){return{min:this.min.toArray(),max:this.max.toArray()}}fromJSON(e){return this.min.fromArray(e.min),this.max.fromArray(e.max),this}}const Nl=[new J,new J,new J,new J,new J,new J,new J,new J],Xo=new J,hx=new Ws,$f=new J,qf=new J,Xf=new J,Fc=new J,Uc=new J,md=new J,vg=new J,fx=new J,px=new J,gd=new J;function z1(r,e,t,n,s){for(let i=0,o=r.length-3;i<=o;i+=3){gd.fromArray(r,i);const a=s.x*Math.abs(gd.x)+s.y*Math.abs(gd.y)+s.z*Math.abs(gd.z),c=e.dot(gd),d=t.dot(gd),f=n.dot(gd);if(Math.max(-Math.max(c,d,f),Math.min(c,d,f))>a)return!1}return!0}const e$=new Ws,xg=new J,V1=new J;class bs{constructor(e=new J,t=-1){this.isSphere=!0,this.center=e,this.radius=t}set(e,t){return this.center.copy(e),this.radius=t,this}setFromPoints(e,t){const n=this.center;t!==void 0?n.copy(t):e$.setFromPoints(e).getCenter(n);let s=0;for(let i=0,o=e.length;i<o;i++)s=Math.max(s,n.distanceToSquared(e[i]));return this.radius=Math.sqrt(s),this}copy(e){return this.center.copy(e.center),this.radius=e.radius,this}isEmpty(){return this.radius<0}makeEmpty(){return this.center.set(0,0,0),this.radius=-1,this}containsPoint(e){return e.distanceToSquared(this.center)<=this.radius*this.radius}distanceToPoint(e){return e.distanceTo(this.center)-this.radius}intersectsSphere(e){const t=this.radius+e.radius;return e.center.distanceToSquared(this.center)<=t*t}intersectsBox(e){return e.intersectsSphere(this)}intersectsPlane(e){return Math.abs(e.distanceToPoint(this.center))<=this.radius}clampPoint(e,t){const n=this.center.distanceToSquared(e);return t.copy(e),n>this.radius*this.radius&&(t.sub(this.center).normalize(),t.multiplyScalar(this.radius).add(this.center)),t}getBoundingBox(e){return this.isEmpty()?(e.makeEmpty(),e):(e.set(this.center,this.center),e.expandByScalar(this.radius),e)}applyMatrix4(e){return this.center.applyMatrix4(e),this.radius=this.radius*e.getMaxScaleOnAxis(),this}translate(e){return this.center.add(e),this}expandByPoint(e){if(this.isEmpty())return this.center.copy(e),this.radius=0,this;xg.subVectors(e,this.center);const t=xg.lengthSq();if(t>this.radius*this.radius){const n=Math.sqrt(t),s=(n-this.radius)*.5;this.center.addScaledVector(xg,s/n),this.radius+=s}return this}union(e){return e.isEmpty()?this:this.isEmpty()?(this.copy(e),this):(this.center.equals(e.center)===!0?this.radius=Math.max(this.radius,e.radius):(V1.subVectors(e.center,this.center).setLength(e.radius),this.expandByPoint(xg.copy(e.center).add(V1)),this.expandByPoint(xg.copy(e.center).sub(V1))),this)}equals(e){return e.center.equals(this.center)&&e.radius===this.radius}clone(){return new this.constructor().copy(this)}toJSON(){return{radius:this.radius,center:this.center.toArray()}}fromJSON(e){return this.radius=e.radius,this.center.fromArray(e.center),this}}const Pl=new J,H1=new J,mx=new J,Bc=new J,G1=new J,gx=new J,W1=new J;class wh{constructor(e=new J,t=new J(0,0,-1)){this.origin=e,this.direction=t}set(e,t){return this.origin.copy(e),this.direction.copy(t),this}copy(e){return this.origin.copy(e.origin),this.direction.copy(e.direction),this}at(e,t){return t.copy(this.origin).addScaledVector(this.direction,e)}lookAt(e){return this.direction.copy(e).sub(this.origin).normalize(),this}recast(e){return this.origin.copy(this.at(e,Pl)),this}closestPointToPoint(e,t){t.subVectors(e,this.origin);const n=t.dot(this.direction);return n<0?t.copy(this.origin):t.copy(this.origin).addScaledVector(this.direction,n)}distanceToPoint(e){return Math.sqrt(this.distanceSqToPoint(e))}distanceSqToPoint(e){const t=Pl.subVectors(e,this.origin).dot(this.direction);return t<0?this.origin.distanceToSquared(e):(Pl.copy(this.origin).addScaledVector(this.direction,t),Pl.distanceToSquared(e))}distanceSqToSegment(e,t,n,s){H1.copy(e).add(t).multiplyScalar(.5),mx.copy(t).sub(e).normalize(),Bc.copy(this.origin).sub(H1);const i=e.distanceTo(t)*.5,o=-this.direction.dot(mx),a=Bc.dot(this.direction),c=-Bc.dot(mx),d=Bc.lengthSq(),f=Math.abs(1-o*o);let m,v,x,_;if(f>0)if(m=o*c-a,v=o*a-c,_=i*f,m>=0)if(v>=-_)if(v<=_){const b=1/f;m*=b,v*=b,x=m*(m+o*v+2*a)+v*(o*m+v+2*c)+d}else v=i,m=Math.max(0,-(o*v+a)),x=-m*m+v*(v+2*c)+d;else v=-i,m=Math.max(0,-(o*v+a)),x=-m*m+v*(v+2*c)+d;else v<=-_?(m=Math.max(0,-(-o*i+a)),v=m>0?-i:Math.min(Math.max(-i,-c),i),x=-m*m+v*(v+2*c)+d):v<=_?(m=0,v=Math.min(Math.max(-i,-c),i),x=v*(v+2*c)+d):(m=Math.max(0,-(o*i+a)),v=m>0?i:Math.min(Math.max(-i,-c),i),x=-m*m+v*(v+2*c)+d);else v=o>0?-i:i,m=Math.max(0,-(o*v+a)),x=-m*m+v*(v+2*c)+d;return n&&n.copy(this.origin).addScaledVector(this.direction,m),s&&s.copy(H1).addScaledVector(mx,v),x}intersectSphere(e,t){Pl.subVectors(e.center,this.origin);const n=Pl.dot(this.direction),s=Pl.dot(Pl)-n*n,i=e.radius*e.radius;if(s>i)return null;const o=Math.sqrt(i-s),a=n-o,c=n+o;return c<0?null:a<0?this.at(c,t):this.at(a,t)}intersectsSphere(e){return e.radius<0?!1:this.distanceSqToPoint(e.center)<=e.radius*e.radius}distanceToPlane(e){const t=e.normal.dot(this.direction);if(t===0)return e.distanceToPoint(this.origin)===0?0:null;const n=-(this.origin.dot(e.normal)+e.constant)/t;return n>=0?n:null}intersectPlane(e,t){const n=this.distanceToPlane(e);return n===null?null:this.at(n,t)}intersectsPlane(e){const t=e.distanceToPoint(this.origin);return t===0||e.normal.dot(this.direction)*t<0}intersectBox(e,t){let n,s,i,o,a,c;const d=1/this.direction.x,f=1/this.direction.y,m=1/this.direction.z,v=this.origin;return d>=0?(n=(e.min.x-v.x)*d,s=(e.max.x-v.x)*d):(n=(e.max.x-v.x)*d,s=(e.min.x-v.x)*d),f>=0?(i=(e.min.y-v.y)*f,o=(e.max.y-v.y)*f):(i=(e.max.y-v.y)*f,o=(e.min.y-v.y)*f),n>o||i>s||((i>n||isNaN(n))&&(n=i),(o<s||isNaN(s))&&(s=o),m>=0?(a=(e.min.z-v.z)*m,c=(e.max.z-v.z)*m):(a=(e.max.z-v.z)*m,c=(e.min.z-v.z)*m),n>c||a>s)||((a>n||n!==n)&&(n=a),(c<s||s!==s)&&(s=c),s<0)?null:this.at(n>=0?n:s,t)}intersectsBox(e){return this.intersectBox(e,Pl)!==null}intersectTriangle(e,t,n,s,i){G1.subVectors(t,e),gx.subVectors(n,e),W1.crossVectors(G1,gx);let o=this.direction.dot(W1),a;if(o>0){if(s)return null;a=1}else if(o<0)a=-1,o=-o;else return null;Bc.subVectors(this.origin,e);const c=a*this.direction.dot(gx.crossVectors(Bc,gx));if(c<0)return null;const d=a*this.direction.dot(G1.cross(Bc));if(d<0||c+d>o)return null;const f=-a*Bc.dot(W1);return f<0?null:this.at(f/o,i)}applyMatrix4(e){return this.origin.applyMatrix4(e),this.direction.transformDirection(e),this}equals(e){return e.origin.equals(this.origin)&&e.direction.equals(this.direction)}clone(){return new this.constructor().copy(this)}}class Jt{constructor(e,t,n,s,i,o,a,c,d,f,m,v,x,_,b,w){Jt.prototype.isMatrix4=!0,this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],e!==void 0&&this.set(e,t,n,s,i,o,a,c,d,f,m,v,x,_,b,w)}set(e,t,n,s,i,o,a,c,d,f,m,v,x,_,b,w){const S=this.elements;return S[0]=e,S[4]=t,S[8]=n,S[12]=s,S[1]=i,S[5]=o,S[9]=a,S[13]=c,S[2]=d,S[6]=f,S[10]=m,S[14]=v,S[3]=x,S[7]=_,S[11]=b,S[15]=w,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return new Jt().fromArray(this.elements)}copy(e){const t=this.elements,n=e.elements;return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[4]=n[4],t[5]=n[5],t[6]=n[6],t[7]=n[7],t[8]=n[8],t[9]=n[9],t[10]=n[10],t[11]=n[11],t[12]=n[12],t[13]=n[13],t[14]=n[14],t[15]=n[15],this}copyPosition(e){const t=this.elements,n=e.elements;return t[12]=n[12],t[13]=n[13],t[14]=n[14],this}setFromMatrix3(e){const t=e.elements;return this.set(t[0],t[3],t[6],0,t[1],t[4],t[7],0,t[2],t[5],t[8],0,0,0,0,1),this}extractBasis(e,t,n){return e.setFromMatrixColumn(this,0),t.setFromMatrixColumn(this,1),n.setFromMatrixColumn(this,2),this}makeBasis(e,t,n){return this.set(e.x,t.x,n.x,0,e.y,t.y,n.y,0,e.z,t.z,n.z,0,0,0,0,1),this}extractRotation(e){const t=this.elements,n=e.elements,s=1/Yf.setFromMatrixColumn(e,0).length(),i=1/Yf.setFromMatrixColumn(e,1).length(),o=1/Yf.setFromMatrixColumn(e,2).length();return t[0]=n[0]*s,t[1]=n[1]*s,t[2]=n[2]*s,t[3]=0,t[4]=n[4]*i,t[5]=n[5]*i,t[6]=n[6]*i,t[7]=0,t[8]=n[8]*o,t[9]=n[9]*o,t[10]=n[10]*o,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromEuler(e){const t=this.elements,n=e.x,s=e.y,i=e.z,o=Math.cos(n),a=Math.sin(n),c=Math.cos(s),d=Math.sin(s),f=Math.cos(i),m=Math.sin(i);if(e.order==="XYZ"){const v=o*f,x=o*m,_=a*f,b=a*m;t[0]=c*f,t[4]=-c*m,t[8]=d,t[1]=x+_*d,t[5]=v-b*d,t[9]=-a*c,t[2]=b-v*d,t[6]=_+x*d,t[10]=o*c}else if(e.order==="YXZ"){const v=c*f,x=c*m,_=d*f,b=d*m;t[0]=v+b*a,t[4]=_*a-x,t[8]=o*d,t[1]=o*m,t[5]=o*f,t[9]=-a,t[2]=x*a-_,t[6]=b+v*a,t[10]=o*c}else if(e.order==="ZXY"){const v=c*f,x=c*m,_=d*f,b=d*m;t[0]=v-b*a,t[4]=-o*m,t[8]=_+x*a,t[1]=x+_*a,t[5]=o*f,t[9]=b-v*a,t[2]=-o*d,t[6]=a,t[10]=o*c}else if(e.order==="ZYX"){const v=o*f,x=o*m,_=a*f,b=a*m;t[0]=c*f,t[4]=_*d-x,t[8]=v*d+b,t[1]=c*m,t[5]=b*d+v,t[9]=x*d-_,t[2]=-d,t[6]=a*c,t[10]=o*c}else if(e.order==="YZX"){const v=o*c,x=o*d,_=a*c,b=a*d;t[0]=c*f,t[4]=b-v*m,t[8]=_*m+x,t[1]=m,t[5]=o*f,t[9]=-a*f,t[2]=-d*f,t[6]=x*m+_,t[10]=v-b*m}else if(e.order==="XZY"){const v=o*c,x=o*d,_=a*c,b=a*d;t[0]=c*f,t[4]=-m,t[8]=d*f,t[1]=v*m+b,t[5]=o*f,t[9]=x*m-_,t[2]=_*m-x,t[6]=a*f,t[10]=b*m+v}return t[3]=0,t[7]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromQuaternion(e){return this.compose(t$,e,n$)}lookAt(e,t,n){const s=this.elements;return Xi.subVectors(e,t),Xi.lengthSq()===0&&(Xi.z=1),Xi.normalize(),zc.crossVectors(n,Xi),zc.lengthSq()===0&&(Math.abs(n.z)===1?Xi.x+=1e-4:Xi.z+=1e-4,Xi.normalize(),zc.crossVectors(n,Xi)),zc.normalize(),vx.crossVectors(Xi,zc),s[0]=zc.x,s[4]=vx.x,s[8]=Xi.x,s[1]=zc.y,s[5]=vx.y,s[9]=Xi.y,s[2]=zc.z,s[6]=vx.z,s[10]=Xi.z,this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){const n=e.elements,s=t.elements,i=this.elements,o=n[0],a=n[4],c=n[8],d=n[12],f=n[1],m=n[5],v=n[9],x=n[13],_=n[2],b=n[6],w=n[10],S=n[14],C=n[3],T=n[7],A=n[11],k=n[15],j=s[0],D=s[4],L=s[8],O=s[12],I=s[1],B=s[5],W=s[9],K=s[13],ee=s[2],oe=s[6],ne=s[10],ce=s[14],V=s[3],q=s[7],Z=s[11],X=s[15];return i[0]=o*j+a*I+c*ee+d*V,i[4]=o*D+a*B+c*oe+d*q,i[8]=o*L+a*W+c*ne+d*Z,i[12]=o*O+a*K+c*ce+d*X,i[1]=f*j+m*I+v*ee+x*V,i[5]=f*D+m*B+v*oe+x*q,i[9]=f*L+m*W+v*ne+x*Z,i[13]=f*O+m*K+v*ce+x*X,i[2]=_*j+b*I+w*ee+S*V,i[6]=_*D+b*B+w*oe+S*q,i[10]=_*L+b*W+w*ne+S*Z,i[14]=_*O+b*K+w*ce+S*X,i[3]=C*j+T*I+A*ee+k*V,i[7]=C*D+T*B+A*oe+k*q,i[11]=C*L+T*W+A*ne+k*Z,i[15]=C*O+T*K+A*ce+k*X,this}multiplyScalar(e){const t=this.elements;return t[0]*=e,t[4]*=e,t[8]*=e,t[12]*=e,t[1]*=e,t[5]*=e,t[9]*=e,t[13]*=e,t[2]*=e,t[6]*=e,t[10]*=e,t[14]*=e,t[3]*=e,t[7]*=e,t[11]*=e,t[15]*=e,this}determinant(){const e=this.elements,t=e[0],n=e[4],s=e[8],i=e[12],o=e[1],a=e[5],c=e[9],d=e[13],f=e[2],m=e[6],v=e[10],x=e[14],_=e[3],b=e[7],w=e[11],S=e[15];return _*(+i*c*m-s*d*m-i*a*v+n*d*v+s*a*x-n*c*x)+b*(+t*c*x-t*d*v+i*o*v-s*o*x+s*d*f-i*c*f)+w*(+t*d*m-t*a*x-i*o*m+n*o*x+i*a*f-n*d*f)+S*(-s*a*f-t*c*m+t*a*v+s*o*m-n*o*v+n*c*f)}transpose(){const e=this.elements;let t;return t=e[1],e[1]=e[4],e[4]=t,t=e[2],e[2]=e[8],e[8]=t,t=e[6],e[6]=e[9],e[9]=t,t=e[3],e[3]=e[12],e[12]=t,t=e[7],e[7]=e[13],e[13]=t,t=e[11],e[11]=e[14],e[14]=t,this}setPosition(e,t,n){const s=this.elements;return e.isVector3?(s[12]=e.x,s[13]=e.y,s[14]=e.z):(s[12]=e,s[13]=t,s[14]=n),this}invert(){const e=this.elements,t=e[0],n=e[1],s=e[2],i=e[3],o=e[4],a=e[5],c=e[6],d=e[7],f=e[8],m=e[9],v=e[10],x=e[11],_=e[12],b=e[13],w=e[14],S=e[15],C=m*w*d-b*v*d+b*c*x-a*w*x-m*c*S+a*v*S,T=_*v*d-f*w*d-_*c*x+o*w*x+f*c*S-o*v*S,A=f*b*d-_*m*d+_*a*x-o*b*x-f*a*S+o*m*S,k=_*m*c-f*b*c-_*a*v+o*b*v+f*a*w-o*m*w,j=t*C+n*T+s*A+i*k;if(j===0)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);const D=1/j;return e[0]=C*D,e[1]=(b*v*i-m*w*i-b*s*x+n*w*x+m*s*S-n*v*S)*D,e[2]=(a*w*i-b*c*i+b*s*d-n*w*d-a*s*S+n*c*S)*D,e[3]=(m*c*i-a*v*i-m*s*d+n*v*d+a*s*x-n*c*x)*D,e[4]=T*D,e[5]=(f*w*i-_*v*i+_*s*x-t*w*x-f*s*S+t*v*S)*D,e[6]=(_*c*i-o*w*i-_*s*d+t*w*d+o*s*S-t*c*S)*D,e[7]=(o*v*i-f*c*i+f*s*d-t*v*d-o*s*x+t*c*x)*D,e[8]=A*D,e[9]=(_*m*i-f*b*i-_*n*x+t*b*x+f*n*S-t*m*S)*D,e[10]=(o*b*i-_*a*i+_*n*d-t*b*d-o*n*S+t*a*S)*D,e[11]=(f*a*i-o*m*i-f*n*d+t*m*d+o*n*x-t*a*x)*D,e[12]=k*D,e[13]=(f*b*s-_*m*s+_*n*v-t*b*v-f*n*w+t*m*w)*D,e[14]=(_*a*s-o*b*s-_*n*c+t*b*c+o*n*w-t*a*w)*D,e[15]=(o*m*s-f*a*s+f*n*c-t*m*c-o*n*v+t*a*v)*D,this}scale(e){const t=this.elements,n=e.x,s=e.y,i=e.z;return t[0]*=n,t[4]*=s,t[8]*=i,t[1]*=n,t[5]*=s,t[9]*=i,t[2]*=n,t[6]*=s,t[10]*=i,t[3]*=n,t[7]*=s,t[11]*=i,this}getMaxScaleOnAxis(){const e=this.elements,t=e[0]*e[0]+e[1]*e[1]+e[2]*e[2],n=e[4]*e[4]+e[5]*e[5]+e[6]*e[6],s=e[8]*e[8]+e[9]*e[9]+e[10]*e[10];return Math.sqrt(Math.max(t,n,s))}makeTranslation(e,t,n){return e.isVector3?this.set(1,0,0,e.x,0,1,0,e.y,0,0,1,e.z,0,0,0,1):this.set(1,0,0,e,0,1,0,t,0,0,1,n,0,0,0,1),this}makeRotationX(e){const t=Math.cos(e),n=Math.sin(e);return this.set(1,0,0,0,0,t,-n,0,0,n,t,0,0,0,0,1),this}makeRotationY(e){const t=Math.cos(e),n=Math.sin(e);return this.set(t,0,n,0,0,1,0,0,-n,0,t,0,0,0,0,1),this}makeRotationZ(e){const t=Math.cos(e),n=Math.sin(e);return this.set(t,-n,0,0,n,t,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(e,t){const n=Math.cos(t),s=Math.sin(t),i=1-n,o=e.x,a=e.y,c=e.z,d=i*o,f=i*a;return this.set(d*o+n,d*a-s*c,d*c+s*a,0,d*a+s*c,f*a+n,f*c-s*o,0,d*c-s*a,f*c+s*o,i*c*c+n,0,0,0,0,1),this}makeScale(e,t,n){return this.set(e,0,0,0,0,t,0,0,0,0,n,0,0,0,0,1),this}makeShear(e,t,n,s,i,o){return this.set(1,n,i,0,e,1,o,0,t,s,1,0,0,0,0,1),this}compose(e,t,n){const s=this.elements,i=t._x,o=t._y,a=t._z,c=t._w,d=i+i,f=o+o,m=a+a,v=i*d,x=i*f,_=i*m,b=o*f,w=o*m,S=a*m,C=c*d,T=c*f,A=c*m,k=n.x,j=n.y,D=n.z;return s[0]=(1-(b+S))*k,s[1]=(x+A)*k,s[2]=(_-T)*k,s[3]=0,s[4]=(x-A)*j,s[5]=(1-(v+S))*j,s[6]=(w+C)*j,s[7]=0,s[8]=(_+T)*D,s[9]=(w-C)*D,s[10]=(1-(v+b))*D,s[11]=0,s[12]=e.x,s[13]=e.y,s[14]=e.z,s[15]=1,this}decompose(e,t,n){const s=this.elements;let i=Yf.set(s[0],s[1],s[2]).length();const o=Yf.set(s[4],s[5],s[6]).length(),a=Yf.set(s[8],s[9],s[10]).length();this.determinant()<0&&(i=-i),e.x=s[12],e.y=s[13],e.z=s[14],Yo.copy(this);const d=1/i,f=1/o,m=1/a;return Yo.elements[0]*=d,Yo.elements[1]*=d,Yo.elements[2]*=d,Yo.elements[4]*=f,Yo.elements[5]*=f,Yo.elements[6]*=f,Yo.elements[8]*=m,Yo.elements[9]*=m,Yo.elements[10]*=m,t.setFromRotationMatrix(Yo),n.x=i,n.y=o,n.z=a,this}makePerspective(e,t,n,s,i,o,a=xo){const c=this.elements,d=2*i/(t-e),f=2*i/(n-s),m=(t+e)/(t-e),v=(n+s)/(n-s);let x,_;if(a===xo)x=-(o+i)/(o-i),_=-2*o*i/(o-i);else if(a===w0)x=-o/(o-i),_=-o*i/(o-i);else throw new Error("THREE.Matrix4.makePerspective(): Invalid coordinate system: "+a);return c[0]=d,c[4]=0,c[8]=m,c[12]=0,c[1]=0,c[5]=f,c[9]=v,c[13]=0,c[2]=0,c[6]=0,c[10]=x,c[14]=_,c[3]=0,c[7]=0,c[11]=-1,c[15]=0,this}makeOrthographic(e,t,n,s,i,o,a=xo){const c=this.elements,d=1/(t-e),f=1/(n-s),m=1/(o-i),v=(t+e)*d,x=(n+s)*f;let _,b;if(a===xo)_=(o+i)*m,b=-2*m;else if(a===w0)_=i*m,b=-1*m;else throw new Error("THREE.Matrix4.makeOrthographic(): Invalid coordinate system: "+a);return c[0]=2*d,c[4]=0,c[8]=0,c[12]=-v,c[1]=0,c[5]=2*f,c[9]=0,c[13]=-x,c[2]=0,c[6]=0,c[10]=b,c[14]=-_,c[3]=0,c[7]=0,c[11]=0,c[15]=1,this}equals(e){const t=this.elements,n=e.elements;for(let s=0;s<16;s++)if(t[s]!==n[s])return!1;return!0}fromArray(e,t=0){for(let n=0;n<16;n++)this.elements[n]=e[n+t];return this}toArray(e=[],t=0){const n=this.elements;return e[t]=n[0],e[t+1]=n[1],e[t+2]=n[2],e[t+3]=n[3],e[t+4]=n[4],e[t+5]=n[5],e[t+6]=n[6],e[t+7]=n[7],e[t+8]=n[8],e[t+9]=n[9],e[t+10]=n[10],e[t+11]=n[11],e[t+12]=n[12],e[t+13]=n[13],e[t+14]=n[14],e[t+15]=n[15],e}}const Yf=new J,Yo=new Jt,t$=new J(0,0,0),n$=new J(1,1,1),zc=new J,vx=new J,Xi=new J,yC=new Jt,_C=new Gs;class eo{constructor(e=0,t=0,n=0,s=eo.DEFAULT_ORDER){this.isEuler=!0,this._x=e,this._y=t,this._z=n,this._order=s}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get order(){return this._order}set order(e){this._order=e,this._onChangeCallback()}set(e,t,n,s=this._order){return this._x=e,this._y=t,this._z=n,this._order=s,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(e){return this._x=e._x,this._y=e._y,this._z=e._z,this._order=e._order,this._onChangeCallback(),this}setFromRotationMatrix(e,t=this._order,n=!0){const s=e.elements,i=s[0],o=s[4],a=s[8],c=s[1],d=s[5],f=s[9],m=s[2],v=s[6],x=s[10];switch(t){case"XYZ":this._y=Math.asin(an(a,-1,1)),Math.abs(a)<.9999999?(this._x=Math.atan2(-f,x),this._z=Math.atan2(-o,i)):(this._x=Math.atan2(v,d),this._z=0);break;case"YXZ":this._x=Math.asin(-an(f,-1,1)),Math.abs(f)<.9999999?(this._y=Math.atan2(a,x),this._z=Math.atan2(c,d)):(this._y=Math.atan2(-m,i),this._z=0);break;case"ZXY":this._x=Math.asin(an(v,-1,1)),Math.abs(v)<.9999999?(this._y=Math.atan2(-m,x),this._z=Math.atan2(-o,d)):(this._y=0,this._z=Math.atan2(c,i));break;case"ZYX":this._y=Math.asin(-an(m,-1,1)),Math.abs(m)<.9999999?(this._x=Math.atan2(v,x),this._z=Math.atan2(c,i)):(this._x=0,this._z=Math.atan2(-o,d));break;case"YZX":this._z=Math.asin(an(c,-1,1)),Math.abs(c)<.9999999?(this._x=Math.atan2(-f,d),this._y=Math.atan2(-m,i)):(this._x=0,this._y=Math.atan2(a,x));break;case"XZY":this._z=Math.asin(-an(o,-1,1)),Math.abs(o)<.9999999?(this._x=Math.atan2(v,d),this._y=Math.atan2(a,i)):(this._x=Math.atan2(-f,x),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+t)}return this._order=t,n===!0&&this._onChangeCallback(),this}setFromQuaternion(e,t,n){return yC.makeRotationFromQuaternion(e),this.setFromRotationMatrix(yC,t,n)}setFromVector3(e,t=this._order){return this.set(e.x,e.y,e.z,t)}reorder(e){return _C.setFromEuler(this),this.setFromQuaternion(_C,e)}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._order===this._order}fromArray(e){return this._x=e[0],this._y=e[1],this._z=e[2],e[3]!==void 0&&(this._order=e[3]),this._onChangeCallback(),this}toArray(e=[],t=0){return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._order,e}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._order}}eo.DEFAULT_ORDER="XYZ";class Zd{constructor(){this.mask=1}set(e){this.mask=(1<<e|0)>>>0}enable(e){this.mask|=1<<e|0}enableAll(){this.mask=-1}toggle(e){this.mask^=1<<e|0}disable(e){this.mask&=~(1<<e|0)}disableAll(){this.mask=0}test(e){return(this.mask&e.mask)!==0}isEnabled(e){return(this.mask&(1<<e|0))!==0}}let r$=0;const wC=new J,Kf=new Gs,Il=new Jt,xx=new J,yg=new J,s$=new J,i$=new Gs,SC=new J(1,0,0),bC=new J(0,1,0),EC=new J(0,0,1),MC={type:"added"},o$={type:"removed"},Qf={type:"childadded",child:null},$1={type:"childremoved",child:null};class jn extends Xa{constructor(){super(),this.isObject3D=!0,Object.defineProperty(this,"id",{value:r$++}),this.uuid=Zi(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=jn.DEFAULT_UP.clone();const e=new J,t=new eo,n=new Gs,s=new J(1,1,1);function i(){n.setFromEuler(t,!1)}function o(){t.setFromQuaternion(n,void 0,!1)}t._onChange(i),n._onChange(o),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:e},rotation:{configurable:!0,enumerable:!0,value:t},quaternion:{configurable:!0,enumerable:!0,value:n},scale:{configurable:!0,enumerable:!0,value:s},modelViewMatrix:{value:new Jt},normalMatrix:{value:new cn}}),this.matrix=new Jt,this.matrixWorld=new Jt,this.matrixAutoUpdate=jn.DEFAULT_MATRIX_AUTO_UPDATE,this.matrixWorldAutoUpdate=jn.DEFAULT_MATRIX_WORLD_AUTO_UPDATE,this.matrixWorldNeedsUpdate=!1,this.layers=new Zd,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.customDepthMaterial=void 0,this.customDistanceMaterial=void 0,this.userData={}}onBeforeShadow(){}onAfterShadow(){}onBeforeRender(){}onAfterRender(){}applyMatrix4(e){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(e),this.matrix.decompose(this.position,this.quaternion,this.scale)}applyQuaternion(e){return this.quaternion.premultiply(e),this}setRotationFromAxisAngle(e,t){this.quaternion.setFromAxisAngle(e,t)}setRotationFromEuler(e){this.quaternion.setFromEuler(e,!0)}setRotationFromMatrix(e){this.quaternion.setFromRotationMatrix(e)}setRotationFromQuaternion(e){this.quaternion.copy(e)}rotateOnAxis(e,t){return Kf.setFromAxisAngle(e,t),this.quaternion.multiply(Kf),this}rotateOnWorldAxis(e,t){return Kf.setFromAxisAngle(e,t),this.quaternion.premultiply(Kf),this}rotateX(e){return this.rotateOnAxis(SC,e)}rotateY(e){return this.rotateOnAxis(bC,e)}rotateZ(e){return this.rotateOnAxis(EC,e)}translateOnAxis(e,t){return wC.copy(e).applyQuaternion(this.quaternion),this.position.add(wC.multiplyScalar(t)),this}translateX(e){return this.translateOnAxis(SC,e)}translateY(e){return this.translateOnAxis(bC,e)}translateZ(e){return this.translateOnAxis(EC,e)}localToWorld(e){return this.updateWorldMatrix(!0,!1),e.applyMatrix4(this.matrixWorld)}worldToLocal(e){return this.updateWorldMatrix(!0,!1),e.applyMatrix4(Il.copy(this.matrixWorld).invert())}lookAt(e,t,n){e.isVector3?xx.copy(e):xx.set(e,t,n);const s=this.parent;this.updateWorldMatrix(!0,!1),yg.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?Il.lookAt(yg,xx,this.up):Il.lookAt(xx,yg,this.up),this.quaternion.setFromRotationMatrix(Il),s&&(Il.extractRotation(s.matrixWorld),Kf.setFromRotationMatrix(Il),this.quaternion.premultiply(Kf.invert()))}add(e){if(arguments.length>1){for(let t=0;t<arguments.length;t++)this.add(arguments[t]);return this}return e===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",e),this):(e&&e.isObject3D?(e.removeFromParent(),e.parent=this,this.children.push(e),e.dispatchEvent(MC),Qf.child=e,this.dispatchEvent(Qf),Qf.child=null):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",e),this)}remove(e){if(arguments.length>1){for(let n=0;n<arguments.length;n++)this.remove(arguments[n]);return this}const t=this.children.indexOf(e);return t!==-1&&(e.parent=null,this.children.splice(t,1),e.dispatchEvent(o$),$1.child=e,this.dispatchEvent($1),$1.child=null),this}removeFromParent(){const e=this.parent;return e!==null&&e.remove(this),this}clear(){return this.remove(...this.children)}attach(e){return this.updateWorldMatrix(!0,!1),Il.copy(this.matrixWorld).invert(),e.parent!==null&&(e.parent.updateWorldMatrix(!0,!1),Il.multiply(e.parent.matrixWorld)),e.applyMatrix4(Il),e.removeFromParent(),e.parent=this,this.children.push(e),e.updateWorldMatrix(!1,!0),e.dispatchEvent(MC),Qf.child=e,this.dispatchEvent(Qf),Qf.child=null,this}getObjectById(e){return this.getObjectByProperty("id",e)}getObjectByName(e){return this.getObjectByProperty("name",e)}getObjectByProperty(e,t){if(this[e]===t)return this;for(let n=0,s=this.children.length;n<s;n++){const o=this.children[n].getObjectByProperty(e,t);if(o!==void 0)return o}}getObjectsByProperty(e,t,n=[]){this[e]===t&&n.push(this);const s=this.children;for(let i=0,o=s.length;i<o;i++)s[i].getObjectsByProperty(e,t,n);return n}getWorldPosition(e){return this.updateWorldMatrix(!0,!1),e.setFromMatrixPosition(this.matrixWorld)}getWorldQuaternion(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(yg,e,s$),e}getWorldScale(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(yg,i$,e),e}getWorldDirection(e){this.updateWorldMatrix(!0,!1);const t=this.matrixWorld.elements;return e.set(t[8],t[9],t[10]).normalize()}raycast(){}traverse(e){e(this);const t=this.children;for(let n=0,s=t.length;n<s;n++)t[n].traverse(e)}traverseVisible(e){if(this.visible===!1)return;e(this);const t=this.children;for(let n=0,s=t.length;n<s;n++)t[n].traverseVisible(e)}traverseAncestors(e){const t=this.parent;t!==null&&(e(t),t.traverseAncestors(e))}updateMatrix(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(e){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||e)&&(this.matrixWorldAutoUpdate===!0&&(this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix)),this.matrixWorldNeedsUpdate=!1,e=!0);const t=this.children;for(let n=0,s=t.length;n<s;n++)t[n].updateMatrixWorld(e)}updateWorldMatrix(e,t){const n=this.parent;if(e===!0&&n!==null&&n.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),this.matrixWorldAutoUpdate===!0&&(this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix)),t===!0){const s=this.children;for(let i=0,o=s.length;i<o;i++)s[i].updateWorldMatrix(!1,!0)}}toJSON(e){const t=e===void 0||typeof e=="string",n={};t&&(e={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{},nodes:{}},n.metadata={version:4.7,type:"Object",generator:"Object3D.toJSON"});const s={};s.uuid=this.uuid,s.type=this.type,this.name!==""&&(s.name=this.name),this.castShadow===!0&&(s.castShadow=!0),this.receiveShadow===!0&&(s.receiveShadow=!0),this.visible===!1&&(s.visible=!1),this.frustumCulled===!1&&(s.frustumCulled=!1),this.renderOrder!==0&&(s.renderOrder=this.renderOrder),Object.keys(this.userData).length>0&&(s.userData=this.userData),s.layers=this.layers.mask,s.matrix=this.matrix.toArray(),s.up=this.up.toArray(),this.matrixAutoUpdate===!1&&(s.matrixAutoUpdate=!1),this.isInstancedMesh&&(s.type="InstancedMesh",s.count=this.count,s.instanceMatrix=this.instanceMatrix.toJSON(),this.instanceColor!==null&&(s.instanceColor=this.instanceColor.toJSON())),this.isBatchedMesh&&(s.type="BatchedMesh",s.perObjectFrustumCulled=this.perObjectFrustumCulled,s.sortObjects=this.sortObjects,s.drawRanges=this._drawRanges,s.reservedRanges=this._reservedRanges,s.geometryInfo=this._geometryInfo.map(a=>({...a,boundingBox:a.boundingBox?a.boundingBox.toJSON():void 0,boundingSphere:a.boundingSphere?a.boundingSphere.toJSON():void 0})),s.instanceInfo=this._instanceInfo.map(a=>({...a})),s.availableInstanceIds=this._availableInstanceIds.slice(),s.availableGeometryIds=this._availableGeometryIds.slice(),s.nextIndexStart=this._nextIndexStart,s.nextVertexStart=this._nextVertexStart,s.geometryCount=this._geometryCount,s.maxInstanceCount=this._maxInstanceCount,s.maxVertexCount=this._maxVertexCount,s.maxIndexCount=this._maxIndexCount,s.geometryInitialized=this._geometryInitialized,s.matricesTexture=this._matricesTexture.toJSON(e),s.indirectTexture=this._indirectTexture.toJSON(e),this._colorsTexture!==null&&(s.colorsTexture=this._colorsTexture.toJSON(e)),this.boundingSphere!==null&&(s.boundingSphere=this.boundingSphere.toJSON()),this.boundingBox!==null&&(s.boundingBox=this.boundingBox.toJSON()));function i(a,c){return a[c.uuid]===void 0&&(a[c.uuid]=c.toJSON(e)),c.uuid}if(this.isScene)this.background&&(this.background.isColor?s.background=this.background.toJSON():this.background.isTexture&&(s.background=this.background.toJSON(e).uuid)),this.environment&&this.environment.isTexture&&this.environment.isRenderTargetTexture!==!0&&(s.environment=this.environment.toJSON(e).uuid);else if(this.isMesh||this.isLine||this.isPoints){s.geometry=i(e.geometries,this.geometry);const a=this.geometry.parameters;if(a!==void 0&&a.shapes!==void 0){const c=a.shapes;if(Array.isArray(c))for(let d=0,f=c.length;d<f;d++){const m=c[d];i(e.shapes,m)}else i(e.shapes,c)}}if(this.isSkinnedMesh&&(s.bindMode=this.bindMode,s.bindMatrix=this.bindMatrix.toArray(),this.skeleton!==void 0&&(i(e.skeletons,this.skeleton),s.skeleton=this.skeleton.uuid)),this.material!==void 0)if(Array.isArray(this.material)){const a=[];for(let c=0,d=this.material.length;c<d;c++)a.push(i(e.materials,this.material[c]));s.material=a}else s.material=i(e.materials,this.material);if(this.children.length>0){s.children=[];for(let a=0;a<this.children.length;a++)s.children.push(this.children[a].toJSON(e).object)}if(this.animations.length>0){s.animations=[];for(let a=0;a<this.animations.length;a++){const c=this.animations[a];s.animations.push(i(e.animations,c))}}if(t){const a=o(e.geometries),c=o(e.materials),d=o(e.textures),f=o(e.images),m=o(e.shapes),v=o(e.skeletons),x=o(e.animations),_=o(e.nodes);a.length>0&&(n.geometries=a),c.length>0&&(n.materials=c),d.length>0&&(n.textures=d),f.length>0&&(n.images=f),m.length>0&&(n.shapes=m),v.length>0&&(n.skeletons=v),x.length>0&&(n.animations=x),_.length>0&&(n.nodes=_)}return n.object=s,n;function o(a){const c=[];for(const d in a){const f=a[d];delete f.metadata,c.push(f)}return c}}clone(e){return new this.constructor().copy(this,e)}copy(e,t=!0){if(this.name=e.name,this.up.copy(e.up),this.position.copy(e.position),this.rotation.order=e.rotation.order,this.quaternion.copy(e.quaternion),this.scale.copy(e.scale),this.matrix.copy(e.matrix),this.matrixWorld.copy(e.matrixWorld),this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrixWorldAutoUpdate=e.matrixWorldAutoUpdate,this.matrixWorldNeedsUpdate=e.matrixWorldNeedsUpdate,this.layers.mask=e.layers.mask,this.visible=e.visible,this.castShadow=e.castShadow,this.receiveShadow=e.receiveShadow,this.frustumCulled=e.frustumCulled,this.renderOrder=e.renderOrder,this.animations=e.animations.slice(),this.userData=JSON.parse(JSON.stringify(e.userData)),t===!0)for(let n=0;n<e.children.length;n++){const s=e.children[n];this.add(s.clone())}return this}}jn.DEFAULT_UP=new J(0,1,0);jn.DEFAULT_MATRIX_AUTO_UPDATE=!0;jn.DEFAULT_MATRIX_WORLD_AUTO_UPDATE=!0;const Ko=new J,kl=new J,q1=new J,Dl=new J,Jf=new J,Zf=new J,TC=new J,X1=new J,Y1=new J,K1=new J,Q1=new On,J1=new On,Z1=new On;class Pi{constructor(e=new J,t=new J,n=new J){this.a=e,this.b=t,this.c=n}static getNormal(e,t,n,s){s.subVectors(n,t),Ko.subVectors(e,t),s.cross(Ko);const i=s.lengthSq();return i>0?s.multiplyScalar(1/Math.sqrt(i)):s.set(0,0,0)}static getBarycoord(e,t,n,s,i){Ko.subVectors(s,t),kl.subVectors(n,t),q1.subVectors(e,t);const o=Ko.dot(Ko),a=Ko.dot(kl),c=Ko.dot(q1),d=kl.dot(kl),f=kl.dot(q1),m=o*d-a*a;if(m===0)return i.set(0,0,0),null;const v=1/m,x=(d*c-a*f)*v,_=(o*f-a*c)*v;return i.set(1-x-_,_,x)}static containsPoint(e,t,n,s){return this.getBarycoord(e,t,n,s,Dl)===null?!1:Dl.x>=0&&Dl.y>=0&&Dl.x+Dl.y<=1}static getInterpolation(e,t,n,s,i,o,a,c){return this.getBarycoord(e,t,n,s,Dl)===null?(c.x=0,c.y=0,"z"in c&&(c.z=0),"w"in c&&(c.w=0),null):(c.setScalar(0),c.addScaledVector(i,Dl.x),c.addScaledVector(o,Dl.y),c.addScaledVector(a,Dl.z),c)}static getInterpolatedAttribute(e,t,n,s,i,o){return Q1.setScalar(0),J1.setScalar(0),Z1.setScalar(0),Q1.fromBufferAttribute(e,t),J1.fromBufferAttribute(e,n),Z1.fromBufferAttribute(e,s),o.setScalar(0),o.addScaledVector(Q1,i.x),o.addScaledVector(J1,i.y),o.addScaledVector(Z1,i.z),o}static isFrontFacing(e,t,n,s){return Ko.subVectors(n,t),kl.subVectors(e,t),Ko.cross(kl).dot(s)<0}set(e,t,n){return this.a.copy(e),this.b.copy(t),this.c.copy(n),this}setFromPointsAndIndices(e,t,n,s){return this.a.copy(e[t]),this.b.copy(e[n]),this.c.copy(e[s]),this}setFromAttributeAndIndices(e,t,n,s){return this.a.fromBufferAttribute(e,t),this.b.fromBufferAttribute(e,n),this.c.fromBufferAttribute(e,s),this}clone(){return new this.constructor().copy(this)}copy(e){return this.a.copy(e.a),this.b.copy(e.b),this.c.copy(e.c),this}getArea(){return Ko.subVectors(this.c,this.b),kl.subVectors(this.a,this.b),Ko.cross(kl).length()*.5}getMidpoint(e){return e.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)}getNormal(e){return Pi.getNormal(this.a,this.b,this.c,e)}getPlane(e){return e.setFromCoplanarPoints(this.a,this.b,this.c)}getBarycoord(e,t){return Pi.getBarycoord(e,this.a,this.b,this.c,t)}getInterpolation(e,t,n,s,i){return Pi.getInterpolation(e,this.a,this.b,this.c,t,n,s,i)}containsPoint(e){return Pi.containsPoint(e,this.a,this.b,this.c)}isFrontFacing(e){return Pi.isFrontFacing(this.a,this.b,this.c,e)}intersectsBox(e){return e.intersectsTriangle(this)}closestPointToPoint(e,t){const n=this.a,s=this.b,i=this.c;let o,a;Jf.subVectors(s,n),Zf.subVectors(i,n),X1.subVectors(e,n);const c=Jf.dot(X1),d=Zf.dot(X1);if(c<=0&&d<=0)return t.copy(n);Y1.subVectors(e,s);const f=Jf.dot(Y1),m=Zf.dot(Y1);if(f>=0&&m<=f)return t.copy(s);const v=c*m-f*d;if(v<=0&&c>=0&&f<=0)return o=c/(c-f),t.copy(n).addScaledVector(Jf,o);K1.subVectors(e,i);const x=Jf.dot(K1),_=Zf.dot(K1);if(_>=0&&x<=_)return t.copy(i);const b=x*d-c*_;if(b<=0&&d>=0&&_<=0)return a=d/(d-_),t.copy(n).addScaledVector(Zf,a);const w=f*_-x*m;if(w<=0&&m-f>=0&&x-_>=0)return TC.subVectors(i,s),a=(m-f)/(m-f+(x-_)),t.copy(s).addScaledVector(TC,a);const S=1/(w+b+v);return o=b*S,a=v*S,t.copy(n).addScaledVector(Jf,o).addScaledVector(Zf,a)}equals(e){return e.a.equals(this.a)&&e.b.equals(this.b)&&e.c.equals(this.c)}}const B4={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},Vc={h:0,s:0,l:0},yx={h:0,s:0,l:0};function eS(r,e,t){return t<0&&(t+=1),t>1&&(t-=1),t<1/6?r+(e-r)*6*t:t<1/2?e:t<2/3?r+(e-r)*6*(2/3-t):r}class St{constructor(e,t,n){return this.isColor=!0,this.r=1,this.g=1,this.b=1,this.set(e,t,n)}set(e,t,n){if(t===void 0&&n===void 0){const s=e;s&&s.isColor?this.copy(s):typeof s=="number"?this.setHex(s):typeof s=="string"&&this.setStyle(s)}else this.setRGB(e,t,n);return this}setScalar(e){return this.r=e,this.g=e,this.b=e,this}setHex(e,t=Ni){return e=Math.floor(e),this.r=(e>>16&255)/255,this.g=(e>>8&255)/255,this.b=(e&255)/255,kn.colorSpaceToWorking(this,t),this}setRGB(e,t,n,s=kn.workingColorSpace){return this.r=e,this.g=t,this.b=n,kn.colorSpaceToWorking(this,s),this}setHSL(e,t,n,s=kn.workingColorSpace){if(e=gM(e,1),t=an(t,0,1),n=an(n,0,1),t===0)this.r=this.g=this.b=n;else{const i=n<=.5?n*(1+t):n+t-n*t,o=2*n-i;this.r=eS(o,i,e+1/3),this.g=eS(o,i,e),this.b=eS(o,i,e-1/3)}return kn.colorSpaceToWorking(this,s),this}setStyle(e,t=Ni){function n(i){i!==void 0&&parseFloat(i)<1&&console.warn("THREE.Color: Alpha component of "+e+" will be ignored.")}let s;if(s=/^(\w+)\(([^\)]*)\)/.exec(e)){let i;const o=s[1],a=s[2];switch(o){case"rgb":case"rgba":if(i=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(a))return n(i[4]),this.setRGB(Math.min(255,parseInt(i[1],10))/255,Math.min(255,parseInt(i[2],10))/255,Math.min(255,parseInt(i[3],10))/255,t);if(i=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(a))return n(i[4]),this.setRGB(Math.min(100,parseInt(i[1],10))/100,Math.min(100,parseInt(i[2],10))/100,Math.min(100,parseInt(i[3],10))/100,t);break;case"hsl":case"hsla":if(i=/^\s*(\d*\.?\d+)\s*,\s*(\d*\.?\d+)\%\s*,\s*(\d*\.?\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(a))return n(i[4]),this.setHSL(parseFloat(i[1])/360,parseFloat(i[2])/100,parseFloat(i[3])/100,t);break;default:console.warn("THREE.Color: Unknown color model "+e)}}else if(s=/^\#([A-Fa-f\d]+)$/.exec(e)){const i=s[1],o=i.length;if(o===3)return this.setRGB(parseInt(i.charAt(0),16)/15,parseInt(i.charAt(1),16)/15,parseInt(i.charAt(2),16)/15,t);if(o===6)return this.setHex(parseInt(i,16),t);console.warn("THREE.Color: Invalid hex color "+e)}else if(e&&e.length>0)return this.setColorName(e,t);return this}setColorName(e,t=Ni){const n=B4[e.toLowerCase()];return n!==void 0?this.setHex(n,t):console.warn("THREE.Color: Unknown color "+e),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(e){return this.r=e.r,this.g=e.g,this.b=e.b,this}copySRGBToLinear(e){return this.r=$l(e.r),this.g=$l(e.g),this.b=$l(e.b),this}copyLinearToSRGB(e){return this.r=Cp(e.r),this.g=Cp(e.g),this.b=Cp(e.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(e=Ni){return kn.workingToColorSpace(Os.copy(this),e),Math.round(an(Os.r*255,0,255))*65536+Math.round(an(Os.g*255,0,255))*256+Math.round(an(Os.b*255,0,255))}getHexString(e=Ni){return("000000"+this.getHex(e).toString(16)).slice(-6)}getHSL(e,t=kn.workingColorSpace){kn.workingToColorSpace(Os.copy(this),t);const n=Os.r,s=Os.g,i=Os.b,o=Math.max(n,s,i),a=Math.min(n,s,i);let c,d;const f=(a+o)/2;if(a===o)c=0,d=0;else{const m=o-a;switch(d=f<=.5?m/(o+a):m/(2-o-a),o){case n:c=(s-i)/m+(s<i?6:0);break;case s:c=(i-n)/m+2;break;case i:c=(n-s)/m+4;break}c/=6}return e.h=c,e.s=d,e.l=f,e}getRGB(e,t=kn.workingColorSpace){return kn.workingToColorSpace(Os.copy(this),t),e.r=Os.r,e.g=Os.g,e.b=Os.b,e}getStyle(e=Ni){kn.workingToColorSpace(Os.copy(this),e);const t=Os.r,n=Os.g,s=Os.b;return e!==Ni?`color(${e} ${t.toFixed(3)} ${n.toFixed(3)} ${s.toFixed(3)})`:`rgb(${Math.round(t*255)},${Math.round(n*255)},${Math.round(s*255)})`}offsetHSL(e,t,n){return this.getHSL(Vc),this.setHSL(Vc.h+e,Vc.s+t,Vc.l+n)}add(e){return this.r+=e.r,this.g+=e.g,this.b+=e.b,this}addColors(e,t){return this.r=e.r+t.r,this.g=e.g+t.g,this.b=e.b+t.b,this}addScalar(e){return this.r+=e,this.g+=e,this.b+=e,this}sub(e){return this.r=Math.max(0,this.r-e.r),this.g=Math.max(0,this.g-e.g),this.b=Math.max(0,this.b-e.b),this}multiply(e){return this.r*=e.r,this.g*=e.g,this.b*=e.b,this}multiplyScalar(e){return this.r*=e,this.g*=e,this.b*=e,this}lerp(e,t){return this.r+=(e.r-this.r)*t,this.g+=(e.g-this.g)*t,this.b+=(e.b-this.b)*t,this}lerpColors(e,t,n){return this.r=e.r+(t.r-e.r)*n,this.g=e.g+(t.g-e.g)*n,this.b=e.b+(t.b-e.b)*n,this}lerpHSL(e,t){this.getHSL(Vc),e.getHSL(yx);const n=Jg(Vc.h,yx.h,t),s=Jg(Vc.s,yx.s,t),i=Jg(Vc.l,yx.l,t);return this.setHSL(n,s,i),this}setFromVector3(e){return this.r=e.x,this.g=e.y,this.b=e.z,this}applyMatrix3(e){const t=this.r,n=this.g,s=this.b,i=e.elements;return this.r=i[0]*t+i[3]*n+i[6]*s,this.g=i[1]*t+i[4]*n+i[7]*s,this.b=i[2]*t+i[5]*n+i[8]*s,this}equals(e){return e.r===this.r&&e.g===this.g&&e.b===this.b}fromArray(e,t=0){return this.r=e[t],this.g=e[t+1],this.b=e[t+2],this}toArray(e=[],t=0){return e[t]=this.r,e[t+1]=this.g,e[t+2]=this.b,e}fromBufferAttribute(e,t){return this.r=e.getX(t),this.g=e.getY(t),this.b=e.getZ(t),this}toJSON(){return this.getHex()}*[Symbol.iterator](){yield this.r,yield this.g,yield this.b}}const Os=new St;St.NAMES=B4;let a$=0;class $s extends Xa{constructor(){super(),this.isMaterial=!0,Object.defineProperty(this,"id",{value:a$++}),this.uuid=Zi(),this.name="",this.type="Material",this.blending=Qd,this.side=Zl,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.alphaHash=!1,this.blendSrc=Iy,this.blendDst=ky,this.blendEquation=Qc,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.blendColor=new St(0,0,0),this.blendAlpha=0,this.depthFunc=dh,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=Ob,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=Id,this.stencilZFail=Id,this.stencilZPass=Id,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaToCoverage=!1,this.premultipliedAlpha=!1,this.forceSinglePass=!1,this.allowOverride=!0,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0,this._alphaTest=0}get alphaTest(){return this._alphaTest}set alphaTest(e){this._alphaTest>0!=e>0&&this.version++,this._alphaTest=e}onBeforeRender(){}onBeforeCompile(){}customProgramCacheKey(){return this.onBeforeCompile.toString()}setValues(e){if(e!==void 0)for(const t in e){const n=e[t];if(n===void 0){console.warn(`THREE.Material: parameter '${t}' has value of undefined.`);continue}const s=this[t];if(s===void 0){console.warn(`THREE.Material: '${t}' is not a property of THREE.${this.type}.`);continue}s&&s.isColor?s.set(n):s&&s.isVector3&&n&&n.isVector3?s.copy(n):this[t]=n}}toJSON(e){const t=e===void 0||typeof e=="string";t&&(e={textures:{},images:{}});const n={metadata:{version:4.7,type:"Material",generator:"Material.toJSON"}};n.uuid=this.uuid,n.type=this.type,this.name!==""&&(n.name=this.name),this.color&&this.color.isColor&&(n.color=this.color.getHex()),this.roughness!==void 0&&(n.roughness=this.roughness),this.metalness!==void 0&&(n.metalness=this.metalness),this.sheen!==void 0&&(n.sheen=this.sheen),this.sheenColor&&this.sheenColor.isColor&&(n.sheenColor=this.sheenColor.getHex()),this.sheenRoughness!==void 0&&(n.sheenRoughness=this.sheenRoughness),this.emissive&&this.emissive.isColor&&(n.emissive=this.emissive.getHex()),this.emissiveIntensity!==void 0&&this.emissiveIntensity!==1&&(n.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(n.specular=this.specular.getHex()),this.specularIntensity!==void 0&&(n.specularIntensity=this.specularIntensity),this.specularColor&&this.specularColor.isColor&&(n.specularColor=this.specularColor.getHex()),this.shininess!==void 0&&(n.shininess=this.shininess),this.clearcoat!==void 0&&(n.clearcoat=this.clearcoat),this.clearcoatRoughness!==void 0&&(n.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(n.clearcoatMap=this.clearcoatMap.toJSON(e).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(n.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(e).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(n.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(e).uuid,n.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),this.dispersion!==void 0&&(n.dispersion=this.dispersion),this.iridescence!==void 0&&(n.iridescence=this.iridescence),this.iridescenceIOR!==void 0&&(n.iridescenceIOR=this.iridescenceIOR),this.iridescenceThicknessRange!==void 0&&(n.iridescenceThicknessRange=this.iridescenceThicknessRange),this.iridescenceMap&&this.iridescenceMap.isTexture&&(n.iridescenceMap=this.iridescenceMap.toJSON(e).uuid),this.iridescenceThicknessMap&&this.iridescenceThicknessMap.isTexture&&(n.iridescenceThicknessMap=this.iridescenceThicknessMap.toJSON(e).uuid),this.anisotropy!==void 0&&(n.anisotropy=this.anisotropy),this.anisotropyRotation!==void 0&&(n.anisotropyRotation=this.anisotropyRotation),this.anisotropyMap&&this.anisotropyMap.isTexture&&(n.anisotropyMap=this.anisotropyMap.toJSON(e).uuid),this.map&&this.map.isTexture&&(n.map=this.map.toJSON(e).uuid),this.matcap&&this.matcap.isTexture&&(n.matcap=this.matcap.toJSON(e).uuid),this.alphaMap&&this.alphaMap.isTexture&&(n.alphaMap=this.alphaMap.toJSON(e).uuid),this.lightMap&&this.lightMap.isTexture&&(n.lightMap=this.lightMap.toJSON(e).uuid,n.lightMapIntensity=this.lightMapIntensity),this.aoMap&&this.aoMap.isTexture&&(n.aoMap=this.aoMap.toJSON(e).uuid,n.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(n.bumpMap=this.bumpMap.toJSON(e).uuid,n.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(n.normalMap=this.normalMap.toJSON(e).uuid,n.normalMapType=this.normalMapType,n.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(n.displacementMap=this.displacementMap.toJSON(e).uuid,n.displacementScale=this.displacementScale,n.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(n.roughnessMap=this.roughnessMap.toJSON(e).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(n.metalnessMap=this.metalnessMap.toJSON(e).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(n.emissiveMap=this.emissiveMap.toJSON(e).uuid),this.specularMap&&this.specularMap.isTexture&&(n.specularMap=this.specularMap.toJSON(e).uuid),this.specularIntensityMap&&this.specularIntensityMap.isTexture&&(n.specularIntensityMap=this.specularIntensityMap.toJSON(e).uuid),this.specularColorMap&&this.specularColorMap.isTexture&&(n.specularColorMap=this.specularColorMap.toJSON(e).uuid),this.envMap&&this.envMap.isTexture&&(n.envMap=this.envMap.toJSON(e).uuid,this.combine!==void 0&&(n.combine=this.combine)),this.envMapRotation!==void 0&&(n.envMapRotation=this.envMapRotation.toArray()),this.envMapIntensity!==void 0&&(n.envMapIntensity=this.envMapIntensity),this.reflectivity!==void 0&&(n.reflectivity=this.reflectivity),this.refractionRatio!==void 0&&(n.refractionRatio=this.refractionRatio),this.gradientMap&&this.gradientMap.isTexture&&(n.gradientMap=this.gradientMap.toJSON(e).uuid),this.transmission!==void 0&&(n.transmission=this.transmission),this.transmissionMap&&this.transmissionMap.isTexture&&(n.transmissionMap=this.transmissionMap.toJSON(e).uuid),this.thickness!==void 0&&(n.thickness=this.thickness),this.thicknessMap&&this.thicknessMap.isTexture&&(n.thicknessMap=this.thicknessMap.toJSON(e).uuid),this.attenuationDistance!==void 0&&this.attenuationDistance!==1/0&&(n.attenuationDistance=this.attenuationDistance),this.attenuationColor!==void 0&&(n.attenuationColor=this.attenuationColor.getHex()),this.size!==void 0&&(n.size=this.size),this.shadowSide!==null&&(n.shadowSide=this.shadowSide),this.sizeAttenuation!==void 0&&(n.sizeAttenuation=this.sizeAttenuation),this.blending!==Qd&&(n.blending=this.blending),this.side!==Zl&&(n.side=this.side),this.vertexColors===!0&&(n.vertexColors=!0),this.opacity<1&&(n.opacity=this.opacity),this.transparent===!0&&(n.transparent=!0),this.blendSrc!==Iy&&(n.blendSrc=this.blendSrc),this.blendDst!==ky&&(n.blendDst=this.blendDst),this.blendEquation!==Qc&&(n.blendEquation=this.blendEquation),this.blendSrcAlpha!==null&&(n.blendSrcAlpha=this.blendSrcAlpha),this.blendDstAlpha!==null&&(n.blendDstAlpha=this.blendDstAlpha),this.blendEquationAlpha!==null&&(n.blendEquationAlpha=this.blendEquationAlpha),this.blendColor&&this.blendColor.isColor&&(n.blendColor=this.blendColor.getHex()),this.blendAlpha!==0&&(n.blendAlpha=this.blendAlpha),this.depthFunc!==dh&&(n.depthFunc=this.depthFunc),this.depthTest===!1&&(n.depthTest=this.depthTest),this.depthWrite===!1&&(n.depthWrite=this.depthWrite),this.colorWrite===!1&&(n.colorWrite=this.colorWrite),this.stencilWriteMask!==255&&(n.stencilWriteMask=this.stencilWriteMask),this.stencilFunc!==Ob&&(n.stencilFunc=this.stencilFunc),this.stencilRef!==0&&(n.stencilRef=this.stencilRef),this.stencilFuncMask!==255&&(n.stencilFuncMask=this.stencilFuncMask),this.stencilFail!==Id&&(n.stencilFail=this.stencilFail),this.stencilZFail!==Id&&(n.stencilZFail=this.stencilZFail),this.stencilZPass!==Id&&(n.stencilZPass=this.stencilZPass),this.stencilWrite===!0&&(n.stencilWrite=this.stencilWrite),this.rotation!==void 0&&this.rotation!==0&&(n.rotation=this.rotation),this.polygonOffset===!0&&(n.polygonOffset=!0),this.polygonOffsetFactor!==0&&(n.polygonOffsetFactor=this.polygonOffsetFactor),this.polygonOffsetUnits!==0&&(n.polygonOffsetUnits=this.polygonOffsetUnits),this.linewidth!==void 0&&this.linewidth!==1&&(n.linewidth=this.linewidth),this.dashSize!==void 0&&(n.dashSize=this.dashSize),this.gapSize!==void 0&&(n.gapSize=this.gapSize),this.scale!==void 0&&(n.scale=this.scale),this.dithering===!0&&(n.dithering=!0),this.alphaTest>0&&(n.alphaTest=this.alphaTest),this.alphaHash===!0&&(n.alphaHash=!0),this.alphaToCoverage===!0&&(n.alphaToCoverage=!0),this.premultipliedAlpha===!0&&(n.premultipliedAlpha=!0),this.forceSinglePass===!0&&(n.forceSinglePass=!0),this.wireframe===!0&&(n.wireframe=!0),this.wireframeLinewidth>1&&(n.wireframeLinewidth=this.wireframeLinewidth),this.wireframeLinecap!=="round"&&(n.wireframeLinecap=this.wireframeLinecap),this.wireframeLinejoin!=="round"&&(n.wireframeLinejoin=this.wireframeLinejoin),this.flatShading===!0&&(n.flatShading=!0),this.visible===!1&&(n.visible=!1),this.toneMapped===!1&&(n.toneMapped=!1),this.fog===!1&&(n.fog=!1),Object.keys(this.userData).length>0&&(n.userData=this.userData);function s(i){const o=[];for(const a in i){const c=i[a];delete c.metadata,o.push(c)}return o}if(t){const i=s(e.textures),o=s(e.images);i.length>0&&(n.textures=i),o.length>0&&(n.images=o)}return n}clone(){return new this.constructor().copy(this)}copy(e){this.name=e.name,this.blending=e.blending,this.side=e.side,this.vertexColors=e.vertexColors,this.opacity=e.opacity,this.transparent=e.transparent,this.blendSrc=e.blendSrc,this.blendDst=e.blendDst,this.blendEquation=e.blendEquation,this.blendSrcAlpha=e.blendSrcAlpha,this.blendDstAlpha=e.blendDstAlpha,this.blendEquationAlpha=e.blendEquationAlpha,this.blendColor.copy(e.blendColor),this.blendAlpha=e.blendAlpha,this.depthFunc=e.depthFunc,this.depthTest=e.depthTest,this.depthWrite=e.depthWrite,this.stencilWriteMask=e.stencilWriteMask,this.stencilFunc=e.stencilFunc,this.stencilRef=e.stencilRef,this.stencilFuncMask=e.stencilFuncMask,this.stencilFail=e.stencilFail,this.stencilZFail=e.stencilZFail,this.stencilZPass=e.stencilZPass,this.stencilWrite=e.stencilWrite;const t=e.clippingPlanes;let n=null;if(t!==null){const s=t.length;n=new Array(s);for(let i=0;i!==s;++i)n[i]=t[i].clone()}return this.clippingPlanes=n,this.clipIntersection=e.clipIntersection,this.clipShadows=e.clipShadows,this.shadowSide=e.shadowSide,this.colorWrite=e.colorWrite,this.precision=e.precision,this.polygonOffset=e.polygonOffset,this.polygonOffsetFactor=e.polygonOffsetFactor,this.polygonOffsetUnits=e.polygonOffsetUnits,this.dithering=e.dithering,this.alphaTest=e.alphaTest,this.alphaHash=e.alphaHash,this.alphaToCoverage=e.alphaToCoverage,this.premultipliedAlpha=e.premultipliedAlpha,this.forceSinglePass=e.forceSinglePass,this.visible=e.visible,this.toneMapped=e.toneMapped,this.userData=JSON.parse(JSON.stringify(e.userData)),this}dispose(){this.dispatchEvent({type:"dispose"})}set needsUpdate(e){e===!0&&this.version++}}class Tu extends $s{constructor(e){super(),this.isMeshBasicMaterial=!0,this.type="MeshBasicMaterial",this.color=new St(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new eo,this.combine=W0,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.fog=e.fog,this}}const Hl=l$();function l$(){const r=new ArrayBuffer(4),e=new Float32Array(r),t=new Uint32Array(r),n=new Uint32Array(512),s=new Uint32Array(512);for(let c=0;c<256;++c){const d=c-127;d<-27?(n[c]=0,n[c|256]=32768,s[c]=24,s[c|256]=24):d<-14?(n[c]=1024>>-d-14,n[c|256]=1024>>-d-14|32768,s[c]=-d-1,s[c|256]=-d-1):d<=15?(n[c]=d+15<<10,n[c|256]=d+15<<10|32768,s[c]=13,s[c|256]=13):d<128?(n[c]=31744,n[c|256]=64512,s[c]=24,s[c|256]=24):(n[c]=31744,n[c|256]=64512,s[c]=13,s[c|256]=13)}const i=new Uint32Array(2048),o=new Uint32Array(64),a=new Uint32Array(64);for(let c=1;c<1024;++c){let d=c<<13,f=0;for(;(d&8388608)===0;)d<<=1,f-=8388608;d&=-8388609,f+=947912704,i[c]=d|f}for(let c=1024;c<2048;++c)i[c]=939524096+(c-1024<<13);for(let c=1;c<31;++c)o[c]=c<<23;o[31]=1199570944,o[32]=2147483648;for(let c=33;c<63;++c)o[c]=2147483648+(c-32<<23);o[63]=3347054592;for(let c=1;c<64;++c)c!==32&&(a[c]=1024);return{floatView:e,uint32View:t,baseTable:n,shiftTable:s,mantissaTable:i,exponentTable:o,offsetTable:a}}function Ti(r){Math.abs(r)>65504&&console.warn("THREE.DataUtils.toHalfFloat(): Value out of range."),r=an(r,-65504,65504),Hl.floatView[0]=r;const e=Hl.uint32View[0],t=e>>23&511;return Hl.baseTable[t]+((e&8388607)>>Hl.shiftTable[t])}function Og(r){const e=r>>10;return Hl.uint32View[0]=Hl.mantissaTable[Hl.offsetTable[e]+(r&1023)]+Hl.exponentTable[e],Hl.floatView[0]}class c${static toHalfFloat(e){return Ti(e)}static fromHalfFloat(e){return Og(e)}}const Fr=new J,_x=new Ve;let u$=0;class Kn{constructor(e,t,n=!1){if(Array.isArray(e))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.isBufferAttribute=!0,Object.defineProperty(this,"id",{value:u$++}),this.name="",this.array=e,this.itemSize=t,this.count=e!==void 0?e.length/t:0,this.normalized=n,this.usage=_0,this.updateRanges=[],this.gpuType=Ii,this.version=0}onUploadCallback(){}set needsUpdate(e){e===!0&&this.version++}setUsage(e){return this.usage=e,this}addUpdateRange(e,t){this.updateRanges.push({start:e,count:t})}clearUpdateRanges(){this.updateRanges.length=0}copy(e){return this.name=e.name,this.array=new e.array.constructor(e.array),this.itemSize=e.itemSize,this.count=e.count,this.normalized=e.normalized,this.usage=e.usage,this.gpuType=e.gpuType,this}copyAt(e,t,n){e*=this.itemSize,n*=t.itemSize;for(let s=0,i=this.itemSize;s<i;s++)this.array[e+s]=t.array[n+s];return this}copyArray(e){return this.array.set(e),this}applyMatrix3(e){if(this.itemSize===2)for(let t=0,n=this.count;t<n;t++)_x.fromBufferAttribute(this,t),_x.applyMatrix3(e),this.setXY(t,_x.x,_x.y);else if(this.itemSize===3)for(let t=0,n=this.count;t<n;t++)Fr.fromBufferAttribute(this,t),Fr.applyMatrix3(e),this.setXYZ(t,Fr.x,Fr.y,Fr.z);return this}applyMatrix4(e){for(let t=0,n=this.count;t<n;t++)Fr.fromBufferAttribute(this,t),Fr.applyMatrix4(e),this.setXYZ(t,Fr.x,Fr.y,Fr.z);return this}applyNormalMatrix(e){for(let t=0,n=this.count;t<n;t++)Fr.fromBufferAttribute(this,t),Fr.applyNormalMatrix(e),this.setXYZ(t,Fr.x,Fr.y,Fr.z);return this}transformDirection(e){for(let t=0,n=this.count;t<n;t++)Fr.fromBufferAttribute(this,t),Fr.transformDirection(e),this.setXYZ(t,Fr.x,Fr.y,Fr.z);return this}set(e,t=0){return this.array.set(e,t),this}getComponent(e,t){let n=this.array[e*this.itemSize+t];return this.normalized&&(n=li(n,this.array)),n}setComponent(e,t,n){return this.normalized&&(n=pn(n,this.array)),this.array[e*this.itemSize+t]=n,this}getX(e){let t=this.array[e*this.itemSize];return this.normalized&&(t=li(t,this.array)),t}setX(e,t){return this.normalized&&(t=pn(t,this.array)),this.array[e*this.itemSize]=t,this}getY(e){let t=this.array[e*this.itemSize+1];return this.normalized&&(t=li(t,this.array)),t}setY(e,t){return this.normalized&&(t=pn(t,this.array)),this.array[e*this.itemSize+1]=t,this}getZ(e){let t=this.array[e*this.itemSize+2];return this.normalized&&(t=li(t,this.array)),t}setZ(e,t){return this.normalized&&(t=pn(t,this.array)),this.array[e*this.itemSize+2]=t,this}getW(e){let t=this.array[e*this.itemSize+3];return this.normalized&&(t=li(t,this.array)),t}setW(e,t){return this.normalized&&(t=pn(t,this.array)),this.array[e*this.itemSize+3]=t,this}setXY(e,t,n){return e*=this.itemSize,this.normalized&&(t=pn(t,this.array),n=pn(n,this.array)),this.array[e+0]=t,this.array[e+1]=n,this}setXYZ(e,t,n,s){return e*=this.itemSize,this.normalized&&(t=pn(t,this.array),n=pn(n,this.array),s=pn(s,this.array)),this.array[e+0]=t,this.array[e+1]=n,this.array[e+2]=s,this}setXYZW(e,t,n,s,i){return e*=this.itemSize,this.normalized&&(t=pn(t,this.array),n=pn(n,this.array),s=pn(s,this.array),i=pn(i,this.array)),this.array[e+0]=t,this.array[e+1]=n,this.array[e+2]=s,this.array[e+3]=i,this}onUpload(e){return this.onUploadCallback=e,this}clone(){return new this.constructor(this.array,this.itemSize).copy(this)}toJSON(){const e={itemSize:this.itemSize,type:this.array.constructor.name,array:Array.from(this.array),normalized:this.normalized};return this.name!==""&&(e.name=this.name),this.usage!==_0&&(e.usage=this.usage),e}}class d$ extends Kn{constructor(e,t,n){super(new Int8Array(e),t,n)}}class h$ extends Kn{constructor(e,t,n){super(new Uint8Array(e),t,n)}}class f$ extends Kn{constructor(e,t,n){super(new Uint8ClampedArray(e),t,n)}}class p$ extends Kn{constructor(e,t,n){super(new Int16Array(e),t,n)}}class xM extends Kn{constructor(e,t,n){super(new Uint16Array(e),t,n)}}class m$ extends Kn{constructor(e,t,n){super(new Int32Array(e),t,n)}}class yM extends Kn{constructor(e,t,n){super(new Uint32Array(e),t,n)}}class g$ extends Kn{constructor(e,t,n){super(new Uint16Array(e),t,n),this.isFloat16BufferAttribute=!0}getX(e){let t=Og(this.array[e*this.itemSize]);return this.normalized&&(t=li(t,this.array)),t}setX(e,t){return this.normalized&&(t=pn(t,this.array)),this.array[e*this.itemSize]=Ti(t),this}getY(e){let t=Og(this.array[e*this.itemSize+1]);return this.normalized&&(t=li(t,this.array)),t}setY(e,t){return this.normalized&&(t=pn(t,this.array)),this.array[e*this.itemSize+1]=Ti(t),this}getZ(e){let t=Og(this.array[e*this.itemSize+2]);return this.normalized&&(t=li(t,this.array)),t}setZ(e,t){return this.normalized&&(t=pn(t,this.array)),this.array[e*this.itemSize+2]=Ti(t),this}getW(e){let t=Og(this.array[e*this.itemSize+3]);return this.normalized&&(t=li(t,this.array)),t}setW(e,t){return this.normalized&&(t=pn(t,this.array)),this.array[e*this.itemSize+3]=Ti(t),this}setXY(e,t,n){return e*=this.itemSize,this.normalized&&(t=pn(t,this.array),n=pn(n,this.array)),this.array[e+0]=Ti(t),this.array[e+1]=Ti(n),this}setXYZ(e,t,n,s){return e*=this.itemSize,this.normalized&&(t=pn(t,this.array),n=pn(n,this.array),s=pn(s,this.array)),this.array[e+0]=Ti(t),this.array[e+1]=Ti(n),this.array[e+2]=Ti(s),this}setXYZW(e,t,n,s,i){return e*=this.itemSize,this.normalized&&(t=pn(t,this.array),n=pn(n,this.array),s=pn(s,this.array),i=pn(i,this.array)),this.array[e+0]=Ti(t),this.array[e+1]=Ti(n),this.array[e+2]=Ti(s),this.array[e+3]=Ti(i),this}}class It extends Kn{constructor(e,t,n){super(new Float32Array(e),t,n)}}let v$=0;const mo=new Jt,tS=new jn,ep=new J,Yi=new Ws,_g=new Ws,as=new J;class mn extends Xa{constructor(){super(),this.isBufferGeometry=!0,Object.defineProperty(this,"id",{value:v$++}),this.uuid=Zi(),this.name="",this.type="BufferGeometry",this.index=null,this.indirect=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}getIndex(){return this.index}setIndex(e){return Array.isArray(e)?this.index=new(j4(e)?yM:xM)(e,1):this.index=e,this}setIndirect(e){return this.indirect=e,this}getIndirect(){return this.indirect}getAttribute(e){return this.attributes[e]}setAttribute(e,t){return this.attributes[e]=t,this}deleteAttribute(e){return delete this.attributes[e],this}hasAttribute(e){return this.attributes[e]!==void 0}addGroup(e,t,n=0){this.groups.push({start:e,count:t,materialIndex:n})}clearGroups(){this.groups=[]}setDrawRange(e,t){this.drawRange.start=e,this.drawRange.count=t}applyMatrix4(e){const t=this.attributes.position;t!==void 0&&(t.applyMatrix4(e),t.needsUpdate=!0);const n=this.attributes.normal;if(n!==void 0){const i=new cn().getNormalMatrix(e);n.applyNormalMatrix(i),n.needsUpdate=!0}const s=this.attributes.tangent;return s!==void 0&&(s.transformDirection(e),s.needsUpdate=!0),this.boundingBox!==null&&this.computeBoundingBox(),this.boundingSphere!==null&&this.computeBoundingSphere(),this}applyQuaternion(e){return mo.makeRotationFromQuaternion(e),this.applyMatrix4(mo),this}rotateX(e){return mo.makeRotationX(e),this.applyMatrix4(mo),this}rotateY(e){return mo.makeRotationY(e),this.applyMatrix4(mo),this}rotateZ(e){return mo.makeRotationZ(e),this.applyMatrix4(mo),this}translate(e,t,n){return mo.makeTranslation(e,t,n),this.applyMatrix4(mo),this}scale(e,t,n){return mo.makeScale(e,t,n),this.applyMatrix4(mo),this}lookAt(e){return tS.lookAt(e),tS.updateMatrix(),this.applyMatrix4(tS.matrix),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter(ep).negate(),this.translate(ep.x,ep.y,ep.z),this}setFromPoints(e){const t=this.getAttribute("position");if(t===void 0){const n=[];for(let s=0,i=e.length;s<i;s++){const o=e[s];n.push(o.x,o.y,o.z||0)}this.setAttribute("position",new It(n,3))}else{const n=Math.min(e.length,t.count);for(let s=0;s<n;s++){const i=e[s];t.setXYZ(s,i.x,i.y,i.z||0)}e.length>t.count&&console.warn("THREE.BufferGeometry: Buffer size too small for points data. Use .dispose() and create a new geometry."),t.needsUpdate=!0}return this}computeBoundingBox(){this.boundingBox===null&&(this.boundingBox=new Ws);const e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute){console.error("THREE.BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box.",this),this.boundingBox.set(new J(-1/0,-1/0,-1/0),new J(1/0,1/0,1/0));return}if(e!==void 0){if(this.boundingBox.setFromBufferAttribute(e),t)for(let n=0,s=t.length;n<s;n++){const i=t[n];Yi.setFromBufferAttribute(i),this.morphTargetsRelative?(as.addVectors(this.boundingBox.min,Yi.min),this.boundingBox.expandByPoint(as),as.addVectors(this.boundingBox.max,Yi.max),this.boundingBox.expandByPoint(as)):(this.boundingBox.expandByPoint(Yi.min),this.boundingBox.expandByPoint(Yi.max))}}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)}computeBoundingSphere(){this.boundingSphere===null&&(this.boundingSphere=new bs);const e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute){console.error("THREE.BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere.",this),this.boundingSphere.set(new J,1/0);return}if(e){const n=this.boundingSphere.center;if(Yi.setFromBufferAttribute(e),t)for(let i=0,o=t.length;i<o;i++){const a=t[i];_g.setFromBufferAttribute(a),this.morphTargetsRelative?(as.addVectors(Yi.min,_g.min),Yi.expandByPoint(as),as.addVectors(Yi.max,_g.max),Yi.expandByPoint(as)):(Yi.expandByPoint(_g.min),Yi.expandByPoint(_g.max))}Yi.getCenter(n);let s=0;for(let i=0,o=e.count;i<o;i++)as.fromBufferAttribute(e,i),s=Math.max(s,n.distanceToSquared(as));if(t)for(let i=0,o=t.length;i<o;i++){const a=t[i],c=this.morphTargetsRelative;for(let d=0,f=a.count;d<f;d++)as.fromBufferAttribute(a,d),c&&(ep.fromBufferAttribute(e,d),as.add(ep)),s=Math.max(s,n.distanceToSquared(as))}this.boundingSphere.radius=Math.sqrt(s),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}computeTangents(){const e=this.index,t=this.attributes;if(e===null||t.position===void 0||t.normal===void 0||t.uv===void 0){console.error("THREE.BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");return}const n=t.position,s=t.normal,i=t.uv;this.hasAttribute("tangent")===!1&&this.setAttribute("tangent",new Kn(new Float32Array(4*n.count),4));const o=this.getAttribute("tangent"),a=[],c=[];for(let L=0;L<n.count;L++)a[L]=new J,c[L]=new J;const d=new J,f=new J,m=new J,v=new Ve,x=new Ve,_=new Ve,b=new J,w=new J;function S(L,O,I){d.fromBufferAttribute(n,L),f.fromBufferAttribute(n,O),m.fromBufferAttribute(n,I),v.fromBufferAttribute(i,L),x.fromBufferAttribute(i,O),_.fromBufferAttribute(i,I),f.sub(d),m.sub(d),x.sub(v),_.sub(v);const B=1/(x.x*_.y-_.x*x.y);isFinite(B)&&(b.copy(f).multiplyScalar(_.y).addScaledVector(m,-x.y).multiplyScalar(B),w.copy(m).multiplyScalar(x.x).addScaledVector(f,-_.x).multiplyScalar(B),a[L].add(b),a[O].add(b),a[I].add(b),c[L].add(w),c[O].add(w),c[I].add(w))}let C=this.groups;C.length===0&&(C=[{start:0,count:e.count}]);for(let L=0,O=C.length;L<O;++L){const I=C[L],B=I.start,W=I.count;for(let K=B,ee=B+W;K<ee;K+=3)S(e.getX(K+0),e.getX(K+1),e.getX(K+2))}const T=new J,A=new J,k=new J,j=new J;function D(L){k.fromBufferAttribute(s,L),j.copy(k);const O=a[L];T.copy(O),T.sub(k.multiplyScalar(k.dot(O))).normalize(),A.crossVectors(j,O);const B=A.dot(c[L])<0?-1:1;o.setXYZW(L,T.x,T.y,T.z,B)}for(let L=0,O=C.length;L<O;++L){const I=C[L],B=I.start,W=I.count;for(let K=B,ee=B+W;K<ee;K+=3)D(e.getX(K+0)),D(e.getX(K+1)),D(e.getX(K+2))}}computeVertexNormals(){const e=this.index,t=this.getAttribute("position");if(t!==void 0){let n=this.getAttribute("normal");if(n===void 0)n=new Kn(new Float32Array(t.count*3),3),this.setAttribute("normal",n);else for(let v=0,x=n.count;v<x;v++)n.setXYZ(v,0,0,0);const s=new J,i=new J,o=new J,a=new J,c=new J,d=new J,f=new J,m=new J;if(e)for(let v=0,x=e.count;v<x;v+=3){const _=e.getX(v+0),b=e.getX(v+1),w=e.getX(v+2);s.fromBufferAttribute(t,_),i.fromBufferAttribute(t,b),o.fromBufferAttribute(t,w),f.subVectors(o,i),m.subVectors(s,i),f.cross(m),a.fromBufferAttribute(n,_),c.fromBufferAttribute(n,b),d.fromBufferAttribute(n,w),a.add(f),c.add(f),d.add(f),n.setXYZ(_,a.x,a.y,a.z),n.setXYZ(b,c.x,c.y,c.z),n.setXYZ(w,d.x,d.y,d.z)}else for(let v=0,x=t.count;v<x;v+=3)s.fromBufferAttribute(t,v+0),i.fromBufferAttribute(t,v+1),o.fromBufferAttribute(t,v+2),f.subVectors(o,i),m.subVectors(s,i),f.cross(m),n.setXYZ(v+0,f.x,f.y,f.z),n.setXYZ(v+1,f.x,f.y,f.z),n.setXYZ(v+2,f.x,f.y,f.z);this.normalizeNormals(),n.needsUpdate=!0}}normalizeNormals(){const e=this.attributes.normal;for(let t=0,n=e.count;t<n;t++)as.fromBufferAttribute(e,t),as.normalize(),e.setXYZ(t,as.x,as.y,as.z)}toNonIndexed(){function e(a,c){const d=a.array,f=a.itemSize,m=a.normalized,v=new d.constructor(c.length*f);let x=0,_=0;for(let b=0,w=c.length;b<w;b++){a.isInterleavedBufferAttribute?x=c[b]*a.data.stride+a.offset:x=c[b]*f;for(let S=0;S<f;S++)v[_++]=d[x++]}return new Kn(v,f,m)}if(this.index===null)return console.warn("THREE.BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),this;const t=new mn,n=this.index.array,s=this.attributes;for(const a in s){const c=s[a],d=e(c,n);t.setAttribute(a,d)}const i=this.morphAttributes;for(const a in i){const c=[],d=i[a];for(let f=0,m=d.length;f<m;f++){const v=d[f],x=e(v,n);c.push(x)}t.morphAttributes[a]=c}t.morphTargetsRelative=this.morphTargetsRelative;const o=this.groups;for(let a=0,c=o.length;a<c;a++){const d=o[a];t.addGroup(d.start,d.count,d.materialIndex)}return t}toJSON(){const e={metadata:{version:4.7,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,this.name!==""&&(e.name=this.name),Object.keys(this.userData).length>0&&(e.userData=this.userData),this.parameters!==void 0){const c=this.parameters;for(const d in c)c[d]!==void 0&&(e[d]=c[d]);return e}e.data={attributes:{}};const t=this.index;t!==null&&(e.data.index={type:t.array.constructor.name,array:Array.prototype.slice.call(t.array)});const n=this.attributes;for(const c in n){const d=n[c];e.data.attributes[c]=d.toJSON(e.data)}const s={};let i=!1;for(const c in this.morphAttributes){const d=this.morphAttributes[c],f=[];for(let m=0,v=d.length;m<v;m++){const x=d[m];f.push(x.toJSON(e.data))}f.length>0&&(s[c]=f,i=!0)}i&&(e.data.morphAttributes=s,e.data.morphTargetsRelative=this.morphTargetsRelative);const o=this.groups;o.length>0&&(e.data.groups=JSON.parse(JSON.stringify(o)));const a=this.boundingSphere;return a!==null&&(e.data.boundingSphere=a.toJSON()),e}clone(){return new this.constructor().copy(this)}copy(e){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;const t={};this.name=e.name;const n=e.index;n!==null&&this.setIndex(n.clone());const s=e.attributes;for(const d in s){const f=s[d];this.setAttribute(d,f.clone(t))}const i=e.morphAttributes;for(const d in i){const f=[],m=i[d];for(let v=0,x=m.length;v<x;v++)f.push(m[v].clone(t));this.morphAttributes[d]=f}this.morphTargetsRelative=e.morphTargetsRelative;const o=e.groups;for(let d=0,f=o.length;d<f;d++){const m=o[d];this.addGroup(m.start,m.count,m.materialIndex)}const a=e.boundingBox;a!==null&&(this.boundingBox=a.clone());const c=e.boundingSphere;return c!==null&&(this.boundingSphere=c.clone()),this.drawRange.start=e.drawRange.start,this.drawRange.count=e.drawRange.count,this.userData=e.userData,this}dispose(){this.dispatchEvent({type:"dispose"})}}const CC=new Jt,vd=new wh,wx=new bs,AC=new J,Sx=new J,bx=new J,Ex=new J,nS=new J,Mx=new J,RC=new J,Tx=new J;class Ur extends jn{constructor(e=new mn,t=new Tu){super(),this.isMesh=!0,this.type="Mesh",this.geometry=e,this.material=t,this.morphTargetDictionary=void 0,this.morphTargetInfluences=void 0,this.count=1,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),e.morphTargetInfluences!==void 0&&(this.morphTargetInfluences=e.morphTargetInfluences.slice()),e.morphTargetDictionary!==void 0&&(this.morphTargetDictionary=Object.assign({},e.morphTargetDictionary)),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}updateMorphTargets(){const t=this.geometry.morphAttributes,n=Object.keys(t);if(n.length>0){const s=t[n[0]];if(s!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let i=0,o=s.length;i<o;i++){const a=s[i].name||String(i);this.morphTargetInfluences.push(0),this.morphTargetDictionary[a]=i}}}}getVertexPosition(e,t){const n=this.geometry,s=n.attributes.position,i=n.morphAttributes.position,o=n.morphTargetsRelative;t.fromBufferAttribute(s,e);const a=this.morphTargetInfluences;if(i&&a){Mx.set(0,0,0);for(let c=0,d=i.length;c<d;c++){const f=a[c],m=i[c];f!==0&&(nS.fromBufferAttribute(m,e),o?Mx.addScaledVector(nS,f):Mx.addScaledVector(nS.sub(t),f))}t.add(Mx)}return t}raycast(e,t){const n=this.geometry,s=this.material,i=this.matrixWorld;s!==void 0&&(n.boundingSphere===null&&n.computeBoundingSphere(),wx.copy(n.boundingSphere),wx.applyMatrix4(i),vd.copy(e.ray).recast(e.near),!(wx.containsPoint(vd.origin)===!1&&(vd.intersectSphere(wx,AC)===null||vd.origin.distanceToSquared(AC)>(e.far-e.near)**2))&&(CC.copy(i).invert(),vd.copy(e.ray).applyMatrix4(CC),!(n.boundingBox!==null&&vd.intersectsBox(n.boundingBox)===!1)&&this._computeIntersections(e,t,vd)))}_computeIntersections(e,t,n){let s;const i=this.geometry,o=this.material,a=i.index,c=i.attributes.position,d=i.attributes.uv,f=i.attributes.uv1,m=i.attributes.normal,v=i.groups,x=i.drawRange;if(a!==null)if(Array.isArray(o))for(let _=0,b=v.length;_<b;_++){const w=v[_],S=o[w.materialIndex],C=Math.max(w.start,x.start),T=Math.min(a.count,Math.min(w.start+w.count,x.start+x.count));for(let A=C,k=T;A<k;A+=3){const j=a.getX(A),D=a.getX(A+1),L=a.getX(A+2);s=Cx(this,S,e,n,d,f,m,j,D,L),s&&(s.faceIndex=Math.floor(A/3),s.face.materialIndex=w.materialIndex,t.push(s))}}else{const _=Math.max(0,x.start),b=Math.min(a.count,x.start+x.count);for(let w=_,S=b;w<S;w+=3){const C=a.getX(w),T=a.getX(w+1),A=a.getX(w+2);s=Cx(this,o,e,n,d,f,m,C,T,A),s&&(s.faceIndex=Math.floor(w/3),t.push(s))}}else if(c!==void 0)if(Array.isArray(o))for(let _=0,b=v.length;_<b;_++){const w=v[_],S=o[w.materialIndex],C=Math.max(w.start,x.start),T=Math.min(c.count,Math.min(w.start+w.count,x.start+x.count));for(let A=C,k=T;A<k;A+=3){const j=A,D=A+1,L=A+2;s=Cx(this,S,e,n,d,f,m,j,D,L),s&&(s.faceIndex=Math.floor(A/3),s.face.materialIndex=w.materialIndex,t.push(s))}}else{const _=Math.max(0,x.start),b=Math.min(c.count,x.start+x.count);for(let w=_,S=b;w<S;w+=3){const C=w,T=w+1,A=w+2;s=Cx(this,o,e,n,d,f,m,C,T,A),s&&(s.faceIndex=Math.floor(w/3),t.push(s))}}}}function x$(r,e,t,n,s,i,o,a){let c;if(e.side===ci?c=n.intersectTriangle(o,i,s,!0,a):c=n.intersectTriangle(s,i,o,e.side===Zl,a),c===null)return null;Tx.copy(a),Tx.applyMatrix4(r.matrixWorld);const d=t.ray.origin.distanceTo(Tx);return d<t.near||d>t.far?null:{distance:d,point:Tx.clone(),object:r}}function Cx(r,e,t,n,s,i,o,a,c,d){r.getVertexPosition(a,Sx),r.getVertexPosition(c,bx),r.getVertexPosition(d,Ex);const f=x$(r,e,t,n,Sx,bx,Ex,RC);if(f){const m=new J;Pi.getBarycoord(RC,Sx,bx,Ex,m),s&&(f.uv=Pi.getInterpolatedAttribute(s,a,c,d,m,new Ve)),i&&(f.uv1=Pi.getInterpolatedAttribute(i,a,c,d,m,new Ve)),o&&(f.normal=Pi.getInterpolatedAttribute(o,a,c,d,m,new J),f.normal.dot(n.direction)>0&&f.normal.multiplyScalar(-1));const v={a,b:c,c:d,normal:new J,materialIndex:0};Pi.getNormal(Sx,bx,Ex,v.normal),f.face=v,f.barycoord=m}return f}class Sh extends mn{constructor(e=1,t=1,n=1,s=1,i=1,o=1){super(),this.type="BoxGeometry",this.parameters={width:e,height:t,depth:n,widthSegments:s,heightSegments:i,depthSegments:o};const a=this;s=Math.floor(s),i=Math.floor(i),o=Math.floor(o);const c=[],d=[],f=[],m=[];let v=0,x=0;_("z","y","x",-1,-1,n,t,e,o,i,0),_("z","y","x",1,-1,n,t,-e,o,i,1),_("x","z","y",1,1,e,n,t,s,o,2),_("x","z","y",1,-1,e,n,-t,s,o,3),_("x","y","z",1,-1,e,t,n,s,i,4),_("x","y","z",-1,-1,e,t,-n,s,i,5),this.setIndex(c),this.setAttribute("position",new It(d,3)),this.setAttribute("normal",new It(f,3)),this.setAttribute("uv",new It(m,2));function _(b,w,S,C,T,A,k,j,D,L,O){const I=A/D,B=k/L,W=A/2,K=k/2,ee=j/2,oe=D+1,ne=L+1;let ce=0,V=0;const q=new J;for(let Z=0;Z<ne;Z++){const X=Z*B-K;for(let ie=0;ie<oe;ie++){const be=ie*I-W;q[b]=be*C,q[w]=X*T,q[S]=ee,d.push(q.x,q.y,q.z),q[b]=0,q[w]=0,q[S]=j>0?1:-1,f.push(q.x,q.y,q.z),m.push(ie/D),m.push(1-Z/L),ce+=1}}for(let Z=0;Z<L;Z++)for(let X=0;X<D;X++){const ie=v+X+oe*Z,be=v+X+oe*(Z+1),ue=v+(X+1)+oe*(Z+1),Ee=v+(X+1)+oe*Z;c.push(ie,be,Ee),c.push(be,ue,Ee),V+=6}a.addGroup(x,V,O),x+=V,v+=ce}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new Sh(e.width,e.height,e.depth,e.widthSegments,e.heightSegments,e.depthSegments)}}function Xp(r){const e={};for(const t in r){e[t]={};for(const n in r[t]){const s=r[t][n];s&&(s.isColor||s.isMatrix3||s.isMatrix4||s.isVector2||s.isVector3||s.isVector4||s.isTexture||s.isQuaternion)?s.isRenderTargetTexture?(console.warn("UniformsUtils: Textures of render targets cannot be cloned via cloneUniforms() or mergeUniforms()."),e[t][n]=null):e[t][n]=s.clone():Array.isArray(s)?e[t][n]=s.slice():e[t][n]=s}}return e}function ii(r){const e={};for(let t=0;t<r.length;t++){const n=Xp(r[t]);for(const s in n)e[s]=n[s]}return e}function y$(r){const e=[];for(let t=0;t<r.length;t++)e.push(r[t].clone());return e}function z4(r){const e=r.getRenderTarget();return e===null?r.outputColorSpace:e.isXRRenderTarget===!0?e.texture.colorSpace:kn.workingColorSpace}const V4={clone:Xp,merge:ii};var _$=`void main() {
	gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
}`,w$=`void main() {
	gl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );
}`;class la extends $s{constructor(e){super(),this.isShaderMaterial=!0,this.type="ShaderMaterial",this.defines={},this.uniforms={},this.uniformsGroups=[],this.vertexShader=_$,this.fragmentShader=w$,this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.forceSinglePass=!0,this.extensions={clipCullDistance:!1,multiDraw:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv1:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,this.glslVersion=null,e!==void 0&&this.setValues(e)}copy(e){return super.copy(e),this.fragmentShader=e.fragmentShader,this.vertexShader=e.vertexShader,this.uniforms=Xp(e.uniforms),this.uniformsGroups=y$(e.uniformsGroups),this.defines=Object.assign({},e.defines),this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.fog=e.fog,this.lights=e.lights,this.clipping=e.clipping,this.extensions=Object.assign({},e.extensions),this.glslVersion=e.glslVersion,this}toJSON(e){const t=super.toJSON(e);t.glslVersion=this.glslVersion,t.uniforms={};for(const s in this.uniforms){const o=this.uniforms[s].value;o&&o.isTexture?t.uniforms[s]={type:"t",value:o.toJSON(e).uuid}:o&&o.isColor?t.uniforms[s]={type:"c",value:o.getHex()}:o&&o.isVector2?t.uniforms[s]={type:"v2",value:o.toArray()}:o&&o.isVector3?t.uniforms[s]={type:"v3",value:o.toArray()}:o&&o.isVector4?t.uniforms[s]={type:"v4",value:o.toArray()}:o&&o.isMatrix3?t.uniforms[s]={type:"m3",value:o.toArray()}:o&&o.isMatrix4?t.uniforms[s]={type:"m4",value:o.toArray()}:t.uniforms[s]={value:o}}Object.keys(this.defines).length>0&&(t.defines=this.defines),t.vertexShader=this.vertexShader,t.fragmentShader=this.fragmentShader,t.lights=this.lights,t.clipping=this.clipping;const n={};for(const s in this.extensions)this.extensions[s]===!0&&(n[s]=!0);return Object.keys(n).length>0&&(t.extensions=n),t}}class q0 extends jn{constructor(){super(),this.isCamera=!0,this.type="Camera",this.matrixWorldInverse=new Jt,this.projectionMatrix=new Jt,this.projectionMatrixInverse=new Jt,this.coordinateSystem=xo}copy(e,t){return super.copy(e,t),this.matrixWorldInverse.copy(e.matrixWorldInverse),this.projectionMatrix.copy(e.projectionMatrix),this.projectionMatrixInverse.copy(e.projectionMatrixInverse),this.coordinateSystem=e.coordinateSystem,this}getWorldDirection(e){return super.getWorldDirection(e).negate()}updateMatrixWorld(e){super.updateMatrixWorld(e),this.matrixWorldInverse.copy(this.matrixWorld).invert()}updateWorldMatrix(e,t){super.updateWorldMatrix(e,t),this.matrixWorldInverse.copy(this.matrixWorld).invert()}clone(){return new this.constructor().copy(this)}}const Hc=new J,NC=new Ve,PC=new Ve;class Cr extends q0{constructor(e=50,t=1,n=.1,s=2e3){super(),this.isPerspectiveCamera=!0,this.type="PerspectiveCamera",this.fov=e,this.zoom=1,this.near=n,this.far=s,this.focus=10,this.aspect=t,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.fov=e.fov,this.zoom=e.zoom,this.near=e.near,this.far=e.far,this.focus=e.focus,this.aspect=e.aspect,this.view=e.view===null?null:Object.assign({},e.view),this.filmGauge=e.filmGauge,this.filmOffset=e.filmOffset,this}setFocalLength(e){const t=.5*this.getFilmHeight()/e;this.fov=qp*2*Math.atan(t),this.updateProjectionMatrix()}getFocalLength(){const e=Math.tan(Jd*.5*this.fov);return .5*this.getFilmHeight()/e}getEffectiveFOV(){return qp*2*Math.atan(Math.tan(Jd*.5*this.fov)/this.zoom)}getFilmWidth(){return this.filmGauge*Math.min(this.aspect,1)}getFilmHeight(){return this.filmGauge/Math.max(this.aspect,1)}getViewBounds(e,t,n){Hc.set(-1,-1,.5).applyMatrix4(this.projectionMatrixInverse),t.set(Hc.x,Hc.y).multiplyScalar(-e/Hc.z),Hc.set(1,1,.5).applyMatrix4(this.projectionMatrixInverse),n.set(Hc.x,Hc.y).multiplyScalar(-e/Hc.z)}getViewSize(e,t){return this.getViewBounds(e,NC,PC),t.subVectors(PC,NC)}setViewOffset(e,t,n,s,i,o){this.aspect=e/t,this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=n,this.view.offsetY=s,this.view.width=i,this.view.height=o,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=this.near;let t=e*Math.tan(Jd*.5*this.fov)/this.zoom,n=2*t,s=this.aspect*n,i=-.5*s;const o=this.view;if(this.view!==null&&this.view.enabled){const c=o.fullWidth,d=o.fullHeight;i+=o.offsetX*s/c,t-=o.offsetY*n/d,s*=o.width/c,n*=o.height/d}const a=this.filmOffset;a!==0&&(i+=e*a/this.getFilmWidth()),this.projectionMatrix.makePerspective(i,i+s,t,t-n,e,this.far,this.coordinateSystem),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const t=super.toJSON(e);return t.object.fov=this.fov,t.object.zoom=this.zoom,t.object.near=this.near,t.object.far=this.far,t.object.focus=this.focus,t.object.aspect=this.aspect,this.view!==null&&(t.object.view=Object.assign({},this.view)),t.object.filmGauge=this.filmGauge,t.object.filmOffset=this.filmOffset,t}}const tp=-90,np=1;class H4 extends jn{constructor(e,t,n){super(),this.type="CubeCamera",this.renderTarget=n,this.coordinateSystem=null,this.activeMipmapLevel=0;const s=new Cr(tp,np,e,t);s.layers=this.layers,this.add(s);const i=new Cr(tp,np,e,t);i.layers=this.layers,this.add(i);const o=new Cr(tp,np,e,t);o.layers=this.layers,this.add(o);const a=new Cr(tp,np,e,t);a.layers=this.layers,this.add(a);const c=new Cr(tp,np,e,t);c.layers=this.layers,this.add(c);const d=new Cr(tp,np,e,t);d.layers=this.layers,this.add(d)}updateCoordinateSystem(){const e=this.coordinateSystem,t=this.children.concat(),[n,s,i,o,a,c]=t;for(const d of t)this.remove(d);if(e===xo)n.up.set(0,1,0),n.lookAt(1,0,0),s.up.set(0,1,0),s.lookAt(-1,0,0),i.up.set(0,0,-1),i.lookAt(0,1,0),o.up.set(0,0,1),o.lookAt(0,-1,0),a.up.set(0,1,0),a.lookAt(0,0,1),c.up.set(0,1,0),c.lookAt(0,0,-1);else if(e===w0)n.up.set(0,-1,0),n.lookAt(-1,0,0),s.up.set(0,-1,0),s.lookAt(1,0,0),i.up.set(0,0,1),i.lookAt(0,1,0),o.up.set(0,0,-1),o.lookAt(0,-1,0),a.up.set(0,-1,0),a.lookAt(0,0,1),c.up.set(0,-1,0),c.lookAt(0,0,-1);else throw new Error("THREE.CubeCamera.updateCoordinateSystem(): Invalid coordinate system: "+e);for(const d of t)this.add(d),d.updateMatrixWorld()}update(e,t){this.parent===null&&this.updateMatrixWorld();const{renderTarget:n,activeMipmapLevel:s}=this;this.coordinateSystem!==e.coordinateSystem&&(this.coordinateSystem=e.coordinateSystem,this.updateCoordinateSystem());const[i,o,a,c,d,f]=this.children,m=e.getRenderTarget(),v=e.getActiveCubeFace(),x=e.getActiveMipmapLevel(),_=e.xr.enabled;e.xr.enabled=!1;const b=n.texture.generateMipmaps;n.texture.generateMipmaps=!1,e.setRenderTarget(n,0,s),e.render(t,i),e.setRenderTarget(n,1,s),e.render(t,o),e.setRenderTarget(n,2,s),e.render(t,a),e.setRenderTarget(n,3,s),e.render(t,c),e.setRenderTarget(n,4,s),e.render(t,d),n.texture.generateMipmaps=b,e.setRenderTarget(n,5,s),e.render(t,f),e.setRenderTarget(m,v,x),e.xr.enabled=_,n.texture.needsPMREMUpdate=!0}}class X0 extends _r{constructor(e=[],t=ec,n,s,i,o,a,c,d,f){super(e,t,n,s,i,o,a,c,d,f),this.isCubeTexture=!0,this.flipY=!1}get images(){return this.image}set images(e){this.image=e}}class G4 extends Ga{constructor(e=1,t={}){super(e,e,t),this.isWebGLCubeRenderTarget=!0;const n={width:e,height:e,depth:1},s=[n,n,n,n,n,n];this.texture=new X0(s),this._setTextureOptions(t),this.texture.isRenderTargetTexture=!0}fromEquirectangularTexture(e,t){this.texture.type=t.type,this.texture.colorSpace=t.colorSpace,this.texture.generateMipmaps=t.generateMipmaps,this.texture.minFilter=t.minFilter,this.texture.magFilter=t.magFilter;const n={uniforms:{tEquirect:{value:null}},vertexShader:`

				varying vec3 vWorldDirection;

				vec3 transformDirection( in vec3 dir, in mat4 matrix ) {

					return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );

				}

				void main() {

					vWorldDirection = transformDirection( position, modelMatrix );

					#include <begin_vertex>
					#include <project_vertex>

				}
			`,fragmentShader:`

				uniform sampler2D tEquirect;

				varying vec3 vWorldDirection;

				#include <common>

				void main() {

					vec3 direction = normalize( vWorldDirection );

					vec2 sampleUV = equirectUv( direction );

					gl_FragColor = texture2D( tEquirect, sampleUV );

				}
			`},s=new Sh(5,5,5),i=new la({name:"CubemapFromEquirect",uniforms:Xp(n.uniforms),vertexShader:n.vertexShader,fragmentShader:n.fragmentShader,side:ci,blending:Wl});i.uniforms.tEquirect.value=t;const o=new Ur(s,i),a=t.minFilter;return t.minFilter===La&&(t.minFilter=Qr),new H4(1,10,this).update(e,o),t.minFilter=a,o.geometry.dispose(),o.material.dispose(),this}clear(e,t=!0,n=!0,s=!0){const i=e.getRenderTarget();for(let o=0;o<6;o++)e.setRenderTarget(this,o),e.clear(t,n,s);e.setRenderTarget(i)}}class yp extends jn{constructor(){super(),this.isGroup=!0,this.type="Group"}}const S$={type:"move"};class gy{constructor(){this._targetRay=null,this._grip=null,this._hand=null}getHandSpace(){return this._hand===null&&(this._hand=new yp,this._hand.matrixAutoUpdate=!1,this._hand.visible=!1,this._hand.joints={},this._hand.inputState={pinching:!1}),this._hand}getTargetRaySpace(){return this._targetRay===null&&(this._targetRay=new yp,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1,this._targetRay.hasLinearVelocity=!1,this._targetRay.linearVelocity=new J,this._targetRay.hasAngularVelocity=!1,this._targetRay.angularVelocity=new J),this._targetRay}getGripSpace(){return this._grip===null&&(this._grip=new yp,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1,this._grip.hasLinearVelocity=!1,this._grip.linearVelocity=new J,this._grip.hasAngularVelocity=!1,this._grip.angularVelocity=new J),this._grip}dispatchEvent(e){return this._targetRay!==null&&this._targetRay.dispatchEvent(e),this._grip!==null&&this._grip.dispatchEvent(e),this._hand!==null&&this._hand.dispatchEvent(e),this}connect(e){if(e&&e.hand){const t=this._hand;if(t)for(const n of e.hand.values())this._getHandJoint(t,n)}return this.dispatchEvent({type:"connected",data:e}),this}disconnect(e){return this.dispatchEvent({type:"disconnected",data:e}),this._targetRay!==null&&(this._targetRay.visible=!1),this._grip!==null&&(this._grip.visible=!1),this._hand!==null&&(this._hand.visible=!1),this}update(e,t,n){let s=null,i=null,o=null;const a=this._targetRay,c=this._grip,d=this._hand;if(e&&t.session.visibilityState!=="visible-blurred"){if(d&&e.hand){o=!0;for(const b of e.hand.values()){const w=t.getJointPose(b,n),S=this._getHandJoint(d,b);w!==null&&(S.matrix.fromArray(w.transform.matrix),S.matrix.decompose(S.position,S.rotation,S.scale),S.matrixWorldNeedsUpdate=!0,S.jointRadius=w.radius),S.visible=w!==null}const f=d.joints["index-finger-tip"],m=d.joints["thumb-tip"],v=f.position.distanceTo(m.position),x=.02,_=.005;d.inputState.pinching&&v>x+_?(d.inputState.pinching=!1,this.dispatchEvent({type:"pinchend",handedness:e.handedness,target:this})):!d.inputState.pinching&&v<=x-_&&(d.inputState.pinching=!0,this.dispatchEvent({type:"pinchstart",handedness:e.handedness,target:this}))}else c!==null&&e.gripSpace&&(i=t.getPose(e.gripSpace,n),i!==null&&(c.matrix.fromArray(i.transform.matrix),c.matrix.decompose(c.position,c.rotation,c.scale),c.matrixWorldNeedsUpdate=!0,i.linearVelocity?(c.hasLinearVelocity=!0,c.linearVelocity.copy(i.linearVelocity)):c.hasLinearVelocity=!1,i.angularVelocity?(c.hasAngularVelocity=!0,c.angularVelocity.copy(i.angularVelocity)):c.hasAngularVelocity=!1));a!==null&&(s=t.getPose(e.targetRaySpace,n),s===null&&i!==null&&(s=i),s!==null&&(a.matrix.fromArray(s.transform.matrix),a.matrix.decompose(a.position,a.rotation,a.scale),a.matrixWorldNeedsUpdate=!0,s.linearVelocity?(a.hasLinearVelocity=!0,a.linearVelocity.copy(s.linearVelocity)):a.hasLinearVelocity=!1,s.angularVelocity?(a.hasAngularVelocity=!0,a.angularVelocity.copy(s.angularVelocity)):a.hasAngularVelocity=!1,this.dispatchEvent(S$)))}return a!==null&&(a.visible=s!==null),c!==null&&(c.visible=i!==null),d!==null&&(d.visible=o!==null),this}_getHandJoint(e,t){if(e.joints[t.jointName]===void 0){const n=new yp;n.matrixAutoUpdate=!1,n.visible=!1,e.joints[t.jointName]=n,e.add(n)}return e.joints[t.jointName]}}class cw{constructor(e,t=25e-5){this.isFogExp2=!0,this.name="",this.color=new St(e),this.density=t}clone(){return new cw(this.color,this.density)}toJSON(){return{type:"FogExp2",name:this.name,color:this.color.getHex(),density:this.density}}}class uw{constructor(e,t=1,n=1e3){this.isFog=!0,this.name="",this.color=new St(e),this.near=t,this.far=n}clone(){return new uw(this.color,this.near,this.far)}toJSON(){return{type:"Fog",name:this.name,color:this.color.getHex(),near:this.near,far:this.far}}}class _M extends jn{constructor(){super(),this.isScene=!0,this.type="Scene",this.background=null,this.environment=null,this.fog=null,this.backgroundBlurriness=0,this.backgroundIntensity=1,this.backgroundRotation=new eo,this.environmentIntensity=1,this.environmentRotation=new eo,this.overrideMaterial=null,typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}copy(e,t){return super.copy(e,t),e.background!==null&&(this.background=e.background.clone()),e.environment!==null&&(this.environment=e.environment.clone()),e.fog!==null&&(this.fog=e.fog.clone()),this.backgroundBlurriness=e.backgroundBlurriness,this.backgroundIntensity=e.backgroundIntensity,this.backgroundRotation.copy(e.backgroundRotation),this.environmentIntensity=e.environmentIntensity,this.environmentRotation.copy(e.environmentRotation),e.overrideMaterial!==null&&(this.overrideMaterial=e.overrideMaterial.clone()),this.matrixAutoUpdate=e.matrixAutoUpdate,this}toJSON(e){const t=super.toJSON(e);return this.fog!==null&&(t.object.fog=this.fog.toJSON()),this.backgroundBlurriness>0&&(t.object.backgroundBlurriness=this.backgroundBlurriness),this.backgroundIntensity!==1&&(t.object.backgroundIntensity=this.backgroundIntensity),t.object.backgroundRotation=this.backgroundRotation.toArray(),this.environmentIntensity!==1&&(t.object.environmentIntensity=this.environmentIntensity),t.object.environmentRotation=this.environmentRotation.toArray(),t}}class dw{constructor(e,t){this.isInterleavedBuffer=!0,this.array=e,this.stride=t,this.count=e!==void 0?e.length/t:0,this.usage=_0,this.updateRanges=[],this.version=0,this.uuid=Zi()}onUploadCallback(){}set needsUpdate(e){e===!0&&this.version++}setUsage(e){return this.usage=e,this}addUpdateRange(e,t){this.updateRanges.push({start:e,count:t})}clearUpdateRanges(){this.updateRanges.length=0}copy(e){return this.array=new e.array.constructor(e.array),this.count=e.count,this.stride=e.stride,this.usage=e.usage,this}copyAt(e,t,n){e*=this.stride,n*=t.stride;for(let s=0,i=this.stride;s<i;s++)this.array[e+s]=t.array[n+s];return this}set(e,t=0){return this.array.set(e,t),this}clone(e){e.arrayBuffers===void 0&&(e.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=Zi()),e.arrayBuffers[this.array.buffer._uuid]===void 0&&(e.arrayBuffers[this.array.buffer._uuid]=this.array.slice(0).buffer);const t=new this.array.constructor(e.arrayBuffers[this.array.buffer._uuid]),n=new this.constructor(t,this.stride);return n.setUsage(this.usage),n}onUpload(e){return this.onUploadCallback=e,this}toJSON(e){return e.arrayBuffers===void 0&&(e.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=Zi()),e.arrayBuffers[this.array.buffer._uuid]===void 0&&(e.arrayBuffers[this.array.buffer._uuid]=Array.from(new Uint32Array(this.array.buffer))),{uuid:this.uuid,buffer:this.array.buffer._uuid,type:this.array.constructor.name,stride:this.stride}}}const si=new J;class fh{constructor(e,t,n,s=!1){this.isInterleavedBufferAttribute=!0,this.name="",this.data=e,this.itemSize=t,this.offset=n,this.normalized=s}get count(){return this.data.count}get array(){return this.data.array}set needsUpdate(e){this.data.needsUpdate=e}applyMatrix4(e){for(let t=0,n=this.data.count;t<n;t++)si.fromBufferAttribute(this,t),si.applyMatrix4(e),this.setXYZ(t,si.x,si.y,si.z);return this}applyNormalMatrix(e){for(let t=0,n=this.count;t<n;t++)si.fromBufferAttribute(this,t),si.applyNormalMatrix(e),this.setXYZ(t,si.x,si.y,si.z);return this}transformDirection(e){for(let t=0,n=this.count;t<n;t++)si.fromBufferAttribute(this,t),si.transformDirection(e),this.setXYZ(t,si.x,si.y,si.z);return this}getComponent(e,t){let n=this.array[e*this.data.stride+this.offset+t];return this.normalized&&(n=li(n,this.array)),n}setComponent(e,t,n){return this.normalized&&(n=pn(n,this.array)),this.data.array[e*this.data.stride+this.offset+t]=n,this}setX(e,t){return this.normalized&&(t=pn(t,this.array)),this.data.array[e*this.data.stride+this.offset]=t,this}setY(e,t){return this.normalized&&(t=pn(t,this.array)),this.data.array[e*this.data.stride+this.offset+1]=t,this}setZ(e,t){return this.normalized&&(t=pn(t,this.array)),this.data.array[e*this.data.stride+this.offset+2]=t,this}setW(e,t){return this.normalized&&(t=pn(t,this.array)),this.data.array[e*this.data.stride+this.offset+3]=t,this}getX(e){let t=this.data.array[e*this.data.stride+this.offset];return this.normalized&&(t=li(t,this.array)),t}getY(e){let t=this.data.array[e*this.data.stride+this.offset+1];return this.normalized&&(t=li(t,this.array)),t}getZ(e){let t=this.data.array[e*this.data.stride+this.offset+2];return this.normalized&&(t=li(t,this.array)),t}getW(e){let t=this.data.array[e*this.data.stride+this.offset+3];return this.normalized&&(t=li(t,this.array)),t}setXY(e,t,n){return e=e*this.data.stride+this.offset,this.normalized&&(t=pn(t,this.array),n=pn(n,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=n,this}setXYZ(e,t,n,s){return e=e*this.data.stride+this.offset,this.normalized&&(t=pn(t,this.array),n=pn(n,this.array),s=pn(s,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=n,this.data.array[e+2]=s,this}setXYZW(e,t,n,s,i){return e=e*this.data.stride+this.offset,this.normalized&&(t=pn(t,this.array),n=pn(n,this.array),s=pn(s,this.array),i=pn(i,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=n,this.data.array[e+2]=s,this.data.array[e+3]=i,this}clone(e){if(e===void 0){console.log("THREE.InterleavedBufferAttribute.clone(): Cloning an interleaved buffer attribute will de-interleave buffer data.");const t=[];for(let n=0;n<this.count;n++){const s=n*this.data.stride+this.offset;for(let i=0;i<this.itemSize;i++)t.push(this.data.array[s+i])}return new Kn(new this.array.constructor(t),this.itemSize,this.normalized)}else return e.interleavedBuffers===void 0&&(e.interleavedBuffers={}),e.interleavedBuffers[this.data.uuid]===void 0&&(e.interleavedBuffers[this.data.uuid]=this.data.clone(e)),new fh(e.interleavedBuffers[this.data.uuid],this.itemSize,this.offset,this.normalized)}toJSON(e){if(e===void 0){console.log("THREE.InterleavedBufferAttribute.toJSON(): Serializing an interleaved buffer attribute will de-interleave buffer data.");const t=[];for(let n=0;n<this.count;n++){const s=n*this.data.stride+this.offset;for(let i=0;i<this.itemSize;i++)t.push(this.data.array[s+i])}return{itemSize:this.itemSize,type:this.array.constructor.name,array:t,normalized:this.normalized}}else return e.interleavedBuffers===void 0&&(e.interleavedBuffers={}),e.interleavedBuffers[this.data.uuid]===void 0&&(e.interleavedBuffers[this.data.uuid]=this.data.toJSON(e)),{isInterleavedBufferAttribute:!0,itemSize:this.itemSize,data:this.data.uuid,offset:this.offset,normalized:this.normalized}}}class wM extends $s{constructor(e){super(),this.isSpriteMaterial=!0,this.type="SpriteMaterial",this.color=new St(16777215),this.map=null,this.alphaMap=null,this.rotation=0,this.sizeAttenuation=!0,this.transparent=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.rotation=e.rotation,this.sizeAttenuation=e.sizeAttenuation,this.fog=e.fog,this}}let rp;const wg=new J,sp=new J,ip=new J,op=new Ve,Sg=new Ve,W4=new Jt,Ax=new J,bg=new J,Rx=new J,IC=new Ve,rS=new Ve,kC=new Ve;class $4 extends jn{constructor(e=new wM){if(super(),this.isSprite=!0,this.type="Sprite",rp===void 0){rp=new mn;const t=new Float32Array([-.5,-.5,0,0,0,.5,-.5,0,1,0,.5,.5,0,1,1,-.5,.5,0,0,1]),n=new dw(t,5);rp.setIndex([0,1,2,0,2,3]),rp.setAttribute("position",new fh(n,3,0,!1)),rp.setAttribute("uv",new fh(n,2,3,!1))}this.geometry=rp,this.material=e,this.center=new Ve(.5,.5),this.count=1}raycast(e,t){e.camera===null&&console.error('THREE.Sprite: "Raycaster.camera" needs to be set in order to raycast against sprites.'),sp.setFromMatrixScale(this.matrixWorld),W4.copy(e.camera.matrixWorld),this.modelViewMatrix.multiplyMatrices(e.camera.matrixWorldInverse,this.matrixWorld),ip.setFromMatrixPosition(this.modelViewMatrix),e.camera.isPerspectiveCamera&&this.material.sizeAttenuation===!1&&sp.multiplyScalar(-ip.z);const n=this.material.rotation;let s,i;n!==0&&(i=Math.cos(n),s=Math.sin(n));const o=this.center;Nx(Ax.set(-.5,-.5,0),ip,o,sp,s,i),Nx(bg.set(.5,-.5,0),ip,o,sp,s,i),Nx(Rx.set(.5,.5,0),ip,o,sp,s,i),IC.set(0,0),rS.set(1,0),kC.set(1,1);let a=e.ray.intersectTriangle(Ax,bg,Rx,!1,wg);if(a===null&&(Nx(bg.set(-.5,.5,0),ip,o,sp,s,i),rS.set(0,1),a=e.ray.intersectTriangle(Ax,Rx,bg,!1,wg),a===null))return;const c=e.ray.origin.distanceTo(wg);c<e.near||c>e.far||t.push({distance:c,point:wg.clone(),uv:Pi.getInterpolation(wg,Ax,bg,Rx,IC,rS,kC,new Ve),face:null,object:this})}copy(e,t){return super.copy(e,t),e.center!==void 0&&this.center.copy(e.center),this.material=e.material,this}}function Nx(r,e,t,n,s,i){op.subVectors(r,t).addScalar(.5).multiply(n),s!==void 0?(Sg.x=i*op.x-s*op.y,Sg.y=s*op.x+i*op.y):Sg.copy(op),r.copy(e),r.x+=Sg.x,r.y+=Sg.y,r.applyMatrix4(W4)}const Px=new J,DC=new J;class q4 extends jn{constructor(){super(),this.isLOD=!0,this._currentLevel=0,this.type="LOD",Object.defineProperties(this,{levels:{enumerable:!0,value:[]}}),this.autoUpdate=!0}copy(e){super.copy(e,!1);const t=e.levels;for(let n=0,s=t.length;n<s;n++){const i=t[n];this.addLevel(i.object.clone(),i.distance,i.hysteresis)}return this.autoUpdate=e.autoUpdate,this}addLevel(e,t=0,n=0){t=Math.abs(t);const s=this.levels;let i;for(i=0;i<s.length&&!(t<s[i].distance);i++);return s.splice(i,0,{distance:t,hysteresis:n,object:e}),this.add(e),this}removeLevel(e){const t=this.levels;for(let n=0;n<t.length;n++)if(t[n].distance===e){const s=t.splice(n,1);return this.remove(s[0].object),!0}return!1}getCurrentLevel(){return this._currentLevel}getObjectForDistance(e){const t=this.levels;if(t.length>0){let n,s;for(n=1,s=t.length;n<s;n++){let i=t[n].distance;if(t[n].object.visible&&(i-=i*t[n].hysteresis),e<i)break}return t[n-1].object}return null}raycast(e,t){if(this.levels.length>0){Px.setFromMatrixPosition(this.matrixWorld);const s=e.ray.origin.distanceTo(Px);this.getObjectForDistance(s).raycast(e,t)}}update(e){const t=this.levels;if(t.length>1){Px.setFromMatrixPosition(e.matrixWorld),DC.setFromMatrixPosition(this.matrixWorld);const n=Px.distanceTo(DC)/e.zoom;t[0].object.visible=!0;let s,i;for(s=1,i=t.length;s<i;s++){let o=t[s].distance;if(t[s].object.visible&&(o-=o*t[s].hysteresis),n>=o)t[s-1].object.visible=!1,t[s].object.visible=!0;else break}for(this._currentLevel=s-1;s<i;s++)t[s].object.visible=!1}}toJSON(e){const t=super.toJSON(e);this.autoUpdate===!1&&(t.object.autoUpdate=!1),t.object.levels=[];const n=this.levels;for(let s=0,i=n.length;s<i;s++){const o=n[s];t.object.levels.push({object:o.object.uuid,distance:o.distance,hysteresis:o.hysteresis})}return t}}const LC=new J,OC=new On,jC=new On,b$=new J,FC=new Jt,Ix=new J,sS=new bs,UC=new Jt,iS=new wh;class X4 extends Ur{constructor(e,t){super(e,t),this.isSkinnedMesh=!0,this.type="SkinnedMesh",this.bindMode=Lb,this.bindMatrix=new Jt,this.bindMatrixInverse=new Jt,this.boundingBox=null,this.boundingSphere=null}computeBoundingBox(){const e=this.geometry;this.boundingBox===null&&(this.boundingBox=new Ws),this.boundingBox.makeEmpty();const t=e.getAttribute("position");for(let n=0;n<t.count;n++)this.getVertexPosition(n,Ix),this.boundingBox.expandByPoint(Ix)}computeBoundingSphere(){const e=this.geometry;this.boundingSphere===null&&(this.boundingSphere=new bs),this.boundingSphere.makeEmpty();const t=e.getAttribute("position");for(let n=0;n<t.count;n++)this.getVertexPosition(n,Ix),this.boundingSphere.expandByPoint(Ix)}copy(e,t){return super.copy(e,t),this.bindMode=e.bindMode,this.bindMatrix.copy(e.bindMatrix),this.bindMatrixInverse.copy(e.bindMatrixInverse),this.skeleton=e.skeleton,e.boundingBox!==null&&(this.boundingBox=e.boundingBox.clone()),e.boundingSphere!==null&&(this.boundingSphere=e.boundingSphere.clone()),this}raycast(e,t){const n=this.material,s=this.matrixWorld;n!==void 0&&(this.boundingSphere===null&&this.computeBoundingSphere(),sS.copy(this.boundingSphere),sS.applyMatrix4(s),e.ray.intersectsSphere(sS)!==!1&&(UC.copy(s).invert(),iS.copy(e.ray).applyMatrix4(UC),!(this.boundingBox!==null&&iS.intersectsBox(this.boundingBox)===!1)&&this._computeIntersections(e,t,iS)))}getVertexPosition(e,t){return super.getVertexPosition(e,t),this.applyBoneTransform(e,t),t}bind(e,t){this.skeleton=e,t===void 0&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),t=this.matrixWorld),this.bindMatrix.copy(t),this.bindMatrixInverse.copy(t).invert()}pose(){this.skeleton.pose()}normalizeSkinWeights(){const e=new On,t=this.geometry.attributes.skinWeight;for(let n=0,s=t.count;n<s;n++){e.fromBufferAttribute(t,n);const i=1/e.manhattanLength();i!==1/0?e.multiplyScalar(i):e.set(1,0,0,0),t.setXYZW(n,e.x,e.y,e.z,e.w)}}updateMatrixWorld(e){super.updateMatrixWorld(e),this.bindMode===Lb?this.bindMatrixInverse.copy(this.matrixWorld).invert():this.bindMode===b4?this.bindMatrixInverse.copy(this.bindMatrix).invert():console.warn("THREE.SkinnedMesh: Unrecognized bindMode: "+this.bindMode)}applyBoneTransform(e,t){const n=this.skeleton,s=this.geometry;OC.fromBufferAttribute(s.attributes.skinIndex,e),jC.fromBufferAttribute(s.attributes.skinWeight,e),LC.copy(t).applyMatrix4(this.bindMatrix),t.set(0,0,0);for(let i=0;i<4;i++){const o=jC.getComponent(i);if(o!==0){const a=OC.getComponent(i);FC.multiplyMatrices(n.bones[a].matrixWorld,n.boneInverses[a]),t.addScaledVector(b$.copy(LC).applyMatrix4(FC),o)}}return t.applyMatrix4(this.bindMatrixInverse)}}class SM extends jn{constructor(){super(),this.isBone=!0,this.type="Bone"}}class Ba extends _r{constructor(e=null,t=1,n=1,s,i,o,a,c,d=Ss,f=Ss,m,v){super(null,o,a,c,d,f,s,i,m,v),this.isDataTexture=!0,this.image={data:e,width:t,height:n},this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}const BC=new Jt,E$=new Jt;class hw{constructor(e=[],t=[]){this.uuid=Zi(),this.bones=e.slice(0),this.boneInverses=t,this.boneMatrices=null,this.boneTexture=null,this.init()}init(){const e=this.bones,t=this.boneInverses;if(this.boneMatrices=new Float32Array(e.length*16),t.length===0)this.calculateInverses();else if(e.length!==t.length){console.warn("THREE.Skeleton: Number of inverse bone matrices does not match amount of bones."),this.boneInverses=[];for(let n=0,s=this.bones.length;n<s;n++)this.boneInverses.push(new Jt)}}calculateInverses(){this.boneInverses.length=0;for(let e=0,t=this.bones.length;e<t;e++){const n=new Jt;this.bones[e]&&n.copy(this.bones[e].matrixWorld).invert(),this.boneInverses.push(n)}}pose(){for(let e=0,t=this.bones.length;e<t;e++){const n=this.bones[e];n&&n.matrixWorld.copy(this.boneInverses[e]).invert()}for(let e=0,t=this.bones.length;e<t;e++){const n=this.bones[e];n&&(n.parent&&n.parent.isBone?(n.matrix.copy(n.parent.matrixWorld).invert(),n.matrix.multiply(n.matrixWorld)):n.matrix.copy(n.matrixWorld),n.matrix.decompose(n.position,n.quaternion,n.scale))}}update(){const e=this.bones,t=this.boneInverses,n=this.boneMatrices,s=this.boneTexture;for(let i=0,o=e.length;i<o;i++){const a=e[i]?e[i].matrixWorld:E$;BC.multiplyMatrices(a,t[i]),BC.toArray(n,i*16)}s!==null&&(s.needsUpdate=!0)}clone(){return new hw(this.bones,this.boneInverses)}computeBoneTexture(){let e=Math.sqrt(this.bones.length*4);e=Math.ceil(e/4)*4,e=Math.max(e,4);const t=new Float32Array(e*e*4);t.set(this.boneMatrices);const n=new Ba(t,e,e,Vs,Ii);return n.needsUpdate=!0,this.boneMatrices=t,this.boneTexture=n,this}getBoneByName(e){for(let t=0,n=this.bones.length;t<n;t++){const s=this.bones[t];if(s.name===e)return s}}dispose(){this.boneTexture!==null&&(this.boneTexture.dispose(),this.boneTexture=null)}fromJSON(e,t){this.uuid=e.uuid;for(let n=0,s=e.bones.length;n<s;n++){const i=e.bones[n];let o=t[i];o===void 0&&(console.warn("THREE.Skeleton: No bone found with UUID:",i),o=new SM),this.bones.push(o),this.boneInverses.push(new Jt().fromArray(e.boneInverses[n]))}return this.init(),this}toJSON(){const e={metadata:{version:4.7,type:"Skeleton",generator:"Skeleton.toJSON"},bones:[],boneInverses:[]};e.uuid=this.uuid;const t=this.bones,n=this.boneInverses;for(let s=0,i=t.length;s<i;s++){const o=t[s];e.bones.push(o.uuid);const a=n[s];e.boneInverses.push(a.toArray())}return e}}class Yp extends Kn{constructor(e,t,n,s=1){super(e,t,n),this.isInstancedBufferAttribute=!0,this.meshPerAttribute=s}copy(e){return super.copy(e),this.meshPerAttribute=e.meshPerAttribute,this}toJSON(){const e=super.toJSON();return e.meshPerAttribute=this.meshPerAttribute,e.isInstancedBufferAttribute=!0,e}}const ap=new Jt,zC=new Jt,kx=[],VC=new Ws,M$=new Jt,Eg=new Ur,Mg=new bs;class Y4 extends Ur{constructor(e,t,n){super(e,t),this.isInstancedMesh=!0,this.instanceMatrix=new Yp(new Float32Array(n*16),16),this.instanceColor=null,this.morphTexture=null,this.count=n,this.boundingBox=null,this.boundingSphere=null;for(let s=0;s<n;s++)this.setMatrixAt(s,M$)}computeBoundingBox(){const e=this.geometry,t=this.count;this.boundingBox===null&&(this.boundingBox=new Ws),e.boundingBox===null&&e.computeBoundingBox(),this.boundingBox.makeEmpty();for(let n=0;n<t;n++)this.getMatrixAt(n,ap),VC.copy(e.boundingBox).applyMatrix4(ap),this.boundingBox.union(VC)}computeBoundingSphere(){const e=this.geometry,t=this.count;this.boundingSphere===null&&(this.boundingSphere=new bs),e.boundingSphere===null&&e.computeBoundingSphere(),this.boundingSphere.makeEmpty();for(let n=0;n<t;n++)this.getMatrixAt(n,ap),Mg.copy(e.boundingSphere).applyMatrix4(ap),this.boundingSphere.union(Mg)}copy(e,t){return super.copy(e,t),this.instanceMatrix.copy(e.instanceMatrix),e.morphTexture!==null&&(this.morphTexture=e.morphTexture.clone()),e.instanceColor!==null&&(this.instanceColor=e.instanceColor.clone()),this.count=e.count,e.boundingBox!==null&&(this.boundingBox=e.boundingBox.clone()),e.boundingSphere!==null&&(this.boundingSphere=e.boundingSphere.clone()),this}getColorAt(e,t){t.fromArray(this.instanceColor.array,e*3)}getMatrixAt(e,t){t.fromArray(this.instanceMatrix.array,e*16)}getMorphAt(e,t){const n=t.morphTargetInfluences,s=this.morphTexture.source.data.data,i=n.length+1,o=e*i+1;for(let a=0;a<n.length;a++)n[a]=s[o+a]}raycast(e,t){const n=this.matrixWorld,s=this.count;if(Eg.geometry=this.geometry,Eg.material=this.material,Eg.material!==void 0&&(this.boundingSphere===null&&this.computeBoundingSphere(),Mg.copy(this.boundingSphere),Mg.applyMatrix4(n),e.ray.intersectsSphere(Mg)!==!1))for(let i=0;i<s;i++){this.getMatrixAt(i,ap),zC.multiplyMatrices(n,ap),Eg.matrixWorld=zC,Eg.raycast(e,kx);for(let o=0,a=kx.length;o<a;o++){const c=kx[o];c.instanceId=i,c.object=this,t.push(c)}kx.length=0}}setColorAt(e,t){this.instanceColor===null&&(this.instanceColor=new Yp(new Float32Array(this.instanceMatrix.count*3).fill(1),3)),t.toArray(this.instanceColor.array,e*3)}setMatrixAt(e,t){t.toArray(this.instanceMatrix.array,e*16)}setMorphAt(e,t){const n=t.morphTargetInfluences,s=n.length+1;this.morphTexture===null&&(this.morphTexture=new Ba(new Float32Array(s*this.count),s,this.count,rw,Ii));const i=this.morphTexture.source.data.data;let o=0;for(let d=0;d<n.length;d++)o+=n[d];const a=this.geometry.morphTargetsRelative?1:1-o,c=s*e;i[c]=a,i.set(n,c+1)}updateMorphTargets(){}dispose(){this.dispatchEvent({type:"dispose"}),this.morphTexture!==null&&(this.morphTexture.dispose(),this.morphTexture=null)}}const oS=new J,T$=new J,C$=new cn;class Bl{constructor(e=new J(1,0,0),t=0){this.isPlane=!0,this.normal=e,this.constant=t}set(e,t){return this.normal.copy(e),this.constant=t,this}setComponents(e,t,n,s){return this.normal.set(e,t,n),this.constant=s,this}setFromNormalAndCoplanarPoint(e,t){return this.normal.copy(e),this.constant=-t.dot(this.normal),this}setFromCoplanarPoints(e,t,n){const s=oS.subVectors(n,t).cross(T$.subVectors(e,t)).normalize();return this.setFromNormalAndCoplanarPoint(s,e),this}copy(e){return this.normal.copy(e.normal),this.constant=e.constant,this}normalize(){const e=1/this.normal.length();return this.normal.multiplyScalar(e),this.constant*=e,this}negate(){return this.constant*=-1,this.normal.negate(),this}distanceToPoint(e){return this.normal.dot(e)+this.constant}distanceToSphere(e){return this.distanceToPoint(e.center)-e.radius}projectPoint(e,t){return t.copy(e).addScaledVector(this.normal,-this.distanceToPoint(e))}intersectLine(e,t){const n=e.delta(oS),s=this.normal.dot(n);if(s===0)return this.distanceToPoint(e.start)===0?t.copy(e.start):null;const i=-(e.start.dot(this.normal)+this.constant)/s;return i<0||i>1?null:t.copy(e.start).addScaledVector(n,i)}intersectsLine(e){const t=this.distanceToPoint(e.start),n=this.distanceToPoint(e.end);return t<0&&n>0||n<0&&t>0}intersectsBox(e){return e.intersectsPlane(this)}intersectsSphere(e){return e.intersectsPlane(this)}coplanarPoint(e){return e.copy(this.normal).multiplyScalar(-this.constant)}applyMatrix4(e,t){const n=t||C$.getNormalMatrix(e),s=this.coplanarPoint(oS).applyMatrix4(e),i=this.normal.applyMatrix3(n).normalize();return this.constant=-s.dot(i),this}translate(e){return this.constant-=e.dot(this.normal),this}equals(e){return e.normal.equals(this.normal)&&e.constant===this.constant}clone(){return new this.constructor().copy(this)}}const xd=new bs,Dx=new J;class pm{constructor(e=new Bl,t=new Bl,n=new Bl,s=new Bl,i=new Bl,o=new Bl){this.planes=[e,t,n,s,i,o]}set(e,t,n,s,i,o){const a=this.planes;return a[0].copy(e),a[1].copy(t),a[2].copy(n),a[3].copy(s),a[4].copy(i),a[5].copy(o),this}copy(e){const t=this.planes;for(let n=0;n<6;n++)t[n].copy(e.planes[n]);return this}setFromProjectionMatrix(e,t=xo){const n=this.planes,s=e.elements,i=s[0],o=s[1],a=s[2],c=s[3],d=s[4],f=s[5],m=s[6],v=s[7],x=s[8],_=s[9],b=s[10],w=s[11],S=s[12],C=s[13],T=s[14],A=s[15];if(n[0].setComponents(c-i,v-d,w-x,A-S).normalize(),n[1].setComponents(c+i,v+d,w+x,A+S).normalize(),n[2].setComponents(c+o,v+f,w+_,A+C).normalize(),n[3].setComponents(c-o,v-f,w-_,A-C).normalize(),n[4].setComponents(c-a,v-m,w-b,A-T).normalize(),t===xo)n[5].setComponents(c+a,v+m,w+b,A+T).normalize();else if(t===w0)n[5].setComponents(a,m,b,T).normalize();else throw new Error("THREE.Frustum.setFromProjectionMatrix(): Invalid coordinate system: "+t);return this}intersectsObject(e){if(e.boundingSphere!==void 0)e.boundingSphere===null&&e.computeBoundingSphere(),xd.copy(e.boundingSphere).applyMatrix4(e.matrixWorld);else{const t=e.geometry;t.boundingSphere===null&&t.computeBoundingSphere(),xd.copy(t.boundingSphere).applyMatrix4(e.matrixWorld)}return this.intersectsSphere(xd)}intersectsSprite(e){return xd.center.set(0,0,0),xd.radius=.7071067811865476,xd.applyMatrix4(e.matrixWorld),this.intersectsSphere(xd)}intersectsSphere(e){const t=this.planes,n=e.center,s=-e.radius;for(let i=0;i<6;i++)if(t[i].distanceToPoint(n)<s)return!1;return!0}intersectsBox(e){const t=this.planes;for(let n=0;n<6;n++){const s=t[n];if(Dx.x=s.normal.x>0?e.max.x:e.min.x,Dx.y=s.normal.y>0?e.max.y:e.min.y,Dx.z=s.normal.z>0?e.max.z:e.min.z,s.distanceToPoint(Dx)<0)return!1}return!0}containsPoint(e){const t=this.planes;for(let n=0;n<6;n++)if(t[n].distanceToPoint(e)<0)return!1;return!0}clone(){return new this.constructor().copy(this)}}const Ta=new Jt,Ca=new pm;class fw{constructor(){this.coordinateSystem=xo}intersectsObject(e,t){if(!t.isArrayCamera||t.cameras.length===0)return!1;for(let n=0;n<t.cameras.length;n++){const s=t.cameras[n];if(Ta.multiplyMatrices(s.projectionMatrix,s.matrixWorldInverse),Ca.setFromProjectionMatrix(Ta,this.coordinateSystem),Ca.intersectsObject(e))return!0}return!1}intersectsSprite(e,t){if(!t||!t.cameras||t.cameras.length===0)return!1;for(let n=0;n<t.cameras.length;n++){const s=t.cameras[n];if(Ta.multiplyMatrices(s.projectionMatrix,s.matrixWorldInverse),Ca.setFromProjectionMatrix(Ta,this.coordinateSystem),Ca.intersectsSprite(e))return!0}return!1}intersectsSphere(e,t){if(!t||!t.cameras||t.cameras.length===0)return!1;for(let n=0;n<t.cameras.length;n++){const s=t.cameras[n];if(Ta.multiplyMatrices(s.projectionMatrix,s.matrixWorldInverse),Ca.setFromProjectionMatrix(Ta,this.coordinateSystem),Ca.intersectsSphere(e))return!0}return!1}intersectsBox(e,t){if(!t||!t.cameras||t.cameras.length===0)return!1;for(let n=0;n<t.cameras.length;n++){const s=t.cameras[n];if(Ta.multiplyMatrices(s.projectionMatrix,s.matrixWorldInverse),Ca.setFromProjectionMatrix(Ta,this.coordinateSystem),Ca.intersectsBox(e))return!0}return!1}containsPoint(e,t){if(!t||!t.cameras||t.cameras.length===0)return!1;for(let n=0;n<t.cameras.length;n++){const s=t.cameras[n];if(Ta.multiplyMatrices(s.projectionMatrix,s.matrixWorldInverse),Ca.setFromProjectionMatrix(Ta,this.coordinateSystem),Ca.containsPoint(e))return!0}return!1}clone(){return new fw}}function aS(r,e){return r-e}function A$(r,e){return r.z-e.z}function R$(r,e){return e.z-r.z}class N${constructor(){this.index=0,this.pool=[],this.list=[]}push(e,t,n,s){const i=this.pool,o=this.list;this.index>=i.length&&i.push({start:-1,count:-1,z:-1,index:-1});const a=i[this.index];o.push(a),this.index++,a.start=e,a.count=t,a.z=n,a.index=s}reset(){this.list.length=0,this.index=0}}const Mi=new Jt,P$=new St(1,1,1),HC=new pm,I$=new fw,Lx=new Ws,yd=new bs,Tg=new J,GC=new J,k$=new J,lS=new N$,js=new Ur,Ox=[];function D$(r,e,t=0){const n=e.itemSize;if(r.isInterleavedBufferAttribute||r.array.constructor!==e.array.constructor){const s=r.count;for(let i=0;i<s;i++)for(let o=0;o<n;o++)e.setComponent(i+t,o,r.getComponent(i,o))}else e.array.set(r.array,t*n);e.needsUpdate=!0}function _d(r,e){if(r.constructor!==e.constructor){const t=Math.min(r.length,e.length);for(let n=0;n<t;n++)e[n]=r[n]}else{const t=Math.min(r.length,e.length);e.set(new r.constructor(r.buffer,0,t))}}class K4 extends Ur{constructor(e,t,n=t*2,s){super(new mn,s),this.isBatchedMesh=!0,this.perObjectFrustumCulled=!0,this.sortObjects=!0,this.boundingBox=null,this.boundingSphere=null,this.customSort=null,this._instanceInfo=[],this._geometryInfo=[],this._availableInstanceIds=[],this._availableGeometryIds=[],this._nextIndexStart=0,this._nextVertexStart=0,this._geometryCount=0,this._visibilityChanged=!0,this._geometryInitialized=!1,this._maxInstanceCount=e,this._maxVertexCount=t,this._maxIndexCount=n,this._multiDrawCounts=new Int32Array(e),this._multiDrawStarts=new Int32Array(e),this._multiDrawCount=0,this._multiDrawInstances=null,this._matricesTexture=null,this._indirectTexture=null,this._colorsTexture=null,this._initMatricesTexture(),this._initIndirectTexture()}get maxInstanceCount(){return this._maxInstanceCount}get instanceCount(){return this._instanceInfo.length-this._availableInstanceIds.length}get unusedVertexCount(){return this._maxVertexCount-this._nextVertexStart}get unusedIndexCount(){return this._maxIndexCount-this._nextIndexStart}_initMatricesTexture(){let e=Math.sqrt(this._maxInstanceCount*4);e=Math.ceil(e/4)*4,e=Math.max(e,4);const t=new Float32Array(e*e*4),n=new Ba(t,e,e,Vs,Ii);this._matricesTexture=n}_initIndirectTexture(){let e=Math.sqrt(this._maxInstanceCount);e=Math.ceil(e);const t=new Uint32Array(e*e),n=new Ba(t,e,e,$0,tc);this._indirectTexture=n}_initColorsTexture(){let e=Math.sqrt(this._maxInstanceCount);e=Math.ceil(e);const t=new Float32Array(e*e*4).fill(1),n=new Ba(t,e,e,Vs,Ii);n.colorSpace=kn.workingColorSpace,this._colorsTexture=n}_initializeGeometry(e){const t=this.geometry,n=this._maxVertexCount,s=this._maxIndexCount;if(this._geometryInitialized===!1){for(const i in e.attributes){const o=e.getAttribute(i),{array:a,itemSize:c,normalized:d}=o,f=new a.constructor(n*c),m=new Kn(f,c,d);t.setAttribute(i,m)}if(e.getIndex()!==null){const i=n>65535?new Uint32Array(s):new Uint16Array(s);t.setIndex(new Kn(i,1))}this._geometryInitialized=!0}}_validateGeometry(e){const t=this.geometry;if(!!e.getIndex()!=!!t.getIndex())throw new Error('THREE.BatchedMesh: All geometries must consistently have "index".');for(const n in t.attributes){if(!e.hasAttribute(n))throw new Error(`THREE.BatchedMesh: Added geometry missing "${n}". All geometries must have consistent attributes.`);const s=e.getAttribute(n),i=t.getAttribute(n);if(s.itemSize!==i.itemSize||s.normalized!==i.normalized)throw new Error("THREE.BatchedMesh: All attributes must have a consistent itemSize and normalized value.")}}validateInstanceId(e){const t=this._instanceInfo;if(e<0||e>=t.length||t[e].active===!1)throw new Error(`THREE.BatchedMesh: Invalid instanceId ${e}. Instance is either out of range or has been deleted.`)}validateGeometryId(e){const t=this._geometryInfo;if(e<0||e>=t.length||t[e].active===!1)throw new Error(`THREE.BatchedMesh: Invalid geometryId ${e}. Geometry is either out of range or has been deleted.`)}setCustomSort(e){return this.customSort=e,this}computeBoundingBox(){this.boundingBox===null&&(this.boundingBox=new Ws);const e=this.boundingBox,t=this._instanceInfo;e.makeEmpty();for(let n=0,s=t.length;n<s;n++){if(t[n].active===!1)continue;const i=t[n].geometryIndex;this.getMatrixAt(n,Mi),this.getBoundingBoxAt(i,Lx).applyMatrix4(Mi),e.union(Lx)}}computeBoundingSphere(){this.boundingSphere===null&&(this.boundingSphere=new bs);const e=this.boundingSphere,t=this._instanceInfo;e.makeEmpty();for(let n=0,s=t.length;n<s;n++){if(t[n].active===!1)continue;const i=t[n].geometryIndex;this.getMatrixAt(n,Mi),this.getBoundingSphereAt(i,yd).applyMatrix4(Mi),e.union(yd)}}addInstance(e){if(this._instanceInfo.length>=this.maxInstanceCount&&this._availableInstanceIds.length===0)throw new Error("THREE.BatchedMesh: Maximum item count reached.");const n={visible:!0,active:!0,geometryIndex:e};let s=null;this._availableInstanceIds.length>0?(this._availableInstanceIds.sort(aS),s=this._availableInstanceIds.shift(),this._instanceInfo[s]=n):(s=this._instanceInfo.length,this._instanceInfo.push(n));const i=this._matricesTexture;Mi.identity().toArray(i.image.data,s*16),i.needsUpdate=!0;const o=this._colorsTexture;return o&&(P$.toArray(o.image.data,s*4),o.needsUpdate=!0),this._visibilityChanged=!0,s}addGeometry(e,t=-1,n=-1){this._initializeGeometry(e),this._validateGeometry(e);const s={vertexStart:-1,vertexCount:-1,reservedVertexCount:-1,indexStart:-1,indexCount:-1,reservedIndexCount:-1,start:-1,count:-1,boundingBox:null,boundingSphere:null,active:!0},i=this._geometryInfo;s.vertexStart=this._nextVertexStart,s.reservedVertexCount=t===-1?e.getAttribute("position").count:t;const o=e.getIndex();if(o!==null&&(s.indexStart=this._nextIndexStart,s.reservedIndexCount=n===-1?o.count:n),s.indexStart!==-1&&s.indexStart+s.reservedIndexCount>this._maxIndexCount||s.vertexStart+s.reservedVertexCount>this._maxVertexCount)throw new Error("THREE.BatchedMesh: Reserved space request exceeds the maximum buffer size.");let c;return this._availableGeometryIds.length>0?(this._availableGeometryIds.sort(aS),c=this._availableGeometryIds.shift(),i[c]=s):(c=this._geometryCount,this._geometryCount++,i.push(s)),this.setGeometryAt(c,e),this._nextIndexStart=s.indexStart+s.reservedIndexCount,this._nextVertexStart=s.vertexStart+s.reservedVertexCount,c}setGeometryAt(e,t){if(e>=this._geometryCount)throw new Error("THREE.BatchedMesh: Maximum geometry count reached.");this._validateGeometry(t);const n=this.geometry,s=n.getIndex()!==null,i=n.getIndex(),o=t.getIndex(),a=this._geometryInfo[e];if(s&&o.count>a.reservedIndexCount||t.attributes.position.count>a.reservedVertexCount)throw new Error("THREE.BatchedMesh: Reserved space not large enough for provided geometry.");const c=a.vertexStart,d=a.reservedVertexCount;a.vertexCount=t.getAttribute("position").count;for(const f in n.attributes){const m=t.getAttribute(f),v=n.getAttribute(f);D$(m,v,c);const x=m.itemSize;for(let _=m.count,b=d;_<b;_++){const w=c+_;for(let S=0;S<x;S++)v.setComponent(w,S,0)}v.needsUpdate=!0,v.addUpdateRange(c*x,d*x)}if(s){const f=a.indexStart,m=a.reservedIndexCount;a.indexCount=t.getIndex().count;for(let v=0;v<o.count;v++)i.setX(f+v,c+o.getX(v));for(let v=o.count,x=m;v<x;v++)i.setX(f+v,c);i.needsUpdate=!0,i.addUpdateRange(f,a.reservedIndexCount)}return a.start=s?a.indexStart:a.vertexStart,a.count=s?a.indexCount:a.vertexCount,a.boundingBox=null,t.boundingBox!==null&&(a.boundingBox=t.boundingBox.clone()),a.boundingSphere=null,t.boundingSphere!==null&&(a.boundingSphere=t.boundingSphere.clone()),this._visibilityChanged=!0,e}deleteGeometry(e){const t=this._geometryInfo;if(e>=t.length||t[e].active===!1)return this;const n=this._instanceInfo;for(let s=0,i=n.length;s<i;s++)n[s].active&&n[s].geometryIndex===e&&this.deleteInstance(s);return t[e].active=!1,this._availableGeometryIds.push(e),this._visibilityChanged=!0,this}deleteInstance(e){return this.validateInstanceId(e),this._instanceInfo[e].active=!1,this._availableInstanceIds.push(e),this._visibilityChanged=!0,this}optimize(){let e=0,t=0;const n=this._geometryInfo,s=n.map((o,a)=>a).sort((o,a)=>n[o].vertexStart-n[a].vertexStart),i=this.geometry;for(let o=0,a=n.length;o<a;o++){const c=s[o],d=n[c];if(d.active!==!1){if(i.index!==null){if(d.indexStart!==t){const{indexStart:f,vertexStart:m,reservedIndexCount:v}=d,x=i.index,_=x.array,b=e-m;for(let w=f;w<f+v;w++)_[w]=_[w]+b;x.array.copyWithin(t,f,f+v),x.addUpdateRange(t,v),d.indexStart=t}t+=d.reservedIndexCount}if(d.vertexStart!==e){const{vertexStart:f,reservedVertexCount:m}=d,v=i.attributes;for(const x in v){const _=v[x],{array:b,itemSize:w}=_;b.copyWithin(e*w,f*w,(f+m)*w),_.addUpdateRange(e*w,m*w)}d.vertexStart=e}e+=d.reservedVertexCount,d.start=i.index?d.indexStart:d.vertexStart,this._nextIndexStart=i.index?d.indexStart+d.reservedIndexCount:0,this._nextVertexStart=d.vertexStart+d.reservedVertexCount}}return this}getBoundingBoxAt(e,t){if(e>=this._geometryCount)return null;const n=this.geometry,s=this._geometryInfo[e];if(s.boundingBox===null){const i=new Ws,o=n.index,a=n.attributes.position;for(let c=s.start,d=s.start+s.count;c<d;c++){let f=c;o&&(f=o.getX(f)),i.expandByPoint(Tg.fromBufferAttribute(a,f))}s.boundingBox=i}return t.copy(s.boundingBox),t}getBoundingSphereAt(e,t){if(e>=this._geometryCount)return null;const n=this.geometry,s=this._geometryInfo[e];if(s.boundingSphere===null){const i=new bs;this.getBoundingBoxAt(e,Lx),Lx.getCenter(i.center);const o=n.index,a=n.attributes.position;let c=0;for(let d=s.start,f=s.start+s.count;d<f;d++){let m=d;o&&(m=o.getX(m)),Tg.fromBufferAttribute(a,m),c=Math.max(c,i.center.distanceToSquared(Tg))}i.radius=Math.sqrt(c),s.boundingSphere=i}return t.copy(s.boundingSphere),t}setMatrixAt(e,t){this.validateInstanceId(e);const n=this._matricesTexture,s=this._matricesTexture.image.data;return t.toArray(s,e*16),n.needsUpdate=!0,this}getMatrixAt(e,t){return this.validateInstanceId(e),t.fromArray(this._matricesTexture.image.data,e*16)}setColorAt(e,t){return this.validateInstanceId(e),this._colorsTexture===null&&this._initColorsTexture(),t.toArray(this._colorsTexture.image.data,e*4),this._colorsTexture.needsUpdate=!0,this}getColorAt(e,t){return this.validateInstanceId(e),t.fromArray(this._colorsTexture.image.data,e*4)}setVisibleAt(e,t){return this.validateInstanceId(e),this._instanceInfo[e].visible===t?this:(this._instanceInfo[e].visible=t,this._visibilityChanged=!0,this)}getVisibleAt(e){return this.validateInstanceId(e),this._instanceInfo[e].visible}setGeometryIdAt(e,t){return this.validateInstanceId(e),this.validateGeometryId(t),this._instanceInfo[e].geometryIndex=t,this}getGeometryIdAt(e){return this.validateInstanceId(e),this._instanceInfo[e].geometryIndex}getGeometryRangeAt(e,t={}){this.validateGeometryId(e);const n=this._geometryInfo[e];return t.vertexStart=n.vertexStart,t.vertexCount=n.vertexCount,t.reservedVertexCount=n.reservedVertexCount,t.indexStart=n.indexStart,t.indexCount=n.indexCount,t.reservedIndexCount=n.reservedIndexCount,t.start=n.start,t.count=n.count,t}setInstanceCount(e){const t=this._availableInstanceIds,n=this._instanceInfo;for(t.sort(aS);t[t.length-1]===n.length;)n.pop(),t.pop();if(e<n.length)throw new Error(`BatchedMesh: Instance ids outside the range ${e} are being used. Cannot shrink instance count.`);const s=new Int32Array(e),i=new Int32Array(e);_d(this._multiDrawCounts,s),_d(this._multiDrawStarts,i),this._multiDrawCounts=s,this._multiDrawStarts=i,this._maxInstanceCount=e;const o=this._indirectTexture,a=this._matricesTexture,c=this._colorsTexture;o.dispose(),this._initIndirectTexture(),_d(o.image.data,this._indirectTexture.image.data),a.dispose(),this._initMatricesTexture(),_d(a.image.data,this._matricesTexture.image.data),c&&(c.dispose(),this._initColorsTexture(),_d(c.image.data,this._colorsTexture.image.data))}setGeometrySize(e,t){const n=[...this._geometryInfo].filter(a=>a.active);if(Math.max(...n.map(a=>a.vertexStart+a.reservedVertexCount))>e)throw new Error(`BatchedMesh: Geometry vertex values are being used outside the range ${t}. Cannot shrink further.`);if(this.geometry.index&&Math.max(...n.map(c=>c.indexStart+c.reservedIndexCount))>t)throw new Error(`BatchedMesh: Geometry index values are being used outside the range ${t}. Cannot shrink further.`);const i=this.geometry;i.dispose(),this._maxVertexCount=e,this._maxIndexCount=t,this._geometryInitialized&&(this._geometryInitialized=!1,this.geometry=new mn,this._initializeGeometry(i));const o=this.geometry;i.index&&_d(i.index.array,o.index.array);for(const a in i.attributes)_d(i.attributes[a].array,o.attributes[a].array)}raycast(e,t){const n=this._instanceInfo,s=this._geometryInfo,i=this.matrixWorld,o=this.geometry;js.material=this.material,js.geometry.index=o.index,js.geometry.attributes=o.attributes,js.geometry.boundingBox===null&&(js.geometry.boundingBox=new Ws),js.geometry.boundingSphere===null&&(js.geometry.boundingSphere=new bs);for(let a=0,c=n.length;a<c;a++){if(!n[a].visible||!n[a].active)continue;const d=n[a].geometryIndex,f=s[d];js.geometry.setDrawRange(f.start,f.count),this.getMatrixAt(a,js.matrixWorld).premultiply(i),this.getBoundingBoxAt(d,js.geometry.boundingBox),this.getBoundingSphereAt(d,js.geometry.boundingSphere),js.raycast(e,Ox);for(let m=0,v=Ox.length;m<v;m++){const x=Ox[m];x.object=this,x.batchId=a,t.push(x)}Ox.length=0}js.material=null,js.geometry.index=null,js.geometry.attributes={},js.geometry.setDrawRange(0,1/0)}copy(e){return super.copy(e),this.geometry=e.geometry.clone(),this.perObjectFrustumCulled=e.perObjectFrustumCulled,this.sortObjects=e.sortObjects,this.boundingBox=e.boundingBox!==null?e.boundingBox.clone():null,this.boundingSphere=e.boundingSphere!==null?e.boundingSphere.clone():null,this._geometryInfo=e._geometryInfo.map(t=>({...t,boundingBox:t.boundingBox!==null?t.boundingBox.clone():null,boundingSphere:t.boundingSphere!==null?t.boundingSphere.clone():null})),this._instanceInfo=e._instanceInfo.map(t=>({...t})),this._availableInstanceIds=e._availableInstanceIds.slice(),this._availableGeometryIds=e._availableGeometryIds.slice(),this._nextIndexStart=e._nextIndexStart,this._nextVertexStart=e._nextVertexStart,this._geometryCount=e._geometryCount,this._maxInstanceCount=e._maxInstanceCount,this._maxVertexCount=e._maxVertexCount,this._maxIndexCount=e._maxIndexCount,this._geometryInitialized=e._geometryInitialized,this._multiDrawCounts=e._multiDrawCounts.slice(),this._multiDrawStarts=e._multiDrawStarts.slice(),this._indirectTexture=e._indirectTexture.clone(),this._indirectTexture.image.data=this._indirectTexture.image.data.slice(),this._matricesTexture=e._matricesTexture.clone(),this._matricesTexture.image.data=this._matricesTexture.image.data.slice(),this._colorsTexture!==null&&(this._colorsTexture=e._colorsTexture.clone(),this._colorsTexture.image.data=this._colorsTexture.image.data.slice()),this}dispose(){this.geometry.dispose(),this._matricesTexture.dispose(),this._matricesTexture=null,this._indirectTexture.dispose(),this._indirectTexture=null,this._colorsTexture!==null&&(this._colorsTexture.dispose(),this._colorsTexture=null)}onBeforeRender(e,t,n,s,i){if(!this._visibilityChanged&&!this.perObjectFrustumCulled&&!this.sortObjects)return;const o=s.getIndex(),a=o===null?1:o.array.BYTES_PER_ELEMENT,c=this._instanceInfo,d=this._multiDrawStarts,f=this._multiDrawCounts,m=this._geometryInfo,v=this.perObjectFrustumCulled,x=this._indirectTexture,_=x.image.data,b=n.isArrayCamera?I$:HC;v&&!n.isArrayCamera&&(Mi.multiplyMatrices(n.projectionMatrix,n.matrixWorldInverse).multiply(this.matrixWorld),HC.setFromProjectionMatrix(Mi,e.coordinateSystem));let w=0;if(this.sortObjects){Mi.copy(this.matrixWorld).invert(),Tg.setFromMatrixPosition(n.matrixWorld).applyMatrix4(Mi),GC.set(0,0,-1).transformDirection(n.matrixWorld).transformDirection(Mi);for(let T=0,A=c.length;T<A;T++)if(c[T].visible&&c[T].active){const k=c[T].geometryIndex;this.getMatrixAt(T,Mi),this.getBoundingSphereAt(k,yd).applyMatrix4(Mi);let j=!1;if(v&&(j=!b.intersectsSphere(yd,n)),!j){const D=m[k],L=k$.subVectors(yd.center,Tg).dot(GC);lS.push(D.start,D.count,L,T)}}const S=lS.list,C=this.customSort;C===null?S.sort(i.transparent?R$:A$):C.call(this,S,n);for(let T=0,A=S.length;T<A;T++){const k=S[T];d[w]=k.start*a,f[w]=k.count,_[w]=k.index,w++}lS.reset()}else for(let S=0,C=c.length;S<C;S++)if(c[S].visible&&c[S].active){const T=c[S].geometryIndex;let A=!1;if(v&&(this.getMatrixAt(S,Mi),this.getBoundingSphereAt(T,yd).applyMatrix4(Mi),A=!b.intersectsSphere(yd,n)),!A){const k=m[T];d[w]=k.start*a,f[w]=k.count,_[w]=S,w++}}x.needsUpdate=!0,this._multiDrawCount=w,this._visibilityChanged=!1}onBeforeShadow(e,t,n,s,i,o){this.onBeforeRender(e,null,s,i,o)}}class di extends $s{constructor(e){super(),this.isLineBasicMaterial=!0,this.type="LineBasicMaterial",this.color=new St(16777215),this.map=null,this.linewidth=1,this.linecap="round",this.linejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.linewidth=e.linewidth,this.linecap=e.linecap,this.linejoin=e.linejoin,this.fog=e.fog,this}}const p_=new J,m_=new J,WC=new Jt,Cg=new wh,jx=new bs,cS=new J,$C=new J;class yu extends jn{constructor(e=new mn,t=new di){super(),this.isLine=!0,this.type="Line",this.geometry=e,this.material=t,this.morphTargetDictionary=void 0,this.morphTargetInfluences=void 0,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}computeLineDistances(){const e=this.geometry;if(e.index===null){const t=e.attributes.position,n=[0];for(let s=1,i=t.count;s<i;s++)p_.fromBufferAttribute(t,s-1),m_.fromBufferAttribute(t,s),n[s]=n[s-1],n[s]+=p_.distanceTo(m_);e.setAttribute("lineDistance",new It(n,1))}else console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}raycast(e,t){const n=this.geometry,s=this.matrixWorld,i=e.params.Line.threshold,o=n.drawRange;if(n.boundingSphere===null&&n.computeBoundingSphere(),jx.copy(n.boundingSphere),jx.applyMatrix4(s),jx.radius+=i,e.ray.intersectsSphere(jx)===!1)return;WC.copy(s).invert(),Cg.copy(e.ray).applyMatrix4(WC);const a=i/((this.scale.x+this.scale.y+this.scale.z)/3),c=a*a,d=this.isLineSegments?2:1,f=n.index,v=n.attributes.position;if(f!==null){const x=Math.max(0,o.start),_=Math.min(f.count,o.start+o.count);for(let b=x,w=_-1;b<w;b+=d){const S=f.getX(b),C=f.getX(b+1),T=Fx(this,e,Cg,c,S,C,b);T&&t.push(T)}if(this.isLineLoop){const b=f.getX(_-1),w=f.getX(x),S=Fx(this,e,Cg,c,b,w,_-1);S&&t.push(S)}}else{const x=Math.max(0,o.start),_=Math.min(v.count,o.start+o.count);for(let b=x,w=_-1;b<w;b+=d){const S=Fx(this,e,Cg,c,b,b+1,b);S&&t.push(S)}if(this.isLineLoop){const b=Fx(this,e,Cg,c,_-1,x,_-1);b&&t.push(b)}}}updateMorphTargets(){const t=this.geometry.morphAttributes,n=Object.keys(t);if(n.length>0){const s=t[n[0]];if(s!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let i=0,o=s.length;i<o;i++){const a=s[i].name||String(i);this.morphTargetInfluences.push(0),this.morphTargetDictionary[a]=i}}}}}function Fx(r,e,t,n,s,i,o){const a=r.geometry.attributes.position;if(p_.fromBufferAttribute(a,s),m_.fromBufferAttribute(a,i),t.distanceSqToSegment(p_,m_,cS,$C)>n)return;cS.applyMatrix4(r.matrixWorld);const d=e.ray.origin.distanceTo(cS);if(!(d<e.near||d>e.far))return{distance:d,point:$C.clone().applyMatrix4(r.matrixWorld),index:o,face:null,faceIndex:null,barycoord:null,object:r}}const qC=new J,XC=new J;class Ya extends yu{constructor(e,t){super(e,t),this.isLineSegments=!0,this.type="LineSegments"}computeLineDistances(){const e=this.geometry;if(e.index===null){const t=e.attributes.position,n=[];for(let s=0,i=t.count;s<i;s+=2)qC.fromBufferAttribute(t,s),XC.fromBufferAttribute(t,s+1),n[s]=s===0?0:n[s-1],n[s+1]=n[s]+qC.distanceTo(XC);e.setAttribute("lineDistance",new It(n,1))}else console.warn("THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}}class Q4 extends yu{constructor(e,t){super(e,t),this.isLineLoop=!0,this.type="LineLoop"}}class bM extends $s{constructor(e){super(),this.isPointsMaterial=!0,this.type="PointsMaterial",this.color=new St(16777215),this.map=null,this.alphaMap=null,this.size=1,this.sizeAttenuation=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.size=e.size,this.sizeAttenuation=e.sizeAttenuation,this.fog=e.fog,this}}const YC=new Jt,Fb=new wh,Ux=new bs,Bx=new J;class J4 extends jn{constructor(e=new mn,t=new bM){super(),this.isPoints=!0,this.type="Points",this.geometry=e,this.material=t,this.morphTargetDictionary=void 0,this.morphTargetInfluences=void 0,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}raycast(e,t){const n=this.geometry,s=this.matrixWorld,i=e.params.Points.threshold,o=n.drawRange;if(n.boundingSphere===null&&n.computeBoundingSphere(),Ux.copy(n.boundingSphere),Ux.applyMatrix4(s),Ux.radius+=i,e.ray.intersectsSphere(Ux)===!1)return;YC.copy(s).invert(),Fb.copy(e.ray).applyMatrix4(YC);const a=i/((this.scale.x+this.scale.y+this.scale.z)/3),c=a*a,d=n.index,m=n.attributes.position;if(d!==null){const v=Math.max(0,o.start),x=Math.min(d.count,o.start+o.count);for(let _=v,b=x;_<b;_++){const w=d.getX(_);Bx.fromBufferAttribute(m,w),KC(Bx,w,c,s,e,t,this)}}else{const v=Math.max(0,o.start),x=Math.min(m.count,o.start+o.count);for(let _=v,b=x;_<b;_++)Bx.fromBufferAttribute(m,_),KC(Bx,_,c,s,e,t,this)}}updateMorphTargets(){const t=this.geometry.morphAttributes,n=Object.keys(t);if(n.length>0){const s=t[n[0]];if(s!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let i=0,o=s.length;i<o;i++){const a=s[i].name||String(i);this.morphTargetInfluences.push(0),this.morphTargetDictionary[a]=i}}}}}function KC(r,e,t,n,s,i,o){const a=Fb.distanceSqToPoint(r);if(a<t){const c=new J;Fb.closestPointToPoint(r,c),c.applyMatrix4(n);const d=s.ray.origin.distanceTo(c);if(d<s.near||d>s.far)return;i.push({distance:d,distanceToRay:Math.sqrt(a),point:c,index:e,face:null,faceIndex:null,barycoord:null,object:o})}}class Z4 extends _r{constructor(e,t,n,s,i=Qr,o=Qr,a,c,d){super(e,t,n,s,i,o,a,c,d),this.isVideoTexture=!0,this.generateMipmaps=!1;const f=this;function m(){f.needsUpdate=!0,e.requestVideoFrameCallback(m)}"requestVideoFrameCallback"in e&&e.requestVideoFrameCallback(m)}clone(){return new this.constructor(this.image).copy(this)}update(){const e=this.image;"requestVideoFrameCallback"in e===!1&&e.readyState>=e.HAVE_CURRENT_DATA&&(this.needsUpdate=!0)}}class L$ extends Z4{constructor(e,t,n,s,i,o,a,c){super({},e,t,n,s,i,o,a,c),this.isVideoFrameTexture=!0}update(){}clone(){return new this.constructor().copy(this)}setFrame(e){this.image=e,this.needsUpdate=!0}}class O$ extends _r{constructor(e,t){super({width:e,height:t}),this.isFramebufferTexture=!0,this.magFilter=Ss,this.minFilter=Ss,this.generateMipmaps=!1,this.needsUpdate=!0}}class pw extends _r{constructor(e,t,n,s,i,o,a,c,d,f,m,v){super(null,o,a,c,d,f,s,i,m,v),this.isCompressedTexture=!0,this.image={width:t,height:n},this.mipmaps=e,this.flipY=!1,this.generateMipmaps=!1}}class j$ extends pw{constructor(e,t,n,s,i,o){super(e,t,n,i,o),this.isCompressedArrayTexture=!0,this.image.depth=s,this.wrapR=vo,this.layerUpdates=new Set}addLayerUpdate(e){this.layerUpdates.add(e)}clearLayerUpdates(){this.layerUpdates.clear()}}class F$ extends pw{constructor(e,t,n){super(void 0,e[0].width,e[0].height,t,n,ec),this.isCompressedCubeTexture=!0,this.isCubeTexture=!0,this.image=e}}class U$ extends _r{constructor(e,t,n,s,i,o,a,c,d){super(e,t,n,s,i,o,a,c,d),this.isCanvasTexture=!0,this.needsUpdate=!0}}class EM extends _r{constructor(e,t,n=tc,s,i,o,a=Ss,c=Ss,d,f=Wp,m=1){if(f!==Wp&&f!==$p)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");const v={width:e,height:t,depth:m};super(v,s,i,o,a,c,f,n,d),this.isDepthTexture=!0,this.flipY=!1,this.generateMipmaps=!1,this.compareFunction=null}copy(e){return super.copy(e),this.source=new au(Object.assign({},e.image)),this.compareFunction=e.compareFunction,this}toJSON(e){const t=super.toJSON(e);return this.compareFunction!==null&&(t.compareFunction=this.compareFunction),t}}class mw extends mn{constructor(e=1,t=1,n=4,s=8,i=1){super(),this.type="CapsuleGeometry",this.parameters={radius:e,height:t,capSegments:n,radialSegments:s,heightSegments:i},t=Math.max(0,t),n=Math.max(1,Math.floor(n)),s=Math.max(3,Math.floor(s)),i=Math.max(1,Math.floor(i));const o=[],a=[],c=[],d=[],f=t/2,m=Math.PI/2*e,v=t,x=2*m+v,_=n*2+i,b=s+1,w=new J,S=new J;for(let C=0;C<=_;C++){let T=0,A=0,k=0,j=0;if(C<=n){const O=C/n,I=O*Math.PI/2;A=-f-e*Math.cos(I),k=e*Math.sin(I),j=-e*Math.cos(I),T=O*m}else if(C<=n+i){const O=(C-n)/i;A=-f+O*t,k=e,j=0,T=m+O*v}else{const O=(C-n-i)/n,I=O*Math.PI/2;A=f+e*Math.sin(I),k=e*Math.cos(I),j=e*Math.sin(I),T=m+v+O*m}const D=Math.max(0,Math.min(1,T/x));let L=0;C===0?L=.5/s:C===_&&(L=-.5/s);for(let O=0;O<=s;O++){const I=O/s,B=I*Math.PI*2,W=Math.sin(B),K=Math.cos(B);S.x=-k*K,S.y=A,S.z=k*W,a.push(S.x,S.y,S.z),w.set(-k*K,j,k*W),w.normalize(),c.push(w.x,w.y,w.z),d.push(I+L,D)}if(C>0){const O=(C-1)*b;for(let I=0;I<s;I++){const B=O+I,W=O+I+1,K=C*b+I,ee=C*b+I+1;o.push(B,W,K),o.push(W,ee,K)}}}this.setIndex(o),this.setAttribute("position",new It(a,3)),this.setAttribute("normal",new It(c,3)),this.setAttribute("uv",new It(d,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new mw(e.radius,e.height,e.capSegments,e.radialSegments,e.heightSegments)}}class gw extends mn{constructor(e=1,t=32,n=0,s=Math.PI*2){super(),this.type="CircleGeometry",this.parameters={radius:e,segments:t,thetaStart:n,thetaLength:s},t=Math.max(3,t);const i=[],o=[],a=[],c=[],d=new J,f=new Ve;o.push(0,0,0),a.push(0,0,1),c.push(.5,.5);for(let m=0,v=3;m<=t;m++,v+=3){const x=n+m/t*s;d.x=e*Math.cos(x),d.y=e*Math.sin(x),o.push(d.x,d.y,d.z),a.push(0,0,1),f.x=(o[v]/e+1)/2,f.y=(o[v+1]/e+1)/2,c.push(f.x,f.y)}for(let m=1;m<=t;m++)i.push(m,m+1,0);this.setIndex(i),this.setAttribute("position",new It(o,3)),this.setAttribute("normal",new It(a,3)),this.setAttribute("uv",new It(c,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new gw(e.radius,e.segments,e.thetaStart,e.thetaLength)}}class Y0 extends mn{constructor(e=1,t=1,n=1,s=32,i=1,o=!1,a=0,c=Math.PI*2){super(),this.type="CylinderGeometry",this.parameters={radiusTop:e,radiusBottom:t,height:n,radialSegments:s,heightSegments:i,openEnded:o,thetaStart:a,thetaLength:c};const d=this;s=Math.floor(s),i=Math.floor(i);const f=[],m=[],v=[],x=[];let _=0;const b=[],w=n/2;let S=0;C(),o===!1&&(e>0&&T(!0),t>0&&T(!1)),this.setIndex(f),this.setAttribute("position",new It(m,3)),this.setAttribute("normal",new It(v,3)),this.setAttribute("uv",new It(x,2));function C(){const A=new J,k=new J;let j=0;const D=(t-e)/n;for(let L=0;L<=i;L++){const O=[],I=L/i,B=I*(t-e)+e;for(let W=0;W<=s;W++){const K=W/s,ee=K*c+a,oe=Math.sin(ee),ne=Math.cos(ee);k.x=B*oe,k.y=-I*n+w,k.z=B*ne,m.push(k.x,k.y,k.z),A.set(oe,D,ne).normalize(),v.push(A.x,A.y,A.z),x.push(K,1-I),O.push(_++)}b.push(O)}for(let L=0;L<s;L++)for(let O=0;O<i;O++){const I=b[O][L],B=b[O+1][L],W=b[O+1][L+1],K=b[O][L+1];(e>0||O!==0)&&(f.push(I,B,K),j+=3),(t>0||O!==i-1)&&(f.push(B,W,K),j+=3)}d.addGroup(S,j,0),S+=j}function T(A){const k=_,j=new Ve,D=new J;let L=0;const O=A===!0?e:t,I=A===!0?1:-1;for(let W=1;W<=s;W++)m.push(0,w*I,0),v.push(0,I,0),x.push(.5,.5),_++;const B=_;for(let W=0;W<=s;W++){const ee=W/s*c+a,oe=Math.cos(ee),ne=Math.sin(ee);D.x=O*ne,D.y=w*I,D.z=O*oe,m.push(D.x,D.y,D.z),v.push(0,I,0),j.x=oe*.5+.5,j.y=ne*.5*I+.5,x.push(j.x,j.y),_++}for(let W=0;W<s;W++){const K=k+W,ee=B+W;A===!0?f.push(ee,ee+1,K):f.push(ee+1,ee,K),L+=3}d.addGroup(S,L,A===!0?1:2),S+=L}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new Y0(e.radiusTop,e.radiusBottom,e.height,e.radialSegments,e.heightSegments,e.openEnded,e.thetaStart,e.thetaLength)}}class K0 extends Y0{constructor(e=1,t=1,n=32,s=1,i=!1,o=0,a=Math.PI*2){super(0,e,t,n,s,i,o,a),this.type="ConeGeometry",this.parameters={radius:e,height:t,radialSegments:n,heightSegments:s,openEnded:i,thetaStart:o,thetaLength:a}}static fromJSON(e){return new K0(e.radius,e.height,e.radialSegments,e.heightSegments,e.openEnded,e.thetaStart,e.thetaLength)}}class Cu extends mn{constructor(e=[],t=[],n=1,s=0){super(),this.type="PolyhedronGeometry",this.parameters={vertices:e,indices:t,radius:n,detail:s};const i=[],o=[];a(s),d(n),f(),this.setAttribute("position",new It(i,3)),this.setAttribute("normal",new It(i.slice(),3)),this.setAttribute("uv",new It(o,2)),s===0?this.computeVertexNormals():this.normalizeNormals();function a(C){const T=new J,A=new J,k=new J;for(let j=0;j<t.length;j+=3)x(t[j+0],T),x(t[j+1],A),x(t[j+2],k),c(T,A,k,C)}function c(C,T,A,k){const j=k+1,D=[];for(let L=0;L<=j;L++){D[L]=[];const O=C.clone().lerp(A,L/j),I=T.clone().lerp(A,L/j),B=j-L;for(let W=0;W<=B;W++)W===0&&L===j?D[L][W]=O:D[L][W]=O.clone().lerp(I,W/B)}for(let L=0;L<j;L++)for(let O=0;O<2*(j-L)-1;O++){const I=Math.floor(O/2);O%2===0?(v(D[L][I+1]),v(D[L+1][I]),v(D[L][I])):(v(D[L][I+1]),v(D[L+1][I+1]),v(D[L+1][I]))}}function d(C){const T=new J;for(let A=0;A<i.length;A+=3)T.x=i[A+0],T.y=i[A+1],T.z=i[A+2],T.normalize().multiplyScalar(C),i[A+0]=T.x,i[A+1]=T.y,i[A+2]=T.z}function f(){const C=new J;for(let T=0;T<i.length;T+=3){C.x=i[T+0],C.y=i[T+1],C.z=i[T+2];const A=w(C)/2/Math.PI+.5,k=S(C)/Math.PI+.5;o.push(A,1-k)}_(),m()}function m(){for(let C=0;C<o.length;C+=6){const T=o[C+0],A=o[C+2],k=o[C+4],j=Math.max(T,A,k),D=Math.min(T,A,k);j>.9&&D<.1&&(T<.2&&(o[C+0]+=1),A<.2&&(o[C+2]+=1),k<.2&&(o[C+4]+=1))}}function v(C){i.push(C.x,C.y,C.z)}function x(C,T){const A=C*3;T.x=e[A+0],T.y=e[A+1],T.z=e[A+2]}function _(){const C=new J,T=new J,A=new J,k=new J,j=new Ve,D=new Ve,L=new Ve;for(let O=0,I=0;O<i.length;O+=9,I+=6){C.set(i[O+0],i[O+1],i[O+2]),T.set(i[O+3],i[O+4],i[O+5]),A.set(i[O+6],i[O+7],i[O+8]),j.set(o[I+0],o[I+1]),D.set(o[I+2],o[I+3]),L.set(o[I+4],o[I+5]),k.copy(C).add(T).add(A).divideScalar(3);const B=w(k);b(j,I+0,C,B),b(D,I+2,T,B),b(L,I+4,A,B)}}function b(C,T,A,k){k<0&&C.x===1&&(o[T]=C.x-1),A.x===0&&A.z===0&&(o[T]=k/2/Math.PI+.5)}function w(C){return Math.atan2(C.z,-C.x)}function S(C){return Math.atan2(-C.y,Math.sqrt(C.x*C.x+C.z*C.z))}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new Cu(e.vertices,e.indices,e.radius,e.details)}}class vw extends Cu{constructor(e=1,t=0){const n=(1+Math.sqrt(5))/2,s=1/n,i=[-1,-1,-1,-1,-1,1,-1,1,-1,-1,1,1,1,-1,-1,1,-1,1,1,1,-1,1,1,1,0,-s,-n,0,-s,n,0,s,-n,0,s,n,-s,-n,0,-s,n,0,s,-n,0,s,n,0,-n,0,-s,n,0,-s,-n,0,s,n,0,s],o=[3,11,7,3,7,15,3,15,13,7,19,17,7,17,6,7,6,15,17,4,8,17,8,10,17,10,6,8,0,16,8,16,2,8,2,10,0,12,1,0,1,18,0,18,16,6,10,2,6,2,13,6,13,15,2,16,18,2,18,3,2,3,13,18,1,9,18,9,11,18,11,3,4,14,12,4,12,0,4,0,8,11,9,5,11,5,19,11,19,7,19,5,14,19,14,4,19,4,17,1,12,14,1,14,5,1,5,9];super(i,o,e,t),this.type="DodecahedronGeometry",this.parameters={radius:e,detail:t}}static fromJSON(e){return new vw(e.radius,e.detail)}}const zx=new J,Vx=new J,uS=new J,Hx=new Pi;class eD extends mn{constructor(e=null,t=1){if(super(),this.type="EdgesGeometry",this.parameters={geometry:e,thresholdAngle:t},e!==null){const s=Math.pow(10,4),i=Math.cos(Jd*t),o=e.getIndex(),a=e.getAttribute("position"),c=o?o.count:a.count,d=[0,0,0],f=["a","b","c"],m=new Array(3),v={},x=[];for(let _=0;_<c;_+=3){o?(d[0]=o.getX(_),d[1]=o.getX(_+1),d[2]=o.getX(_+2)):(d[0]=_,d[1]=_+1,d[2]=_+2);const{a:b,b:w,c:S}=Hx;if(b.fromBufferAttribute(a,d[0]),w.fromBufferAttribute(a,d[1]),S.fromBufferAttribute(a,d[2]),Hx.getNormal(uS),m[0]=`${Math.round(b.x*s)},${Math.round(b.y*s)},${Math.round(b.z*s)}`,m[1]=`${Math.round(w.x*s)},${Math.round(w.y*s)},${Math.round(w.z*s)}`,m[2]=`${Math.round(S.x*s)},${Math.round(S.y*s)},${Math.round(S.z*s)}`,!(m[0]===m[1]||m[1]===m[2]||m[2]===m[0]))for(let C=0;C<3;C++){const T=(C+1)%3,A=m[C],k=m[T],j=Hx[f[C]],D=Hx[f[T]],L=`${A}_${k}`,O=`${k}_${A}`;O in v&&v[O]?(uS.dot(v[O].normal)<=i&&(x.push(j.x,j.y,j.z),x.push(D.x,D.y,D.z)),v[O]=null):L in v||(v[L]={index0:d[C],index1:d[T],normal:uS.clone()})}}for(const _ in v)if(v[_]){const{index0:b,index1:w}=v[_];zx.fromBufferAttribute(a,b),Vx.fromBufferAttribute(a,w),x.push(zx.x,zx.y,zx.z),x.push(Vx.x,Vx.y,Vx.z)}this.setAttribute("position",new It(x,3))}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}}class da{constructor(){this.type="Curve",this.arcLengthDivisions=200,this.needsUpdate=!1,this.cacheArcLengths=null}getPoint(){console.warn("THREE.Curve: .getPoint() not implemented.")}getPointAt(e,t){const n=this.getUtoTmapping(e);return this.getPoint(n,t)}getPoints(e=5){const t=[];for(let n=0;n<=e;n++)t.push(this.getPoint(n/e));return t}getSpacedPoints(e=5){const t=[];for(let n=0;n<=e;n++)t.push(this.getPointAt(n/e));return t}getLength(){const e=this.getLengths();return e[e.length-1]}getLengths(e=this.arcLengthDivisions){if(this.cacheArcLengths&&this.cacheArcLengths.length===e+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;const t=[];let n,s=this.getPoint(0),i=0;t.push(0);for(let o=1;o<=e;o++)n=this.getPoint(o/e),i+=n.distanceTo(s),t.push(i),s=n;return this.cacheArcLengths=t,t}updateArcLengths(){this.needsUpdate=!0,this.getLengths()}getUtoTmapping(e,t=null){const n=this.getLengths();let s=0;const i=n.length;let o;t?o=t:o=e*n[i-1];let a=0,c=i-1,d;for(;a<=c;)if(s=Math.floor(a+(c-a)/2),d=n[s]-o,d<0)a=s+1;else if(d>0)c=s-1;else{c=s;break}if(s=c,n[s]===o)return s/(i-1);const f=n[s],v=n[s+1]-f,x=(o-f)/v;return(s+x)/(i-1)}getTangent(e,t){let s=e-1e-4,i=e+1e-4;s<0&&(s=0),i>1&&(i=1);const o=this.getPoint(s),a=this.getPoint(i),c=t||(o.isVector2?new Ve:new J);return c.copy(a).sub(o).normalize(),c}getTangentAt(e,t){const n=this.getUtoTmapping(e);return this.getTangent(n,t)}computeFrenetFrames(e,t=!1){const n=new J,s=[],i=[],o=[],a=new J,c=new Jt;for(let x=0;x<=e;x++){const _=x/e;s[x]=this.getTangentAt(_,new J)}i[0]=new J,o[0]=new J;let d=Number.MAX_VALUE;const f=Math.abs(s[0].x),m=Math.abs(s[0].y),v=Math.abs(s[0].z);f<=d&&(d=f,n.set(1,0,0)),m<=d&&(d=m,n.set(0,1,0)),v<=d&&n.set(0,0,1),a.crossVectors(s[0],n).normalize(),i[0].crossVectors(s[0],a),o[0].crossVectors(s[0],i[0]);for(let x=1;x<=e;x++){if(i[x]=i[x-1].clone(),o[x]=o[x-1].clone(),a.crossVectors(s[x-1],s[x]),a.length()>Number.EPSILON){a.normalize();const _=Math.acos(an(s[x-1].dot(s[x]),-1,1));i[x].applyMatrix4(c.makeRotationAxis(a,_))}o[x].crossVectors(s[x],i[x])}if(t===!0){let x=Math.acos(an(i[0].dot(i[e]),-1,1));x/=e,s[0].dot(a.crossVectors(i[0],i[e]))>0&&(x=-x);for(let _=1;_<=e;_++)i[_].applyMatrix4(c.makeRotationAxis(s[_],x*_)),o[_].crossVectors(s[_],i[_])}return{tangents:s,normals:i,binormals:o}}clone(){return new this.constructor().copy(this)}copy(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}toJSON(){const e={metadata:{version:4.7,type:"Curve",generator:"Curve.toJSON"}};return e.arcLengthDivisions=this.arcLengthDivisions,e.type=this.type,e}fromJSON(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}}class xw extends da{constructor(e=0,t=0,n=1,s=1,i=0,o=Math.PI*2,a=!1,c=0){super(),this.isEllipseCurve=!0,this.type="EllipseCurve",this.aX=e,this.aY=t,this.xRadius=n,this.yRadius=s,this.aStartAngle=i,this.aEndAngle=o,this.aClockwise=a,this.aRotation=c}getPoint(e,t=new Ve){const n=t,s=Math.PI*2;let i=this.aEndAngle-this.aStartAngle;const o=Math.abs(i)<Number.EPSILON;for(;i<0;)i+=s;for(;i>s;)i-=s;i<Number.EPSILON&&(o?i=0:i=s),this.aClockwise===!0&&!o&&(i===s?i=-s:i=i-s);const a=this.aStartAngle+e*i;let c=this.aX+this.xRadius*Math.cos(a),d=this.aY+this.yRadius*Math.sin(a);if(this.aRotation!==0){const f=Math.cos(this.aRotation),m=Math.sin(this.aRotation),v=c-this.aX,x=d-this.aY;c=v*f-x*m+this.aX,d=v*m+x*f+this.aY}return n.set(c,d)}copy(e){return super.copy(e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}toJSON(){const e=super.toJSON();return e.aX=this.aX,e.aY=this.aY,e.xRadius=this.xRadius,e.yRadius=this.yRadius,e.aStartAngle=this.aStartAngle,e.aEndAngle=this.aEndAngle,e.aClockwise=this.aClockwise,e.aRotation=this.aRotation,e}fromJSON(e){return super.fromJSON(e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}}class tD extends xw{constructor(e,t,n,s,i,o){super(e,t,n,n,s,i,o),this.isArcCurve=!0,this.type="ArcCurve"}}function MM(){let r=0,e=0,t=0,n=0;function s(i,o,a,c){r=i,e=a,t=-3*i+3*o-2*a-c,n=2*i-2*o+a+c}return{initCatmullRom:function(i,o,a,c,d){s(o,a,d*(a-i),d*(c-o))},initNonuniformCatmullRom:function(i,o,a,c,d,f,m){let v=(o-i)/d-(a-i)/(d+f)+(a-o)/f,x=(a-o)/f-(c-o)/(f+m)+(c-a)/m;v*=f,x*=f,s(o,a,v,x)},calc:function(i){const o=i*i,a=o*i;return r+e*i+t*o+n*a}}}const Gx=new J,dS=new MM,hS=new MM,fS=new MM;class nD extends da{constructor(e=[],t=!1,n="centripetal",s=.5){super(),this.isCatmullRomCurve3=!0,this.type="CatmullRomCurve3",this.points=e,this.closed=t,this.curveType=n,this.tension=s}getPoint(e,t=new J){const n=t,s=this.points,i=s.length,o=(i-(this.closed?0:1))*e;let a=Math.floor(o),c=o-a;this.closed?a+=a>0?0:(Math.floor(Math.abs(a)/i)+1)*i:c===0&&a===i-1&&(a=i-2,c=1);let d,f;this.closed||a>0?d=s[(a-1)%i]:(Gx.subVectors(s[0],s[1]).add(s[0]),d=Gx);const m=s[a%i],v=s[(a+1)%i];if(this.closed||a+2<i?f=s[(a+2)%i]:(Gx.subVectors(s[i-1],s[i-2]).add(s[i-1]),f=Gx),this.curveType==="centripetal"||this.curveType==="chordal"){const x=this.curveType==="chordal"?.5:.25;let _=Math.pow(d.distanceToSquared(m),x),b=Math.pow(m.distanceToSquared(v),x),w=Math.pow(v.distanceToSquared(f),x);b<1e-4&&(b=1),_<1e-4&&(_=b),w<1e-4&&(w=b),dS.initNonuniformCatmullRom(d.x,m.x,v.x,f.x,_,b,w),hS.initNonuniformCatmullRom(d.y,m.y,v.y,f.y,_,b,w),fS.initNonuniformCatmullRom(d.z,m.z,v.z,f.z,_,b,w)}else this.curveType==="catmullrom"&&(dS.initCatmullRom(d.x,m.x,v.x,f.x,this.tension),hS.initCatmullRom(d.y,m.y,v.y,f.y,this.tension),fS.initCatmullRom(d.z,m.z,v.z,f.z,this.tension));return n.set(dS.calc(c),hS.calc(c),fS.calc(c)),n}copy(e){super.copy(e),this.points=[];for(let t=0,n=e.points.length;t<n;t++){const s=e.points[t];this.points.push(s.clone())}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}toJSON(){const e=super.toJSON();e.points=[];for(let t=0,n=this.points.length;t<n;t++){const s=this.points[t];e.points.push(s.toArray())}return e.closed=this.closed,e.curveType=this.curveType,e.tension=this.tension,e}fromJSON(e){super.fromJSON(e),this.points=[];for(let t=0,n=e.points.length;t<n;t++){const s=e.points[t];this.points.push(new J().fromArray(s))}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}}function QC(r,e,t,n,s){const i=(n-e)*.5,o=(s-t)*.5,a=r*r,c=r*a;return(2*t-2*n+i+o)*c+(-3*t+3*n-2*i-o)*a+i*r+t}function B$(r,e){const t=1-r;return t*t*e}function z$(r,e){return 2*(1-r)*r*e}function V$(r,e){return r*r*e}function Zg(r,e,t,n){return B$(r,e)+z$(r,t)+V$(r,n)}function H$(r,e){const t=1-r;return t*t*t*e}function G$(r,e){const t=1-r;return 3*t*t*r*e}function W$(r,e){return 3*(1-r)*r*r*e}function $$(r,e){return r*r*r*e}function e0(r,e,t,n,s){return H$(r,e)+G$(r,t)+W$(r,n)+$$(r,s)}class TM extends da{constructor(e=new Ve,t=new Ve,n=new Ve,s=new Ve){super(),this.isCubicBezierCurve=!0,this.type="CubicBezierCurve",this.v0=e,this.v1=t,this.v2=n,this.v3=s}getPoint(e,t=new Ve){const n=t,s=this.v0,i=this.v1,o=this.v2,a=this.v3;return n.set(e0(e,s.x,i.x,o.x,a.x),e0(e,s.y,i.y,o.y,a.y)),n}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}}class rD extends da{constructor(e=new J,t=new J,n=new J,s=new J){super(),this.isCubicBezierCurve3=!0,this.type="CubicBezierCurve3",this.v0=e,this.v1=t,this.v2=n,this.v3=s}getPoint(e,t=new J){const n=t,s=this.v0,i=this.v1,o=this.v2,a=this.v3;return n.set(e0(e,s.x,i.x,o.x,a.x),e0(e,s.y,i.y,o.y,a.y),e0(e,s.z,i.z,o.z,a.z)),n}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}}class CM extends da{constructor(e=new Ve,t=new Ve){super(),this.isLineCurve=!0,this.type="LineCurve",this.v1=e,this.v2=t}getPoint(e,t=new Ve){const n=t;return e===1?n.copy(this.v2):(n.copy(this.v2).sub(this.v1),n.multiplyScalar(e).add(this.v1)),n}getPointAt(e,t){return this.getPoint(e,t)}getTangent(e,t=new Ve){return t.subVectors(this.v2,this.v1).normalize()}getTangentAt(e,t){return this.getTangent(e,t)}copy(e){return super.copy(e),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class sD extends da{constructor(e=new J,t=new J){super(),this.isLineCurve3=!0,this.type="LineCurve3",this.v1=e,this.v2=t}getPoint(e,t=new J){const n=t;return e===1?n.copy(this.v2):(n.copy(this.v2).sub(this.v1),n.multiplyScalar(e).add(this.v1)),n}getPointAt(e,t){return this.getPoint(e,t)}getTangent(e,t=new J){return t.subVectors(this.v2,this.v1).normalize()}getTangentAt(e,t){return this.getTangent(e,t)}copy(e){return super.copy(e),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class AM extends da{constructor(e=new Ve,t=new Ve,n=new Ve){super(),this.isQuadraticBezierCurve=!0,this.type="QuadraticBezierCurve",this.v0=e,this.v1=t,this.v2=n}getPoint(e,t=new Ve){const n=t,s=this.v0,i=this.v1,o=this.v2;return n.set(Zg(e,s.x,i.x,o.x),Zg(e,s.y,i.y,o.y)),n}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class RM extends da{constructor(e=new J,t=new J,n=new J){super(),this.isQuadraticBezierCurve3=!0,this.type="QuadraticBezierCurve3",this.v0=e,this.v1=t,this.v2=n}getPoint(e,t=new J){const n=t,s=this.v0,i=this.v1,o=this.v2;return n.set(Zg(e,s.x,i.x,o.x),Zg(e,s.y,i.y,o.y),Zg(e,s.z,i.z,o.z)),n}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class NM extends da{constructor(e=[]){super(),this.isSplineCurve=!0,this.type="SplineCurve",this.points=e}getPoint(e,t=new Ve){const n=t,s=this.points,i=(s.length-1)*e,o=Math.floor(i),a=i-o,c=s[o===0?o:o-1],d=s[o],f=s[o>s.length-2?s.length-1:o+1],m=s[o>s.length-3?s.length-1:o+2];return n.set(QC(a,c.x,d.x,f.x,m.x),QC(a,c.y,d.y,f.y,m.y)),n}copy(e){super.copy(e),this.points=[];for(let t=0,n=e.points.length;t<n;t++){const s=e.points[t];this.points.push(s.clone())}return this}toJSON(){const e=super.toJSON();e.points=[];for(let t=0,n=this.points.length;t<n;t++){const s=this.points[t];e.points.push(s.toArray())}return e}fromJSON(e){super.fromJSON(e),this.points=[];for(let t=0,n=e.points.length;t<n;t++){const s=e.points[t];this.points.push(new Ve().fromArray(s))}return this}}var g_=Object.freeze({__proto__:null,ArcCurve:tD,CatmullRomCurve3:nD,CubicBezierCurve:TM,CubicBezierCurve3:rD,EllipseCurve:xw,LineCurve:CM,LineCurve3:sD,QuadraticBezierCurve:AM,QuadraticBezierCurve3:RM,SplineCurve:NM});class iD extends da{constructor(){super(),this.type="CurvePath",this.curves=[],this.autoClose=!1}add(e){this.curves.push(e)}closePath(){const e=this.curves[0].getPoint(0),t=this.curves[this.curves.length-1].getPoint(1);if(!e.equals(t)){const n=e.isVector2===!0?"LineCurve":"LineCurve3";this.curves.push(new g_[n](t,e))}return this}getPoint(e,t){const n=e*this.getLength(),s=this.getCurveLengths();let i=0;for(;i<s.length;){if(s[i]>=n){const o=s[i]-n,a=this.curves[i],c=a.getLength(),d=c===0?0:1-o/c;return a.getPointAt(d,t)}i++}return null}getLength(){const e=this.getCurveLengths();return e[e.length-1]}updateArcLengths(){this.needsUpdate=!0,this.cacheLengths=null,this.getCurveLengths()}getCurveLengths(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;const e=[];let t=0;for(let n=0,s=this.curves.length;n<s;n++)t+=this.curves[n].getLength(),e.push(t);return this.cacheLengths=e,e}getSpacedPoints(e=40){const t=[];for(let n=0;n<=e;n++)t.push(this.getPoint(n/e));return this.autoClose&&t.push(t[0]),t}getPoints(e=12){const t=[];let n;for(let s=0,i=this.curves;s<i.length;s++){const o=i[s],a=o.isEllipseCurve?e*2:o.isLineCurve||o.isLineCurve3?1:o.isSplineCurve?e*o.points.length:e,c=o.getPoints(a);for(let d=0;d<c.length;d++){const f=c[d];n&&n.equals(f)||(t.push(f),n=f)}}return this.autoClose&&t.length>1&&!t[t.length-1].equals(t[0])&&t.push(t[0]),t}copy(e){super.copy(e),this.curves=[];for(let t=0,n=e.curves.length;t<n;t++){const s=e.curves[t];this.curves.push(s.clone())}return this.autoClose=e.autoClose,this}toJSON(){const e=super.toJSON();e.autoClose=this.autoClose,e.curves=[];for(let t=0,n=this.curves.length;t<n;t++){const s=this.curves[t];e.curves.push(s.toJSON())}return e}fromJSON(e){super.fromJSON(e),this.autoClose=e.autoClose,this.curves=[];for(let t=0,n=e.curves.length;t<n;t++){const s=e.curves[t];this.curves.push(new g_[s.type]().fromJSON(s))}return this}}class v_ extends iD{constructor(e){super(),this.type="Path",this.currentPoint=new Ve,e&&this.setFromPoints(e)}setFromPoints(e){this.moveTo(e[0].x,e[0].y);for(let t=1,n=e.length;t<n;t++)this.lineTo(e[t].x,e[t].y);return this}moveTo(e,t){return this.currentPoint.set(e,t),this}lineTo(e,t){const n=new CM(this.currentPoint.clone(),new Ve(e,t));return this.curves.push(n),this.currentPoint.set(e,t),this}quadraticCurveTo(e,t,n,s){const i=new AM(this.currentPoint.clone(),new Ve(e,t),new Ve(n,s));return this.curves.push(i),this.currentPoint.set(n,s),this}bezierCurveTo(e,t,n,s,i,o){const a=new TM(this.currentPoint.clone(),new Ve(e,t),new Ve(n,s),new Ve(i,o));return this.curves.push(a),this.currentPoint.set(i,o),this}splineThru(e){const t=[this.currentPoint.clone()].concat(e),n=new NM(t);return this.curves.push(n),this.currentPoint.copy(e[e.length-1]),this}arc(e,t,n,s,i,o){const a=this.currentPoint.x,c=this.currentPoint.y;return this.absarc(e+a,t+c,n,s,i,o),this}absarc(e,t,n,s,i,o){return this.absellipse(e,t,n,n,s,i,o),this}ellipse(e,t,n,s,i,o,a,c){const d=this.currentPoint.x,f=this.currentPoint.y;return this.absellipse(e+d,t+f,n,s,i,o,a,c),this}absellipse(e,t,n,s,i,o,a,c){const d=new xw(e,t,n,s,i,o,a,c);if(this.curves.length>0){const m=d.getPoint(0);m.equals(this.currentPoint)||this.lineTo(m.x,m.y)}this.curves.push(d);const f=d.getPoint(1);return this.currentPoint.copy(f),this}copy(e){return super.copy(e),this.currentPoint.copy(e.currentPoint),this}toJSON(){const e=super.toJSON();return e.currentPoint=this.currentPoint.toArray(),e}fromJSON(e){return super.fromJSON(e),this.currentPoint.fromArray(e.currentPoint),this}}class eh extends v_{constructor(e){super(e),this.uuid=Zi(),this.type="Shape",this.holes=[]}getPointsHoles(e){const t=[];for(let n=0,s=this.holes.length;n<s;n++)t[n]=this.holes[n].getPoints(e);return t}extractPoints(e){return{shape:this.getPoints(e),holes:this.getPointsHoles(e)}}copy(e){super.copy(e),this.holes=[];for(let t=0,n=e.holes.length;t<n;t++){const s=e.holes[t];this.holes.push(s.clone())}return this}toJSON(){const e=super.toJSON();e.uuid=this.uuid,e.holes=[];for(let t=0,n=this.holes.length;t<n;t++){const s=this.holes[t];e.holes.push(s.toJSON())}return e}fromJSON(e){super.fromJSON(e),this.uuid=e.uuid,this.holes=[];for(let t=0,n=e.holes.length;t<n;t++){const s=e.holes[t];this.holes.push(new v_().fromJSON(s))}return this}}function q$(r,e,t=2){const n=e&&e.length,s=n?e[0]*t:r.length;let i=oD(r,0,s,t,!0);const o=[];if(!i||i.next===i.prev)return o;let a,c,d;if(n&&(i=J$(r,e,i,t)),r.length>80*t){a=1/0,c=1/0;let f=-1/0,m=-1/0;for(let v=t;v<s;v+=t){const x=r[v],_=r[v+1];x<a&&(a=x),_<c&&(c=_),x>f&&(f=x),_>m&&(m=_)}d=Math.max(f-a,m-c),d=d!==0?32767/d:0}return b0(i,o,t,a,c,d,0),o}function oD(r,e,t,n,s){let i;if(s===cq(r,e,t,n)>0)for(let o=e;o<t;o+=n)i=JC(o/n|0,r[o],r[o+1],i);else for(let o=t-n;o>=e;o-=n)i=JC(o/n|0,r[o],r[o+1],i);return i&&Kp(i,i.next)&&(M0(i),i=i.next),i}function ph(r,e){if(!r)return r;e||(e=r);let t=r,n;do if(n=!1,!t.steiner&&(Kp(t,t.next)||fr(t.prev,t,t.next)===0)){if(M0(t),t=e=t.prev,t===t.next)break;n=!0}else t=t.next;while(n||t!==e);return e}function b0(r,e,t,n,s,i,o){if(!r)return;!o&&i&&rq(r,n,s,i);let a=r;for(;r.prev!==r.next;){const c=r.prev,d=r.next;if(i?Y$(r,n,s,i):X$(r)){e.push(c.i,r.i,d.i),M0(r),r=d.next,a=d.next;continue}if(r=d,r===a){o?o===1?(r=K$(ph(r),e),b0(r,e,t,n,s,i,2)):o===2&&Q$(r,e,t,n,s,i):b0(ph(r),e,t,n,s,i,1);break}}}function X$(r){const e=r.prev,t=r,n=r.next;if(fr(e,t,n)>=0)return!1;const s=e.x,i=t.x,o=n.x,a=e.y,c=t.y,d=n.y,f=Math.min(s,i,o),m=Math.min(a,c,d),v=Math.max(s,i,o),x=Math.max(a,c,d);let _=n.next;for(;_!==e;){if(_.x>=f&&_.x<=v&&_.y>=m&&_.y<=x&&jg(s,a,i,c,o,d,_.x,_.y)&&fr(_.prev,_,_.next)>=0)return!1;_=_.next}return!0}function Y$(r,e,t,n){const s=r.prev,i=r,o=r.next;if(fr(s,i,o)>=0)return!1;const a=s.x,c=i.x,d=o.x,f=s.y,m=i.y,v=o.y,x=Math.min(a,c,d),_=Math.min(f,m,v),b=Math.max(a,c,d),w=Math.max(f,m,v),S=Ub(x,_,e,t,n),C=Ub(b,w,e,t,n);let T=r.prevZ,A=r.nextZ;for(;T&&T.z>=S&&A&&A.z<=C;){if(T.x>=x&&T.x<=b&&T.y>=_&&T.y<=w&&T!==s&&T!==o&&jg(a,f,c,m,d,v,T.x,T.y)&&fr(T.prev,T,T.next)>=0||(T=T.prevZ,A.x>=x&&A.x<=b&&A.y>=_&&A.y<=w&&A!==s&&A!==o&&jg(a,f,c,m,d,v,A.x,A.y)&&fr(A.prev,A,A.next)>=0))return!1;A=A.nextZ}for(;T&&T.z>=S;){if(T.x>=x&&T.x<=b&&T.y>=_&&T.y<=w&&T!==s&&T!==o&&jg(a,f,c,m,d,v,T.x,T.y)&&fr(T.prev,T,T.next)>=0)return!1;T=T.prevZ}for(;A&&A.z<=C;){if(A.x>=x&&A.x<=b&&A.y>=_&&A.y<=w&&A!==s&&A!==o&&jg(a,f,c,m,d,v,A.x,A.y)&&fr(A.prev,A,A.next)>=0)return!1;A=A.nextZ}return!0}function K$(r,e){let t=r;do{const n=t.prev,s=t.next.next;!Kp(n,s)&&lD(n,t,t.next,s)&&E0(n,s)&&E0(s,n)&&(e.push(n.i,t.i,s.i),M0(t),M0(t.next),t=r=s),t=t.next}while(t!==r);return ph(t)}function Q$(r,e,t,n,s,i){let o=r;do{let a=o.next.next;for(;a!==o.prev;){if(o.i!==a.i&&oq(o,a)){let c=cD(o,a);o=ph(o,o.next),c=ph(c,c.next),b0(o,e,t,n,s,i,0),b0(c,e,t,n,s,i,0);return}a=a.next}o=o.next}while(o!==r)}function J$(r,e,t,n){const s=[];for(let i=0,o=e.length;i<o;i++){const a=e[i]*n,c=i<o-1?e[i+1]*n:r.length,d=oD(r,a,c,n,!1);d===d.next&&(d.steiner=!0),s.push(iq(d))}s.sort(Z$);for(let i=0;i<s.length;i++)t=eq(s[i],t);return t}function Z$(r,e){let t=r.x-e.x;if(t===0&&(t=r.y-e.y,t===0)){const n=(r.next.y-r.y)/(r.next.x-r.x),s=(e.next.y-e.y)/(e.next.x-e.x);t=n-s}return t}function eq(r,e){const t=tq(r,e);if(!t)return e;const n=cD(t,r);return ph(n,n.next),ph(t,t.next)}function tq(r,e){let t=e;const n=r.x,s=r.y;let i=-1/0,o;if(Kp(r,t))return t;do{if(Kp(r,t.next))return t.next;if(s<=t.y&&s>=t.next.y&&t.next.y!==t.y){const m=t.x+(s-t.y)*(t.next.x-t.x)/(t.next.y-t.y);if(m<=n&&m>i&&(i=m,o=t.x<t.next.x?t:t.next,m===n))return o}t=t.next}while(t!==e);if(!o)return null;const a=o,c=o.x,d=o.y;let f=1/0;t=o;do{if(n>=t.x&&t.x>=c&&n!==t.x&&aD(s<d?n:i,s,c,d,s<d?i:n,s,t.x,t.y)){const m=Math.abs(s-t.y)/(n-t.x);E0(t,r)&&(m<f||m===f&&(t.x>o.x||t.x===o.x&&nq(o,t)))&&(o=t,f=m)}t=t.next}while(t!==a);return o}function nq(r,e){return fr(r.prev,r,e.prev)<0&&fr(e.next,r,r.next)<0}function rq(r,e,t,n){let s=r;do s.z===0&&(s.z=Ub(s.x,s.y,e,t,n)),s.prevZ=s.prev,s.nextZ=s.next,s=s.next;while(s!==r);s.prevZ.nextZ=null,s.prevZ=null,sq(s)}function sq(r){let e,t=1;do{let n=r,s;r=null;let i=null;for(e=0;n;){e++;let o=n,a=0;for(let d=0;d<t&&(a++,o=o.nextZ,!!o);d++);let c=t;for(;a>0||c>0&&o;)a!==0&&(c===0||!o||n.z<=o.z)?(s=n,n=n.nextZ,a--):(s=o,o=o.nextZ,c--),i?i.nextZ=s:r=s,s.prevZ=i,i=s;n=o}i.nextZ=null,t*=2}while(e>1);return r}function Ub(r,e,t,n,s){return r=(r-t)*s|0,e=(e-n)*s|0,r=(r|r<<8)&16711935,r=(r|r<<4)&252645135,r=(r|r<<2)&858993459,r=(r|r<<1)&1431655765,e=(e|e<<8)&16711935,e=(e|e<<4)&252645135,e=(e|e<<2)&858993459,e=(e|e<<1)&1431655765,r|e<<1}function iq(r){let e=r,t=r;do(e.x<t.x||e.x===t.x&&e.y<t.y)&&(t=e),e=e.next;while(e!==r);return t}function aD(r,e,t,n,s,i,o,a){return(s-o)*(e-a)>=(r-o)*(i-a)&&(r-o)*(n-a)>=(t-o)*(e-a)&&(t-o)*(i-a)>=(s-o)*(n-a)}function jg(r,e,t,n,s,i,o,a){return!(r===o&&e===a)&&aD(r,e,t,n,s,i,o,a)}function oq(r,e){return r.next.i!==e.i&&r.prev.i!==e.i&&!aq(r,e)&&(E0(r,e)&&E0(e,r)&&lq(r,e)&&(fr(r.prev,r,e.prev)||fr(r,e.prev,e))||Kp(r,e)&&fr(r.prev,r,r.next)>0&&fr(e.prev,e,e.next)>0)}function fr(r,e,t){return(e.y-r.y)*(t.x-e.x)-(e.x-r.x)*(t.y-e.y)}function Kp(r,e){return r.x===e.x&&r.y===e.y}function lD(r,e,t,n){const s=$x(fr(r,e,t)),i=$x(fr(r,e,n)),o=$x(fr(t,n,r)),a=$x(fr(t,n,e));return!!(s!==i&&o!==a||s===0&&Wx(r,t,e)||i===0&&Wx(r,n,e)||o===0&&Wx(t,r,n)||a===0&&Wx(t,e,n))}function Wx(r,e,t){return e.x<=Math.max(r.x,t.x)&&e.x>=Math.min(r.x,t.x)&&e.y<=Math.max(r.y,t.y)&&e.y>=Math.min(r.y,t.y)}function $x(r){return r>0?1:r<0?-1:0}function aq(r,e){let t=r;do{if(t.i!==r.i&&t.next.i!==r.i&&t.i!==e.i&&t.next.i!==e.i&&lD(t,t.next,r,e))return!0;t=t.next}while(t!==r);return!1}function E0(r,e){return fr(r.prev,r,r.next)<0?fr(r,e,r.next)>=0&&fr(r,r.prev,e)>=0:fr(r,e,r.prev)<0||fr(r,r.next,e)<0}function lq(r,e){let t=r,n=!1;const s=(r.x+e.x)/2,i=(r.y+e.y)/2;do t.y>i!=t.next.y>i&&t.next.y!==t.y&&s<(t.next.x-t.x)*(i-t.y)/(t.next.y-t.y)+t.x&&(n=!n),t=t.next;while(t!==r);return n}function cD(r,e){const t=Bb(r.i,r.x,r.y),n=Bb(e.i,e.x,e.y),s=r.next,i=e.prev;return r.next=e,e.prev=r,t.next=s,s.prev=t,n.next=t,t.prev=n,i.next=n,n.prev=i,n}function JC(r,e,t,n){const s=Bb(r,e,t);return n?(s.next=n.next,s.prev=n,n.next.prev=s,n.next=s):(s.prev=s,s.next=s),s}function M0(r){r.next.prev=r.prev,r.prev.next=r.next,r.prevZ&&(r.prevZ.nextZ=r.nextZ),r.nextZ&&(r.nextZ.prevZ=r.prevZ)}function Bb(r,e,t){return{i:r,x:e,y:t,prev:null,next:null,z:0,prevZ:null,nextZ:null,steiner:!1}}function cq(r,e,t,n){let s=0;for(let i=e,o=t-n;i<t;i+=n)s+=(r[o]-r[i])*(r[i+1]+r[o+1]),o=i;return s}class uq{static triangulate(e,t,n=2){return q$(e,t,n)}}class ia{static area(e){const t=e.length;let n=0;for(let s=t-1,i=0;i<t;s=i++)n+=e[s].x*e[i].y-e[i].x*e[s].y;return n*.5}static isClockWise(e){return ia.area(e)<0}static triangulateShape(e,t){const n=[],s=[],i=[];ZC(e),eA(n,e);let o=e.length;t.forEach(ZC);for(let c=0;c<t.length;c++)s.push(o),o+=t[c].length,eA(n,t[c]);const a=uq.triangulate(n,s);for(let c=0;c<a.length;c+=3)i.push(a.slice(c,c+3));return i}}function ZC(r){const e=r.length;e>2&&r[e-1].equals(r[0])&&r.pop()}function eA(r,e){for(let t=0;t<e.length;t++)r.push(e[t].x),r.push(e[t].y)}class yw extends mn{constructor(e=new eh([new Ve(.5,.5),new Ve(-.5,.5),new Ve(-.5,-.5),new Ve(.5,-.5)]),t={}){super(),this.type="ExtrudeGeometry",this.parameters={shapes:e,options:t},e=Array.isArray(e)?e:[e];const n=this,s=[],i=[];for(let a=0,c=e.length;a<c;a++){const d=e[a];o(d)}this.setAttribute("position",new It(s,3)),this.setAttribute("uv",new It(i,2)),this.computeVertexNormals();function o(a){const c=[],d=t.curveSegments!==void 0?t.curveSegments:12,f=t.steps!==void 0?t.steps:1,m=t.depth!==void 0?t.depth:1;let v=t.bevelEnabled!==void 0?t.bevelEnabled:!0,x=t.bevelThickness!==void 0?t.bevelThickness:.2,_=t.bevelSize!==void 0?t.bevelSize:x-.1,b=t.bevelOffset!==void 0?t.bevelOffset:0,w=t.bevelSegments!==void 0?t.bevelSegments:3;const S=t.extrudePath,C=t.UVGenerator!==void 0?t.UVGenerator:dq;let T,A=!1,k,j,D,L;S&&(T=S.getSpacedPoints(f),A=!0,v=!1,k=S.computeFrenetFrames(f,!1),j=new J,D=new J,L=new J),v||(w=0,x=0,_=0,b=0);const O=a.extractPoints(d);let I=O.shape;const B=O.holes;if(!ia.isClockWise(I)){I=I.reverse();for(let $=0,Ce=B.length;$<Ce;$++){const ke=B[$];ia.isClockWise(ke)&&(B[$]=ke.reverse())}}function K($){const ke=10000000000000001e-36;let Ge=$[0];for(let Ae=1;Ae<=$.length;Ae++){const rt=Ae%$.length,qe=$[rt],nt=qe.x-Ge.x,jt=qe.y-Ge.y,Q=nt*nt+jt*jt,H=Math.max(Math.abs(qe.x),Math.abs(qe.y),Math.abs(Ge.x),Math.abs(Ge.y)),ye=ke*H*H;if(Q<=ye){$.splice(rt,1),Ae--;continue}Ge=qe}}K(I),B.forEach(K);const ee=B.length,oe=I;for(let $=0;$<ee;$++){const Ce=B[$];I=I.concat(Ce)}function ne($,Ce,ke){return Ce||console.error("THREE.ExtrudeGeometry: vec does not exist"),$.clone().addScaledVector(Ce,ke)}const ce=I.length;function V($,Ce,ke){let Ge,Ae,rt;const qe=$.x-Ce.x,nt=$.y-Ce.y,jt=ke.x-$.x,Q=ke.y-$.y,H=qe*qe+nt*nt,ye=qe*Q-nt*jt;if(Math.abs(ye)>Number.EPSILON){const Re=Math.sqrt(H),Ue=Math.sqrt(jt*jt+Q*Q),Le=Ce.x-nt/Re,bt=Ce.y+qe/Re,st=ke.x-Q/Ue,xt=ke.y+jt/Ue,Et=((st-Le)*Q-(xt-bt)*jt)/(qe*Q-nt*jt);Ge=Le+qe*Et-$.x,Ae=bt+nt*Et-$.y;const We=Ge*Ge+Ae*Ae;if(We<=2)return new Ve(Ge,Ae);rt=Math.sqrt(We/2)}else{let Re=!1;qe>Number.EPSILON?jt>Number.EPSILON&&(Re=!0):qe<-Number.EPSILON?jt<-Number.EPSILON&&(Re=!0):Math.sign(nt)===Math.sign(Q)&&(Re=!0),Re?(Ge=-nt,Ae=qe,rt=Math.sqrt(H)):(Ge=qe,Ae=nt,rt=Math.sqrt(H/2))}return new Ve(Ge/rt,Ae/rt)}const q=[];for(let $=0,Ce=oe.length,ke=Ce-1,Ge=$+1;$<Ce;$++,ke++,Ge++)ke===Ce&&(ke=0),Ge===Ce&&(Ge=0),q[$]=V(oe[$],oe[ke],oe[Ge]);const Z=[];let X,ie=q.concat();for(let $=0,Ce=ee;$<Ce;$++){const ke=B[$];X=[];for(let Ge=0,Ae=ke.length,rt=Ae-1,qe=Ge+1;Ge<Ae;Ge++,rt++,qe++)rt===Ae&&(rt=0),qe===Ae&&(qe=0),X[Ge]=V(ke[Ge],ke[rt],ke[qe]);Z.push(X),ie=ie.concat(X)}let be;if(w===0)be=ia.triangulateShape(oe,B);else{const $=[],Ce=[];for(let ke=0;ke<w;ke++){const Ge=ke/w,Ae=x*Math.cos(Ge*Math.PI/2),rt=_*Math.sin(Ge*Math.PI/2)+b;for(let qe=0,nt=oe.length;qe<nt;qe++){const jt=ne(oe[qe],q[qe],rt);Xe(jt.x,jt.y,-Ae),Ge===0&&$.push(jt)}for(let qe=0,nt=ee;qe<nt;qe++){const jt=B[qe];X=Z[qe];const Q=[];for(let H=0,ye=jt.length;H<ye;H++){const Re=ne(jt[H],X[H],rt);Xe(Re.x,Re.y,-Ae),Ge===0&&Q.push(Re)}Ge===0&&Ce.push(Q)}}be=ia.triangulateShape($,Ce)}const ue=be.length,Ee=_+b;for(let $=0;$<ce;$++){const Ce=v?ne(I[$],ie[$],Ee):I[$];A?(D.copy(k.normals[0]).multiplyScalar(Ce.x),j.copy(k.binormals[0]).multiplyScalar(Ce.y),L.copy(T[0]).add(D).add(j),Xe(L.x,L.y,L.z)):Xe(Ce.x,Ce.y,0)}for(let $=1;$<=f;$++)for(let Ce=0;Ce<ce;Ce++){const ke=v?ne(I[Ce],ie[Ce],Ee):I[Ce];A?(D.copy(k.normals[$]).multiplyScalar(ke.x),j.copy(k.binormals[$]).multiplyScalar(ke.y),L.copy(T[$]).add(D).add(j),Xe(L.x,L.y,L.z)):Xe(ke.x,ke.y,m/f*$)}for(let $=w-1;$>=0;$--){const Ce=$/w,ke=x*Math.cos(Ce*Math.PI/2),Ge=_*Math.sin(Ce*Math.PI/2)+b;for(let Ae=0,rt=oe.length;Ae<rt;Ae++){const qe=ne(oe[Ae],q[Ae],Ge);Xe(qe.x,qe.y,m+ke)}for(let Ae=0,rt=B.length;Ae<rt;Ae++){const qe=B[Ae];X=Z[Ae];for(let nt=0,jt=qe.length;nt<jt;nt++){const Q=ne(qe[nt],X[nt],Ge);A?Xe(Q.x,Q.y+T[f-1].y,T[f-1].x+ke):Xe(Q.x,Q.y,m+ke)}}}Fe(),me();function Fe(){const $=s.length/3;if(v){let Ce=0,ke=ce*Ce;for(let Ge=0;Ge<ue;Ge++){const Ae=be[Ge];$e(Ae[2]+ke,Ae[1]+ke,Ae[0]+ke)}Ce=f+w*2,ke=ce*Ce;for(let Ge=0;Ge<ue;Ge++){const Ae=be[Ge];$e(Ae[0]+ke,Ae[1]+ke,Ae[2]+ke)}}else{for(let Ce=0;Ce<ue;Ce++){const ke=be[Ce];$e(ke[2],ke[1],ke[0])}for(let Ce=0;Ce<ue;Ce++){const ke=be[Ce];$e(ke[0]+ce*f,ke[1]+ce*f,ke[2]+ce*f)}}n.addGroup($,s.length/3-$,0)}function me(){const $=s.length/3;let Ce=0;je(oe,Ce),Ce+=oe.length;for(let ke=0,Ge=B.length;ke<Ge;ke++){const Ae=B[ke];je(Ae,Ce),Ce+=Ae.length}n.addGroup($,s.length/3-$,1)}function je($,Ce){let ke=$.length;for(;--ke>=0;){const Ge=ke;let Ae=ke-1;Ae<0&&(Ae=$.length-1);for(let rt=0,qe=f+w*2;rt<qe;rt++){const nt=ce*rt,jt=ce*(rt+1),Q=Ce+Ge+nt,H=Ce+Ae+nt,ye=Ce+Ae+jt,Re=Ce+Ge+jt;dt(Q,H,ye,Re)}}}function Xe($,Ce,ke){c.push($),c.push(Ce),c.push(ke)}function $e($,Ce,ke){ht($),ht(Ce),ht(ke);const Ge=s.length/3,Ae=C.generateTopUV(n,s,Ge-3,Ge-2,Ge-1);Ie(Ae[0]),Ie(Ae[1]),Ie(Ae[2])}function dt($,Ce,ke,Ge){ht($),ht(Ce),ht(Ge),ht(Ce),ht(ke),ht(Ge);const Ae=s.length/3,rt=C.generateSideWallUV(n,s,Ae-6,Ae-3,Ae-2,Ae-1);Ie(rt[0]),Ie(rt[1]),Ie(rt[3]),Ie(rt[1]),Ie(rt[2]),Ie(rt[3])}function ht($){s.push(c[$*3+0]),s.push(c[$*3+1]),s.push(c[$*3+2])}function Ie($){i.push($.x),i.push($.y)}}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}toJSON(){const e=super.toJSON(),t=this.parameters.shapes,n=this.parameters.options;return hq(t,n,e)}static fromJSON(e,t){const n=[];for(let i=0,o=e.shapes.length;i<o;i++){const a=t[e.shapes[i]];n.push(a)}const s=e.options.extrudePath;return s!==void 0&&(e.options.extrudePath=new g_[s.type]().fromJSON(s)),new yw(n,e.options)}}const dq={generateTopUV:function(r,e,t,n,s){const i=e[t*3],o=e[t*3+1],a=e[n*3],c=e[n*3+1],d=e[s*3],f=e[s*3+1];return[new Ve(i,o),new Ve(a,c),new Ve(d,f)]},generateSideWallUV:function(r,e,t,n,s,i){const o=e[t*3],a=e[t*3+1],c=e[t*3+2],d=e[n*3],f=e[n*3+1],m=e[n*3+2],v=e[s*3],x=e[s*3+1],_=e[s*3+2],b=e[i*3],w=e[i*3+1],S=e[i*3+2];return Math.abs(a-f)<Math.abs(o-d)?[new Ve(o,1-c),new Ve(d,1-m),new Ve(v,1-_),new Ve(b,1-S)]:[new Ve(a,1-c),new Ve(f,1-m),new Ve(x,1-_),new Ve(w,1-S)]}};function hq(r,e,t){if(t.shapes=[],Array.isArray(r))for(let n=0,s=r.length;n<s;n++){const i=r[n];t.shapes.push(i.uuid)}else t.shapes.push(r.uuid);return t.options=Object.assign({},e),e.extrudePath!==void 0&&(t.options.extrudePath=e.extrudePath.toJSON()),t}class _w extends Cu{constructor(e=1,t=0){const n=(1+Math.sqrt(5))/2,s=[-1,n,0,1,n,0,-1,-n,0,1,-n,0,0,-1,n,0,1,n,0,-1,-n,0,1,-n,n,0,-1,n,0,1,-n,0,-1,-n,0,1],i=[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1];super(s,i,e,t),this.type="IcosahedronGeometry",this.parameters={radius:e,detail:t}}static fromJSON(e){return new _w(e.radius,e.detail)}}class ww extends mn{constructor(e=[new Ve(0,-.5),new Ve(.5,0),new Ve(0,.5)],t=12,n=0,s=Math.PI*2){super(),this.type="LatheGeometry",this.parameters={points:e,segments:t,phiStart:n,phiLength:s},t=Math.floor(t),s=an(s,0,Math.PI*2);const i=[],o=[],a=[],c=[],d=[],f=1/t,m=new J,v=new Ve,x=new J,_=new J,b=new J;let w=0,S=0;for(let C=0;C<=e.length-1;C++)switch(C){case 0:w=e[C+1].x-e[C].x,S=e[C+1].y-e[C].y,x.x=S*1,x.y=-w,x.z=S*0,b.copy(x),x.normalize(),c.push(x.x,x.y,x.z);break;case e.length-1:c.push(b.x,b.y,b.z);break;default:w=e[C+1].x-e[C].x,S=e[C+1].y-e[C].y,x.x=S*1,x.y=-w,x.z=S*0,_.copy(x),x.x+=b.x,x.y+=b.y,x.z+=b.z,x.normalize(),c.push(x.x,x.y,x.z),b.copy(_)}for(let C=0;C<=t;C++){const T=n+C*f*s,A=Math.sin(T),k=Math.cos(T);for(let j=0;j<=e.length-1;j++){m.x=e[j].x*A,m.y=e[j].y,m.z=e[j].x*k,o.push(m.x,m.y,m.z),v.x=C/t,v.y=j/(e.length-1),a.push(v.x,v.y);const D=c[3*j+0]*A,L=c[3*j+1],O=c[3*j+0]*k;d.push(D,L,O)}}for(let C=0;C<t;C++)for(let T=0;T<e.length-1;T++){const A=T+C*e.length,k=A,j=A+e.length,D=A+e.length+1,L=A+1;i.push(k,j,L),i.push(D,L,j)}this.setIndex(i),this.setAttribute("position",new It(o,3)),this.setAttribute("uv",new It(a,2)),this.setAttribute("normal",new It(d,3))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new ww(e.points,e.segments,e.phiStart,e.phiLength)}}class Q0 extends Cu{constructor(e=1,t=0){const n=[1,0,0,-1,0,0,0,1,0,0,-1,0,0,0,1,0,0,-1],s=[0,2,4,0,4,3,0,3,5,0,5,2,1,2,5,1,5,3,1,3,4,1,4,2];super(n,s,e,t),this.type="OctahedronGeometry",this.parameters={radius:e,detail:t}}static fromJSON(e){return new Q0(e.radius,e.detail)}}class mm extends mn{constructor(e=1,t=1,n=1,s=1){super(),this.type="PlaneGeometry",this.parameters={width:e,height:t,widthSegments:n,heightSegments:s};const i=e/2,o=t/2,a=Math.floor(n),c=Math.floor(s),d=a+1,f=c+1,m=e/a,v=t/c,x=[],_=[],b=[],w=[];for(let S=0;S<f;S++){const C=S*v-o;for(let T=0;T<d;T++){const A=T*m-i;_.push(A,-C,0),b.push(0,0,1),w.push(T/a),w.push(1-S/c)}}for(let S=0;S<c;S++)for(let C=0;C<a;C++){const T=C+d*S,A=C+d*(S+1),k=C+1+d*(S+1),j=C+1+d*S;x.push(T,A,j),x.push(A,k,j)}this.setIndex(x),this.setAttribute("position",new It(_,3)),this.setAttribute("normal",new It(b,3)),this.setAttribute("uv",new It(w,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new mm(e.width,e.height,e.widthSegments,e.heightSegments)}}class Sw extends mn{constructor(e=.5,t=1,n=32,s=1,i=0,o=Math.PI*2){super(),this.type="RingGeometry",this.parameters={innerRadius:e,outerRadius:t,thetaSegments:n,phiSegments:s,thetaStart:i,thetaLength:o},n=Math.max(3,n),s=Math.max(1,s);const a=[],c=[],d=[],f=[];let m=e;const v=(t-e)/s,x=new J,_=new Ve;for(let b=0;b<=s;b++){for(let w=0;w<=n;w++){const S=i+w/n*o;x.x=m*Math.cos(S),x.y=m*Math.sin(S),c.push(x.x,x.y,x.z),d.push(0,0,1),_.x=(x.x/t+1)/2,_.y=(x.y/t+1)/2,f.push(_.x,_.y)}m+=v}for(let b=0;b<s;b++){const w=b*(n+1);for(let S=0;S<n;S++){const C=S+w,T=C,A=C+n+1,k=C+n+2,j=C+1;a.push(T,A,j),a.push(A,k,j)}}this.setIndex(a),this.setAttribute("position",new It(c,3)),this.setAttribute("normal",new It(d,3)),this.setAttribute("uv",new It(f,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new Sw(e.innerRadius,e.outerRadius,e.thetaSegments,e.phiSegments,e.thetaStart,e.thetaLength)}}class bw extends mn{constructor(e=new eh([new Ve(0,.5),new Ve(-.5,-.5),new Ve(.5,-.5)]),t=12){super(),this.type="ShapeGeometry",this.parameters={shapes:e,curveSegments:t};const n=[],s=[],i=[],o=[];let a=0,c=0;if(Array.isArray(e)===!1)d(e);else for(let f=0;f<e.length;f++)d(e[f]),this.addGroup(a,c,f),a+=c,c=0;this.setIndex(n),this.setAttribute("position",new It(s,3)),this.setAttribute("normal",new It(i,3)),this.setAttribute("uv",new It(o,2));function d(f){const m=s.length/3,v=f.extractPoints(t);let x=v.shape;const _=v.holes;ia.isClockWise(x)===!1&&(x=x.reverse());for(let w=0,S=_.length;w<S;w++){const C=_[w];ia.isClockWise(C)===!0&&(_[w]=C.reverse())}const b=ia.triangulateShape(x,_);for(let w=0,S=_.length;w<S;w++){const C=_[w];x=x.concat(C)}for(let w=0,S=x.length;w<S;w++){const C=x[w];s.push(C.x,C.y,0),i.push(0,0,1),o.push(C.x,C.y)}for(let w=0,S=b.length;w<S;w++){const C=b[w],T=C[0]+m,A=C[1]+m,k=C[2]+m;n.push(T,A,k),c+=3}}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}toJSON(){const e=super.toJSON(),t=this.parameters.shapes;return fq(t,e)}static fromJSON(e,t){const n=[];for(let s=0,i=e.shapes.length;s<i;s++){const o=t[e.shapes[s]];n.push(o)}return new bw(n,e.curveSegments)}}function fq(r,e){if(e.shapes=[],Array.isArray(r))for(let t=0,n=r.length;t<n;t++){const s=r[t];e.shapes.push(s.uuid)}else e.shapes.push(r.uuid);return e}class J0 extends mn{constructor(e=1,t=32,n=16,s=0,i=Math.PI*2,o=0,a=Math.PI){super(),this.type="SphereGeometry",this.parameters={radius:e,widthSegments:t,heightSegments:n,phiStart:s,phiLength:i,thetaStart:o,thetaLength:a},t=Math.max(3,Math.floor(t)),n=Math.max(2,Math.floor(n));const c=Math.min(o+a,Math.PI);let d=0;const f=[],m=new J,v=new J,x=[],_=[],b=[],w=[];for(let S=0;S<=n;S++){const C=[],T=S/n;let A=0;S===0&&o===0?A=.5/t:S===n&&c===Math.PI&&(A=-.5/t);for(let k=0;k<=t;k++){const j=k/t;m.x=-e*Math.cos(s+j*i)*Math.sin(o+T*a),m.y=e*Math.cos(o+T*a),m.z=e*Math.sin(s+j*i)*Math.sin(o+T*a),_.push(m.x,m.y,m.z),v.copy(m).normalize(),b.push(v.x,v.y,v.z),w.push(j+A,1-T),C.push(d++)}f.push(C)}for(let S=0;S<n;S++)for(let C=0;C<t;C++){const T=f[S][C+1],A=f[S][C],k=f[S+1][C],j=f[S+1][C+1];(S!==0||o>0)&&x.push(T,A,j),(S!==n-1||c<Math.PI)&&x.push(A,k,j)}this.setIndex(x),this.setAttribute("position",new It(_,3)),this.setAttribute("normal",new It(b,3)),this.setAttribute("uv",new It(w,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new J0(e.radius,e.widthSegments,e.heightSegments,e.phiStart,e.phiLength,e.thetaStart,e.thetaLength)}}class Ew extends Cu{constructor(e=1,t=0){const n=[1,1,1,-1,-1,1,-1,1,-1,1,-1,-1],s=[2,1,0,0,3,2,1,3,0,2,3,1];super(n,s,e,t),this.type="TetrahedronGeometry",this.parameters={radius:e,detail:t}}static fromJSON(e){return new Ew(e.radius,e.detail)}}class Mw extends mn{constructor(e=1,t=.4,n=12,s=48,i=Math.PI*2){super(),this.type="TorusGeometry",this.parameters={radius:e,tube:t,radialSegments:n,tubularSegments:s,arc:i},n=Math.floor(n),s=Math.floor(s);const o=[],a=[],c=[],d=[],f=new J,m=new J,v=new J;for(let x=0;x<=n;x++)for(let _=0;_<=s;_++){const b=_/s*i,w=x/n*Math.PI*2;m.x=(e+t*Math.cos(w))*Math.cos(b),m.y=(e+t*Math.cos(w))*Math.sin(b),m.z=t*Math.sin(w),a.push(m.x,m.y,m.z),f.x=e*Math.cos(b),f.y=e*Math.sin(b),v.subVectors(m,f).normalize(),c.push(v.x,v.y,v.z),d.push(_/s),d.push(x/n)}for(let x=1;x<=n;x++)for(let _=1;_<=s;_++){const b=(s+1)*x+_-1,w=(s+1)*(x-1)+_-1,S=(s+1)*(x-1)+_,C=(s+1)*x+_;o.push(b,w,C),o.push(w,S,C)}this.setIndex(o),this.setAttribute("position",new It(a,3)),this.setAttribute("normal",new It(c,3)),this.setAttribute("uv",new It(d,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new Mw(e.radius,e.tube,e.radialSegments,e.tubularSegments,e.arc)}}class Tw extends mn{constructor(e=1,t=.4,n=64,s=8,i=2,o=3){super(),this.type="TorusKnotGeometry",this.parameters={radius:e,tube:t,tubularSegments:n,radialSegments:s,p:i,q:o},n=Math.floor(n),s=Math.floor(s);const a=[],c=[],d=[],f=[],m=new J,v=new J,x=new J,_=new J,b=new J,w=new J,S=new J;for(let T=0;T<=n;++T){const A=T/n*i*Math.PI*2;C(A,i,o,e,x),C(A+.01,i,o,e,_),w.subVectors(_,x),S.addVectors(_,x),b.crossVectors(w,S),S.crossVectors(b,w),b.normalize(),S.normalize();for(let k=0;k<=s;++k){const j=k/s*Math.PI*2,D=-t*Math.cos(j),L=t*Math.sin(j);m.x=x.x+(D*S.x+L*b.x),m.y=x.y+(D*S.y+L*b.y),m.z=x.z+(D*S.z+L*b.z),c.push(m.x,m.y,m.z),v.subVectors(m,x).normalize(),d.push(v.x,v.y,v.z),f.push(T/n),f.push(k/s)}}for(let T=1;T<=n;T++)for(let A=1;A<=s;A++){const k=(s+1)*(T-1)+(A-1),j=(s+1)*T+(A-1),D=(s+1)*T+A,L=(s+1)*(T-1)+A;a.push(k,j,L),a.push(j,D,L)}this.setIndex(a),this.setAttribute("position",new It(c,3)),this.setAttribute("normal",new It(d,3)),this.setAttribute("uv",new It(f,2));function C(T,A,k,j,D){const L=Math.cos(T),O=Math.sin(T),I=k/A*T,B=Math.cos(I);D.x=j*(2+B)*.5*L,D.y=j*(2+B)*O*.5,D.z=j*Math.sin(I)*.5}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new Tw(e.radius,e.tube,e.tubularSegments,e.radialSegments,e.p,e.q)}}class Cw extends mn{constructor(e=new RM(new J(-1,-1,0),new J(-1,1,0),new J(1,1,0)),t=64,n=1,s=8,i=!1){super(),this.type="TubeGeometry",this.parameters={path:e,tubularSegments:t,radius:n,radialSegments:s,closed:i};const o=e.computeFrenetFrames(t,i);this.tangents=o.tangents,this.normals=o.normals,this.binormals=o.binormals;const a=new J,c=new J,d=new Ve;let f=new J;const m=[],v=[],x=[],_=[];b(),this.setIndex(_),this.setAttribute("position",new It(m,3)),this.setAttribute("normal",new It(v,3)),this.setAttribute("uv",new It(x,2));function b(){for(let T=0;T<t;T++)w(T);w(i===!1?t:0),C(),S()}function w(T){f=e.getPointAt(T/t,f);const A=o.normals[T],k=o.binormals[T];for(let j=0;j<=s;j++){const D=j/s*Math.PI*2,L=Math.sin(D),O=-Math.cos(D);c.x=O*A.x+L*k.x,c.y=O*A.y+L*k.y,c.z=O*A.z+L*k.z,c.normalize(),v.push(c.x,c.y,c.z),a.x=f.x+n*c.x,a.y=f.y+n*c.y,a.z=f.z+n*c.z,m.push(a.x,a.y,a.z)}}function S(){for(let T=1;T<=t;T++)for(let A=1;A<=s;A++){const k=(s+1)*(T-1)+(A-1),j=(s+1)*T+(A-1),D=(s+1)*T+A,L=(s+1)*(T-1)+A;_.push(k,j,L),_.push(j,D,L)}}function C(){for(let T=0;T<=t;T++)for(let A=0;A<=s;A++)d.x=T/t,d.y=A/s,x.push(d.x,d.y)}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}toJSON(){const e=super.toJSON();return e.path=this.parameters.path.toJSON(),e}static fromJSON(e){return new Cw(new g_[e.path.type]().fromJSON(e.path),e.tubularSegments,e.radius,e.radialSegments,e.closed)}}class uD extends mn{constructor(e=null){if(super(),this.type="WireframeGeometry",this.parameters={geometry:e},e!==null){const t=[],n=new Set,s=new J,i=new J;if(e.index!==null){const o=e.attributes.position,a=e.index;let c=e.groups;c.length===0&&(c=[{start:0,count:a.count,materialIndex:0}]);for(let d=0,f=c.length;d<f;++d){const m=c[d],v=m.start,x=m.count;for(let _=v,b=v+x;_<b;_+=3)for(let w=0;w<3;w++){const S=a.getX(_+w),C=a.getX(_+(w+1)%3);s.fromBufferAttribute(o,S),i.fromBufferAttribute(o,C),tA(s,i,n)===!0&&(t.push(s.x,s.y,s.z),t.push(i.x,i.y,i.z))}}}else{const o=e.attributes.position;for(let a=0,c=o.count/3;a<c;a++)for(let d=0;d<3;d++){const f=3*a+d,m=3*a+(d+1)%3;s.fromBufferAttribute(o,f),i.fromBufferAttribute(o,m),tA(s,i,n)===!0&&(t.push(s.x,s.y,s.z),t.push(i.x,i.y,i.z))}}this.setAttribute("position",new It(t,3))}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}}function tA(r,e,t){const n=`${r.x},${r.y},${r.z}-${e.x},${e.y},${e.z}`,s=`${e.x},${e.y},${e.z}-${r.x},${r.y},${r.z}`;return t.has(n)===!0||t.has(s)===!0?!1:(t.add(n),t.add(s),!0)}var nA=Object.freeze({__proto__:null,BoxGeometry:Sh,CapsuleGeometry:mw,CircleGeometry:gw,ConeGeometry:K0,CylinderGeometry:Y0,DodecahedronGeometry:vw,EdgesGeometry:eD,ExtrudeGeometry:yw,IcosahedronGeometry:_w,LatheGeometry:ww,OctahedronGeometry:Q0,PlaneGeometry:mm,PolyhedronGeometry:Cu,RingGeometry:Sw,ShapeGeometry:bw,SphereGeometry:J0,TetrahedronGeometry:Ew,TorusGeometry:Mw,TorusKnotGeometry:Tw,TubeGeometry:Cw,WireframeGeometry:uD});class dD extends $s{constructor(e){super(),this.isShadowMaterial=!0,this.type="ShadowMaterial",this.color=new St(0),this.transparent=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.fog=e.fog,this}}class hD extends la{constructor(e){super(e),this.isRawShaderMaterial=!0,this.type="RawShaderMaterial"}}class PM extends $s{constructor(e){super(),this.isMeshStandardMaterial=!0,this.type="MeshStandardMaterial",this.defines={STANDARD:""},this.color=new St(16777215),this.roughness=1,this.metalness=0,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new St(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Mu,this.normalScale=new Ve(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.roughnessMap=null,this.metalnessMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new eo,this.envMapIntensity=1,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.defines={STANDARD:""},this.color.copy(e.color),this.roughness=e.roughness,this.metalness=e.metalness,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.roughnessMap=e.roughnessMap,this.metalnessMap=e.metalnessMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.envMapIntensity=e.envMapIntensity,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class fD extends PM{constructor(e){super(),this.isMeshPhysicalMaterial=!0,this.defines={STANDARD:"",PHYSICAL:""},this.type="MeshPhysicalMaterial",this.anisotropyRotation=0,this.anisotropyMap=null,this.clearcoatMap=null,this.clearcoatRoughness=0,this.clearcoatRoughnessMap=null,this.clearcoatNormalScale=new Ve(1,1),this.clearcoatNormalMap=null,this.ior=1.5,Object.defineProperty(this,"reflectivity",{get:function(){return an(2.5*(this.ior-1)/(this.ior+1),0,1)},set:function(t){this.ior=(1+.4*t)/(1-.4*t)}}),this.iridescenceMap=null,this.iridescenceIOR=1.3,this.iridescenceThicknessRange=[100,400],this.iridescenceThicknessMap=null,this.sheenColor=new St(0),this.sheenColorMap=null,this.sheenRoughness=1,this.sheenRoughnessMap=null,this.transmissionMap=null,this.thickness=0,this.thicknessMap=null,this.attenuationDistance=1/0,this.attenuationColor=new St(1,1,1),this.specularIntensity=1,this.specularIntensityMap=null,this.specularColor=new St(1,1,1),this.specularColorMap=null,this._anisotropy=0,this._clearcoat=0,this._dispersion=0,this._iridescence=0,this._sheen=0,this._transmission=0,this.setValues(e)}get anisotropy(){return this._anisotropy}set anisotropy(e){this._anisotropy>0!=e>0&&this.version++,this._anisotropy=e}get clearcoat(){return this._clearcoat}set clearcoat(e){this._clearcoat>0!=e>0&&this.version++,this._clearcoat=e}get iridescence(){return this._iridescence}set iridescence(e){this._iridescence>0!=e>0&&this.version++,this._iridescence=e}get dispersion(){return this._dispersion}set dispersion(e){this._dispersion>0!=e>0&&this.version++,this._dispersion=e}get sheen(){return this._sheen}set sheen(e){this._sheen>0!=e>0&&this.version++,this._sheen=e}get transmission(){return this._transmission}set transmission(e){this._transmission>0!=e>0&&this.version++,this._transmission=e}copy(e){return super.copy(e),this.defines={STANDARD:"",PHYSICAL:""},this.anisotropy=e.anisotropy,this.anisotropyRotation=e.anisotropyRotation,this.anisotropyMap=e.anisotropyMap,this.clearcoat=e.clearcoat,this.clearcoatMap=e.clearcoatMap,this.clearcoatRoughness=e.clearcoatRoughness,this.clearcoatRoughnessMap=e.clearcoatRoughnessMap,this.clearcoatNormalMap=e.clearcoatNormalMap,this.clearcoatNormalScale.copy(e.clearcoatNormalScale),this.dispersion=e.dispersion,this.ior=e.ior,this.iridescence=e.iridescence,this.iridescenceMap=e.iridescenceMap,this.iridescenceIOR=e.iridescenceIOR,this.iridescenceThicknessRange=[...e.iridescenceThicknessRange],this.iridescenceThicknessMap=e.iridescenceThicknessMap,this.sheen=e.sheen,this.sheenColor.copy(e.sheenColor),this.sheenColorMap=e.sheenColorMap,this.sheenRoughness=e.sheenRoughness,this.sheenRoughnessMap=e.sheenRoughnessMap,this.transmission=e.transmission,this.transmissionMap=e.transmissionMap,this.thickness=e.thickness,this.thicknessMap=e.thicknessMap,this.attenuationDistance=e.attenuationDistance,this.attenuationColor.copy(e.attenuationColor),this.specularIntensity=e.specularIntensity,this.specularIntensityMap=e.specularIntensityMap,this.specularColor.copy(e.specularColor),this.specularColorMap=e.specularColorMap,this}}class pD extends $s{constructor(e){super(),this.isMeshPhongMaterial=!0,this.type="MeshPhongMaterial",this.color=new St(16777215),this.specular=new St(1118481),this.shininess=30,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new St(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Mu,this.normalScale=new Ve(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new eo,this.combine=W0,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.specular.copy(e.specular),this.shininess=e.shininess,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class mD extends $s{constructor(e){super(),this.isMeshToonMaterial=!0,this.defines={TOON:""},this.type="MeshToonMaterial",this.color=new St(16777215),this.map=null,this.gradientMap=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new St(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Mu,this.normalScale=new Ve(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.gradientMap=e.gradientMap,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.alphaMap=e.alphaMap,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.fog=e.fog,this}}class gD extends $s{constructor(e){super(),this.isMeshNormalMaterial=!0,this.type="MeshNormalMaterial",this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Mu,this.normalScale=new Ve(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.flatShading=!1,this.setValues(e)}copy(e){return super.copy(e),this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.flatShading=e.flatShading,this}}class vD extends $s{constructor(e){super(),this.isMeshLambertMaterial=!0,this.type="MeshLambertMaterial",this.color=new St(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new St(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Mu,this.normalScale=new Ve(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new eo,this.combine=W0,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class IM extends $s{constructor(e){super(),this.isMeshDepthMaterial=!0,this.type="MeshDepthMaterial",this.depthPacking=C4,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.setValues(e)}copy(e){return super.copy(e),this.depthPacking=e.depthPacking,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this}}class kM extends $s{constructor(e){super(),this.isMeshDistanceMaterial=!0,this.type="MeshDistanceMaterial",this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.setValues(e)}copy(e){return super.copy(e),this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this}}class xD extends $s{constructor(e){super(),this.isMeshMatcapMaterial=!0,this.defines={MATCAP:""},this.type="MeshMatcapMaterial",this.color=new St(16777215),this.matcap=null,this.map=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Mu,this.normalScale=new Ve(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.defines={MATCAP:""},this.color.copy(e.color),this.matcap=e.matcap,this.map=e.map,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.alphaMap=e.alphaMap,this.flatShading=e.flatShading,this.fog=e.fog,this}}class yD extends di{constructor(e){super(),this.isLineDashedMaterial=!0,this.type="LineDashedMaterial",this.scale=1,this.dashSize=3,this.gapSize=1,this.setValues(e)}copy(e){return super.copy(e),this.scale=e.scale,this.dashSize=e.dashSize,this.gapSize=e.gapSize,this}}function Ud(r,e){return!r||r.constructor===e?r:typeof e.BYTES_PER_ELEMENT=="number"?new e(r):Array.prototype.slice.call(r)}function _D(r){return ArrayBuffer.isView(r)&&!(r instanceof DataView)}function wD(r){function e(s,i){return r[s]-r[i]}const t=r.length,n=new Array(t);for(let s=0;s!==t;++s)n[s]=s;return n.sort(e),n}function zb(r,e,t){const n=r.length,s=new r.constructor(n);for(let i=0,o=0;o!==n;++i){const a=t[i]*e;for(let c=0;c!==e;++c)s[o++]=r[a+c]}return s}function DM(r,e,t,n){let s=1,i=r[0];for(;i!==void 0&&i[n]===void 0;)i=r[s++];if(i===void 0)return;let o=i[n];if(o!==void 0)if(Array.isArray(o))do o=i[n],o!==void 0&&(e.push(i.time),t.push(...o)),i=r[s++];while(i!==void 0);else if(o.toArray!==void 0)do o=i[n],o!==void 0&&(e.push(i.time),o.toArray(t,t.length)),i=r[s++];while(i!==void 0);else do o=i[n],o!==void 0&&(e.push(i.time),t.push(o)),i=r[s++];while(i!==void 0)}function pq(r,e,t,n,s=30){const i=r.clone();i.name=e;const o=[];for(let c=0;c<i.tracks.length;++c){const d=i.tracks[c],f=d.getValueSize(),m=[],v=[];for(let x=0;x<d.times.length;++x){const _=d.times[x]*s;if(!(_<t||_>=n)){m.push(d.times[x]);for(let b=0;b<f;++b)v.push(d.values[x*f+b])}}m.length!==0&&(d.times=Ud(m,d.times.constructor),d.values=Ud(v,d.values.constructor),o.push(d))}i.tracks=o;let a=1/0;for(let c=0;c<i.tracks.length;++c)a>i.tracks[c].times[0]&&(a=i.tracks[c].times[0]);for(let c=0;c<i.tracks.length;++c)i.tracks[c].shift(-1*a);return i.resetDuration(),i}function mq(r,e=0,t=r,n=30){n<=0&&(n=30);const s=t.tracks.length,i=e/n;for(let o=0;o<s;++o){const a=t.tracks[o],c=a.ValueTypeName;if(c==="bool"||c==="string")continue;const d=r.tracks.find(function(S){return S.name===a.name&&S.ValueTypeName===c});if(d===void 0)continue;let f=0;const m=a.getValueSize();a.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(f=m/3);let v=0;const x=d.getValueSize();d.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(v=x/3);const _=a.times.length-1;let b;if(i<=a.times[0]){const S=f,C=m-f;b=a.values.slice(S,C)}else if(i>=a.times[_]){const S=_*m+f,C=S+m-f;b=a.values.slice(S,C)}else{const S=a.createInterpolant(),C=f,T=m-f;S.evaluate(i),b=S.resultBuffer.slice(C,T)}c==="quaternion"&&new Gs().fromArray(b).normalize().conjugate().toArray(b);const w=d.times.length;for(let S=0;S<w;++S){const C=S*x+v;if(c==="quaternion")Gs.multiplyQuaternionsFlat(d.values,C,b,0,d.values,C);else{const T=x-v*2;for(let A=0;A<T;++A)d.values[C+A]-=b[A]}}}return r.blendMode=pM,r}class gq{static convertArray(e,t){return Ud(e,t)}static isTypedArray(e){return _D(e)}static getKeyframeOrder(e){return wD(e)}static sortedArray(e,t,n){return zb(e,t,n)}static flattenJSON(e,t,n,s){DM(e,t,n,s)}static subclip(e,t,n,s,i=30){return pq(e,t,n,s,i)}static makeClipAdditive(e,t=0,n=e,s=30){return mq(e,t,n,s)}}class Z0{constructor(e,t,n,s){this.parameterPositions=e,this._cachedIndex=0,this.resultBuffer=s!==void 0?s:new t.constructor(n),this.sampleValues=t,this.valueSize=n,this.settings=null,this.DefaultSettings_={}}evaluate(e){const t=this.parameterPositions;let n=this._cachedIndex,s=t[n],i=t[n-1];e:{t:{let o;n:{r:if(!(e<s)){for(let a=n+2;;){if(s===void 0){if(e<i)break r;return n=t.length,this._cachedIndex=n,this.copySampleValue_(n-1)}if(n===a)break;if(i=s,s=t[++n],e<s)break t}o=t.length;break n}if(!(e>=i)){const a=t[1];e<a&&(n=2,i=a);for(let c=n-2;;){if(i===void 0)return this._cachedIndex=0,this.copySampleValue_(0);if(n===c)break;if(s=i,i=t[--n-1],e>=i)break t}o=n,n=0;break n}break e}for(;n<o;){const a=n+o>>>1;e<t[a]?o=a:n=a+1}if(s=t[n],i=t[n-1],i===void 0)return this._cachedIndex=0,this.copySampleValue_(0);if(s===void 0)return n=t.length,this._cachedIndex=n,this.copySampleValue_(n-1)}this._cachedIndex=n,this.intervalChanged_(n,i,s)}return this.interpolate_(n,i,e,s)}getSettings_(){return this.settings||this.DefaultSettings_}copySampleValue_(e){const t=this.resultBuffer,n=this.sampleValues,s=this.valueSize,i=e*s;for(let o=0;o!==s;++o)t[o]=n[i+o];return t}interpolate_(){throw new Error("call to abstract method")}intervalChanged_(){}}class SD extends Z0{constructor(e,t,n,s){super(e,t,n,s),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0,this.DefaultSettings_={endingStart:jd,endingEnd:jd}}intervalChanged_(e,t,n){const s=this.parameterPositions;let i=e-2,o=e+1,a=s[i],c=s[o];if(a===void 0)switch(this.getSettings_().endingStart){case Fd:i=e,a=2*t-n;break;case x0:i=s.length-2,a=t+s[i]-s[i+1];break;default:i=e,a=n}if(c===void 0)switch(this.getSettings_().endingEnd){case Fd:o=e,c=2*n-t;break;case x0:o=1,c=n+s[1]-s[0];break;default:o=e-1,c=t}const d=(n-t)*.5,f=this.valueSize;this._weightPrev=d/(t-a),this._weightNext=d/(c-n),this._offsetPrev=i*f,this._offsetNext=o*f}interpolate_(e,t,n,s){const i=this.resultBuffer,o=this.sampleValues,a=this.valueSize,c=e*a,d=c-a,f=this._offsetPrev,m=this._offsetNext,v=this._weightPrev,x=this._weightNext,_=(n-t)/(s-t),b=_*_,w=b*_,S=-v*w+2*v*b-v*_,C=(1+v)*w+(-1.5-2*v)*b+(-.5+v)*_+1,T=(-1-x)*w+(1.5+x)*b+.5*_,A=x*w-x*b;for(let k=0;k!==a;++k)i[k]=S*o[f+k]+C*o[d+k]+T*o[c+k]+A*o[m+k];return i}}class LM extends Z0{constructor(e,t,n,s){super(e,t,n,s)}interpolate_(e,t,n,s){const i=this.resultBuffer,o=this.sampleValues,a=this.valueSize,c=e*a,d=c-a,f=(n-t)/(s-t),m=1-f;for(let v=0;v!==a;++v)i[v]=o[d+v]*m+o[c+v]*f;return i}}class bD extends Z0{constructor(e,t,n,s){super(e,t,n,s)}interpolate_(e){return this.copySampleValue_(e-1)}}class So{constructor(e,t,n,s){if(e===void 0)throw new Error("THREE.KeyframeTrack: track name is undefined");if(t===void 0||t.length===0)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+e);this.name=e,this.times=Ud(t,this.TimeBufferType),this.values=Ud(n,this.ValueBufferType),this.setInterpolation(s||this.DefaultInterpolation)}static toJSON(e){const t=e.constructor;let n;if(t.toJSON!==this.toJSON)n=t.toJSON(e);else{n={name:e.name,times:Ud(e.times,Array),values:Ud(e.values,Array)};const s=e.getInterpolation();s!==e.DefaultInterpolation&&(n.interpolation=s)}return n.type=e.ValueTypeName,n}InterpolantFactoryMethodDiscrete(e){return new bD(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodLinear(e){return new LM(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodSmooth(e){return new SD(this.times,this.values,this.getValueSize(),e)}setInterpolation(e){let t;switch(e){case v0:t=this.InterpolantFactoryMethodDiscrete;break;case f_:t=this.InterpolantFactoryMethodLinear;break;case my:t=this.InterpolantFactoryMethodSmooth;break}if(t===void 0){const n="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(this.createInterpolant===void 0)if(e!==this.DefaultInterpolation)this.setInterpolation(this.DefaultInterpolation);else throw new Error(n);return console.warn("THREE.KeyframeTrack:",n),this}return this.createInterpolant=t,this}getInterpolation(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return v0;case this.InterpolantFactoryMethodLinear:return f_;case this.InterpolantFactoryMethodSmooth:return my}}getValueSize(){return this.values.length/this.times.length}shift(e){if(e!==0){const t=this.times;for(let n=0,s=t.length;n!==s;++n)t[n]+=e}return this}scale(e){if(e!==1){const t=this.times;for(let n=0,s=t.length;n!==s;++n)t[n]*=e}return this}trim(e,t){const n=this.times,s=n.length;let i=0,o=s-1;for(;i!==s&&n[i]<e;)++i;for(;o!==-1&&n[o]>t;)--o;if(++o,i!==0||o!==s){i>=o&&(o=Math.max(o,1),i=o-1);const a=this.getValueSize();this.times=n.slice(i,o),this.values=this.values.slice(i*a,o*a)}return this}validate(){let e=!0;const t=this.getValueSize();t-Math.floor(t)!==0&&(console.error("THREE.KeyframeTrack: Invalid value size in track.",this),e=!1);const n=this.times,s=this.values,i=n.length;i===0&&(console.error("THREE.KeyframeTrack: Track is empty.",this),e=!1);let o=null;for(let a=0;a!==i;a++){const c=n[a];if(typeof c=="number"&&isNaN(c)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,a,c),e=!1;break}if(o!==null&&o>c){console.error("THREE.KeyframeTrack: Out of order keys.",this,a,c,o),e=!1;break}o=c}if(s!==void 0&&_D(s))for(let a=0,c=s.length;a!==c;++a){const d=s[a];if(isNaN(d)){console.error("THREE.KeyframeTrack: Value is not a valid number.",this,a,d),e=!1;break}}return e}optimize(){const e=this.times.slice(),t=this.values.slice(),n=this.getValueSize(),s=this.getInterpolation()===my,i=e.length-1;let o=1;for(let a=1;a<i;++a){let c=!1;const d=e[a],f=e[a+1];if(d!==f&&(a!==1||d!==e[0]))if(s)c=!0;else{const m=a*n,v=m-n,x=m+n;for(let _=0;_!==n;++_){const b=t[m+_];if(b!==t[v+_]||b!==t[x+_]){c=!0;break}}}if(c){if(a!==o){e[o]=e[a];const m=a*n,v=o*n;for(let x=0;x!==n;++x)t[v+x]=t[m+x]}++o}}if(i>0){e[o]=e[i];for(let a=i*n,c=o*n,d=0;d!==n;++d)t[c+d]=t[a+d];++o}return o!==e.length?(this.times=e.slice(0,o),this.values=t.slice(0,o*n)):(this.times=e,this.values=t),this}clone(){const e=this.times.slice(),t=this.values.slice(),n=this.constructor,s=new n(this.name,e,t);return s.createInterpolant=this.createInterpolant,s}}So.prototype.ValueTypeName="";So.prototype.TimeBufferType=Float32Array;So.prototype.ValueBufferType=Float32Array;So.prototype.DefaultInterpolation=f_;class bh extends So{constructor(e,t,n){super(e,t,n)}}bh.prototype.ValueTypeName="bool";bh.prototype.ValueBufferType=Array;bh.prototype.DefaultInterpolation=v0;bh.prototype.InterpolantFactoryMethodLinear=void 0;bh.prototype.InterpolantFactoryMethodSmooth=void 0;class OM extends So{constructor(e,t,n,s){super(e,t,n,s)}}OM.prototype.ValueTypeName="color";class T0 extends So{constructor(e,t,n,s){super(e,t,n,s)}}T0.prototype.ValueTypeName="number";class ED extends Z0{constructor(e,t,n,s){super(e,t,n,s)}interpolate_(e,t,n,s){const i=this.resultBuffer,o=this.sampleValues,a=this.valueSize,c=(n-t)/(s-t);let d=e*a;for(let f=d+a;d!==f;d+=4)Gs.slerpFlat(i,0,o,d-a,o,d,c);return i}}class ev extends So{constructor(e,t,n,s){super(e,t,n,s)}InterpolantFactoryMethodLinear(e){return new ED(this.times,this.values,this.getValueSize(),e)}}ev.prototype.ValueTypeName="quaternion";ev.prototype.InterpolantFactoryMethodSmooth=void 0;class Eh extends So{constructor(e,t,n){super(e,t,n)}}Eh.prototype.ValueTypeName="string";Eh.prototype.ValueBufferType=Array;Eh.prototype.DefaultInterpolation=v0;Eh.prototype.InterpolantFactoryMethodLinear=void 0;Eh.prototype.InterpolantFactoryMethodSmooth=void 0;class C0 extends So{constructor(e,t,n,s){super(e,t,n,s)}}C0.prototype.ValueTypeName="vector";class A0{constructor(e="",t=-1,n=[],s=ow){this.name=e,this.tracks=n,this.duration=t,this.blendMode=s,this.uuid=Zi(),this.duration<0&&this.resetDuration()}static parse(e){const t=[],n=e.tracks,s=1/(e.fps||1);for(let o=0,a=n.length;o!==a;++o)t.push(xq(n[o]).scale(s));const i=new this(e.name,e.duration,t,e.blendMode);return i.uuid=e.uuid,i}static toJSON(e){const t=[],n=e.tracks,s={name:e.name,duration:e.duration,tracks:t,uuid:e.uuid,blendMode:e.blendMode};for(let i=0,o=n.length;i!==o;++i)t.push(So.toJSON(n[i]));return s}static CreateFromMorphTargetSequence(e,t,n,s){const i=t.length,o=[];for(let a=0;a<i;a++){let c=[],d=[];c.push((a+i-1)%i,a,(a+1)%i),d.push(0,1,0);const f=wD(c);c=zb(c,1,f),d=zb(d,1,f),!s&&c[0]===0&&(c.push(i),d.push(d[0])),o.push(new T0(".morphTargetInfluences["+t[a].name+"]",c,d).scale(1/n))}return new this(e,-1,o)}static findByName(e,t){let n=e;if(!Array.isArray(e)){const s=e;n=s.geometry&&s.geometry.animations||s.animations}for(let s=0;s<n.length;s++)if(n[s].name===t)return n[s];return null}static CreateClipsFromMorphTargetSequences(e,t,n){const s={},i=/^([\w-]*?)([\d]+)$/;for(let a=0,c=e.length;a<c;a++){const d=e[a],f=d.name.match(i);if(f&&f.length>1){const m=f[1];let v=s[m];v||(s[m]=v=[]),v.push(d)}}const o=[];for(const a in s)o.push(this.CreateFromMorphTargetSequence(a,s[a],t,n));return o}static parseAnimation(e,t){if(console.warn("THREE.AnimationClip: parseAnimation() is deprecated and will be removed with r185"),!e)return console.error("THREE.AnimationClip: No animation in JSONLoader data."),null;const n=function(m,v,x,_,b){if(x.length!==0){const w=[],S=[];DM(x,w,S,_),w.length!==0&&b.push(new m(v,w,S))}},s=[],i=e.name||"default",o=e.fps||30,a=e.blendMode;let c=e.length||-1;const d=e.hierarchy||[];for(let m=0;m<d.length;m++){const v=d[m].keys;if(!(!v||v.length===0))if(v[0].morphTargets){const x={};let _;for(_=0;_<v.length;_++)if(v[_].morphTargets)for(let b=0;b<v[_].morphTargets.length;b++)x[v[_].morphTargets[b]]=-1;for(const b in x){const w=[],S=[];for(let C=0;C!==v[_].morphTargets.length;++C){const T=v[_];w.push(T.time),S.push(T.morphTarget===b?1:0)}s.push(new T0(".morphTargetInfluence["+b+"]",w,S))}c=x.length*o}else{const x=".bones["+t[m].name+"]";n(C0,x+".position",v,"pos",s),n(ev,x+".quaternion",v,"rot",s),n(C0,x+".scale",v,"scl",s)}}return s.length===0?null:new this(i,c,s,a)}resetDuration(){const e=this.tracks;let t=0;for(let n=0,s=e.length;n!==s;++n){const i=this.tracks[n];t=Math.max(t,i.times[i.times.length-1])}return this.duration=t,this}trim(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].trim(0,this.duration);return this}validate(){let e=!0;for(let t=0;t<this.tracks.length;t++)e=e&&this.tracks[t].validate();return e}optimize(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].optimize();return this}clone(){const e=[];for(let t=0;t<this.tracks.length;t++)e.push(this.tracks[t].clone());return new this.constructor(this.name,this.duration,e,this.blendMode)}toJSON(){return this.constructor.toJSON(this)}}function vq(r){switch(r.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return T0;case"vector":case"vector2":case"vector3":case"vector4":return C0;case"color":return OM;case"quaternion":return ev;case"bool":case"boolean":return bh;case"string":return Eh}throw new Error("THREE.KeyframeTrack: Unsupported typeName: "+r)}function xq(r){if(r.type===void 0)throw new Error("THREE.KeyframeTrack: track type undefined, can not parse");const e=vq(r.type);if(r.times===void 0){const t=[],n=[];DM(r.keys,t,n,"value"),r.times=t,r.values=n}return e.parse!==void 0?e.parse(r):new e(r.name,r.times,r.values,r.interpolation)}const Gl={enabled:!1,files:{},add:function(r,e){this.enabled!==!1&&(this.files[r]=e)},get:function(r){if(this.enabled!==!1)return this.files[r]},remove:function(r){delete this.files[r]},clear:function(){this.files={}}};class jM{constructor(e,t,n){const s=this;let i=!1,o=0,a=0,c;const d=[];this.onStart=void 0,this.onLoad=e,this.onProgress=t,this.onError=n,this.itemStart=function(f){a++,i===!1&&s.onStart!==void 0&&s.onStart(f,o,a),i=!0},this.itemEnd=function(f){o++,s.onProgress!==void 0&&s.onProgress(f,o,a),o===a&&(i=!1,s.onLoad!==void 0&&s.onLoad())},this.itemError=function(f){s.onError!==void 0&&s.onError(f)},this.resolveURL=function(f){return c?c(f):f},this.setURLModifier=function(f){return c=f,this},this.addHandler=function(f,m){return d.push(f,m),this},this.removeHandler=function(f){const m=d.indexOf(f);return m!==-1&&d.splice(m,2),this},this.getHandler=function(f){for(let m=0,v=d.length;m<v;m+=2){const x=d[m],_=d[m+1];if(x.global&&(x.lastIndex=0),x.test(f))return _}return null}}}const MD=new jM;class Li{constructor(e){this.manager=e!==void 0?e:MD,this.crossOrigin="anonymous",this.withCredentials=!1,this.path="",this.resourcePath="",this.requestHeader={}}load(){}loadAsync(e,t){const n=this;return new Promise(function(s,i){n.load(e,s,t,i)})}parse(){}setCrossOrigin(e){return this.crossOrigin=e,this}setWithCredentials(e){return this.withCredentials=e,this}setPath(e){return this.path=e,this}setResourcePath(e){return this.resourcePath=e,this}setRequestHeader(e){return this.requestHeader=e,this}}Li.DEFAULT_MATERIAL_NAME="__DEFAULT";const Ll={};class yq extends Error{constructor(e,t){super(e),this.response=t}}class nc extends Li{constructor(e){super(e),this.mimeType="",this.responseType=""}load(e,t,n,s){e===void 0&&(e=""),this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);const i=Gl.get(e);if(i!==void 0)return this.manager.itemStart(e),setTimeout(()=>{t&&t(i),this.manager.itemEnd(e)},0),i;if(Ll[e]!==void 0){Ll[e].push({onLoad:t,onProgress:n,onError:s});return}Ll[e]=[],Ll[e].push({onLoad:t,onProgress:n,onError:s});const o=new Request(e,{headers:new Headers(this.requestHeader),credentials:this.withCredentials?"include":"same-origin"}),a=this.mimeType,c=this.responseType;fetch(o).then(d=>{if(d.status===200||d.status===0){if(d.status===0&&console.warn("THREE.FileLoader: HTTP Status 0 received."),typeof ReadableStream>"u"||d.body===void 0||d.body.getReader===void 0)return d;const f=Ll[e],m=d.body.getReader(),v=d.headers.get("X-File-Size")||d.headers.get("Content-Length"),x=v?parseInt(v):0,_=x!==0;let b=0;const w=new ReadableStream({start(S){C();function C(){m.read().then(({done:T,value:A})=>{if(T)S.close();else{b+=A.byteLength;const k=new ProgressEvent("progress",{lengthComputable:_,loaded:b,total:x});for(let j=0,D=f.length;j<D;j++){const L=f[j];L.onProgress&&L.onProgress(k)}S.enqueue(A),C()}},T=>{S.error(T)})}}});return new Response(w)}else throw new yq(`fetch for "${d.url}" responded with ${d.status}: ${d.statusText}`,d)}).then(d=>{switch(c){case"arraybuffer":return d.arrayBuffer();case"blob":return d.blob();case"document":return d.text().then(f=>new DOMParser().parseFromString(f,a));case"json":return d.json();default:if(a==="")return d.text();{const m=/charset="?([^;"\s]*)"?/i.exec(a),v=m&&m[1]?m[1].toLowerCase():void 0,x=new TextDecoder(v);return d.arrayBuffer().then(_=>x.decode(_))}}}).then(d=>{Gl.add(e,d);const f=Ll[e];delete Ll[e];for(let m=0,v=f.length;m<v;m++){const x=f[m];x.onLoad&&x.onLoad(d)}}).catch(d=>{const f=Ll[e];if(f===void 0)throw this.manager.itemError(e),d;delete Ll[e];for(let m=0,v=f.length;m<v;m++){const x=f[m];x.onError&&x.onError(d)}this.manager.itemError(e)}).finally(()=>{this.manager.itemEnd(e)}),this.manager.itemStart(e)}setResponseType(e){return this.responseType=e,this}setMimeType(e){return this.mimeType=e,this}}class _q extends Li{constructor(e){super(e)}load(e,t,n,s){const i=this,o=new nc(this.manager);o.setPath(this.path),o.setRequestHeader(this.requestHeader),o.setWithCredentials(this.withCredentials),o.load(e,function(a){try{t(i.parse(JSON.parse(a)))}catch(c){s?s(c):console.error(c),i.manager.itemError(e)}},n,s)}parse(e){const t=[];for(let n=0;n<e.length;n++){const s=A0.parse(e[n]);t.push(s)}return t}}class wq extends Li{constructor(e){super(e)}load(e,t,n,s){const i=this,o=[],a=new pw,c=new nc(this.manager);c.setPath(this.path),c.setResponseType("arraybuffer"),c.setRequestHeader(this.requestHeader),c.setWithCredentials(i.withCredentials);let d=0;function f(m){c.load(e[m],function(v){const x=i.parse(v,!0);o[m]={width:x.width,height:x.height,format:x.format,mipmaps:x.mipmaps},d+=1,d===6&&(x.mipmapCount===1&&(a.minFilter=Qr),a.image=o,a.format=x.format,a.needsUpdate=!0,t&&t(a))},n,s)}if(Array.isArray(e))for(let m=0,v=e.length;m<v;++m)f(m);else c.load(e,function(m){const v=i.parse(m,!0);if(v.isCubemap){const x=v.mipmaps.length/v.mipmapCount;for(let _=0;_<x;_++){o[_]={mipmaps:[]};for(let b=0;b<v.mipmapCount;b++)o[_].mipmaps.push(v.mipmaps[_*v.mipmapCount+b]),o[_].format=v.format,o[_].width=v.width,o[_].height=v.height}a.image=o}else a.image.width=v.width,a.image.height=v.height,a.mipmaps=v.mipmaps;v.mipmapCount===1&&(a.minFilter=Qr),a.format=v.format,a.needsUpdate=!0,t&&t(a)},n,s);return a}}class R0 extends Li{constructor(e){super(e)}load(e,t,n,s){this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);const i=this,o=Gl.get(e);if(o!==void 0)return i.manager.itemStart(e),setTimeout(function(){t&&t(o),i.manager.itemEnd(e)},0),o;const a=S0("img");function c(){f(),Gl.add(e,this),t&&t(this),i.manager.itemEnd(e)}function d(m){f(),s&&s(m),i.manager.itemError(e),i.manager.itemEnd(e)}function f(){a.removeEventListener("load",c,!1),a.removeEventListener("error",d,!1)}return a.addEventListener("load",c,!1),a.addEventListener("error",d,!1),e.slice(0,5)!=="data:"&&this.crossOrigin!==void 0&&(a.crossOrigin=this.crossOrigin),i.manager.itemStart(e),a.src=e,a}}class Sq extends Li{constructor(e){super(e)}load(e,t,n,s){const i=new X0;i.colorSpace=Ni;const o=new R0(this.manager);o.setCrossOrigin(this.crossOrigin),o.setPath(this.path);let a=0;function c(d){o.load(e[d],function(f){i.images[d]=f,a++,a===6&&(i.needsUpdate=!0,t&&t(i))},void 0,s)}for(let d=0;d<e.length;++d)c(d);return i}}class bq extends Li{constructor(e){super(e)}load(e,t,n,s){const i=this,o=new Ba,a=new nc(this.manager);return a.setResponseType("arraybuffer"),a.setRequestHeader(this.requestHeader),a.setPath(this.path),a.setWithCredentials(i.withCredentials),a.load(e,function(c){let d;try{d=i.parse(c)}catch(f){if(s!==void 0)s(f);else{console.error(f);return}}d.image!==void 0?o.image=d.image:d.data!==void 0&&(o.image.width=d.width,o.image.height=d.height,o.image.data=d.data),o.wrapS=d.wrapS!==void 0?d.wrapS:vo,o.wrapT=d.wrapT!==void 0?d.wrapT:vo,o.magFilter=d.magFilter!==void 0?d.magFilter:Qr,o.minFilter=d.minFilter!==void 0?d.minFilter:Qr,o.anisotropy=d.anisotropy!==void 0?d.anisotropy:1,d.colorSpace!==void 0&&(o.colorSpace=d.colorSpace),d.flipY!==void 0&&(o.flipY=d.flipY),d.format!==void 0&&(o.format=d.format),d.type!==void 0&&(o.type=d.type),d.mipmaps!==void 0&&(o.mipmaps=d.mipmaps,o.minFilter=La),d.mipmapCount===1&&(o.minFilter=Qr),d.generateMipmaps!==void 0&&(o.generateMipmaps=d.generateMipmaps),o.needsUpdate=!0,t&&t(o,d)},n,s),o}}class Eq extends Li{constructor(e){super(e)}load(e,t,n,s){const i=new _r,o=new R0(this.manager);return o.setCrossOrigin(this.crossOrigin),o.setPath(this.path),o.load(e,function(a){i.image=a,i.needsUpdate=!0,t!==void 0&&t(i)},n,s),i}}class Au extends jn{constructor(e,t=1){super(),this.isLight=!0,this.type="Light",this.color=new St(e),this.intensity=t}dispose(){}copy(e,t){return super.copy(e,t),this.color.copy(e.color),this.intensity=e.intensity,this}toJSON(e){const t=super.toJSON(e);return t.object.color=this.color.getHex(),t.object.intensity=this.intensity,this.groundColor!==void 0&&(t.object.groundColor=this.groundColor.getHex()),this.distance!==void 0&&(t.object.distance=this.distance),this.angle!==void 0&&(t.object.angle=this.angle),this.decay!==void 0&&(t.object.decay=this.decay),this.penumbra!==void 0&&(t.object.penumbra=this.penumbra),this.shadow!==void 0&&(t.object.shadow=this.shadow.toJSON()),this.target!==void 0&&(t.object.target=this.target.uuid),t}}class TD extends Au{constructor(e,t,n){super(e,n),this.isHemisphereLight=!0,this.type="HemisphereLight",this.position.copy(jn.DEFAULT_UP),this.updateMatrix(),this.groundColor=new St(t)}copy(e,t){return super.copy(e,t),this.groundColor.copy(e.groundColor),this}}const pS=new Jt,rA=new J,sA=new J;class FM{constructor(e){this.camera=e,this.intensity=1,this.bias=0,this.normalBias=0,this.radius=1,this.blurSamples=8,this.mapSize=new Ve(512,512),this.mapType=_o,this.map=null,this.mapPass=null,this.matrix=new Jt,this.autoUpdate=!0,this.needsUpdate=!1,this._frustum=new pm,this._frameExtents=new Ve(1,1),this._viewportCount=1,this._viewports=[new On(0,0,1,1)]}getViewportCount(){return this._viewportCount}getFrustum(){return this._frustum}updateMatrices(e){const t=this.camera,n=this.matrix;rA.setFromMatrixPosition(e.matrixWorld),t.position.copy(rA),sA.setFromMatrixPosition(e.target.matrixWorld),t.lookAt(sA),t.updateMatrixWorld(),pS.multiplyMatrices(t.projectionMatrix,t.matrixWorldInverse),this._frustum.setFromProjectionMatrix(pS),n.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),n.multiply(pS)}getViewport(e){return this._viewports[e]}getFrameExtents(){return this._frameExtents}dispose(){this.map&&this.map.dispose(),this.mapPass&&this.mapPass.dispose()}copy(e){return this.camera=e.camera.clone(),this.intensity=e.intensity,this.bias=e.bias,this.radius=e.radius,this.autoUpdate=e.autoUpdate,this.needsUpdate=e.needsUpdate,this.normalBias=e.normalBias,this.blurSamples=e.blurSamples,this.mapSize.copy(e.mapSize),this}clone(){return new this.constructor().copy(this)}toJSON(){const e={};return this.intensity!==1&&(e.intensity=this.intensity),this.bias!==0&&(e.bias=this.bias),this.normalBias!==0&&(e.normalBias=this.normalBias),this.radius!==1&&(e.radius=this.radius),(this.mapSize.x!==512||this.mapSize.y!==512)&&(e.mapSize=this.mapSize.toArray()),e.camera=this.camera.toJSON(!1).object,delete e.camera.matrix,e}}class Mq extends FM{constructor(){super(new Cr(50,1,.5,500)),this.isSpotLightShadow=!0,this.focus=1,this.aspect=1}updateMatrices(e){const t=this.camera,n=qp*2*e.angle*this.focus,s=this.mapSize.width/this.mapSize.height*this.aspect,i=e.distance||t.far;(n!==t.fov||s!==t.aspect||i!==t.far)&&(t.fov=n,t.aspect=s,t.far=i,t.updateProjectionMatrix()),super.updateMatrices(e)}copy(e){return super.copy(e),this.focus=e.focus,this}}class CD extends Au{constructor(e,t,n=0,s=Math.PI/3,i=0,o=2){super(e,t),this.isSpotLight=!0,this.type="SpotLight",this.position.copy(jn.DEFAULT_UP),this.updateMatrix(),this.target=new jn,this.distance=n,this.angle=s,this.penumbra=i,this.decay=o,this.map=null,this.shadow=new Mq}get power(){return this.intensity*Math.PI}set power(e){this.intensity=e/Math.PI}dispose(){this.shadow.dispose()}copy(e,t){return super.copy(e,t),this.distance=e.distance,this.angle=e.angle,this.penumbra=e.penumbra,this.decay=e.decay,this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}const iA=new Jt,Ag=new J,mS=new J;class Tq extends FM{constructor(){super(new Cr(90,1,.5,500)),this.isPointLightShadow=!0,this._frameExtents=new Ve(4,2),this._viewportCount=6,this._viewports=[new On(2,1,1,1),new On(0,1,1,1),new On(3,1,1,1),new On(1,1,1,1),new On(3,0,1,1),new On(1,0,1,1)],this._cubeDirections=[new J(1,0,0),new J(-1,0,0),new J(0,0,1),new J(0,0,-1),new J(0,1,0),new J(0,-1,0)],this._cubeUps=[new J(0,1,0),new J(0,1,0),new J(0,1,0),new J(0,1,0),new J(0,0,1),new J(0,0,-1)]}updateMatrices(e,t=0){const n=this.camera,s=this.matrix,i=e.distance||n.far;i!==n.far&&(n.far=i,n.updateProjectionMatrix()),Ag.setFromMatrixPosition(e.matrixWorld),n.position.copy(Ag),mS.copy(n.position),mS.add(this._cubeDirections[t]),n.up.copy(this._cubeUps[t]),n.lookAt(mS),n.updateMatrixWorld(),s.makeTranslation(-Ag.x,-Ag.y,-Ag.z),iA.multiplyMatrices(n.projectionMatrix,n.matrixWorldInverse),this._frustum.setFromProjectionMatrix(iA)}}class AD extends Au{constructor(e,t,n=0,s=2){super(e,t),this.isPointLight=!0,this.type="PointLight",this.distance=n,this.decay=s,this.shadow=new Tq}get power(){return this.intensity*4*Math.PI}set power(e){this.intensity=e/(4*Math.PI)}dispose(){this.shadow.dispose()}copy(e,t){return super.copy(e,t),this.distance=e.distance,this.decay=e.decay,this.shadow=e.shadow.clone(),this}}class hu extends q0{constructor(e=-1,t=1,n=1,s=-1,i=.1,o=2e3){super(),this.isOrthographicCamera=!0,this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=e,this.right=t,this.top=n,this.bottom=s,this.near=i,this.far=o,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.left=e.left,this.right=e.right,this.top=e.top,this.bottom=e.bottom,this.near=e.near,this.far=e.far,this.zoom=e.zoom,this.view=e.view===null?null:Object.assign({},e.view),this}setViewOffset(e,t,n,s,i,o){this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=n,this.view.offsetY=s,this.view.width=i,this.view.height=o,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=(this.right-this.left)/(2*this.zoom),t=(this.top-this.bottom)/(2*this.zoom),n=(this.right+this.left)/2,s=(this.top+this.bottom)/2;let i=n-e,o=n+e,a=s+t,c=s-t;if(this.view!==null&&this.view.enabled){const d=(this.right-this.left)/this.view.fullWidth/this.zoom,f=(this.top-this.bottom)/this.view.fullHeight/this.zoom;i+=d*this.view.offsetX,o=i+d*this.view.width,a-=f*this.view.offsetY,c=a-f*this.view.height}this.projectionMatrix.makeOrthographic(i,o,a,c,this.near,this.far,this.coordinateSystem),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const t=super.toJSON(e);return t.object.zoom=this.zoom,t.object.left=this.left,t.object.right=this.right,t.object.top=this.top,t.object.bottom=this.bottom,t.object.near=this.near,t.object.far=this.far,this.view!==null&&(t.object.view=Object.assign({},this.view)),t}}class Cq extends FM{constructor(){super(new hu(-5,5,5,-5,.5,500)),this.isDirectionalLightShadow=!0}}class RD extends Au{constructor(e,t){super(e,t),this.isDirectionalLight=!0,this.type="DirectionalLight",this.position.copy(jn.DEFAULT_UP),this.updateMatrix(),this.target=new jn,this.shadow=new Cq}dispose(){this.shadow.dispose()}copy(e){return super.copy(e),this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}class ND extends Au{constructor(e,t){super(e,t),this.isAmbientLight=!0,this.type="AmbientLight"}}class PD extends Au{constructor(e,t,n=10,s=10){super(e,t),this.isRectAreaLight=!0,this.type="RectAreaLight",this.width=n,this.height=s}get power(){return this.intensity*this.width*this.height*Math.PI}set power(e){this.intensity=e/(this.width*this.height*Math.PI)}copy(e){return super.copy(e),this.width=e.width,this.height=e.height,this}toJSON(e){const t=super.toJSON(e);return t.object.width=this.width,t.object.height=this.height,t}}class ID{constructor(){this.isSphericalHarmonics3=!0,this.coefficients=[];for(let e=0;e<9;e++)this.coefficients.push(new J)}set(e){for(let t=0;t<9;t++)this.coefficients[t].copy(e[t]);return this}zero(){for(let e=0;e<9;e++)this.coefficients[e].set(0,0,0);return this}getAt(e,t){const n=e.x,s=e.y,i=e.z,o=this.coefficients;return t.copy(o[0]).multiplyScalar(.282095),t.addScaledVector(o[1],.488603*s),t.addScaledVector(o[2],.488603*i),t.addScaledVector(o[3],.488603*n),t.addScaledVector(o[4],1.092548*(n*s)),t.addScaledVector(o[5],1.092548*(s*i)),t.addScaledVector(o[6],.315392*(3*i*i-1)),t.addScaledVector(o[7],1.092548*(n*i)),t.addScaledVector(o[8],.546274*(n*n-s*s)),t}getIrradianceAt(e,t){const n=e.x,s=e.y,i=e.z,o=this.coefficients;return t.copy(o[0]).multiplyScalar(.886227),t.addScaledVector(o[1],2*.511664*s),t.addScaledVector(o[2],2*.511664*i),t.addScaledVector(o[3],2*.511664*n),t.addScaledVector(o[4],2*.429043*n*s),t.addScaledVector(o[5],2*.429043*s*i),t.addScaledVector(o[6],.743125*i*i-.247708),t.addScaledVector(o[7],2*.429043*n*i),t.addScaledVector(o[8],.429043*(n*n-s*s)),t}add(e){for(let t=0;t<9;t++)this.coefficients[t].add(e.coefficients[t]);return this}addScaledSH(e,t){for(let n=0;n<9;n++)this.coefficients[n].addScaledVector(e.coefficients[n],t);return this}scale(e){for(let t=0;t<9;t++)this.coefficients[t].multiplyScalar(e);return this}lerp(e,t){for(let n=0;n<9;n++)this.coefficients[n].lerp(e.coefficients[n],t);return this}equals(e){for(let t=0;t<9;t++)if(!this.coefficients[t].equals(e.coefficients[t]))return!1;return!0}copy(e){return this.set(e.coefficients)}clone(){return new this.constructor().copy(this)}fromArray(e,t=0){const n=this.coefficients;for(let s=0;s<9;s++)n[s].fromArray(e,t+s*3);return this}toArray(e=[],t=0){const n=this.coefficients;for(let s=0;s<9;s++)n[s].toArray(e,t+s*3);return e}static getBasisAt(e,t){const n=e.x,s=e.y,i=e.z;t[0]=.282095,t[1]=.488603*s,t[2]=.488603*i,t[3]=.488603*n,t[4]=1.092548*n*s,t[5]=1.092548*s*i,t[6]=.315392*(3*i*i-1),t[7]=1.092548*n*i,t[8]=.546274*(n*n-s*s)}}class kD extends Au{constructor(e=new ID,t=1){super(void 0,t),this.isLightProbe=!0,this.sh=e}copy(e){return super.copy(e),this.sh.copy(e.sh),this}fromJSON(e){return this.intensity=e.intensity,this.sh.fromArray(e.sh),this}toJSON(e){const t=super.toJSON(e);return t.object.sh=this.sh.toArray(),t}}class Aw extends Li{constructor(e){super(e),this.textures={}}load(e,t,n,s){const i=this,o=new nc(i.manager);o.setPath(i.path),o.setRequestHeader(i.requestHeader),o.setWithCredentials(i.withCredentials),o.load(e,function(a){try{t(i.parse(JSON.parse(a)))}catch(c){s?s(c):console.error(c),i.manager.itemError(e)}},n,s)}parse(e){const t=this.textures;function n(i){return t[i]===void 0&&console.warn("THREE.MaterialLoader: Undefined texture",i),t[i]}const s=this.createMaterialFromType(e.type);if(e.uuid!==void 0&&(s.uuid=e.uuid),e.name!==void 0&&(s.name=e.name),e.color!==void 0&&s.color!==void 0&&s.color.setHex(e.color),e.roughness!==void 0&&(s.roughness=e.roughness),e.metalness!==void 0&&(s.metalness=e.metalness),e.sheen!==void 0&&(s.sheen=e.sheen),e.sheenColor!==void 0&&(s.sheenColor=new St().setHex(e.sheenColor)),e.sheenRoughness!==void 0&&(s.sheenRoughness=e.sheenRoughness),e.emissive!==void 0&&s.emissive!==void 0&&s.emissive.setHex(e.emissive),e.specular!==void 0&&s.specular!==void 0&&s.specular.setHex(e.specular),e.specularIntensity!==void 0&&(s.specularIntensity=e.specularIntensity),e.specularColor!==void 0&&s.specularColor!==void 0&&s.specularColor.setHex(e.specularColor),e.shininess!==void 0&&(s.shininess=e.shininess),e.clearcoat!==void 0&&(s.clearcoat=e.clearcoat),e.clearcoatRoughness!==void 0&&(s.clearcoatRoughness=e.clearcoatRoughness),e.dispersion!==void 0&&(s.dispersion=e.dispersion),e.iridescence!==void 0&&(s.iridescence=e.iridescence),e.iridescenceIOR!==void 0&&(s.iridescenceIOR=e.iridescenceIOR),e.iridescenceThicknessRange!==void 0&&(s.iridescenceThicknessRange=e.iridescenceThicknessRange),e.transmission!==void 0&&(s.transmission=e.transmission),e.thickness!==void 0&&(s.thickness=e.thickness),e.attenuationDistance!==void 0&&(s.attenuationDistance=e.attenuationDistance),e.attenuationColor!==void 0&&s.attenuationColor!==void 0&&s.attenuationColor.setHex(e.attenuationColor),e.anisotropy!==void 0&&(s.anisotropy=e.anisotropy),e.anisotropyRotation!==void 0&&(s.anisotropyRotation=e.anisotropyRotation),e.fog!==void 0&&(s.fog=e.fog),e.flatShading!==void 0&&(s.flatShading=e.flatShading),e.blending!==void 0&&(s.blending=e.blending),e.combine!==void 0&&(s.combine=e.combine),e.side!==void 0&&(s.side=e.side),e.shadowSide!==void 0&&(s.shadowSide=e.shadowSide),e.opacity!==void 0&&(s.opacity=e.opacity),e.transparent!==void 0&&(s.transparent=e.transparent),e.alphaTest!==void 0&&(s.alphaTest=e.alphaTest),e.alphaHash!==void 0&&(s.alphaHash=e.alphaHash),e.depthFunc!==void 0&&(s.depthFunc=e.depthFunc),e.depthTest!==void 0&&(s.depthTest=e.depthTest),e.depthWrite!==void 0&&(s.depthWrite=e.depthWrite),e.colorWrite!==void 0&&(s.colorWrite=e.colorWrite),e.blendSrc!==void 0&&(s.blendSrc=e.blendSrc),e.blendDst!==void 0&&(s.blendDst=e.blendDst),e.blendEquation!==void 0&&(s.blendEquation=e.blendEquation),e.blendSrcAlpha!==void 0&&(s.blendSrcAlpha=e.blendSrcAlpha),e.blendDstAlpha!==void 0&&(s.blendDstAlpha=e.blendDstAlpha),e.blendEquationAlpha!==void 0&&(s.blendEquationAlpha=e.blendEquationAlpha),e.blendColor!==void 0&&s.blendColor!==void 0&&s.blendColor.setHex(e.blendColor),e.blendAlpha!==void 0&&(s.blendAlpha=e.blendAlpha),e.stencilWriteMask!==void 0&&(s.stencilWriteMask=e.stencilWriteMask),e.stencilFunc!==void 0&&(s.stencilFunc=e.stencilFunc),e.stencilRef!==void 0&&(s.stencilRef=e.stencilRef),e.stencilFuncMask!==void 0&&(s.stencilFuncMask=e.stencilFuncMask),e.stencilFail!==void 0&&(s.stencilFail=e.stencilFail),e.stencilZFail!==void 0&&(s.stencilZFail=e.stencilZFail),e.stencilZPass!==void 0&&(s.stencilZPass=e.stencilZPass),e.stencilWrite!==void 0&&(s.stencilWrite=e.stencilWrite),e.wireframe!==void 0&&(s.wireframe=e.wireframe),e.wireframeLinewidth!==void 0&&(s.wireframeLinewidth=e.wireframeLinewidth),e.wireframeLinecap!==void 0&&(s.wireframeLinecap=e.wireframeLinecap),e.wireframeLinejoin!==void 0&&(s.wireframeLinejoin=e.wireframeLinejoin),e.rotation!==void 0&&(s.rotation=e.rotation),e.linewidth!==void 0&&(s.linewidth=e.linewidth),e.dashSize!==void 0&&(s.dashSize=e.dashSize),e.gapSize!==void 0&&(s.gapSize=e.gapSize),e.scale!==void 0&&(s.scale=e.scale),e.polygonOffset!==void 0&&(s.polygonOffset=e.polygonOffset),e.polygonOffsetFactor!==void 0&&(s.polygonOffsetFactor=e.polygonOffsetFactor),e.polygonOffsetUnits!==void 0&&(s.polygonOffsetUnits=e.polygonOffsetUnits),e.dithering!==void 0&&(s.dithering=e.dithering),e.alphaToCoverage!==void 0&&(s.alphaToCoverage=e.alphaToCoverage),e.premultipliedAlpha!==void 0&&(s.premultipliedAlpha=e.premultipliedAlpha),e.forceSinglePass!==void 0&&(s.forceSinglePass=e.forceSinglePass),e.visible!==void 0&&(s.visible=e.visible),e.toneMapped!==void 0&&(s.toneMapped=e.toneMapped),e.userData!==void 0&&(s.userData=e.userData),e.vertexColors!==void 0&&(typeof e.vertexColors=="number"?s.vertexColors=e.vertexColors>0:s.vertexColors=e.vertexColors),e.uniforms!==void 0)for(const i in e.uniforms){const o=e.uniforms[i];switch(s.uniforms[i]={},o.type){case"t":s.uniforms[i].value=n(o.value);break;case"c":s.uniforms[i].value=new St().setHex(o.value);break;case"v2":s.uniforms[i].value=new Ve().fromArray(o.value);break;case"v3":s.uniforms[i].value=new J().fromArray(o.value);break;case"v4":s.uniforms[i].value=new On().fromArray(o.value);break;case"m3":s.uniforms[i].value=new cn().fromArray(o.value);break;case"m4":s.uniforms[i].value=new Jt().fromArray(o.value);break;default:s.uniforms[i].value=o.value}}if(e.defines!==void 0&&(s.defines=e.defines),e.vertexShader!==void 0&&(s.vertexShader=e.vertexShader),e.fragmentShader!==void 0&&(s.fragmentShader=e.fragmentShader),e.glslVersion!==void 0&&(s.glslVersion=e.glslVersion),e.extensions!==void 0)for(const i in e.extensions)s.extensions[i]=e.extensions[i];if(e.lights!==void 0&&(s.lights=e.lights),e.clipping!==void 0&&(s.clipping=e.clipping),e.size!==void 0&&(s.size=e.size),e.sizeAttenuation!==void 0&&(s.sizeAttenuation=e.sizeAttenuation),e.map!==void 0&&(s.map=n(e.map)),e.matcap!==void 0&&(s.matcap=n(e.matcap)),e.alphaMap!==void 0&&(s.alphaMap=n(e.alphaMap)),e.bumpMap!==void 0&&(s.bumpMap=n(e.bumpMap)),e.bumpScale!==void 0&&(s.bumpScale=e.bumpScale),e.normalMap!==void 0&&(s.normalMap=n(e.normalMap)),e.normalMapType!==void 0&&(s.normalMapType=e.normalMapType),e.normalScale!==void 0){let i=e.normalScale;Array.isArray(i)===!1&&(i=[i,i]),s.normalScale=new Ve().fromArray(i)}return e.displacementMap!==void 0&&(s.displacementMap=n(e.displacementMap)),e.displacementScale!==void 0&&(s.displacementScale=e.displacementScale),e.displacementBias!==void 0&&(s.displacementBias=e.displacementBias),e.roughnessMap!==void 0&&(s.roughnessMap=n(e.roughnessMap)),e.metalnessMap!==void 0&&(s.metalnessMap=n(e.metalnessMap)),e.emissiveMap!==void 0&&(s.emissiveMap=n(e.emissiveMap)),e.emissiveIntensity!==void 0&&(s.emissiveIntensity=e.emissiveIntensity),e.specularMap!==void 0&&(s.specularMap=n(e.specularMap)),e.specularIntensityMap!==void 0&&(s.specularIntensityMap=n(e.specularIntensityMap)),e.specularColorMap!==void 0&&(s.specularColorMap=n(e.specularColorMap)),e.envMap!==void 0&&(s.envMap=n(e.envMap)),e.envMapRotation!==void 0&&s.envMapRotation.fromArray(e.envMapRotation),e.envMapIntensity!==void 0&&(s.envMapIntensity=e.envMapIntensity),e.reflectivity!==void 0&&(s.reflectivity=e.reflectivity),e.refractionRatio!==void 0&&(s.refractionRatio=e.refractionRatio),e.lightMap!==void 0&&(s.lightMap=n(e.lightMap)),e.lightMapIntensity!==void 0&&(s.lightMapIntensity=e.lightMapIntensity),e.aoMap!==void 0&&(s.aoMap=n(e.aoMap)),e.aoMapIntensity!==void 0&&(s.aoMapIntensity=e.aoMapIntensity),e.gradientMap!==void 0&&(s.gradientMap=n(e.gradientMap)),e.clearcoatMap!==void 0&&(s.clearcoatMap=n(e.clearcoatMap)),e.clearcoatRoughnessMap!==void 0&&(s.clearcoatRoughnessMap=n(e.clearcoatRoughnessMap)),e.clearcoatNormalMap!==void 0&&(s.clearcoatNormalMap=n(e.clearcoatNormalMap)),e.clearcoatNormalScale!==void 0&&(s.clearcoatNormalScale=new Ve().fromArray(e.clearcoatNormalScale)),e.iridescenceMap!==void 0&&(s.iridescenceMap=n(e.iridescenceMap)),e.iridescenceThicknessMap!==void 0&&(s.iridescenceThicknessMap=n(e.iridescenceThicknessMap)),e.transmissionMap!==void 0&&(s.transmissionMap=n(e.transmissionMap)),e.thicknessMap!==void 0&&(s.thicknessMap=n(e.thicknessMap)),e.anisotropyMap!==void 0&&(s.anisotropyMap=n(e.anisotropyMap)),e.sheenColorMap!==void 0&&(s.sheenColorMap=n(e.sheenColorMap)),e.sheenRoughnessMap!==void 0&&(s.sheenRoughnessMap=n(e.sheenRoughnessMap)),s}setTextures(e){return this.textures=e,this}createMaterialFromType(e){return Aw.createMaterialFromType(e)}static createMaterialFromType(e){const t={ShadowMaterial:dD,SpriteMaterial:wM,RawShaderMaterial:hD,ShaderMaterial:la,PointsMaterial:bM,MeshPhysicalMaterial:fD,MeshStandardMaterial:PM,MeshPhongMaterial:pD,MeshToonMaterial:mD,MeshNormalMaterial:gD,MeshLambertMaterial:vD,MeshDepthMaterial:IM,MeshDistanceMaterial:kM,MeshBasicMaterial:Tu,MeshMatcapMaterial:xD,LineDashedMaterial:yD,LineBasicMaterial:di,Material:$s};return new t[e]}}class Vb{static extractUrlBase(e){const t=e.lastIndexOf("/");return t===-1?"./":e.slice(0,t+1)}static resolveURL(e,t){return typeof e!="string"||e===""?"":(/^https?:\/\//i.test(t)&&/^\//.test(e)&&(t=t.replace(/(^https?:\/\/[^\/]+).*/i,"$1")),/^(https?:)?\/\//i.test(e)||/^data:.*,.*$/i.test(e)||/^blob:.*$/i.test(e)?e:t+e)}}class DD extends mn{constructor(){super(),this.isInstancedBufferGeometry=!0,this.type="InstancedBufferGeometry",this.instanceCount=1/0}copy(e){return super.copy(e),this.instanceCount=e.instanceCount,this}toJSON(){const e=super.toJSON();return e.instanceCount=this.instanceCount,e.isInstancedBufferGeometry=!0,e}}class LD extends Li{constructor(e){super(e)}load(e,t,n,s){const i=this,o=new nc(i.manager);o.setPath(i.path),o.setRequestHeader(i.requestHeader),o.setWithCredentials(i.withCredentials),o.load(e,function(a){try{t(i.parse(JSON.parse(a)))}catch(c){s?s(c):console.error(c),i.manager.itemError(e)}},n,s)}parse(e){const t={},n={};function s(x,_){if(t[_]!==void 0)return t[_];const w=x.interleavedBuffers[_],S=i(x,w.buffer),C=xp(w.type,S),T=new dw(C,w.stride);return T.uuid=w.uuid,t[_]=T,T}function i(x,_){if(n[_]!==void 0)return n[_];const w=x.arrayBuffers[_],S=new Uint32Array(w).buffer;return n[_]=S,S}const o=e.isInstancedBufferGeometry?new DD:new mn,a=e.data.index;if(a!==void 0){const x=xp(a.type,a.array);o.setIndex(new Kn(x,1))}const c=e.data.attributes;for(const x in c){const _=c[x];let b;if(_.isInterleavedBufferAttribute){const w=s(e.data,_.data);b=new fh(w,_.itemSize,_.offset,_.normalized)}else{const w=xp(_.type,_.array),S=_.isInstancedBufferAttribute?Yp:Kn;b=new S(w,_.itemSize,_.normalized)}_.name!==void 0&&(b.name=_.name),_.usage!==void 0&&b.setUsage(_.usage),o.setAttribute(x,b)}const d=e.data.morphAttributes;if(d)for(const x in d){const _=d[x],b=[];for(let w=0,S=_.length;w<S;w++){const C=_[w];let T;if(C.isInterleavedBufferAttribute){const A=s(e.data,C.data);T=new fh(A,C.itemSize,C.offset,C.normalized)}else{const A=xp(C.type,C.array);T=new Kn(A,C.itemSize,C.normalized)}C.name!==void 0&&(T.name=C.name),b.push(T)}o.morphAttributes[x]=b}e.data.morphTargetsRelative&&(o.morphTargetsRelative=!0);const m=e.data.groups||e.data.drawcalls||e.data.offsets;if(m!==void 0)for(let x=0,_=m.length;x!==_;++x){const b=m[x];o.addGroup(b.start,b.count,b.materialIndex)}const v=e.data.boundingSphere;return v!==void 0&&(o.boundingSphere=new bs().fromJSON(v)),e.name&&(o.name=e.name),e.userData&&(o.userData=e.userData),o}}class Aq extends Li{constructor(e){super(e)}load(e,t,n,s){const i=this,o=this.path===""?Vb.extractUrlBase(e):this.path;this.resourcePath=this.resourcePath||o;const a=new nc(this.manager);a.setPath(this.path),a.setRequestHeader(this.requestHeader),a.setWithCredentials(this.withCredentials),a.load(e,function(c){let d=null;try{d=JSON.parse(c)}catch(m){s!==void 0&&s(m),console.error("THREE:ObjectLoader: Can't parse "+e+".",m.message);return}const f=d.metadata;if(f===void 0||f.type===void 0||f.type.toLowerCase()==="geometry"){s!==void 0&&s(new Error("THREE.ObjectLoader: Can't load "+e)),console.error("THREE.ObjectLoader: Can't load "+e);return}i.parse(d,t)},n,s)}async loadAsync(e,t){const n=this,s=this.path===""?Vb.extractUrlBase(e):this.path;this.resourcePath=this.resourcePath||s;const i=new nc(this.manager);i.setPath(this.path),i.setRequestHeader(this.requestHeader),i.setWithCredentials(this.withCredentials);const o=await i.loadAsync(e,t),a=JSON.parse(o),c=a.metadata;if(c===void 0||c.type===void 0||c.type.toLowerCase()==="geometry")throw new Error("THREE.ObjectLoader: Can't load "+e);return await n.parseAsync(a)}parse(e,t){const n=this.parseAnimations(e.animations),s=this.parseShapes(e.shapes),i=this.parseGeometries(e.geometries,s),o=this.parseImages(e.images,function(){t!==void 0&&t(d)}),a=this.parseTextures(e.textures,o),c=this.parseMaterials(e.materials,a),d=this.parseObject(e.object,i,c,a,n),f=this.parseSkeletons(e.skeletons,d);if(this.bindSkeletons(d,f),this.bindLightTargets(d),t!==void 0){let m=!1;for(const v in o)if(o[v].data instanceof HTMLImageElement){m=!0;break}m===!1&&t(d)}return d}async parseAsync(e){const t=this.parseAnimations(e.animations),n=this.parseShapes(e.shapes),s=this.parseGeometries(e.geometries,n),i=await this.parseImagesAsync(e.images),o=this.parseTextures(e.textures,i),a=this.parseMaterials(e.materials,o),c=this.parseObject(e.object,s,a,o,t),d=this.parseSkeletons(e.skeletons,c);return this.bindSkeletons(c,d),this.bindLightTargets(c),c}parseShapes(e){const t={};if(e!==void 0)for(let n=0,s=e.length;n<s;n++){const i=new eh().fromJSON(e[n]);t[i.uuid]=i}return t}parseSkeletons(e,t){const n={},s={};if(t.traverse(function(i){i.isBone&&(s[i.uuid]=i)}),e!==void 0)for(let i=0,o=e.length;i<o;i++){const a=new hw().fromJSON(e[i],s);n[a.uuid]=a}return n}parseGeometries(e,t){const n={};if(e!==void 0){const s=new LD;for(let i=0,o=e.length;i<o;i++){let a;const c=e[i];switch(c.type){case"BufferGeometry":case"InstancedBufferGeometry":a=s.parse(c);break;default:c.type in nA?a=nA[c.type].fromJSON(c,t):console.warn(`THREE.ObjectLoader: Unsupported geometry type "${c.type}"`)}a.uuid=c.uuid,c.name!==void 0&&(a.name=c.name),c.userData!==void 0&&(a.userData=c.userData),n[c.uuid]=a}}return n}parseMaterials(e,t){const n={},s={};if(e!==void 0){const i=new Aw;i.setTextures(t);for(let o=0,a=e.length;o<a;o++){const c=e[o];n[c.uuid]===void 0&&(n[c.uuid]=i.parse(c)),s[c.uuid]=n[c.uuid]}}return s}parseAnimations(e){const t={};if(e!==void 0)for(let n=0;n<e.length;n++){const s=e[n],i=A0.parse(s);t[i.uuid]=i}return t}parseImages(e,t){const n=this,s={};let i;function o(c){return n.manager.itemStart(c),i.load(c,function(){n.manager.itemEnd(c)},void 0,function(){n.manager.itemError(c),n.manager.itemEnd(c)})}function a(c){if(typeof c=="string"){const d=c,f=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(d)?d:n.resourcePath+d;return o(f)}else return c.data?{data:xp(c.type,c.data),width:c.width,height:c.height}:null}if(e!==void 0&&e.length>0){const c=new jM(t);i=new R0(c),i.setCrossOrigin(this.crossOrigin);for(let d=0,f=e.length;d<f;d++){const m=e[d],v=m.url;if(Array.isArray(v)){const x=[];for(let _=0,b=v.length;_<b;_++){const w=v[_],S=a(w);S!==null&&(S instanceof HTMLImageElement?x.push(S):x.push(new Ba(S.data,S.width,S.height)))}s[m.uuid]=new au(x)}else{const x=a(m.url);s[m.uuid]=new au(x)}}}return s}async parseImagesAsync(e){const t=this,n={};let s;async function i(o){if(typeof o=="string"){const a=o,c=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(a)?a:t.resourcePath+a;return await s.loadAsync(c)}else return o.data?{data:xp(o.type,o.data),width:o.width,height:o.height}:null}if(e!==void 0&&e.length>0){s=new R0(this.manager),s.setCrossOrigin(this.crossOrigin);for(let o=0,a=e.length;o<a;o++){const c=e[o],d=c.url;if(Array.isArray(d)){const f=[];for(let m=0,v=d.length;m<v;m++){const x=d[m],_=await i(x);_!==null&&(_ instanceof HTMLImageElement?f.push(_):f.push(new Ba(_.data,_.width,_.height)))}n[c.uuid]=new au(f)}else{const f=await i(c.url);n[c.uuid]=new au(f)}}}return n}parseTextures(e,t){function n(i,o){return typeof i=="number"?i:(console.warn("THREE.ObjectLoader.parseTexture: Constant should be in numeric form.",i),o[i])}const s={};if(e!==void 0)for(let i=0,o=e.length;i<o;i++){const a=e[i];a.image===void 0&&console.warn('THREE.ObjectLoader: No "image" specified for',a.uuid),t[a.image]===void 0&&console.warn("THREE.ObjectLoader: Undefined image",a.image);const c=t[a.image],d=c.data;let f;Array.isArray(d)?(f=new X0,d.length===6&&(f.needsUpdate=!0)):(d&&d.data?f=new Ba:f=new _r,d&&(f.needsUpdate=!0)),f.source=c,f.uuid=a.uuid,a.name!==void 0&&(f.name=a.name),a.mapping!==void 0&&(f.mapping=n(a.mapping,Rq)),a.channel!==void 0&&(f.channel=a.channel),a.offset!==void 0&&f.offset.fromArray(a.offset),a.repeat!==void 0&&f.repeat.fromArray(a.repeat),a.center!==void 0&&f.center.fromArray(a.center),a.rotation!==void 0&&(f.rotation=a.rotation),a.wrap!==void 0&&(f.wrapS=n(a.wrap[0],oA),f.wrapT=n(a.wrap[1],oA)),a.format!==void 0&&(f.format=a.format),a.internalFormat!==void 0&&(f.internalFormat=a.internalFormat),a.type!==void 0&&(f.type=a.type),a.colorSpace!==void 0&&(f.colorSpace=a.colorSpace),a.minFilter!==void 0&&(f.minFilter=n(a.minFilter,aA)),a.magFilter!==void 0&&(f.magFilter=n(a.magFilter,aA)),a.anisotropy!==void 0&&(f.anisotropy=a.anisotropy),a.flipY!==void 0&&(f.flipY=a.flipY),a.generateMipmaps!==void 0&&(f.generateMipmaps=a.generateMipmaps),a.premultiplyAlpha!==void 0&&(f.premultiplyAlpha=a.premultiplyAlpha),a.unpackAlignment!==void 0&&(f.unpackAlignment=a.unpackAlignment),a.compareFunction!==void 0&&(f.compareFunction=a.compareFunction),a.userData!==void 0&&(f.userData=a.userData),s[a.uuid]=f}return s}parseObject(e,t,n,s,i){let o;function a(v){return t[v]===void 0&&console.warn("THREE.ObjectLoader: Undefined geometry",v),t[v]}function c(v){if(v!==void 0){if(Array.isArray(v)){const x=[];for(let _=0,b=v.length;_<b;_++){const w=v[_];n[w]===void 0&&console.warn("THREE.ObjectLoader: Undefined material",w),x.push(n[w])}return x}return n[v]===void 0&&console.warn("THREE.ObjectLoader: Undefined material",v),n[v]}}function d(v){return s[v]===void 0&&console.warn("THREE.ObjectLoader: Undefined texture",v),s[v]}let f,m;switch(e.type){case"Scene":o=new _M,e.background!==void 0&&(Number.isInteger(e.background)?o.background=new St(e.background):o.background=d(e.background)),e.environment!==void 0&&(o.environment=d(e.environment)),e.fog!==void 0&&(e.fog.type==="Fog"?o.fog=new uw(e.fog.color,e.fog.near,e.fog.far):e.fog.type==="FogExp2"&&(o.fog=new cw(e.fog.color,e.fog.density)),e.fog.name!==""&&(o.fog.name=e.fog.name)),e.backgroundBlurriness!==void 0&&(o.backgroundBlurriness=e.backgroundBlurriness),e.backgroundIntensity!==void 0&&(o.backgroundIntensity=e.backgroundIntensity),e.backgroundRotation!==void 0&&o.backgroundRotation.fromArray(e.backgroundRotation),e.environmentIntensity!==void 0&&(o.environmentIntensity=e.environmentIntensity),e.environmentRotation!==void 0&&o.environmentRotation.fromArray(e.environmentRotation);break;case"PerspectiveCamera":o=new Cr(e.fov,e.aspect,e.near,e.far),e.focus!==void 0&&(o.focus=e.focus),e.zoom!==void 0&&(o.zoom=e.zoom),e.filmGauge!==void 0&&(o.filmGauge=e.filmGauge),e.filmOffset!==void 0&&(o.filmOffset=e.filmOffset),e.view!==void 0&&(o.view=Object.assign({},e.view));break;case"OrthographicCamera":o=new hu(e.left,e.right,e.top,e.bottom,e.near,e.far),e.zoom!==void 0&&(o.zoom=e.zoom),e.view!==void 0&&(o.view=Object.assign({},e.view));break;case"AmbientLight":o=new ND(e.color,e.intensity);break;case"DirectionalLight":o=new RD(e.color,e.intensity),o.target=e.target||"";break;case"PointLight":o=new AD(e.color,e.intensity,e.distance,e.decay);break;case"RectAreaLight":o=new PD(e.color,e.intensity,e.width,e.height);break;case"SpotLight":o=new CD(e.color,e.intensity,e.distance,e.angle,e.penumbra,e.decay),o.target=e.target||"";break;case"HemisphereLight":o=new TD(e.color,e.groundColor,e.intensity);break;case"LightProbe":o=new kD().fromJSON(e);break;case"SkinnedMesh":f=a(e.geometry),m=c(e.material),o=new X4(f,m),e.bindMode!==void 0&&(o.bindMode=e.bindMode),e.bindMatrix!==void 0&&o.bindMatrix.fromArray(e.bindMatrix),e.skeleton!==void 0&&(o.skeleton=e.skeleton);break;case"Mesh":f=a(e.geometry),m=c(e.material),o=new Ur(f,m);break;case"InstancedMesh":f=a(e.geometry),m=c(e.material);const v=e.count,x=e.instanceMatrix,_=e.instanceColor;o=new Y4(f,m,v),o.instanceMatrix=new Yp(new Float32Array(x.array),16),_!==void 0&&(o.instanceColor=new Yp(new Float32Array(_.array),_.itemSize));break;case"BatchedMesh":f=a(e.geometry),m=c(e.material),o=new K4(e.maxInstanceCount,e.maxVertexCount,e.maxIndexCount,m),o.geometry=f,o.perObjectFrustumCulled=e.perObjectFrustumCulled,o.sortObjects=e.sortObjects,o._drawRanges=e.drawRanges,o._reservedRanges=e.reservedRanges,o._geometryInfo=e.geometryInfo.map(b=>{let w=null,S=null;return b.boundingBox!==void 0&&(w=new Ws().fromJSON(b.boundingBox)),b.boundingSphere!==void 0&&(S=new bs().fromJSON(b.boundingSphere)),{...b,boundingBox:w,boundingSphere:S}}),o._instanceInfo=e.instanceInfo,o._availableInstanceIds=e._availableInstanceIds,o._availableGeometryIds=e._availableGeometryIds,o._nextIndexStart=e.nextIndexStart,o._nextVertexStart=e.nextVertexStart,o._geometryCount=e.geometryCount,o._maxInstanceCount=e.maxInstanceCount,o._maxVertexCount=e.maxVertexCount,o._maxIndexCount=e.maxIndexCount,o._geometryInitialized=e.geometryInitialized,o._matricesTexture=d(e.matricesTexture.uuid),o._indirectTexture=d(e.indirectTexture.uuid),e.colorsTexture!==void 0&&(o._colorsTexture=d(e.colorsTexture.uuid)),e.boundingSphere!==void 0&&(o.boundingSphere=new bs().fromJSON(e.boundingSphere)),e.boundingBox!==void 0&&(o.boundingBox=new Ws().fromJSON(e.boundingBox));break;case"LOD":o=new q4;break;case"Line":o=new yu(a(e.geometry),c(e.material));break;case"LineLoop":o=new Q4(a(e.geometry),c(e.material));break;case"LineSegments":o=new Ya(a(e.geometry),c(e.material));break;case"PointCloud":case"Points":o=new J4(a(e.geometry),c(e.material));break;case"Sprite":o=new $4(c(e.material));break;case"Group":o=new yp;break;case"Bone":o=new SM;break;default:o=new jn}if(o.uuid=e.uuid,e.name!==void 0&&(o.name=e.name),e.matrix!==void 0?(o.matrix.fromArray(e.matrix),e.matrixAutoUpdate!==void 0&&(o.matrixAutoUpdate=e.matrixAutoUpdate),o.matrixAutoUpdate&&o.matrix.decompose(o.position,o.quaternion,o.scale)):(e.position!==void 0&&o.position.fromArray(e.position),e.rotation!==void 0&&o.rotation.fromArray(e.rotation),e.quaternion!==void 0&&o.quaternion.fromArray(e.quaternion),e.scale!==void 0&&o.scale.fromArray(e.scale)),e.up!==void 0&&o.up.fromArray(e.up),e.castShadow!==void 0&&(o.castShadow=e.castShadow),e.receiveShadow!==void 0&&(o.receiveShadow=e.receiveShadow),e.shadow&&(e.shadow.intensity!==void 0&&(o.shadow.intensity=e.shadow.intensity),e.shadow.bias!==void 0&&(o.shadow.bias=e.shadow.bias),e.shadow.normalBias!==void 0&&(o.shadow.normalBias=e.shadow.normalBias),e.shadow.radius!==void 0&&(o.shadow.radius=e.shadow.radius),e.shadow.mapSize!==void 0&&o.shadow.mapSize.fromArray(e.shadow.mapSize),e.shadow.camera!==void 0&&(o.shadow.camera=this.parseObject(e.shadow.camera))),e.visible!==void 0&&(o.visible=e.visible),e.frustumCulled!==void 0&&(o.frustumCulled=e.frustumCulled),e.renderOrder!==void 0&&(o.renderOrder=e.renderOrder),e.userData!==void 0&&(o.userData=e.userData),e.layers!==void 0&&(o.layers.mask=e.layers),e.children!==void 0){const v=e.children;for(let x=0;x<v.length;x++)o.add(this.parseObject(v[x],t,n,s,i))}if(e.animations!==void 0){const v=e.animations;for(let x=0;x<v.length;x++){const _=v[x];o.animations.push(i[_])}}if(e.type==="LOD"){e.autoUpdate!==void 0&&(o.autoUpdate=e.autoUpdate);const v=e.levels;for(let x=0;x<v.length;x++){const _=v[x],b=o.getObjectByProperty("uuid",_.object);b!==void 0&&o.addLevel(b,_.distance,_.hysteresis)}}return o}bindSkeletons(e,t){Object.keys(t).length!==0&&e.traverse(function(n){if(n.isSkinnedMesh===!0&&n.skeleton!==void 0){const s=t[n.skeleton];s===void 0?console.warn("THREE.ObjectLoader: No skeleton found with UUID:",n.skeleton):n.bind(s,n.bindMatrix)}})}bindLightTargets(e){e.traverse(function(t){if(t.isDirectionalLight||t.isSpotLight){const n=t.target,s=e.getObjectByProperty("uuid",n);s!==void 0?t.target=s:t.target=new jn}})}}const Rq={UVMapping:Z_,CubeReflectionMapping:ec,CubeRefractionMapping:xu,EquirectangularReflectionMapping:f0,EquirectangularRefractionMapping:p0,CubeUVReflectionMapping:hm},oA={RepeatWrapping:m0,ClampToEdgeWrapping:vo,MirroredRepeatWrapping:g0},aA={NearestFilter:Ss,NearestMipmapNearestFilter:oM,NearestMipmapLinearFilter:vp,LinearFilter:Qr,LinearMipmapNearestFilter:$g,LinearMipmapLinearFilter:La},gS=new WeakMap;class Nq extends Li{constructor(e){super(e),this.isImageBitmapLoader=!0,typeof createImageBitmap>"u"&&console.warn("THREE.ImageBitmapLoader: createImageBitmap() not supported."),typeof fetch>"u"&&console.warn("THREE.ImageBitmapLoader: fetch() not supported."),this.options={premultiplyAlpha:"none"}}setOptions(e){return this.options=e,this}load(e,t,n,s){e===void 0&&(e=""),this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);const i=this,o=Gl.get(e);if(o!==void 0){if(i.manager.itemStart(e),o.then){o.then(d=>{if(gS.has(o)===!0)s&&s(gS.get(o)),i.manager.itemError(e),i.manager.itemEnd(e);else return t&&t(d),i.manager.itemEnd(e),d});return}return setTimeout(function(){t&&t(o),i.manager.itemEnd(e)},0),o}const a={};a.credentials=this.crossOrigin==="anonymous"?"same-origin":"include",a.headers=this.requestHeader;const c=fetch(e,a).then(function(d){return d.blob()}).then(function(d){return createImageBitmap(d,Object.assign(i.options,{colorSpaceConversion:"none"}))}).then(function(d){return Gl.add(e,d),t&&t(d),i.manager.itemEnd(e),d}).catch(function(d){s&&s(d),gS.set(c,d),Gl.remove(e),i.manager.itemError(e),i.manager.itemEnd(e)});Gl.add(e,c),i.manager.itemStart(e)}}let qx;class UM{static getContext(){return qx===void 0&&(qx=new(window.AudioContext||window.webkitAudioContext)),qx}static setContext(e){qx=e}}class Pq extends Li{constructor(e){super(e)}load(e,t,n,s){const i=this,o=new nc(this.manager);o.setResponseType("arraybuffer"),o.setPath(this.path),o.setRequestHeader(this.requestHeader),o.setWithCredentials(this.withCredentials),o.load(e,function(c){try{const d=c.slice(0);UM.getContext().decodeAudioData(d,function(m){t(m)}).catch(a)}catch(d){a(d)}},n,s);function a(c){s?s(c):console.error(c),i.manager.itemError(e)}}}const lA=new Jt,cA=new Jt,wd=new Jt;class Iq{constructor(){this.type="StereoCamera",this.aspect=1,this.eyeSep=.064,this.cameraL=new Cr,this.cameraL.layers.enable(1),this.cameraL.matrixAutoUpdate=!1,this.cameraR=new Cr,this.cameraR.layers.enable(2),this.cameraR.matrixAutoUpdate=!1,this._cache={focus:null,fov:null,aspect:null,near:null,far:null,zoom:null,eyeSep:null}}update(e){const t=this._cache;if(t.focus!==e.focus||t.fov!==e.fov||t.aspect!==e.aspect*this.aspect||t.near!==e.near||t.far!==e.far||t.zoom!==e.zoom||t.eyeSep!==this.eyeSep){t.focus=e.focus,t.fov=e.fov,t.aspect=e.aspect*this.aspect,t.near=e.near,t.far=e.far,t.zoom=e.zoom,t.eyeSep=this.eyeSep,wd.copy(e.projectionMatrix);const s=t.eyeSep/2,i=s*t.near/t.focus,o=t.near*Math.tan(Jd*t.fov*.5)/t.zoom;let a,c;cA.elements[12]=-s,lA.elements[12]=s,a=-o*t.aspect+i,c=o*t.aspect+i,wd.elements[0]=2*t.near/(c-a),wd.elements[8]=(c+a)/(c-a),this.cameraL.projectionMatrix.copy(wd),a=-o*t.aspect-i,c=o*t.aspect-i,wd.elements[0]=2*t.near/(c-a),wd.elements[8]=(c+a)/(c-a),this.cameraR.projectionMatrix.copy(wd)}this.cameraL.matrixWorld.copy(e.matrixWorld).multiply(cA),this.cameraR.matrixWorld.copy(e.matrixWorld).multiply(lA)}}class OD extends Cr{constructor(e=[]){super(),this.isArrayCamera=!0,this.isMultiViewCamera=!1,this.cameras=e}}class BM{constructor(e=!0){this.autoStart=e,this.startTime=0,this.oldTime=0,this.elapsedTime=0,this.running=!1}start(){this.startTime=uA(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0}stop(){this.getElapsedTime(),this.running=!1,this.autoStart=!1}getElapsedTime(){return this.getDelta(),this.elapsedTime}getDelta(){let e=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){const t=uA();e=(t-this.oldTime)/1e3,this.oldTime=t,this.elapsedTime+=e}return e}}function uA(){return performance.now()}const Sd=new J,vS=new Gs,kq=new J,bd=new J,Ed=new J;class Dq extends jn{constructor(){super(),this.type="AudioListener",this.context=UM.getContext(),this.gain=this.context.createGain(),this.gain.connect(this.context.destination),this.filter=null,this.timeDelta=0,this._clock=new BM}getInput(){return this.gain}removeFilter(){return this.filter!==null&&(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination),this.gain.connect(this.context.destination),this.filter=null),this}getFilter(){return this.filter}setFilter(e){return this.filter!==null?(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination)):this.gain.disconnect(this.context.destination),this.filter=e,this.gain.connect(this.filter),this.filter.connect(this.context.destination),this}getMasterVolume(){return this.gain.gain.value}setMasterVolume(e){return this.gain.gain.setTargetAtTime(e,this.context.currentTime,.01),this}updateMatrixWorld(e){super.updateMatrixWorld(e);const t=this.context.listener;if(this.timeDelta=this._clock.getDelta(),this.matrixWorld.decompose(Sd,vS,kq),bd.set(0,0,-1).applyQuaternion(vS),Ed.set(0,1,0).applyQuaternion(vS),t.positionX){const n=this.context.currentTime+this.timeDelta;t.positionX.linearRampToValueAtTime(Sd.x,n),t.positionY.linearRampToValueAtTime(Sd.y,n),t.positionZ.linearRampToValueAtTime(Sd.z,n),t.forwardX.linearRampToValueAtTime(bd.x,n),t.forwardY.linearRampToValueAtTime(bd.y,n),t.forwardZ.linearRampToValueAtTime(bd.z,n),t.upX.linearRampToValueAtTime(Ed.x,n),t.upY.linearRampToValueAtTime(Ed.y,n),t.upZ.linearRampToValueAtTime(Ed.z,n)}else t.setPosition(Sd.x,Sd.y,Sd.z),t.setOrientation(bd.x,bd.y,bd.z,Ed.x,Ed.y,Ed.z)}}class jD extends jn{constructor(e){super(),this.type="Audio",this.listener=e,this.context=e.context,this.gain=this.context.createGain(),this.gain.connect(e.getInput()),this.autoplay=!1,this.buffer=null,this.detune=0,this.loop=!1,this.loopStart=0,this.loopEnd=0,this.offset=0,this.duration=void 0,this.playbackRate=1,this.isPlaying=!1,this.hasPlaybackControl=!0,this.source=null,this.sourceType="empty",this._startedAt=0,this._progress=0,this._connected=!1,this.filters=[]}getOutput(){return this.gain}setNodeSource(e){return this.hasPlaybackControl=!1,this.sourceType="audioNode",this.source=e,this.connect(),this}setMediaElementSource(e){return this.hasPlaybackControl=!1,this.sourceType="mediaNode",this.source=this.context.createMediaElementSource(e),this.connect(),this}setMediaStreamSource(e){return this.hasPlaybackControl=!1,this.sourceType="mediaStreamNode",this.source=this.context.createMediaStreamSource(e),this.connect(),this}setBuffer(e){return this.buffer=e,this.sourceType="buffer",this.autoplay&&this.play(),this}play(e=0){if(this.isPlaying===!0){console.warn("THREE.Audio: Audio is already playing.");return}if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}this._startedAt=this.context.currentTime+e;const t=this.context.createBufferSource();return t.buffer=this.buffer,t.loop=this.loop,t.loopStart=this.loopStart,t.loopEnd=this.loopEnd,t.onended=this.onEnded.bind(this),t.start(this._startedAt,this._progress+this.offset,this.duration),this.isPlaying=!0,this.source=t,this.setDetune(this.detune),this.setPlaybackRate(this.playbackRate),this.connect()}pause(){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this.isPlaying===!0&&(this._progress+=Math.max(this.context.currentTime-this._startedAt,0)*this.playbackRate,this.loop===!0&&(this._progress=this._progress%(this.duration||this.buffer.duration)),this.source.stop(),this.source.onended=null,this.isPlaying=!1),this}stop(e=0){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this._progress=0,this.source!==null&&(this.source.stop(this.context.currentTime+e),this.source.onended=null),this.isPlaying=!1,this}connect(){if(this.filters.length>0){this.source.connect(this.filters[0]);for(let e=1,t=this.filters.length;e<t;e++)this.filters[e-1].connect(this.filters[e]);this.filters[this.filters.length-1].connect(this.getOutput())}else this.source.connect(this.getOutput());return this._connected=!0,this}disconnect(){if(this._connected!==!1){if(this.filters.length>0){this.source.disconnect(this.filters[0]);for(let e=1,t=this.filters.length;e<t;e++)this.filters[e-1].disconnect(this.filters[e]);this.filters[this.filters.length-1].disconnect(this.getOutput())}else this.source.disconnect(this.getOutput());return this._connected=!1,this}}getFilters(){return this.filters}setFilters(e){return e||(e=[]),this._connected===!0?(this.disconnect(),this.filters=e.slice(),this.connect()):this.filters=e.slice(),this}setDetune(e){return this.detune=e,this.isPlaying===!0&&this.source.detune!==void 0&&this.source.detune.setTargetAtTime(this.detune,this.context.currentTime,.01),this}getDetune(){return this.detune}getFilter(){return this.getFilters()[0]}setFilter(e){return this.setFilters(e?[e]:[])}setPlaybackRate(e){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this.playbackRate=e,this.isPlaying===!0&&this.source.playbackRate.setTargetAtTime(this.playbackRate,this.context.currentTime,.01),this}getPlaybackRate(){return this.playbackRate}onEnded(){this.isPlaying=!1,this._progress=0}getLoop(){return this.hasPlaybackControl===!1?(console.warn("THREE.Audio: this Audio has no playback control."),!1):this.loop}setLoop(e){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this.loop=e,this.isPlaying===!0&&(this.source.loop=this.loop),this}setLoopStart(e){return this.loopStart=e,this}setLoopEnd(e){return this.loopEnd=e,this}getVolume(){return this.gain.gain.value}setVolume(e){return this.gain.gain.setTargetAtTime(e,this.context.currentTime,.01),this}copy(e,t){return super.copy(e,t),e.sourceType!=="buffer"?(console.warn("THREE.Audio: Audio source type cannot be copied."),this):(this.autoplay=e.autoplay,this.buffer=e.buffer,this.detune=e.detune,this.loop=e.loop,this.loopStart=e.loopStart,this.loopEnd=e.loopEnd,this.offset=e.offset,this.duration=e.duration,this.playbackRate=e.playbackRate,this.hasPlaybackControl=e.hasPlaybackControl,this.sourceType=e.sourceType,this.filters=e.filters.slice(),this)}clone(e){return new this.constructor(this.listener).copy(this,e)}}const Md=new J,dA=new Gs,Lq=new J,Td=new J;class Oq extends jD{constructor(e){super(e),this.panner=this.context.createPanner(),this.panner.panningModel="HRTF",this.panner.connect(this.gain)}connect(){return super.connect(),this.panner.connect(this.gain),this}disconnect(){return super.disconnect(),this.panner.disconnect(this.gain),this}getOutput(){return this.panner}getRefDistance(){return this.panner.refDistance}setRefDistance(e){return this.panner.refDistance=e,this}getRolloffFactor(){return this.panner.rolloffFactor}setRolloffFactor(e){return this.panner.rolloffFactor=e,this}getDistanceModel(){return this.panner.distanceModel}setDistanceModel(e){return this.panner.distanceModel=e,this}getMaxDistance(){return this.panner.maxDistance}setMaxDistance(e){return this.panner.maxDistance=e,this}setDirectionalCone(e,t,n){return this.panner.coneInnerAngle=e,this.panner.coneOuterAngle=t,this.panner.coneOuterGain=n,this}updateMatrixWorld(e){if(super.updateMatrixWorld(e),this.hasPlaybackControl===!0&&this.isPlaying===!1)return;this.matrixWorld.decompose(Md,dA,Lq),Td.set(0,0,1).applyQuaternion(dA);const t=this.panner;if(t.positionX){const n=this.context.currentTime+this.listener.timeDelta;t.positionX.linearRampToValueAtTime(Md.x,n),t.positionY.linearRampToValueAtTime(Md.y,n),t.positionZ.linearRampToValueAtTime(Md.z,n),t.orientationX.linearRampToValueAtTime(Td.x,n),t.orientationY.linearRampToValueAtTime(Td.y,n),t.orientationZ.linearRampToValueAtTime(Td.z,n)}else t.setPosition(Md.x,Md.y,Md.z),t.setOrientation(Td.x,Td.y,Td.z)}}class jq{constructor(e,t=2048){this.analyser=e.context.createAnalyser(),this.analyser.fftSize=t,this.data=new Uint8Array(this.analyser.frequencyBinCount),e.getOutput().connect(this.analyser)}getFrequencyData(){return this.analyser.getByteFrequencyData(this.data),this.data}getAverageFrequency(){let e=0;const t=this.getFrequencyData();for(let n=0;n<t.length;n++)e+=t[n];return e/t.length}}class FD{constructor(e,t,n){this.binding=e,this.valueSize=n;let s,i,o;switch(t){case"quaternion":s=this._slerp,i=this._slerpAdditive,o=this._setAdditiveIdentityQuaternion,this.buffer=new Float64Array(n*6),this._workIndex=5;break;case"string":case"bool":s=this._select,i=this._select,o=this._setAdditiveIdentityOther,this.buffer=new Array(n*5);break;default:s=this._lerp,i=this._lerpAdditive,o=this._setAdditiveIdentityNumeric,this.buffer=new Float64Array(n*5)}this._mixBufferRegion=s,this._mixBufferRegionAdditive=i,this._setIdentity=o,this._origIndex=3,this._addIndex=4,this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,this.useCount=0,this.referenceCount=0}accumulate(e,t){const n=this.buffer,s=this.valueSize,i=e*s+s;let o=this.cumulativeWeight;if(o===0){for(let a=0;a!==s;++a)n[i+a]=n[a];o=t}else{o+=t;const a=t/o;this._mixBufferRegion(n,i,0,a,s)}this.cumulativeWeight=o}accumulateAdditive(e){const t=this.buffer,n=this.valueSize,s=n*this._addIndex;this.cumulativeWeightAdditive===0&&this._setIdentity(),this._mixBufferRegionAdditive(t,s,0,e,n),this.cumulativeWeightAdditive+=e}apply(e){const t=this.valueSize,n=this.buffer,s=e*t+t,i=this.cumulativeWeight,o=this.cumulativeWeightAdditive,a=this.binding;if(this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,i<1){const c=t*this._origIndex;this._mixBufferRegion(n,s,c,1-i,t)}o>0&&this._mixBufferRegionAdditive(n,s,this._addIndex*t,1,t);for(let c=t,d=t+t;c!==d;++c)if(n[c]!==n[c+t]){a.setValue(n,s);break}}saveOriginalState(){const e=this.binding,t=this.buffer,n=this.valueSize,s=n*this._origIndex;e.getValue(t,s);for(let i=n,o=s;i!==o;++i)t[i]=t[s+i%n];this._setIdentity(),this.cumulativeWeight=0,this.cumulativeWeightAdditive=0}restoreOriginalState(){const e=this.valueSize*3;this.binding.setValue(this.buffer,e)}_setAdditiveIdentityNumeric(){const e=this._addIndex*this.valueSize,t=e+this.valueSize;for(let n=e;n<t;n++)this.buffer[n]=0}_setAdditiveIdentityQuaternion(){this._setAdditiveIdentityNumeric(),this.buffer[this._addIndex*this.valueSize+3]=1}_setAdditiveIdentityOther(){const e=this._origIndex*this.valueSize,t=this._addIndex*this.valueSize;for(let n=0;n<this.valueSize;n++)this.buffer[t+n]=this.buffer[e+n]}_select(e,t,n,s,i){if(s>=.5)for(let o=0;o!==i;++o)e[t+o]=e[n+o]}_slerp(e,t,n,s){Gs.slerpFlat(e,t,e,t,e,n,s)}_slerpAdditive(e,t,n,s,i){const o=this._workIndex*i;Gs.multiplyQuaternionsFlat(e,o,e,t,e,n),Gs.slerpFlat(e,t,e,t,e,o,s)}_lerp(e,t,n,s,i){const o=1-s;for(let a=0;a!==i;++a){const c=t+a;e[c]=e[c]*o+e[n+a]*s}}_lerpAdditive(e,t,n,s,i){for(let o=0;o!==i;++o){const a=t+o;e[a]=e[a]+e[n+o]*s}}}const zM="\\[\\]\\.:\\/",Fq=new RegExp("["+zM+"]","g"),VM="[^"+zM+"]",Uq="[^"+zM.replace("\\.","")+"]",Bq=/((?:WC+[\/:])*)/.source.replace("WC",VM),zq=/(WCOD+)?/.source.replace("WCOD",Uq),Vq=/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC",VM),Hq=/\.(WC+)(?:\[(.+)\])?/.source.replace("WC",VM),Gq=new RegExp("^"+Bq+zq+Vq+Hq+"$"),Wq=["material","materials","bones","map"];class $q{constructor(e,t,n){const s=n||Ln.parseTrackName(t);this._targetGroup=e,this._bindings=e.subscribe_(t,s)}getValue(e,t){this.bind();const n=this._targetGroup.nCachedObjects_,s=this._bindings[n];s!==void 0&&s.getValue(e,t)}setValue(e,t){const n=this._bindings;for(let s=this._targetGroup.nCachedObjects_,i=n.length;s!==i;++s)n[s].setValue(e,t)}bind(){const e=this._bindings;for(let t=this._targetGroup.nCachedObjects_,n=e.length;t!==n;++t)e[t].bind()}unbind(){const e=this._bindings;for(let t=this._targetGroup.nCachedObjects_,n=e.length;t!==n;++t)e[t].unbind()}}class Ln{constructor(e,t,n){this.path=t,this.parsedPath=n||Ln.parseTrackName(t),this.node=Ln.findNode(e,this.parsedPath.nodeName),this.rootNode=e,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}static create(e,t,n){return e&&e.isAnimationObjectGroup?new Ln.Composite(e,t,n):new Ln(e,t,n)}static sanitizeNodeName(e){return e.replace(/\s/g,"_").replace(Fq,"")}static parseTrackName(e){const t=Gq.exec(e);if(t===null)throw new Error("PropertyBinding: Cannot parse trackName: "+e);const n={nodeName:t[2],objectName:t[3],objectIndex:t[4],propertyName:t[5],propertyIndex:t[6]},s=n.nodeName&&n.nodeName.lastIndexOf(".");if(s!==void 0&&s!==-1){const i=n.nodeName.substring(s+1);Wq.indexOf(i)!==-1&&(n.nodeName=n.nodeName.substring(0,s),n.objectName=i)}if(n.propertyName===null||n.propertyName.length===0)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+e);return n}static findNode(e,t){if(t===void 0||t===""||t==="."||t===-1||t===e.name||t===e.uuid)return e;if(e.skeleton){const n=e.skeleton.getBoneByName(t);if(n!==void 0)return n}if(e.children){const n=function(i){for(let o=0;o<i.length;o++){const a=i[o];if(a.name===t||a.uuid===t)return a;const c=n(a.children);if(c)return c}return null},s=n(e.children);if(s)return s}return null}_getValue_unavailable(){}_setValue_unavailable(){}_getValue_direct(e,t){e[t]=this.targetObject[this.propertyName]}_getValue_array(e,t){const n=this.resolvedProperty;for(let s=0,i=n.length;s!==i;++s)e[t++]=n[s]}_getValue_arrayElement(e,t){e[t]=this.resolvedProperty[this.propertyIndex]}_getValue_toArray(e,t){this.resolvedProperty.toArray(e,t)}_setValue_direct(e,t){this.targetObject[this.propertyName]=e[t]}_setValue_direct_setNeedsUpdate(e,t){this.targetObject[this.propertyName]=e[t],this.targetObject.needsUpdate=!0}_setValue_direct_setMatrixWorldNeedsUpdate(e,t){this.targetObject[this.propertyName]=e[t],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_array(e,t){const n=this.resolvedProperty;for(let s=0,i=n.length;s!==i;++s)n[s]=e[t++]}_setValue_array_setNeedsUpdate(e,t){const n=this.resolvedProperty;for(let s=0,i=n.length;s!==i;++s)n[s]=e[t++];this.targetObject.needsUpdate=!0}_setValue_array_setMatrixWorldNeedsUpdate(e,t){const n=this.resolvedProperty;for(let s=0,i=n.length;s!==i;++s)n[s]=e[t++];this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_arrayElement(e,t){this.resolvedProperty[this.propertyIndex]=e[t]}_setValue_arrayElement_setNeedsUpdate(e,t){this.resolvedProperty[this.propertyIndex]=e[t],this.targetObject.needsUpdate=!0}_setValue_arrayElement_setMatrixWorldNeedsUpdate(e,t){this.resolvedProperty[this.propertyIndex]=e[t],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_fromArray(e,t){this.resolvedProperty.fromArray(e,t)}_setValue_fromArray_setNeedsUpdate(e,t){this.resolvedProperty.fromArray(e,t),this.targetObject.needsUpdate=!0}_setValue_fromArray_setMatrixWorldNeedsUpdate(e,t){this.resolvedProperty.fromArray(e,t),this.targetObject.matrixWorldNeedsUpdate=!0}_getValue_unbound(e,t){this.bind(),this.getValue(e,t)}_setValue_unbound(e,t){this.bind(),this.setValue(e,t)}bind(){let e=this.node;const t=this.parsedPath,n=t.objectName,s=t.propertyName;let i=t.propertyIndex;if(e||(e=Ln.findNode(this.rootNode,t.nodeName),this.node=e),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,!e){console.warn("THREE.PropertyBinding: No target node found for track: "+this.path+".");return}if(n){let d=t.objectIndex;switch(n){case"materials":if(!e.material){console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);return}if(!e.material.materials){console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);return}e=e.material.materials;break;case"bones":if(!e.skeleton){console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);return}e=e.skeleton.bones;for(let f=0;f<e.length;f++)if(e[f].name===d){d=f;break}break;case"map":if("map"in e){e=e.map;break}if(!e.material){console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);return}if(!e.material.map){console.error("THREE.PropertyBinding: Can not bind to material.map as node.material does not have a map.",this);return}e=e.material.map;break;default:if(e[n]===void 0){console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);return}e=e[n]}if(d!==void 0){if(e[d]===void 0){console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,e);return}e=e[d]}}const o=e[s];if(o===void 0){const d=t.nodeName;console.error("THREE.PropertyBinding: Trying to update property for track: "+d+"."+s+" but it wasn't found.",e);return}let a=this.Versioning.None;this.targetObject=e,e.isMaterial===!0?a=this.Versioning.NeedsUpdate:e.isObject3D===!0&&(a=this.Versioning.MatrixWorldNeedsUpdate);let c=this.BindingType.Direct;if(i!==void 0){if(s==="morphTargetInfluences"){if(!e.geometry){console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);return}if(!e.geometry.morphAttributes){console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);return}e.morphTargetDictionary[i]!==void 0&&(i=e.morphTargetDictionary[i])}c=this.BindingType.ArrayElement,this.resolvedProperty=o,this.propertyIndex=i}else o.fromArray!==void 0&&o.toArray!==void 0?(c=this.BindingType.HasFromToArray,this.resolvedProperty=o):Array.isArray(o)?(c=this.BindingType.EntireArray,this.resolvedProperty=o):this.propertyName=s;this.getValue=this.GetterByBindingType[c],this.setValue=this.SetterByBindingTypeAndVersioning[c][a]}unbind(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}Ln.Composite=$q;Ln.prototype.BindingType={Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3};Ln.prototype.Versioning={None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2};Ln.prototype.GetterByBindingType=[Ln.prototype._getValue_direct,Ln.prototype._getValue_array,Ln.prototype._getValue_arrayElement,Ln.prototype._getValue_toArray];Ln.prototype.SetterByBindingTypeAndVersioning=[[Ln.prototype._setValue_direct,Ln.prototype._setValue_direct_setNeedsUpdate,Ln.prototype._setValue_direct_setMatrixWorldNeedsUpdate],[Ln.prototype._setValue_array,Ln.prototype._setValue_array_setNeedsUpdate,Ln.prototype._setValue_array_setMatrixWorldNeedsUpdate],[Ln.prototype._setValue_arrayElement,Ln.prototype._setValue_arrayElement_setNeedsUpdate,Ln.prototype._setValue_arrayElement_setMatrixWorldNeedsUpdate],[Ln.prototype._setValue_fromArray,Ln.prototype._setValue_fromArray_setNeedsUpdate,Ln.prototype._setValue_fromArray_setMatrixWorldNeedsUpdate]];class qq{constructor(){this.isAnimationObjectGroup=!0,this.uuid=Zi(),this._objects=Array.prototype.slice.call(arguments),this.nCachedObjects_=0;const e={};this._indicesByUUID=e;for(let n=0,s=arguments.length;n!==s;++n)e[arguments[n].uuid]=n;this._paths=[],this._parsedPaths=[],this._bindings=[],this._bindingsIndicesByPath={};const t=this;this.stats={objects:{get total(){return t._objects.length},get inUse(){return this.total-t.nCachedObjects_}},get bindingsPerObject(){return t._bindings.length}}}add(){const e=this._objects,t=this._indicesByUUID,n=this._paths,s=this._parsedPaths,i=this._bindings,o=i.length;let a,c=e.length,d=this.nCachedObjects_;for(let f=0,m=arguments.length;f!==m;++f){const v=arguments[f],x=v.uuid;let _=t[x];if(_===void 0){_=c++,t[x]=_,e.push(v);for(let b=0,w=o;b!==w;++b)i[b].push(new Ln(v,n[b],s[b]))}else if(_<d){a=e[_];const b=--d,w=e[b];t[w.uuid]=_,e[_]=w,t[x]=b,e[b]=v;for(let S=0,C=o;S!==C;++S){const T=i[S],A=T[b];let k=T[_];T[_]=A,k===void 0&&(k=new Ln(v,n[S],s[S])),T[b]=k}}else e[_]!==a&&console.error("THREE.AnimationObjectGroup: Different objects with the same UUID detected. Clean the caches or recreate your infrastructure when reloading scenes.")}this.nCachedObjects_=d}remove(){const e=this._objects,t=this._indicesByUUID,n=this._bindings,s=n.length;let i=this.nCachedObjects_;for(let o=0,a=arguments.length;o!==a;++o){const c=arguments[o],d=c.uuid,f=t[d];if(f!==void 0&&f>=i){const m=i++,v=e[m];t[v.uuid]=f,e[f]=v,t[d]=m,e[m]=c;for(let x=0,_=s;x!==_;++x){const b=n[x],w=b[m],S=b[f];b[f]=w,b[m]=S}}}this.nCachedObjects_=i}uncache(){const e=this._objects,t=this._indicesByUUID,n=this._bindings,s=n.length;let i=this.nCachedObjects_,o=e.length;for(let a=0,c=arguments.length;a!==c;++a){const d=arguments[a],f=d.uuid,m=t[f];if(m!==void 0)if(delete t[f],m<i){const v=--i,x=e[v],_=--o,b=e[_];t[x.uuid]=m,e[m]=x,t[b.uuid]=v,e[v]=b,e.pop();for(let w=0,S=s;w!==S;++w){const C=n[w],T=C[v],A=C[_];C[m]=T,C[v]=A,C.pop()}}else{const v=--o,x=e[v];v>0&&(t[x.uuid]=m),e[m]=x,e.pop();for(let _=0,b=s;_!==b;++_){const w=n[_];w[m]=w[v],w.pop()}}}this.nCachedObjects_=i}subscribe_(e,t){const n=this._bindingsIndicesByPath;let s=n[e];const i=this._bindings;if(s!==void 0)return i[s];const o=this._paths,a=this._parsedPaths,c=this._objects,d=c.length,f=this.nCachedObjects_,m=new Array(d);s=i.length,n[e]=s,o.push(e),a.push(t),i.push(m);for(let v=f,x=c.length;v!==x;++v){const _=c[v];m[v]=new Ln(_,e,t)}return m}unsubscribe_(e){const t=this._bindingsIndicesByPath,n=t[e];if(n!==void 0){const s=this._paths,i=this._parsedPaths,o=this._bindings,a=o.length-1,c=o[a],d=e[a];t[d]=n,o[n]=c,o.pop(),i[n]=i[a],i.pop(),s[n]=s[a],s.pop()}}}class UD{constructor(e,t,n=null,s=t.blendMode){this._mixer=e,this._clip=t,this._localRoot=n,this.blendMode=s;const i=t.tracks,o=i.length,a=new Array(o),c={endingStart:jd,endingEnd:jd};for(let d=0;d!==o;++d){const f=i[d].createInterpolant(null);a[d]=f,f.settings=c}this._interpolantSettings=c,this._interpolants=a,this._propertyBindings=new Array(o),this._cacheIndex=null,this._byClipCacheIndex=null,this._timeScaleInterpolant=null,this._weightInterpolant=null,this.loop=M4,this._loopCount=-1,this._startTime=null,this.time=0,this.timeScale=1,this._effectiveTimeScale=1,this.weight=1,this._effectiveWeight=1,this.repetitions=1/0,this.paused=!1,this.enabled=!0,this.clampWhenFinished=!1,this.zeroSlopeAtStart=!0,this.zeroSlopeAtEnd=!0}play(){return this._mixer._activateAction(this),this}stop(){return this._mixer._deactivateAction(this),this.reset()}reset(){return this.paused=!1,this.enabled=!0,this.time=0,this._loopCount=-1,this._startTime=null,this.stopFading().stopWarping()}isRunning(){return this.enabled&&!this.paused&&this.timeScale!==0&&this._startTime===null&&this._mixer._isActiveAction(this)}isScheduled(){return this._mixer._isActiveAction(this)}startAt(e){return this._startTime=e,this}setLoop(e,t){return this.loop=e,this.repetitions=t,this}setEffectiveWeight(e){return this.weight=e,this._effectiveWeight=this.enabled?e:0,this.stopFading()}getEffectiveWeight(){return this._effectiveWeight}fadeIn(e){return this._scheduleFading(e,0,1)}fadeOut(e){return this._scheduleFading(e,1,0)}crossFadeFrom(e,t,n=!1){if(e.fadeOut(t),this.fadeIn(t),n===!0){const s=this._clip.duration,i=e._clip.duration,o=i/s,a=s/i;e.warp(1,o,t),this.warp(a,1,t)}return this}crossFadeTo(e,t,n=!1){return e.crossFadeFrom(this,t,n)}stopFading(){const e=this._weightInterpolant;return e!==null&&(this._weightInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this}setEffectiveTimeScale(e){return this.timeScale=e,this._effectiveTimeScale=this.paused?0:e,this.stopWarping()}getEffectiveTimeScale(){return this._effectiveTimeScale}setDuration(e){return this.timeScale=this._clip.duration/e,this.stopWarping()}syncWith(e){return this.time=e.time,this.timeScale=e.timeScale,this.stopWarping()}halt(e){return this.warp(this._effectiveTimeScale,0,e)}warp(e,t,n){const s=this._mixer,i=s.time,o=this.timeScale;let a=this._timeScaleInterpolant;a===null&&(a=s._lendControlInterpolant(),this._timeScaleInterpolant=a);const c=a.parameterPositions,d=a.sampleValues;return c[0]=i,c[1]=i+n,d[0]=e/o,d[1]=t/o,this}stopWarping(){const e=this._timeScaleInterpolant;return e!==null&&(this._timeScaleInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this}getMixer(){return this._mixer}getClip(){return this._clip}getRoot(){return this._localRoot||this._mixer._root}_update(e,t,n,s){if(!this.enabled){this._updateWeight(e);return}const i=this._startTime;if(i!==null){const c=(e-i)*n;c<0||n===0?t=0:(this._startTime=null,t=n*c)}t*=this._updateTimeScale(e);const o=this._updateTime(t),a=this._updateWeight(e);if(a>0){const c=this._interpolants,d=this._propertyBindings;switch(this.blendMode){case pM:for(let f=0,m=c.length;f!==m;++f)c[f].evaluate(o),d[f].accumulateAdditive(a);break;case ow:default:for(let f=0,m=c.length;f!==m;++f)c[f].evaluate(o),d[f].accumulate(s,a)}}}_updateWeight(e){let t=0;if(this.enabled){t=this.weight;const n=this._weightInterpolant;if(n!==null){const s=n.evaluate(e)[0];t*=s,e>n.parameterPositions[1]&&(this.stopFading(),s===0&&(this.enabled=!1))}}return this._effectiveWeight=t,t}_updateTimeScale(e){let t=0;if(!this.paused){t=this.timeScale;const n=this._timeScaleInterpolant;if(n!==null){const s=n.evaluate(e)[0];t*=s,e>n.parameterPositions[1]&&(this.stopWarping(),t===0?this.paused=!0:this.timeScale=t)}}return this._effectiveTimeScale=t,t}_updateTime(e){const t=this._clip.duration,n=this.loop;let s=this.time+e,i=this._loopCount;const o=n===T4;if(e===0)return i===-1?s:o&&(i&1)===1?t-s:s;if(n===E4){i===-1&&(this._loopCount=0,this._setEndings(!0,!0,!1));e:{if(s>=t)s=t;else if(s<0)s=0;else{this.time=s;break e}this.clampWhenFinished?this.paused=!0:this.enabled=!1,this.time=s,this._mixer.dispatchEvent({type:"finished",action:this,direction:e<0?-1:1})}}else{if(i===-1&&(e>=0?(i=0,this._setEndings(!0,this.repetitions===0,o)):this._setEndings(this.repetitions===0,!0,o)),s>=t||s<0){const a=Math.floor(s/t);s-=t*a,i+=Math.abs(a);const c=this.repetitions-i;if(c<=0)this.clampWhenFinished?this.paused=!0:this.enabled=!1,s=e>0?t:0,this.time=s,this._mixer.dispatchEvent({type:"finished",action:this,direction:e>0?1:-1});else{if(c===1){const d=e<0;this._setEndings(d,!d,o)}else this._setEndings(!1,!1,o);this._loopCount=i,this.time=s,this._mixer.dispatchEvent({type:"loop",action:this,loopDelta:a})}}else this.time=s;if(o&&(i&1)===1)return t-s}return s}_setEndings(e,t,n){const s=this._interpolantSettings;n?(s.endingStart=Fd,s.endingEnd=Fd):(e?s.endingStart=this.zeroSlopeAtStart?Fd:jd:s.endingStart=x0,t?s.endingEnd=this.zeroSlopeAtEnd?Fd:jd:s.endingEnd=x0)}_scheduleFading(e,t,n){const s=this._mixer,i=s.time;let o=this._weightInterpolant;o===null&&(o=s._lendControlInterpolant(),this._weightInterpolant=o);const a=o.parameterPositions,c=o.sampleValues;return a[0]=i,c[0]=t,a[1]=i+e,c[1]=n,this}}const Xq=new Float32Array(1);class Yq extends Xa{constructor(e){super(),this._root=e,this._initMemoryManager(),this._accuIndex=0,this.time=0,this.timeScale=1}_bindAction(e,t){const n=e._localRoot||this._root,s=e._clip.tracks,i=s.length,o=e._propertyBindings,a=e._interpolants,c=n.uuid,d=this._bindingsByRootAndName;let f=d[c];f===void 0&&(f={},d[c]=f);for(let m=0;m!==i;++m){const v=s[m],x=v.name;let _=f[x];if(_!==void 0)++_.referenceCount,o[m]=_;else{if(_=o[m],_!==void 0){_._cacheIndex===null&&(++_.referenceCount,this._addInactiveBinding(_,c,x));continue}const b=t&&t._propertyBindings[m].binding.parsedPath;_=new FD(Ln.create(n,x,b),v.ValueTypeName,v.getValueSize()),++_.referenceCount,this._addInactiveBinding(_,c,x),o[m]=_}a[m].resultBuffer=_.buffer}}_activateAction(e){if(!this._isActiveAction(e)){if(e._cacheIndex===null){const n=(e._localRoot||this._root).uuid,s=e._clip.uuid,i=this._actionsByClip[s];this._bindAction(e,i&&i.knownActions[0]),this._addInactiveAction(e,s,n)}const t=e._propertyBindings;for(let n=0,s=t.length;n!==s;++n){const i=t[n];i.useCount++===0&&(this._lendBinding(i),i.saveOriginalState())}this._lendAction(e)}}_deactivateAction(e){if(this._isActiveAction(e)){const t=e._propertyBindings;for(let n=0,s=t.length;n!==s;++n){const i=t[n];--i.useCount===0&&(i.restoreOriginalState(),this._takeBackBinding(i))}this._takeBackAction(e)}}_initMemoryManager(){this._actions=[],this._nActiveActions=0,this._actionsByClip={},this._bindings=[],this._nActiveBindings=0,this._bindingsByRootAndName={},this._controlInterpolants=[],this._nActiveControlInterpolants=0;const e=this;this.stats={actions:{get total(){return e._actions.length},get inUse(){return e._nActiveActions}},bindings:{get total(){return e._bindings.length},get inUse(){return e._nActiveBindings}},controlInterpolants:{get total(){return e._controlInterpolants.length},get inUse(){return e._nActiveControlInterpolants}}}}_isActiveAction(e){const t=e._cacheIndex;return t!==null&&t<this._nActiveActions}_addInactiveAction(e,t,n){const s=this._actions,i=this._actionsByClip;let o=i[t];if(o===void 0)o={knownActions:[e],actionByRoot:{}},e._byClipCacheIndex=0,i[t]=o;else{const a=o.knownActions;e._byClipCacheIndex=a.length,a.push(e)}e._cacheIndex=s.length,s.push(e),o.actionByRoot[n]=e}_removeInactiveAction(e){const t=this._actions,n=t[t.length-1],s=e._cacheIndex;n._cacheIndex=s,t[s]=n,t.pop(),e._cacheIndex=null;const i=e._clip.uuid,o=this._actionsByClip,a=o[i],c=a.knownActions,d=c[c.length-1],f=e._byClipCacheIndex;d._byClipCacheIndex=f,c[f]=d,c.pop(),e._byClipCacheIndex=null;const m=a.actionByRoot,v=(e._localRoot||this._root).uuid;delete m[v],c.length===0&&delete o[i],this._removeInactiveBindingsForAction(e)}_removeInactiveBindingsForAction(e){const t=e._propertyBindings;for(let n=0,s=t.length;n!==s;++n){const i=t[n];--i.referenceCount===0&&this._removeInactiveBinding(i)}}_lendAction(e){const t=this._actions,n=e._cacheIndex,s=this._nActiveActions++,i=t[s];e._cacheIndex=s,t[s]=e,i._cacheIndex=n,t[n]=i}_takeBackAction(e){const t=this._actions,n=e._cacheIndex,s=--this._nActiveActions,i=t[s];e._cacheIndex=s,t[s]=e,i._cacheIndex=n,t[n]=i}_addInactiveBinding(e,t,n){const s=this._bindingsByRootAndName,i=this._bindings;let o=s[t];o===void 0&&(o={},s[t]=o),o[n]=e,e._cacheIndex=i.length,i.push(e)}_removeInactiveBinding(e){const t=this._bindings,n=e.binding,s=n.rootNode.uuid,i=n.path,o=this._bindingsByRootAndName,a=o[s],c=t[t.length-1],d=e._cacheIndex;c._cacheIndex=d,t[d]=c,t.pop(),delete a[i],Object.keys(a).length===0&&delete o[s]}_lendBinding(e){const t=this._bindings,n=e._cacheIndex,s=this._nActiveBindings++,i=t[s];e._cacheIndex=s,t[s]=e,i._cacheIndex=n,t[n]=i}_takeBackBinding(e){const t=this._bindings,n=e._cacheIndex,s=--this._nActiveBindings,i=t[s];e._cacheIndex=s,t[s]=e,i._cacheIndex=n,t[n]=i}_lendControlInterpolant(){const e=this._controlInterpolants,t=this._nActiveControlInterpolants++;let n=e[t];return n===void 0&&(n=new LM(new Float32Array(2),new Float32Array(2),1,Xq),n.__cacheIndex=t,e[t]=n),n}_takeBackControlInterpolant(e){const t=this._controlInterpolants,n=e.__cacheIndex,s=--this._nActiveControlInterpolants,i=t[s];e.__cacheIndex=s,t[s]=e,i.__cacheIndex=n,t[n]=i}clipAction(e,t,n){const s=t||this._root,i=s.uuid;let o=typeof e=="string"?A0.findByName(s,e):e;const a=o!==null?o.uuid:e,c=this._actionsByClip[a];let d=null;if(n===void 0&&(o!==null?n=o.blendMode:n=ow),c!==void 0){const m=c.actionByRoot[i];if(m!==void 0&&m.blendMode===n)return m;d=c.knownActions[0],o===null&&(o=d._clip)}if(o===null)return null;const f=new UD(this,o,t,n);return this._bindAction(f,d),this._addInactiveAction(f,a,i),f}existingAction(e,t){const n=t||this._root,s=n.uuid,i=typeof e=="string"?A0.findByName(n,e):e,o=i?i.uuid:e,a=this._actionsByClip[o];return a!==void 0&&a.actionByRoot[s]||null}stopAllAction(){const e=this._actions,t=this._nActiveActions;for(let n=t-1;n>=0;--n)e[n].stop();return this}update(e){e*=this.timeScale;const t=this._actions,n=this._nActiveActions,s=this.time+=e,i=Math.sign(e),o=this._accuIndex^=1;for(let d=0;d!==n;++d)t[d]._update(s,e,i,o);const a=this._bindings,c=this._nActiveBindings;for(let d=0;d!==c;++d)a[d].apply(o);return this}setTime(e){this.time=0;for(let t=0;t<this._actions.length;t++)this._actions[t].time=0;return this.update(e)}getRoot(){return this._root}uncacheClip(e){const t=this._actions,n=e.uuid,s=this._actionsByClip,i=s[n];if(i!==void 0){const o=i.knownActions;for(let a=0,c=o.length;a!==c;++a){const d=o[a];this._deactivateAction(d);const f=d._cacheIndex,m=t[t.length-1];d._cacheIndex=null,d._byClipCacheIndex=null,m._cacheIndex=f,t[f]=m,t.pop(),this._removeInactiveBindingsForAction(d)}delete s[n]}}uncacheRoot(e){const t=e.uuid,n=this._actionsByClip;for(const o in n){const a=n[o].actionByRoot,c=a[t];c!==void 0&&(this._deactivateAction(c),this._removeInactiveAction(c))}const s=this._bindingsByRootAndName,i=s[t];if(i!==void 0)for(const o in i){const a=i[o];a.restoreOriginalState(),this._removeInactiveBinding(a)}}uncacheAction(e,t){const n=this.existingAction(e,t);n!==null&&(this._deactivateAction(n),this._removeInactiveAction(n))}}class Kq extends vM{constructor(e=1,t=1,n=1,s={}){super(e,t,s),this.isRenderTarget3D=!0,this.depth=n,this.texture=new lw(null,e,t,n),this._setTextureOptions(s),this.texture.isRenderTargetTexture=!0}}class HM{constructor(e){this.value=e}clone(){return new HM(this.value.clone===void 0?this.value:this.value.clone())}}let Qq=0;class Jq extends Xa{constructor(){super(),this.isUniformsGroup=!0,Object.defineProperty(this,"id",{value:Qq++}),this.name="",this.usage=_0,this.uniforms=[]}add(e){return this.uniforms.push(e),this}remove(e){const t=this.uniforms.indexOf(e);return t!==-1&&this.uniforms.splice(t,1),this}setName(e){return this.name=e,this}setUsage(e){return this.usage=e,this}dispose(){this.dispatchEvent({type:"dispose"})}copy(e){this.name=e.name,this.usage=e.usage;const t=e.uniforms;this.uniforms.length=0;for(let n=0,s=t.length;n<s;n++){const i=Array.isArray(t[n])?t[n]:[t[n]];for(let o=0;o<i.length;o++)this.uniforms.push(i[o].clone())}return this}clone(){return new this.constructor().copy(this)}}class Zq extends dw{constructor(e,t,n=1){super(e,t),this.isInstancedInterleavedBuffer=!0,this.meshPerAttribute=n}copy(e){return super.copy(e),this.meshPerAttribute=e.meshPerAttribute,this}clone(e){const t=super.clone(e);return t.meshPerAttribute=this.meshPerAttribute,t}toJSON(e){const t=super.toJSON(e);return t.isInstancedInterleavedBuffer=!0,t.meshPerAttribute=this.meshPerAttribute,t}}class eX{constructor(e,t,n,s,i){this.isGLBufferAttribute=!0,this.name="",this.buffer=e,this.type=t,this.itemSize=n,this.elementSize=s,this.count=i,this.version=0}set needsUpdate(e){e===!0&&this.version++}setBuffer(e){return this.buffer=e,this}setType(e,t){return this.type=e,this.elementSize=t,this}setItemSize(e){return this.itemSize=e,this}setCount(e){return this.count=e,this}}const hA=new Jt;class BD{constructor(e,t,n=0,s=1/0){this.ray=new wh(e,t),this.near=n,this.far=s,this.camera=null,this.layers=new Zd,this.params={Mesh:{},Line:{threshold:1},LOD:{},Points:{threshold:1},Sprite:{}}}set(e,t){this.ray.set(e,t)}setFromCamera(e,t){t.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(t.matrixWorld),this.ray.direction.set(e.x,e.y,.5).unproject(t).sub(this.ray.origin).normalize(),this.camera=t):t.isOrthographicCamera?(this.ray.origin.set(e.x,e.y,(t.near+t.far)/(t.near-t.far)).unproject(t),this.ray.direction.set(0,0,-1).transformDirection(t.matrixWorld),this.camera=t):console.error("THREE.Raycaster: Unsupported camera type: "+t.type)}setFromXRController(e){return hA.identity().extractRotation(e.matrixWorld),this.ray.origin.setFromMatrixPosition(e.matrixWorld),this.ray.direction.set(0,0,-1).applyMatrix4(hA),this}intersectObject(e,t=!0,n=[]){return Hb(e,this,n,t),n.sort(fA),n}intersectObjects(e,t=!0,n=[]){for(let s=0,i=e.length;s<i;s++)Hb(e[s],this,n,t);return n.sort(fA),n}}function fA(r,e){return r.distance-e.distance}function Hb(r,e,t,n){let s=!0;if(r.layers.test(e.layers)&&r.raycast(e,t)===!1&&(s=!1),s===!0&&n===!0){const i=r.children;for(let o=0,a=i.length;o<a;o++)Hb(i[o],e,t,!0)}}class Gb{constructor(e=1,t=0,n=0){this.radius=e,this.phi=t,this.theta=n}set(e,t,n){return this.radius=e,this.phi=t,this.theta=n,this}copy(e){return this.radius=e.radius,this.phi=e.phi,this.theta=e.theta,this}makeSafe(){return this.phi=an(this.phi,1e-6,Math.PI-1e-6),this}setFromVector3(e){return this.setFromCartesianCoords(e.x,e.y,e.z)}setFromCartesianCoords(e,t,n){return this.radius=Math.sqrt(e*e+t*t+n*n),this.radius===0?(this.theta=0,this.phi=0):(this.theta=Math.atan2(e,n),this.phi=Math.acos(an(t/this.radius,-1,1))),this}clone(){return new this.constructor().copy(this)}}class tX{constructor(e=1,t=0,n=0){this.radius=e,this.theta=t,this.y=n}set(e,t,n){return this.radius=e,this.theta=t,this.y=n,this}copy(e){return this.radius=e.radius,this.theta=e.theta,this.y=e.y,this}setFromVector3(e){return this.setFromCartesianCoords(e.x,e.y,e.z)}setFromCartesianCoords(e,t,n){return this.radius=Math.sqrt(e*e+n*n),this.theta=Math.atan2(e,n),this.y=t,this}clone(){return new this.constructor().copy(this)}}class GM{constructor(e,t,n,s){GM.prototype.isMatrix2=!0,this.elements=[1,0,0,1],e!==void 0&&this.set(e,t,n,s)}identity(){return this.set(1,0,0,1),this}fromArray(e,t=0){for(let n=0;n<4;n++)this.elements[n]=e[n+t];return this}set(e,t,n,s){const i=this.elements;return i[0]=e,i[2]=t,i[1]=n,i[3]=s,this}}const pA=new Ve;class nX{constructor(e=new Ve(1/0,1/0),t=new Ve(-1/0,-1/0)){this.isBox2=!0,this.min=e,this.max=t}set(e,t){return this.min.copy(e),this.max.copy(t),this}setFromPoints(e){this.makeEmpty();for(let t=0,n=e.length;t<n;t++)this.expandByPoint(e[t]);return this}setFromCenterAndSize(e,t){const n=pA.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(n),this.max.copy(e).add(n),this}clone(){return new this.constructor().copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=1/0,this.max.x=this.max.y=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y}getCenter(e){return this.isEmpty()?e.set(0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}containsPoint(e){return e.x>=this.min.x&&e.x<=this.max.x&&e.y>=this.min.y&&e.y<=this.max.y}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y}getParameter(e,t){return t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y))}intersectsBox(e){return e.max.x>=this.min.x&&e.min.x<=this.max.x&&e.max.y>=this.min.y&&e.min.y<=this.max.y}clampPoint(e,t){return t.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return this.clampPoint(e,pA).distanceTo(e)}intersect(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}}const mA=new J,Xx=new J;class rX{constructor(e=new J,t=new J){this.start=e,this.end=t}set(e,t){return this.start.copy(e),this.end.copy(t),this}copy(e){return this.start.copy(e.start),this.end.copy(e.end),this}getCenter(e){return e.addVectors(this.start,this.end).multiplyScalar(.5)}delta(e){return e.subVectors(this.end,this.start)}distanceSq(){return this.start.distanceToSquared(this.end)}distance(){return this.start.distanceTo(this.end)}at(e,t){return this.delta(t).multiplyScalar(e).add(this.start)}closestPointToPointParameter(e,t){mA.subVectors(e,this.start),Xx.subVectors(this.end,this.start);const n=Xx.dot(Xx);let i=Xx.dot(mA)/n;return t&&(i=an(i,0,1)),i}closestPointToPoint(e,t,n){const s=this.closestPointToPointParameter(e,t);return this.delta(n).multiplyScalar(s).add(this.start)}applyMatrix4(e){return this.start.applyMatrix4(e),this.end.applyMatrix4(e),this}equals(e){return e.start.equals(this.start)&&e.end.equals(this.end)}clone(){return new this.constructor().copy(this)}}const gA=new J;class sX extends jn{constructor(e,t){super(),this.light=e,this.matrixAutoUpdate=!1,this.color=t,this.type="SpotLightHelper";const n=new mn,s=[0,0,0,0,0,1,0,0,0,1,0,1,0,0,0,-1,0,1,0,0,0,0,1,1,0,0,0,0,-1,1];for(let o=0,a=1,c=32;o<c;o++,a++){const d=o/c*Math.PI*2,f=a/c*Math.PI*2;s.push(Math.cos(d),Math.sin(d),1,Math.cos(f),Math.sin(f),1)}n.setAttribute("position",new It(s,3));const i=new di({fog:!1,toneMapped:!1});this.cone=new Ya(n,i),this.add(this.cone),this.update()}dispose(){this.cone.geometry.dispose(),this.cone.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.light.target.updateWorldMatrix(!0,!1),this.parent?(this.parent.updateWorldMatrix(!0),this.matrix.copy(this.parent.matrixWorld).invert().multiply(this.light.matrixWorld)):this.matrix.copy(this.light.matrixWorld),this.matrixWorld.copy(this.light.matrixWorld);const e=this.light.distance?this.light.distance:1e3,t=e*Math.tan(this.light.angle);this.cone.scale.set(t,t,e),gA.setFromMatrixPosition(this.light.target.matrixWorld),this.cone.lookAt(gA),this.color!==void 0?this.cone.material.color.set(this.color):this.cone.material.color.copy(this.light.color)}}const Gc=new J,Yx=new Jt,xS=new Jt;class iX extends Ya{constructor(e){const t=zD(e),n=new mn,s=[],i=[],o=new St(0,0,1),a=new St(0,1,0);for(let d=0;d<t.length;d++){const f=t[d];f.parent&&f.parent.isBone&&(s.push(0,0,0),s.push(0,0,0),i.push(o.r,o.g,o.b),i.push(a.r,a.g,a.b))}n.setAttribute("position",new It(s,3)),n.setAttribute("color",new It(i,3));const c=new di({vertexColors:!0,depthTest:!1,depthWrite:!1,toneMapped:!1,transparent:!0});super(n,c),this.isSkeletonHelper=!0,this.type="SkeletonHelper",this.root=e,this.bones=t,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1}updateMatrixWorld(e){const t=this.bones,n=this.geometry,s=n.getAttribute("position");xS.copy(this.root.matrixWorld).invert();for(let i=0,o=0;i<t.length;i++){const a=t[i];a.parent&&a.parent.isBone&&(Yx.multiplyMatrices(xS,a.matrixWorld),Gc.setFromMatrixPosition(Yx),s.setXYZ(o,Gc.x,Gc.y,Gc.z),Yx.multiplyMatrices(xS,a.parent.matrixWorld),Gc.setFromMatrixPosition(Yx),s.setXYZ(o+1,Gc.x,Gc.y,Gc.z),o+=2)}n.getAttribute("position").needsUpdate=!0,super.updateMatrixWorld(e)}dispose(){this.geometry.dispose(),this.material.dispose()}}function zD(r){const e=[];r.isBone===!0&&e.push(r);for(let t=0;t<r.children.length;t++)e.push(...zD(r.children[t]));return e}class oX extends Ur{constructor(e,t,n){const s=new J0(t,4,2),i=new Tu({wireframe:!0,fog:!1,toneMapped:!1});super(s,i),this.light=e,this.color=n,this.type="PointLightHelper",this.matrix=this.light.matrixWorld,this.matrixAutoUpdate=!1,this.update()}dispose(){this.geometry.dispose(),this.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.color!==void 0?this.material.color.set(this.color):this.material.color.copy(this.light.color)}}const aX=new J,vA=new St,xA=new St;class lX extends jn{constructor(e,t,n){super(),this.light=e,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=n,this.type="HemisphereLightHelper";const s=new Q0(t);s.rotateY(Math.PI*.5),this.material=new Tu({wireframe:!0,fog:!1,toneMapped:!1}),this.color===void 0&&(this.material.vertexColors=!0);const i=s.getAttribute("position"),o=new Float32Array(i.count*3);s.setAttribute("color",new Kn(o,3)),this.add(new Ur(s,this.material)),this.update()}dispose(){this.children[0].geometry.dispose(),this.children[0].material.dispose()}update(){const e=this.children[0];if(this.color!==void 0)this.material.color.set(this.color);else{const t=e.geometry.getAttribute("color");vA.copy(this.light.color),xA.copy(this.light.groundColor);for(let n=0,s=t.count;n<s;n++){const i=n<s/2?vA:xA;t.setXYZ(n,i.r,i.g,i.b)}t.needsUpdate=!0}this.light.updateWorldMatrix(!0,!1),e.lookAt(aX.setFromMatrixPosition(this.light.matrixWorld).negate())}}class cX extends Ya{constructor(e=10,t=10,n=4473924,s=8947848){n=new St(n),s=new St(s);const i=t/2,o=e/t,a=e/2,c=[],d=[];for(let v=0,x=0,_=-a;v<=t;v++,_+=o){c.push(-a,0,_,a,0,_),c.push(_,0,-a,_,0,a);const b=v===i?n:s;b.toArray(d,x),x+=3,b.toArray(d,x),x+=3,b.toArray(d,x),x+=3,b.toArray(d,x),x+=3}const f=new mn;f.setAttribute("position",new It(c,3)),f.setAttribute("color",new It(d,3));const m=new di({vertexColors:!0,toneMapped:!1});super(f,m),this.type="GridHelper"}dispose(){this.geometry.dispose(),this.material.dispose()}}class uX extends Ya{constructor(e=10,t=16,n=8,s=64,i=4473924,o=8947848){i=new St(i),o=new St(o);const a=[],c=[];if(t>1)for(let m=0;m<t;m++){const v=m/t*(Math.PI*2),x=Math.sin(v)*e,_=Math.cos(v)*e;a.push(0,0,0),a.push(x,0,_);const b=m&1?i:o;c.push(b.r,b.g,b.b),c.push(b.r,b.g,b.b)}for(let m=0;m<n;m++){const v=m&1?i:o,x=e-e/n*m;for(let _=0;_<s;_++){let b=_/s*(Math.PI*2),w=Math.sin(b)*x,S=Math.cos(b)*x;a.push(w,0,S),c.push(v.r,v.g,v.b),b=(_+1)/s*(Math.PI*2),w=Math.sin(b)*x,S=Math.cos(b)*x,a.push(w,0,S),c.push(v.r,v.g,v.b)}}const d=new mn;d.setAttribute("position",new It(a,3)),d.setAttribute("color",new It(c,3));const f=new di({vertexColors:!0,toneMapped:!1});super(d,f),this.type="PolarGridHelper"}dispose(){this.geometry.dispose(),this.material.dispose()}}const yA=new J,Kx=new J,_A=new J;class dX extends jn{constructor(e,t,n){super(),this.light=e,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=n,this.type="DirectionalLightHelper",t===void 0&&(t=1);let s=new mn;s.setAttribute("position",new It([-t,t,0,t,t,0,t,-t,0,-t,-t,0,-t,t,0],3));const i=new di({fog:!1,toneMapped:!1});this.lightPlane=new yu(s,i),this.add(this.lightPlane),s=new mn,s.setAttribute("position",new It([0,0,0,0,0,1],3)),this.targetLine=new yu(s,i),this.add(this.targetLine),this.update()}dispose(){this.lightPlane.geometry.dispose(),this.lightPlane.material.dispose(),this.targetLine.geometry.dispose(),this.targetLine.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.light.target.updateWorldMatrix(!0,!1),yA.setFromMatrixPosition(this.light.matrixWorld),Kx.setFromMatrixPosition(this.light.target.matrixWorld),_A.subVectors(Kx,yA),this.lightPlane.lookAt(Kx),this.color!==void 0?(this.lightPlane.material.color.set(this.color),this.targetLine.material.color.set(this.color)):(this.lightPlane.material.color.copy(this.light.color),this.targetLine.material.color.copy(this.light.color)),this.targetLine.lookAt(Kx),this.targetLine.scale.z=_A.length()}}const Qx=new J,xr=new q0;class hX extends Ya{constructor(e){const t=new mn,n=new di({color:16777215,vertexColors:!0,toneMapped:!1}),s=[],i=[],o={};a("n1","n2"),a("n2","n4"),a("n4","n3"),a("n3","n1"),a("f1","f2"),a("f2","f4"),a("f4","f3"),a("f3","f1"),a("n1","f1"),a("n2","f2"),a("n3","f3"),a("n4","f4"),a("p","n1"),a("p","n2"),a("p","n3"),a("p","n4"),a("u1","u2"),a("u2","u3"),a("u3","u1"),a("c","t"),a("p","c"),a("cn1","cn2"),a("cn3","cn4"),a("cf1","cf2"),a("cf3","cf4");function a(_,b){c(_),c(b)}function c(_){s.push(0,0,0),i.push(0,0,0),o[_]===void 0&&(o[_]=[]),o[_].push(s.length/3-1)}t.setAttribute("position",new It(s,3)),t.setAttribute("color",new It(i,3)),super(t,n),this.type="CameraHelper",this.camera=e,this.camera.updateProjectionMatrix&&this.camera.updateProjectionMatrix(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.pointMap=o,this.update();const d=new St(16755200),f=new St(16711680),m=new St(43775),v=new St(16777215),x=new St(3355443);this.setColors(d,f,m,v,x)}setColors(e,t,n,s,i){const a=this.geometry.getAttribute("color");a.setXYZ(0,e.r,e.g,e.b),a.setXYZ(1,e.r,e.g,e.b),a.setXYZ(2,e.r,e.g,e.b),a.setXYZ(3,e.r,e.g,e.b),a.setXYZ(4,e.r,e.g,e.b),a.setXYZ(5,e.r,e.g,e.b),a.setXYZ(6,e.r,e.g,e.b),a.setXYZ(7,e.r,e.g,e.b),a.setXYZ(8,e.r,e.g,e.b),a.setXYZ(9,e.r,e.g,e.b),a.setXYZ(10,e.r,e.g,e.b),a.setXYZ(11,e.r,e.g,e.b),a.setXYZ(12,e.r,e.g,e.b),a.setXYZ(13,e.r,e.g,e.b),a.setXYZ(14,e.r,e.g,e.b),a.setXYZ(15,e.r,e.g,e.b),a.setXYZ(16,e.r,e.g,e.b),a.setXYZ(17,e.r,e.g,e.b),a.setXYZ(18,e.r,e.g,e.b),a.setXYZ(19,e.r,e.g,e.b),a.setXYZ(20,e.r,e.g,e.b),a.setXYZ(21,e.r,e.g,e.b),a.setXYZ(22,e.r,e.g,e.b),a.setXYZ(23,e.r,e.g,e.b),a.setXYZ(24,t.r,t.g,t.b),a.setXYZ(25,t.r,t.g,t.b),a.setXYZ(26,t.r,t.g,t.b),a.setXYZ(27,t.r,t.g,t.b),a.setXYZ(28,t.r,t.g,t.b),a.setXYZ(29,t.r,t.g,t.b),a.setXYZ(30,t.r,t.g,t.b),a.setXYZ(31,t.r,t.g,t.b),a.setXYZ(32,n.r,n.g,n.b),a.setXYZ(33,n.r,n.g,n.b),a.setXYZ(34,n.r,n.g,n.b),a.setXYZ(35,n.r,n.g,n.b),a.setXYZ(36,n.r,n.g,n.b),a.setXYZ(37,n.r,n.g,n.b),a.setXYZ(38,s.r,s.g,s.b),a.setXYZ(39,s.r,s.g,s.b),a.setXYZ(40,i.r,i.g,i.b),a.setXYZ(41,i.r,i.g,i.b),a.setXYZ(42,i.r,i.g,i.b),a.setXYZ(43,i.r,i.g,i.b),a.setXYZ(44,i.r,i.g,i.b),a.setXYZ(45,i.r,i.g,i.b),a.setXYZ(46,i.r,i.g,i.b),a.setXYZ(47,i.r,i.g,i.b),a.setXYZ(48,i.r,i.g,i.b),a.setXYZ(49,i.r,i.g,i.b),a.needsUpdate=!0}update(){const e=this.geometry,t=this.pointMap,n=1,s=1;xr.projectionMatrixInverse.copy(this.camera.projectionMatrixInverse);const i=this.camera.coordinateSystem===xo?-1:0;Mr("c",t,e,xr,0,0,i),Mr("t",t,e,xr,0,0,1),Mr("n1",t,e,xr,-1,-1,i),Mr("n2",t,e,xr,n,-1,i),Mr("n3",t,e,xr,-1,s,i),Mr("n4",t,e,xr,n,s,i),Mr("f1",t,e,xr,-1,-1,1),Mr("f2",t,e,xr,n,-1,1),Mr("f3",t,e,xr,-1,s,1),Mr("f4",t,e,xr,n,s,1),Mr("u1",t,e,xr,n*.7,s*1.1,i),Mr("u2",t,e,xr,-1*.7,s*1.1,i),Mr("u3",t,e,xr,0,s*2,i),Mr("cf1",t,e,xr,-1,0,1),Mr("cf2",t,e,xr,n,0,1),Mr("cf3",t,e,xr,0,-1,1),Mr("cf4",t,e,xr,0,s,1),Mr("cn1",t,e,xr,-1,0,i),Mr("cn2",t,e,xr,n,0,i),Mr("cn3",t,e,xr,0,-1,i),Mr("cn4",t,e,xr,0,s,i),e.getAttribute("position").needsUpdate=!0}dispose(){this.geometry.dispose(),this.material.dispose()}}function Mr(r,e,t,n,s,i,o){Qx.set(s,i,o).unproject(n);const a=e[r];if(a!==void 0){const c=t.getAttribute("position");for(let d=0,f=a.length;d<f;d++)c.setXYZ(a[d],Qx.x,Qx.y,Qx.z)}}const Jx=new Ws;class fX extends Ya{constructor(e,t=16776960){const n=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),s=new Float32Array(8*3),i=new mn;i.setIndex(new Kn(n,1)),i.setAttribute("position",new Kn(s,3)),super(i,new di({color:t,toneMapped:!1})),this.object=e,this.type="BoxHelper",this.matrixAutoUpdate=!1,this.update()}update(){if(this.object!==void 0&&Jx.setFromObject(this.object),Jx.isEmpty())return;const e=Jx.min,t=Jx.max,n=this.geometry.attributes.position,s=n.array;s[0]=t.x,s[1]=t.y,s[2]=t.z,s[3]=e.x,s[4]=t.y,s[5]=t.z,s[6]=e.x,s[7]=e.y,s[8]=t.z,s[9]=t.x,s[10]=e.y,s[11]=t.z,s[12]=t.x,s[13]=t.y,s[14]=e.z,s[15]=e.x,s[16]=t.y,s[17]=e.z,s[18]=e.x,s[19]=e.y,s[20]=e.z,s[21]=t.x,s[22]=e.y,s[23]=e.z,n.needsUpdate=!0,this.geometry.computeBoundingSphere()}setFromObject(e){return this.object=e,this.update(),this}copy(e,t){return super.copy(e,t),this.object=e.object,this}dispose(){this.geometry.dispose(),this.material.dispose()}}class pX extends Ya{constructor(e,t=16776960){const n=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),s=[1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,-1,-1,1,-1,-1,-1,-1,1,-1,-1],i=new mn;i.setIndex(new Kn(n,1)),i.setAttribute("position",new It(s,3)),super(i,new di({color:t,toneMapped:!1})),this.box=e,this.type="Box3Helper",this.geometry.computeBoundingSphere()}updateMatrixWorld(e){const t=this.box;t.isEmpty()||(t.getCenter(this.position),t.getSize(this.scale),this.scale.multiplyScalar(.5),super.updateMatrixWorld(e))}dispose(){this.geometry.dispose(),this.material.dispose()}}class mX extends yu{constructor(e,t=1,n=16776960){const s=n,i=[1,-1,0,-1,1,0,-1,-1,0,1,1,0,-1,1,0,-1,-1,0,1,-1,0,1,1,0],o=new mn;o.setAttribute("position",new It(i,3)),o.computeBoundingSphere(),super(o,new di({color:s,toneMapped:!1})),this.type="PlaneHelper",this.plane=e,this.size=t;const a=[1,1,0,-1,1,0,-1,-1,0,1,1,0,-1,-1,0,1,-1,0],c=new mn;c.setAttribute("position",new It(a,3)),c.computeBoundingSphere(),this.add(new Ur(c,new Tu({color:s,opacity:.2,transparent:!0,depthWrite:!1,toneMapped:!1})))}updateMatrixWorld(e){this.position.set(0,0,0),this.scale.set(.5*this.size,.5*this.size,1),this.lookAt(this.plane.normal),this.translateZ(-this.plane.constant),super.updateMatrixWorld(e)}dispose(){this.geometry.dispose(),this.material.dispose(),this.children[0].geometry.dispose(),this.children[0].material.dispose()}}const wA=new J;let Zx,yS;class gX extends jn{constructor(e=new J(0,0,1),t=new J(0,0,0),n=1,s=16776960,i=n*.2,o=i*.2){super(),this.type="ArrowHelper",Zx===void 0&&(Zx=new mn,Zx.setAttribute("position",new It([0,0,0,0,1,0],3)),yS=new K0(.5,1,5,1),yS.translate(0,-.5,0)),this.position.copy(t),this.line=new yu(Zx,new di({color:s,toneMapped:!1})),this.line.matrixAutoUpdate=!1,this.add(this.line),this.cone=new Ur(yS,new Tu({color:s,toneMapped:!1})),this.cone.matrixAutoUpdate=!1,this.add(this.cone),this.setDirection(e),this.setLength(n,i,o)}setDirection(e){if(e.y>.99999)this.quaternion.set(0,0,0,1);else if(e.y<-.99999)this.quaternion.set(1,0,0,0);else{wA.set(e.z,0,-e.x).normalize();const t=Math.acos(e.y);this.quaternion.setFromAxisAngle(wA,t)}}setLength(e,t=e*.2,n=t*.2){this.line.scale.set(1,Math.max(1e-4,e-t),1),this.line.updateMatrix(),this.cone.scale.set(n,t,n),this.cone.position.y=e,this.cone.updateMatrix()}setColor(e){this.line.material.color.set(e),this.cone.material.color.set(e)}copy(e){return super.copy(e,!1),this.line.copy(e.line),this.cone.copy(e.cone),this}dispose(){this.line.geometry.dispose(),this.line.material.dispose(),this.cone.geometry.dispose(),this.cone.material.dispose()}}class vX extends Ya{constructor(e=1){const t=[0,0,0,e,0,0,0,0,0,0,e,0,0,0,0,0,0,e],n=[1,0,0,1,.6,0,0,1,0,.6,1,0,0,0,1,0,.6,1],s=new mn;s.setAttribute("position",new It(t,3)),s.setAttribute("color",new It(n,3));const i=new di({vertexColors:!0,toneMapped:!1});super(s,i),this.type="AxesHelper"}setColors(e,t,n){const s=new St,i=this.geometry.attributes.color.array;return s.set(e),s.toArray(i,0),s.toArray(i,3),s.set(t),s.toArray(i,6),s.toArray(i,9),s.set(n),s.toArray(i,12),s.toArray(i,15),this.geometry.attributes.color.needsUpdate=!0,this}dispose(){this.geometry.dispose(),this.material.dispose()}}class xX{constructor(){this.type="ShapePath",this.color=new St,this.subPaths=[],this.currentPath=null}moveTo(e,t){return this.currentPath=new v_,this.subPaths.push(this.currentPath),this.currentPath.moveTo(e,t),this}lineTo(e,t){return this.currentPath.lineTo(e,t),this}quadraticCurveTo(e,t,n,s){return this.currentPath.quadraticCurveTo(e,t,n,s),this}bezierCurveTo(e,t,n,s,i,o){return this.currentPath.bezierCurveTo(e,t,n,s,i,o),this}splineThru(e){return this.currentPath.splineThru(e),this}toShapes(e){function t(S){const C=[];for(let T=0,A=S.length;T<A;T++){const k=S[T],j=new eh;j.curves=k.curves,C.push(j)}return C}function n(S,C){const T=C.length;let A=!1;for(let k=T-1,j=0;j<T;k=j++){let D=C[k],L=C[j],O=L.x-D.x,I=L.y-D.y;if(Math.abs(I)>Number.EPSILON){if(I<0&&(D=C[j],O=-O,L=C[k],I=-I),S.y<D.y||S.y>L.y)continue;if(S.y===D.y){if(S.x===D.x)return!0}else{const B=I*(S.x-D.x)-O*(S.y-D.y);if(B===0)return!0;if(B<0)continue;A=!A}}else{if(S.y!==D.y)continue;if(L.x<=S.x&&S.x<=D.x||D.x<=S.x&&S.x<=L.x)return!0}}return A}const s=ia.isClockWise,i=this.subPaths;if(i.length===0)return[];let o,a,c;const d=[];if(i.length===1)return a=i[0],c=new eh,c.curves=a.curves,d.push(c),d;let f=!s(i[0].getPoints());f=e?!f:f;const m=[],v=[];let x=[],_=0,b;v[_]=void 0,x[_]=[];for(let S=0,C=i.length;S<C;S++)a=i[S],b=a.getPoints(),o=s(b),o=e?!o:o,o?(!f&&v[_]&&_++,v[_]={s:new eh,p:b},v[_].s.curves=a.curves,f&&_++,x[_]=[]):x[_].push({h:a,p:b[0]});if(!v[0])return t(i);if(v.length>1){let S=!1,C=0;for(let T=0,A=v.length;T<A;T++)m[T]=[];for(let T=0,A=v.length;T<A;T++){const k=x[T];for(let j=0;j<k.length;j++){const D=k[j];let L=!0;for(let O=0;O<v.length;O++)n(D.p,v[O].p)&&(T!==O&&C++,L?(L=!1,m[O].push(D)):S=!0);L&&m[T].push(D)}}C>0&&S===!1&&(x=m)}let w;for(let S=0,C=v.length;S<C;S++){c=v[S].s,d.push(c),w=x[S];for(let T=0,A=w.length;T<A;T++)c.holes.push(w[T].h)}return d}}class yX extends Xa{constructor(e,t=null){super(),this.object=e,this.domElement=t,this.enabled=!0,this.state=-1,this.keys={},this.mouseButtons={LEFT:null,MIDDLE:null,RIGHT:null},this.touches={ONE:null,TWO:null}}connect(e){if(e===void 0){console.warn("THREE.Controls: connect() now requires an element.");return}this.domElement!==null&&this.disconnect(),this.domElement=e}disconnect(){}dispose(){}update(){}}function _X(r,e){const t=r.image&&r.image.width?r.image.width/r.image.height:1;return t>e?(r.repeat.x=1,r.repeat.y=t/e,r.offset.x=0,r.offset.y=(1-r.repeat.y)/2):(r.repeat.x=e/t,r.repeat.y=1,r.offset.x=(1-r.repeat.x)/2,r.offset.y=0),r}function wX(r,e){const t=r.image&&r.image.width?r.image.width/r.image.height:1;return t>e?(r.repeat.x=e/t,r.repeat.y=1,r.offset.x=(1-r.repeat.x)/2,r.offset.y=0):(r.repeat.x=1,r.repeat.y=t/e,r.offset.x=0,r.offset.y=(1-r.repeat.y)/2),r}function SX(r){return r.repeat.x=1,r.repeat.y=1,r.offset.x=0,r.offset.y=0,r}function Wb(r,e,t,n){const s=bX(n);switch(t){case uM:return r*e;case rw:return r*e/s.components*s.byteLength;case $0:return r*e/s.components*s.byteLength;case hM:return r*e*2/s.components*s.byteLength;case sw:return r*e*2/s.components*s.byteLength;case dM:return r*e*3/s.components*s.byteLength;case Vs:return r*e*4/s.components*s.byteLength;case iw:return r*e*4/s.components*s.byteLength;case qg:case Xg:return Math.floor((r+3)/4)*Math.floor((e+3)/4)*8;case Yg:case Kg:return Math.floor((r+3)/4)*Math.floor((e+3)/4)*16;case Vy:case Gy:return Math.max(r,16)*Math.max(e,8)/4;case zy:case Hy:return Math.max(r,8)*Math.max(e,8)/2;case Wy:case $y:return Math.floor((r+3)/4)*Math.floor((e+3)/4)*8;case qy:return Math.floor((r+3)/4)*Math.floor((e+3)/4)*16;case Xy:return Math.floor((r+3)/4)*Math.floor((e+3)/4)*16;case Yy:return Math.floor((r+4)/5)*Math.floor((e+3)/4)*16;case Ky:return Math.floor((r+4)/5)*Math.floor((e+4)/5)*16;case Qy:return Math.floor((r+5)/6)*Math.floor((e+4)/5)*16;case Jy:return Math.floor((r+5)/6)*Math.floor((e+5)/6)*16;case Zy:return Math.floor((r+7)/8)*Math.floor((e+4)/5)*16;case e_:return Math.floor((r+7)/8)*Math.floor((e+5)/6)*16;case t_:return Math.floor((r+7)/8)*Math.floor((e+7)/8)*16;case n_:return Math.floor((r+9)/10)*Math.floor((e+4)/5)*16;case r_:return Math.floor((r+9)/10)*Math.floor((e+5)/6)*16;case s_:return Math.floor((r+9)/10)*Math.floor((e+7)/8)*16;case i_:return Math.floor((r+9)/10)*Math.floor((e+9)/10)*16;case o_:return Math.floor((r+11)/12)*Math.floor((e+9)/10)*16;case a_:return Math.floor((r+11)/12)*Math.floor((e+11)/12)*16;case Qg:case l_:case c_:return Math.ceil(r/4)*Math.ceil(e/4)*16;case fM:case u_:return Math.ceil(r/4)*Math.ceil(e/4)*8;case d_:case h_:return Math.ceil(r/4)*Math.ceil(e/4)*16}throw new Error(`Unable to determine texture byte length for ${t} format.`)}function bX(r){switch(r){case _o:case aM:return{byteLength:1,components:1};case Hp:case lM:case fm:return{byteLength:2,components:1};case tw:case nw:return{byteLength:2,components:4};case tc:case ew:case Ii:return{byteLength:4,components:1};case cM:return{byteLength:4,components:3}}throw new Error(`Unknown texture type ${r}.`)}class EX{static contain(e,t){return _X(e,t)}static cover(e,t){return wX(e,t)}static fill(e){return SX(e)}static getByteLength(e,t,n,s){return Wb(e,t,n,s)}}typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:Q_}}));typeof window<"u"&&(window.__THREE__?console.warn("WARNING: Multiple instances of Three.js being imported."):window.__THREE__=Q_);/**
 * @license
 * Copyright 2010-2025 Three.js Authors
 * SPDX-License-Identifier: MIT
 */function VD(){let r=null,e=!1,t=null,n=null;function s(i,o){t(i,o),n=r.requestAnimationFrame(s)}return{start:function(){e!==!0&&t!==null&&(n=r.requestAnimationFrame(s),e=!0)},stop:function(){r.cancelAnimationFrame(n),e=!1},setAnimationLoop:function(i){t=i},setContext:function(i){r=i}}}function MX(r){const e=new WeakMap;function t(a,c){const d=a.array,f=a.usage,m=d.byteLength,v=r.createBuffer();r.bindBuffer(c,v),r.bufferData(c,d,f),a.onUploadCallback();let x;if(d instanceof Float32Array)x=r.FLOAT;else if(d instanceof Uint16Array)a.isFloat16BufferAttribute?x=r.HALF_FLOAT:x=r.UNSIGNED_SHORT;else if(d instanceof Int16Array)x=r.SHORT;else if(d instanceof Uint32Array)x=r.UNSIGNED_INT;else if(d instanceof Int32Array)x=r.INT;else if(d instanceof Int8Array)x=r.BYTE;else if(d instanceof Uint8Array)x=r.UNSIGNED_BYTE;else if(d instanceof Uint8ClampedArray)x=r.UNSIGNED_BYTE;else throw new Error("THREE.WebGLAttributes: Unsupported buffer data format: "+d);return{buffer:v,type:x,bytesPerElement:d.BYTES_PER_ELEMENT,version:a.version,size:m}}function n(a,c,d){const f=c.array,m=c.updateRanges;if(r.bindBuffer(d,a),m.length===0)r.bufferSubData(d,0,f);else{m.sort((x,_)=>x.start-_.start);let v=0;for(let x=1;x<m.length;x++){const _=m[v],b=m[x];b.start<=_.start+_.count+1?_.count=Math.max(_.count,b.start+b.count-_.start):(++v,m[v]=b)}m.length=v+1;for(let x=0,_=m.length;x<_;x++){const b=m[x];r.bufferSubData(d,b.start*f.BYTES_PER_ELEMENT,f,b.start,b.count)}c.clearUpdateRanges()}c.onUploadCallback()}function s(a){return a.isInterleavedBufferAttribute&&(a=a.data),e.get(a)}function i(a){a.isInterleavedBufferAttribute&&(a=a.data);const c=e.get(a);c&&(r.deleteBuffer(c.buffer),e.delete(a))}function o(a,c){if(a.isInterleavedBufferAttribute&&(a=a.data),a.isGLBufferAttribute){const f=e.get(a);(!f||f.version<a.version)&&e.set(a,{buffer:a.buffer,type:a.type,bytesPerElement:a.elementSize,version:a.version});return}const d=e.get(a);if(d===void 0)e.set(a,t(a,c));else if(d.version<a.version){if(d.size!==a.array.byteLength)throw new Error("THREE.WebGLAttributes: The size of the buffer attribute's array buffer does not match the original size. Resizing buffer attributes is not supported.");n(d.buffer,a,c),d.version=a.version}}return{get:s,remove:i,update:o}}var TX=`#ifdef USE_ALPHAHASH
	if ( diffuseColor.a < getAlphaHashThreshold( vPosition ) ) discard;
#endif`,CX=`#ifdef USE_ALPHAHASH
	const float ALPHA_HASH_SCALE = 0.05;
	float hash2D( vec2 value ) {
		return fract( 1.0e4 * sin( 17.0 * value.x + 0.1 * value.y ) * ( 0.1 + abs( sin( 13.0 * value.y + value.x ) ) ) );
	}
	float hash3D( vec3 value ) {
		return hash2D( vec2( hash2D( value.xy ), value.z ) );
	}
	float getAlphaHashThreshold( vec3 position ) {
		float maxDeriv = max(
			length( dFdx( position.xyz ) ),
			length( dFdy( position.xyz ) )
		);
		float pixScale = 1.0 / ( ALPHA_HASH_SCALE * maxDeriv );
		vec2 pixScales = vec2(
			exp2( floor( log2( pixScale ) ) ),
			exp2( ceil( log2( pixScale ) ) )
		);
		vec2 alpha = vec2(
			hash3D( floor( pixScales.x * position.xyz ) ),
			hash3D( floor( pixScales.y * position.xyz ) )
		);
		float lerpFactor = fract( log2( pixScale ) );
		float x = ( 1.0 - lerpFactor ) * alpha.x + lerpFactor * alpha.y;
		float a = min( lerpFactor, 1.0 - lerpFactor );
		vec3 cases = vec3(
			x * x / ( 2.0 * a * ( 1.0 - a ) ),
			( x - 0.5 * a ) / ( 1.0 - a ),
			1.0 - ( ( 1.0 - x ) * ( 1.0 - x ) / ( 2.0 * a * ( 1.0 - a ) ) )
		);
		float threshold = ( x < ( 1.0 - a ) )
			? ( ( x < a ) ? cases.x : cases.y )
			: cases.z;
		return clamp( threshold , 1.0e-6, 1.0 );
	}
#endif`,AX=`#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, vAlphaMapUv ).g;
#endif`,RX=`#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,NX=`#ifdef USE_ALPHATEST
	#ifdef ALPHA_TO_COVERAGE
	diffuseColor.a = smoothstep( alphaTest, alphaTest + fwidth( diffuseColor.a ), diffuseColor.a );
	if ( diffuseColor.a == 0.0 ) discard;
	#else
	if ( diffuseColor.a < alphaTest ) discard;
	#endif
#endif`,PX=`#ifdef USE_ALPHATEST
	uniform float alphaTest;
#endif`,IX=`#ifdef USE_AOMAP
	float ambientOcclusion = ( texture2D( aoMap, vAoMapUv ).r - 1.0 ) * aoMapIntensity + 1.0;
	reflectedLight.indirectDiffuse *= ambientOcclusion;
	#if defined( USE_CLEARCOAT ) 
		clearcoatSpecularIndirect *= ambientOcclusion;
	#endif
	#if defined( USE_SHEEN ) 
		sheenSpecularIndirect *= ambientOcclusion;
	#endif
	#if defined( USE_ENVMAP ) && defined( STANDARD )
		float dotNV = saturate( dot( geometryNormal, geometryViewDir ) );
		reflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.roughness );
	#endif
#endif`,kX=`#ifdef USE_AOMAP
	uniform sampler2D aoMap;
	uniform float aoMapIntensity;
#endif`,DX=`#ifdef USE_BATCHING
	#if ! defined( GL_ANGLE_multi_draw )
	#define gl_DrawID _gl_DrawID
	uniform int _gl_DrawID;
	#endif
	uniform highp sampler2D batchingTexture;
	uniform highp usampler2D batchingIdTexture;
	mat4 getBatchingMatrix( const in float i ) {
		int size = textureSize( batchingTexture, 0 ).x;
		int j = int( i ) * 4;
		int x = j % size;
		int y = j / size;
		vec4 v1 = texelFetch( batchingTexture, ivec2( x, y ), 0 );
		vec4 v2 = texelFetch( batchingTexture, ivec2( x + 1, y ), 0 );
		vec4 v3 = texelFetch( batchingTexture, ivec2( x + 2, y ), 0 );
		vec4 v4 = texelFetch( batchingTexture, ivec2( x + 3, y ), 0 );
		return mat4( v1, v2, v3, v4 );
	}
	float getIndirectIndex( const in int i ) {
		int size = textureSize( batchingIdTexture, 0 ).x;
		int x = i % size;
		int y = i / size;
		return float( texelFetch( batchingIdTexture, ivec2( x, y ), 0 ).r );
	}
#endif
#ifdef USE_BATCHING_COLOR
	uniform sampler2D batchingColorTexture;
	vec3 getBatchingColor( const in float i ) {
		int size = textureSize( batchingColorTexture, 0 ).x;
		int j = int( i );
		int x = j % size;
		int y = j / size;
		return texelFetch( batchingColorTexture, ivec2( x, y ), 0 ).rgb;
	}
#endif`,LX=`#ifdef USE_BATCHING
	mat4 batchingMatrix = getBatchingMatrix( getIndirectIndex( gl_DrawID ) );
#endif`,OX=`vec3 transformed = vec3( position );
#ifdef USE_ALPHAHASH
	vPosition = vec3( position );
#endif`,jX=`vec3 objectNormal = vec3( normal );
#ifdef USE_TANGENT
	vec3 objectTangent = vec3( tangent.xyz );
#endif`,FX=`float G_BlinnPhong_Implicit( ) {
	return 0.25;
}
float D_BlinnPhong( const in float shininess, const in float dotNH ) {
	return RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );
}
vec3 BRDF_BlinnPhong( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float shininess ) {
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );
	vec3 F = F_Schlick( specularColor, 1.0, dotVH );
	float G = G_BlinnPhong_Implicit( );
	float D = D_BlinnPhong( shininess, dotNH );
	return F * ( G * D );
} // validated`,UX=`#ifdef USE_IRIDESCENCE
	const mat3 XYZ_TO_REC709 = mat3(
		 3.2404542, -0.9692660,  0.0556434,
		-1.5371385,  1.8760108, -0.2040259,
		-0.4985314,  0.0415560,  1.0572252
	);
	vec3 Fresnel0ToIor( vec3 fresnel0 ) {
		vec3 sqrtF0 = sqrt( fresnel0 );
		return ( vec3( 1.0 ) + sqrtF0 ) / ( vec3( 1.0 ) - sqrtF0 );
	}
	vec3 IorToFresnel0( vec3 transmittedIor, float incidentIor ) {
		return pow2( ( transmittedIor - vec3( incidentIor ) ) / ( transmittedIor + vec3( incidentIor ) ) );
	}
	float IorToFresnel0( float transmittedIor, float incidentIor ) {
		return pow2( ( transmittedIor - incidentIor ) / ( transmittedIor + incidentIor ));
	}
	vec3 evalSensitivity( float OPD, vec3 shift ) {
		float phase = 2.0 * PI * OPD * 1.0e-9;
		vec3 val = vec3( 5.4856e-13, 4.4201e-13, 5.2481e-13 );
		vec3 pos = vec3( 1.6810e+06, 1.7953e+06, 2.2084e+06 );
		vec3 var = vec3( 4.3278e+09, 9.3046e+09, 6.6121e+09 );
		vec3 xyz = val * sqrt( 2.0 * PI * var ) * cos( pos * phase + shift ) * exp( - pow2( phase ) * var );
		xyz.x += 9.7470e-14 * sqrt( 2.0 * PI * 4.5282e+09 ) * cos( 2.2399e+06 * phase + shift[ 0 ] ) * exp( - 4.5282e+09 * pow2( phase ) );
		xyz /= 1.0685e-7;
		vec3 rgb = XYZ_TO_REC709 * xyz;
		return rgb;
	}
	vec3 evalIridescence( float outsideIOR, float eta2, float cosTheta1, float thinFilmThickness, vec3 baseF0 ) {
		vec3 I;
		float iridescenceIOR = mix( outsideIOR, eta2, smoothstep( 0.0, 0.03, thinFilmThickness ) );
		float sinTheta2Sq = pow2( outsideIOR / iridescenceIOR ) * ( 1.0 - pow2( cosTheta1 ) );
		float cosTheta2Sq = 1.0 - sinTheta2Sq;
		if ( cosTheta2Sq < 0.0 ) {
			return vec3( 1.0 );
		}
		float cosTheta2 = sqrt( cosTheta2Sq );
		float R0 = IorToFresnel0( iridescenceIOR, outsideIOR );
		float R12 = F_Schlick( R0, 1.0, cosTheta1 );
		float T121 = 1.0 - R12;
		float phi12 = 0.0;
		if ( iridescenceIOR < outsideIOR ) phi12 = PI;
		float phi21 = PI - phi12;
		vec3 baseIOR = Fresnel0ToIor( clamp( baseF0, 0.0, 0.9999 ) );		vec3 R1 = IorToFresnel0( baseIOR, iridescenceIOR );
		vec3 R23 = F_Schlick( R1, 1.0, cosTheta2 );
		vec3 phi23 = vec3( 0.0 );
		if ( baseIOR[ 0 ] < iridescenceIOR ) phi23[ 0 ] = PI;
		if ( baseIOR[ 1 ] < iridescenceIOR ) phi23[ 1 ] = PI;
		if ( baseIOR[ 2 ] < iridescenceIOR ) phi23[ 2 ] = PI;
		float OPD = 2.0 * iridescenceIOR * thinFilmThickness * cosTheta2;
		vec3 phi = vec3( phi21 ) + phi23;
		vec3 R123 = clamp( R12 * R23, 1e-5, 0.9999 );
		vec3 r123 = sqrt( R123 );
		vec3 Rs = pow2( T121 ) * R23 / ( vec3( 1.0 ) - R123 );
		vec3 C0 = R12 + Rs;
		I = C0;
		vec3 Cm = Rs - T121;
		for ( int m = 1; m <= 2; ++ m ) {
			Cm *= r123;
			vec3 Sm = 2.0 * evalSensitivity( float( m ) * OPD, float( m ) * phi );
			I += Cm * Sm;
		}
		return max( I, vec3( 0.0 ) );
	}
#endif`,BX=`#ifdef USE_BUMPMAP
	uniform sampler2D bumpMap;
	uniform float bumpScale;
	vec2 dHdxy_fwd() {
		vec2 dSTdx = dFdx( vBumpMapUv );
		vec2 dSTdy = dFdy( vBumpMapUv );
		float Hll = bumpScale * texture2D( bumpMap, vBumpMapUv ).x;
		float dBx = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdx ).x - Hll;
		float dBy = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdy ).x - Hll;
		return vec2( dBx, dBy );
	}
	vec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy, float faceDirection ) {
		vec3 vSigmaX = normalize( dFdx( surf_pos.xyz ) );
		vec3 vSigmaY = normalize( dFdy( surf_pos.xyz ) );
		vec3 vN = surf_norm;
		vec3 R1 = cross( vSigmaY, vN );
		vec3 R2 = cross( vN, vSigmaX );
		float fDet = dot( vSigmaX, R1 ) * faceDirection;
		vec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );
		return normalize( abs( fDet ) * surf_norm - vGrad );
	}
#endif`,zX=`#if NUM_CLIPPING_PLANES > 0
	vec4 plane;
	#ifdef ALPHA_TO_COVERAGE
		float distanceToPlane, distanceGradient;
		float clipOpacity = 1.0;
		#pragma unroll_loop_start
		for ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {
			plane = clippingPlanes[ i ];
			distanceToPlane = - dot( vClipPosition, plane.xyz ) + plane.w;
			distanceGradient = fwidth( distanceToPlane ) / 2.0;
			clipOpacity *= smoothstep( - distanceGradient, distanceGradient, distanceToPlane );
			if ( clipOpacity == 0.0 ) discard;
		}
		#pragma unroll_loop_end
		#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES
			float unionClipOpacity = 1.0;
			#pragma unroll_loop_start
			for ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {
				plane = clippingPlanes[ i ];
				distanceToPlane = - dot( vClipPosition, plane.xyz ) + plane.w;
				distanceGradient = fwidth( distanceToPlane ) / 2.0;
				unionClipOpacity *= 1.0 - smoothstep( - distanceGradient, distanceGradient, distanceToPlane );
			}
			#pragma unroll_loop_end
			clipOpacity *= 1.0 - unionClipOpacity;
		#endif
		diffuseColor.a *= clipOpacity;
		if ( diffuseColor.a == 0.0 ) discard;
	#else
		#pragma unroll_loop_start
		for ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {
			plane = clippingPlanes[ i ];
			if ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;
		}
		#pragma unroll_loop_end
		#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES
			bool clipped = true;
			#pragma unroll_loop_start
			for ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {
				plane = clippingPlanes[ i ];
				clipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;
			}
			#pragma unroll_loop_end
			if ( clipped ) discard;
		#endif
	#endif
#endif`,VX=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
	uniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];
#endif`,HX=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
#endif`,GX=`#if NUM_CLIPPING_PLANES > 0
	vClipPosition = - mvPosition.xyz;
#endif`,WX=`#if defined( USE_COLOR_ALPHA )
	diffuseColor *= vColor;
#elif defined( USE_COLOR )
	diffuseColor.rgb *= vColor;
#endif`,$X=`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR )
	varying vec3 vColor;
#endif`,qX=`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR ) || defined( USE_BATCHING_COLOR )
	varying vec3 vColor;
#endif`,XX=`#if defined( USE_COLOR_ALPHA )
	vColor = vec4( 1.0 );
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR ) || defined( USE_BATCHING_COLOR )
	vColor = vec3( 1.0 );
#endif
#ifdef USE_COLOR
	vColor *= color;
#endif
#ifdef USE_INSTANCING_COLOR
	vColor.xyz *= instanceColor.xyz;
#endif
#ifdef USE_BATCHING_COLOR
	vec3 batchingColor = getBatchingColor( getIndirectIndex( gl_DrawID ) );
	vColor.xyz *= batchingColor.xyz;
#endif`,YX=`#define PI 3.141592653589793
#define PI2 6.283185307179586
#define PI_HALF 1.5707963267948966
#define RECIPROCAL_PI 0.3183098861837907
#define RECIPROCAL_PI2 0.15915494309189535
#define EPSILON 1e-6
#ifndef saturate
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
#define whiteComplement( a ) ( 1.0 - saturate( a ) )
float pow2( const in float x ) { return x*x; }
vec3 pow2( const in vec3 x ) { return x*x; }
float pow3( const in float x ) { return x*x*x; }
float pow4( const in float x ) { float x2 = x*x; return x2*x2; }
float max3( const in vec3 v ) { return max( max( v.x, v.y ), v.z ); }
float average( const in vec3 v ) { return dot( v, vec3( 0.3333333 ) ); }
highp float rand( const in vec2 uv ) {
	const highp float a = 12.9898, b = 78.233, c = 43758.5453;
	highp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );
	return fract( sin( sn ) * c );
}
#ifdef HIGH_PRECISION
	float precisionSafeLength( vec3 v ) { return length( v ); }
#else
	float precisionSafeLength( vec3 v ) {
		float maxComponent = max3( abs( v ) );
		return length( v / maxComponent ) * maxComponent;
	}
#endif
struct IncidentLight {
	vec3 color;
	vec3 direction;
	bool visible;
};
struct ReflectedLight {
	vec3 directDiffuse;
	vec3 directSpecular;
	vec3 indirectDiffuse;
	vec3 indirectSpecular;
};
#ifdef USE_ALPHAHASH
	varying vec3 vPosition;
#endif
vec3 transformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );
}
vec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );
}
mat3 transposeMat3( const in mat3 m ) {
	mat3 tmp;
	tmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );
	tmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );
	tmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );
	return tmp;
}
bool isPerspectiveMatrix( mat4 m ) {
	return m[ 2 ][ 3 ] == - 1.0;
}
vec2 equirectUv( in vec3 dir ) {
	float u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;
	float v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;
	return vec2( u, v );
}
vec3 BRDF_Lambert( const in vec3 diffuseColor ) {
	return RECIPROCAL_PI * diffuseColor;
}
vec3 F_Schlick( const in vec3 f0, const in float f90, const in float dotVH ) {
	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );
	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );
}
float F_Schlick( const in float f0, const in float f90, const in float dotVH ) {
	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );
	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );
} // validated`,KX=`#ifdef ENVMAP_TYPE_CUBE_UV
	#define cubeUV_minMipLevel 4.0
	#define cubeUV_minTileSize 16.0
	float getFace( vec3 direction ) {
		vec3 absDirection = abs( direction );
		float face = - 1.0;
		if ( absDirection.x > absDirection.z ) {
			if ( absDirection.x > absDirection.y )
				face = direction.x > 0.0 ? 0.0 : 3.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		} else {
			if ( absDirection.z > absDirection.y )
				face = direction.z > 0.0 ? 2.0 : 5.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		}
		return face;
	}
	vec2 getUV( vec3 direction, float face ) {
		vec2 uv;
		if ( face == 0.0 ) {
			uv = vec2( direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 1.0 ) {
			uv = vec2( - direction.x, - direction.z ) / abs( direction.y );
		} else if ( face == 2.0 ) {
			uv = vec2( - direction.x, direction.y ) / abs( direction.z );
		} else if ( face == 3.0 ) {
			uv = vec2( - direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 4.0 ) {
			uv = vec2( - direction.x, direction.z ) / abs( direction.y );
		} else {
			uv = vec2( direction.x, direction.y ) / abs( direction.z );
		}
		return 0.5 * ( uv + 1.0 );
	}
	vec3 bilinearCubeUV( sampler2D envMap, vec3 direction, float mipInt ) {
		float face = getFace( direction );
		float filterInt = max( cubeUV_minMipLevel - mipInt, 0.0 );
		mipInt = max( mipInt, cubeUV_minMipLevel );
		float faceSize = exp2( mipInt );
		highp vec2 uv = getUV( direction, face ) * ( faceSize - 2.0 ) + 1.0;
		if ( face > 2.0 ) {
			uv.y += faceSize;
			face -= 3.0;
		}
		uv.x += face * faceSize;
		uv.x += filterInt * 3.0 * cubeUV_minTileSize;
		uv.y += 4.0 * ( exp2( CUBEUV_MAX_MIP ) - faceSize );
		uv.x *= CUBEUV_TEXEL_WIDTH;
		uv.y *= CUBEUV_TEXEL_HEIGHT;
		#ifdef texture2DGradEXT
			return texture2DGradEXT( envMap, uv, vec2( 0.0 ), vec2( 0.0 ) ).rgb;
		#else
			return texture2D( envMap, uv ).rgb;
		#endif
	}
	#define cubeUV_r0 1.0
	#define cubeUV_m0 - 2.0
	#define cubeUV_r1 0.8
	#define cubeUV_m1 - 1.0
	#define cubeUV_r4 0.4
	#define cubeUV_m4 2.0
	#define cubeUV_r5 0.305
	#define cubeUV_m5 3.0
	#define cubeUV_r6 0.21
	#define cubeUV_m6 4.0
	float roughnessToMip( float roughness ) {
		float mip = 0.0;
		if ( roughness >= cubeUV_r1 ) {
			mip = ( cubeUV_r0 - roughness ) * ( cubeUV_m1 - cubeUV_m0 ) / ( cubeUV_r0 - cubeUV_r1 ) + cubeUV_m0;
		} else if ( roughness >= cubeUV_r4 ) {
			mip = ( cubeUV_r1 - roughness ) * ( cubeUV_m4 - cubeUV_m1 ) / ( cubeUV_r1 - cubeUV_r4 ) + cubeUV_m1;
		} else if ( roughness >= cubeUV_r5 ) {
			mip = ( cubeUV_r4 - roughness ) * ( cubeUV_m5 - cubeUV_m4 ) / ( cubeUV_r4 - cubeUV_r5 ) + cubeUV_m4;
		} else if ( roughness >= cubeUV_r6 ) {
			mip = ( cubeUV_r5 - roughness ) * ( cubeUV_m6 - cubeUV_m5 ) / ( cubeUV_r5 - cubeUV_r6 ) + cubeUV_m5;
		} else {
			mip = - 2.0 * log2( 1.16 * roughness );		}
		return mip;
	}
	vec4 textureCubeUV( sampler2D envMap, vec3 sampleDir, float roughness ) {
		float mip = clamp( roughnessToMip( roughness ), cubeUV_m0, CUBEUV_MAX_MIP );
		float mipF = fract( mip );
		float mipInt = floor( mip );
		vec3 color0 = bilinearCubeUV( envMap, sampleDir, mipInt );
		if ( mipF == 0.0 ) {
			return vec4( color0, 1.0 );
		} else {
			vec3 color1 = bilinearCubeUV( envMap, sampleDir, mipInt + 1.0 );
			return vec4( mix( color0, color1, mipF ), 1.0 );
		}
	}
#endif`,QX=`vec3 transformedNormal = objectNormal;
#ifdef USE_TANGENT
	vec3 transformedTangent = objectTangent;
#endif
#ifdef USE_BATCHING
	mat3 bm = mat3( batchingMatrix );
	transformedNormal /= vec3( dot( bm[ 0 ], bm[ 0 ] ), dot( bm[ 1 ], bm[ 1 ] ), dot( bm[ 2 ], bm[ 2 ] ) );
	transformedNormal = bm * transformedNormal;
	#ifdef USE_TANGENT
		transformedTangent = bm * transformedTangent;
	#endif
#endif
#ifdef USE_INSTANCING
	mat3 im = mat3( instanceMatrix );
	transformedNormal /= vec3( dot( im[ 0 ], im[ 0 ] ), dot( im[ 1 ], im[ 1 ] ), dot( im[ 2 ], im[ 2 ] ) );
	transformedNormal = im * transformedNormal;
	#ifdef USE_TANGENT
		transformedTangent = im * transformedTangent;
	#endif
#endif
transformedNormal = normalMatrix * transformedNormal;
#ifdef FLIP_SIDED
	transformedNormal = - transformedNormal;
#endif
#ifdef USE_TANGENT
	transformedTangent = ( modelViewMatrix * vec4( transformedTangent, 0.0 ) ).xyz;
	#ifdef FLIP_SIDED
		transformedTangent = - transformedTangent;
	#endif
#endif`,JX=`#ifdef USE_DISPLACEMENTMAP
	uniform sampler2D displacementMap;
	uniform float displacementScale;
	uniform float displacementBias;
#endif`,ZX=`#ifdef USE_DISPLACEMENTMAP
	transformed += normalize( objectNormal ) * ( texture2D( displacementMap, vDisplacementMapUv ).x * displacementScale + displacementBias );
#endif`,eY=`#ifdef USE_EMISSIVEMAP
	vec4 emissiveColor = texture2D( emissiveMap, vEmissiveMapUv );
	#ifdef DECODE_VIDEO_TEXTURE_EMISSIVE
		emissiveColor = sRGBTransferEOTF( emissiveColor );
	#endif
	totalEmissiveRadiance *= emissiveColor.rgb;
#endif`,tY=`#ifdef USE_EMISSIVEMAP
	uniform sampler2D emissiveMap;
#endif`,nY="gl_FragColor = linearToOutputTexel( gl_FragColor );",rY=`vec4 LinearTransferOETF( in vec4 value ) {
	return value;
}
vec4 sRGBTransferEOTF( in vec4 value ) {
	return vec4( mix( pow( value.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), value.rgb * 0.0773993808, vec3( lessThanEqual( value.rgb, vec3( 0.04045 ) ) ) ), value.a );
}
vec4 sRGBTransferOETF( in vec4 value ) {
	return vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );
}`,sY=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vec3 cameraToFrag;
		if ( isOrthographic ) {
			cameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToFrag = normalize( vWorldPosition - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vec3 reflectVec = reflect( cameraToFrag, worldNormal );
		#else
			vec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );
		#endif
	#else
		vec3 reflectVec = vReflect;
	#endif
	#ifdef ENVMAP_TYPE_CUBE
		vec4 envColor = textureCube( envMap, envMapRotation * vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );
	#else
		vec4 envColor = vec4( 0.0 );
	#endif
	#ifdef ENVMAP_BLENDING_MULTIPLY
		outgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_MIX )
		outgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_ADD )
		outgoingLight += envColor.xyz * specularStrength * reflectivity;
	#endif
#endif`,iY=`#ifdef USE_ENVMAP
	uniform float envMapIntensity;
	uniform float flipEnvMap;
	uniform mat3 envMapRotation;
	#ifdef ENVMAP_TYPE_CUBE
		uniform samplerCube envMap;
	#else
		uniform sampler2D envMap;
	#endif
	
#endif`,oY=`#ifdef USE_ENVMAP
	uniform float reflectivity;
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		varying vec3 vWorldPosition;
		uniform float refractionRatio;
	#else
		varying vec3 vReflect;
	#endif
#endif`,aY=`#ifdef USE_ENVMAP
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		
		varying vec3 vWorldPosition;
	#else
		varying vec3 vReflect;
		uniform float refractionRatio;
	#endif
#endif`,lY=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vWorldPosition = worldPosition.xyz;
	#else
		vec3 cameraToVertex;
		if ( isOrthographic ) {
			cameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToVertex = normalize( worldPosition.xyz - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vReflect = reflect( cameraToVertex, worldNormal );
		#else
			vReflect = refract( cameraToVertex, worldNormal, refractionRatio );
		#endif
	#endif
#endif`,cY=`#ifdef USE_FOG
	vFogDepth = - mvPosition.z;
#endif`,uY=`#ifdef USE_FOG
	varying float vFogDepth;
#endif`,dY=`#ifdef USE_FOG
	#ifdef FOG_EXP2
		float fogFactor = 1.0 - exp( - fogDensity * fogDensity * vFogDepth * vFogDepth );
	#else
		float fogFactor = smoothstep( fogNear, fogFar, vFogDepth );
	#endif
	gl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );
#endif`,hY=`#ifdef USE_FOG
	uniform vec3 fogColor;
	varying float vFogDepth;
	#ifdef FOG_EXP2
		uniform float fogDensity;
	#else
		uniform float fogNear;
		uniform float fogFar;
	#endif
#endif`,fY=`#ifdef USE_GRADIENTMAP
	uniform sampler2D gradientMap;
#endif
vec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {
	float dotNL = dot( normal, lightDirection );
	vec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );
	#ifdef USE_GRADIENTMAP
		return vec3( texture2D( gradientMap, coord ).r );
	#else
		vec2 fw = fwidth( coord ) * 0.5;
		return mix( vec3( 0.7 ), vec3( 1.0 ), smoothstep( 0.7 - fw.x, 0.7 + fw.x, coord.x ) );
	#endif
}`,pY=`#ifdef USE_LIGHTMAP
	uniform sampler2D lightMap;
	uniform float lightMapIntensity;
#endif`,mY=`LambertMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularStrength = specularStrength;`,gY=`varying vec3 vViewPosition;
struct LambertMaterial {
	vec3 diffuseColor;
	float specularStrength;
};
void RE_Direct_Lambert( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Lambert( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Lambert
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Lambert`,vY=`uniform bool receiveShadow;
uniform vec3 ambientLightColor;
#if defined( USE_LIGHT_PROBES )
	uniform vec3 lightProbe[ 9 ];
#endif
vec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {
	float x = normal.x, y = normal.y, z = normal.z;
	vec3 result = shCoefficients[ 0 ] * 0.886227;
	result += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;
	result += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;
	result += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;
	result += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;
	result += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;
	result += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );
	result += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;
	result += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );
	return result;
}
vec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in vec3 normal ) {
	vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
	vec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );
	return irradiance;
}
vec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {
	vec3 irradiance = ambientLightColor;
	return irradiance;
}
float getDistanceAttenuation( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {
	float distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );
	if ( cutoffDistance > 0.0 ) {
		distanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );
	}
	return distanceFalloff;
}
float getSpotAttenuation( const in float coneCosine, const in float penumbraCosine, const in float angleCosine ) {
	return smoothstep( coneCosine, penumbraCosine, angleCosine );
}
#if NUM_DIR_LIGHTS > 0
	struct DirectionalLight {
		vec3 direction;
		vec3 color;
	};
	uniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];
	void getDirectionalLightInfo( const in DirectionalLight directionalLight, out IncidentLight light ) {
		light.color = directionalLight.color;
		light.direction = directionalLight.direction;
		light.visible = true;
	}
#endif
#if NUM_POINT_LIGHTS > 0
	struct PointLight {
		vec3 position;
		vec3 color;
		float distance;
		float decay;
	};
	uniform PointLight pointLights[ NUM_POINT_LIGHTS ];
	void getPointLightInfo( const in PointLight pointLight, const in vec3 geometryPosition, out IncidentLight light ) {
		vec3 lVector = pointLight.position - geometryPosition;
		light.direction = normalize( lVector );
		float lightDistance = length( lVector );
		light.color = pointLight.color;
		light.color *= getDistanceAttenuation( lightDistance, pointLight.distance, pointLight.decay );
		light.visible = ( light.color != vec3( 0.0 ) );
	}
#endif
#if NUM_SPOT_LIGHTS > 0
	struct SpotLight {
		vec3 position;
		vec3 direction;
		vec3 color;
		float distance;
		float decay;
		float coneCos;
		float penumbraCos;
	};
	uniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];
	void getSpotLightInfo( const in SpotLight spotLight, const in vec3 geometryPosition, out IncidentLight light ) {
		vec3 lVector = spotLight.position - geometryPosition;
		light.direction = normalize( lVector );
		float angleCos = dot( light.direction, spotLight.direction );
		float spotAttenuation = getSpotAttenuation( spotLight.coneCos, spotLight.penumbraCos, angleCos );
		if ( spotAttenuation > 0.0 ) {
			float lightDistance = length( lVector );
			light.color = spotLight.color * spotAttenuation;
			light.color *= getDistanceAttenuation( lightDistance, spotLight.distance, spotLight.decay );
			light.visible = ( light.color != vec3( 0.0 ) );
		} else {
			light.color = vec3( 0.0 );
			light.visible = false;
		}
	}
#endif
#if NUM_RECT_AREA_LIGHTS > 0
	struct RectAreaLight {
		vec3 color;
		vec3 position;
		vec3 halfWidth;
		vec3 halfHeight;
	};
	uniform sampler2D ltc_1;	uniform sampler2D ltc_2;
	uniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];
#endif
#if NUM_HEMI_LIGHTS > 0
	struct HemisphereLight {
		vec3 direction;
		vec3 skyColor;
		vec3 groundColor;
	};
	uniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];
	vec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in vec3 normal ) {
		float dotNL = dot( normal, hemiLight.direction );
		float hemiDiffuseWeight = 0.5 * dotNL + 0.5;
		vec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );
		return irradiance;
	}
#endif`,xY=`#ifdef USE_ENVMAP
	vec3 getIBLIrradiance( const in vec3 normal ) {
		#ifdef ENVMAP_TYPE_CUBE_UV
			vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
			vec4 envMapColor = textureCubeUV( envMap, envMapRotation * worldNormal, 1.0 );
			return PI * envMapColor.rgb * envMapIntensity;
		#else
			return vec3( 0.0 );
		#endif
	}
	vec3 getIBLRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness ) {
		#ifdef ENVMAP_TYPE_CUBE_UV
			vec3 reflectVec = reflect( - viewDir, normal );
			reflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );
			reflectVec = inverseTransformDirection( reflectVec, viewMatrix );
			vec4 envMapColor = textureCubeUV( envMap, envMapRotation * reflectVec, roughness );
			return envMapColor.rgb * envMapIntensity;
		#else
			return vec3( 0.0 );
		#endif
	}
	#ifdef USE_ANISOTROPY
		vec3 getIBLAnisotropyRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness, const in vec3 bitangent, const in float anisotropy ) {
			#ifdef ENVMAP_TYPE_CUBE_UV
				vec3 bentNormal = cross( bitangent, viewDir );
				bentNormal = normalize( cross( bentNormal, bitangent ) );
				bentNormal = normalize( mix( bentNormal, normal, pow2( pow2( 1.0 - anisotropy * ( 1.0 - roughness ) ) ) ) );
				return getIBLRadiance( viewDir, bentNormal, roughness );
			#else
				return vec3( 0.0 );
			#endif
		}
	#endif
#endif`,yY=`ToonMaterial material;
material.diffuseColor = diffuseColor.rgb;`,_Y=`varying vec3 vViewPosition;
struct ToonMaterial {
	vec3 diffuseColor;
};
void RE_Direct_Toon( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	vec3 irradiance = getGradientIrradiance( geometryNormal, directLight.direction ) * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Toon
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Toon`,wY=`BlinnPhongMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularColor = specular;
material.specularShininess = shininess;
material.specularStrength = specularStrength;`,SY=`varying vec3 vViewPosition;
struct BlinnPhongMaterial {
	vec3 diffuseColor;
	vec3 specularColor;
	float specularShininess;
	float specularStrength;
};
void RE_Direct_BlinnPhong( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
	reflectedLight.directSpecular += irradiance * BRDF_BlinnPhong( directLight.direction, geometryViewDir, geometryNormal, material.specularColor, material.specularShininess ) * material.specularStrength;
}
void RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_BlinnPhong
#define RE_IndirectDiffuse		RE_IndirectDiffuse_BlinnPhong`,bY=`PhysicalMaterial material;
material.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );
vec3 dxy = max( abs( dFdx( nonPerturbedNormal ) ), abs( dFdy( nonPerturbedNormal ) ) );
float geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );
material.roughness = max( roughnessFactor, 0.0525 );material.roughness += geometryRoughness;
material.roughness = min( material.roughness, 1.0 );
#ifdef IOR
	material.ior = ior;
	#ifdef USE_SPECULAR
		float specularIntensityFactor = specularIntensity;
		vec3 specularColorFactor = specularColor;
		#ifdef USE_SPECULAR_COLORMAP
			specularColorFactor *= texture2D( specularColorMap, vSpecularColorMapUv ).rgb;
		#endif
		#ifdef USE_SPECULAR_INTENSITYMAP
			specularIntensityFactor *= texture2D( specularIntensityMap, vSpecularIntensityMapUv ).a;
		#endif
		material.specularF90 = mix( specularIntensityFactor, 1.0, metalnessFactor );
	#else
		float specularIntensityFactor = 1.0;
		vec3 specularColorFactor = vec3( 1.0 );
		material.specularF90 = 1.0;
	#endif
	material.specularColor = mix( min( pow2( ( material.ior - 1.0 ) / ( material.ior + 1.0 ) ) * specularColorFactor, vec3( 1.0 ) ) * specularIntensityFactor, diffuseColor.rgb, metalnessFactor );
#else
	material.specularColor = mix( vec3( 0.04 ), diffuseColor.rgb, metalnessFactor );
	material.specularF90 = 1.0;
#endif
#ifdef USE_CLEARCOAT
	material.clearcoat = clearcoat;
	material.clearcoatRoughness = clearcoatRoughness;
	material.clearcoatF0 = vec3( 0.04 );
	material.clearcoatF90 = 1.0;
	#ifdef USE_CLEARCOATMAP
		material.clearcoat *= texture2D( clearcoatMap, vClearcoatMapUv ).x;
	#endif
	#ifdef USE_CLEARCOAT_ROUGHNESSMAP
		material.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vClearcoatRoughnessMapUv ).y;
	#endif
	material.clearcoat = saturate( material.clearcoat );	material.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );
	material.clearcoatRoughness += geometryRoughness;
	material.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );
#endif
#ifdef USE_DISPERSION
	material.dispersion = dispersion;
#endif
#ifdef USE_IRIDESCENCE
	material.iridescence = iridescence;
	material.iridescenceIOR = iridescenceIOR;
	#ifdef USE_IRIDESCENCEMAP
		material.iridescence *= texture2D( iridescenceMap, vIridescenceMapUv ).r;
	#endif
	#ifdef USE_IRIDESCENCE_THICKNESSMAP
		material.iridescenceThickness = (iridescenceThicknessMaximum - iridescenceThicknessMinimum) * texture2D( iridescenceThicknessMap, vIridescenceThicknessMapUv ).g + iridescenceThicknessMinimum;
	#else
		material.iridescenceThickness = iridescenceThicknessMaximum;
	#endif
#endif
#ifdef USE_SHEEN
	material.sheenColor = sheenColor;
	#ifdef USE_SHEEN_COLORMAP
		material.sheenColor *= texture2D( sheenColorMap, vSheenColorMapUv ).rgb;
	#endif
	material.sheenRoughness = clamp( sheenRoughness, 0.07, 1.0 );
	#ifdef USE_SHEEN_ROUGHNESSMAP
		material.sheenRoughness *= texture2D( sheenRoughnessMap, vSheenRoughnessMapUv ).a;
	#endif
#endif
#ifdef USE_ANISOTROPY
	#ifdef USE_ANISOTROPYMAP
		mat2 anisotropyMat = mat2( anisotropyVector.x, anisotropyVector.y, - anisotropyVector.y, anisotropyVector.x );
		vec3 anisotropyPolar = texture2D( anisotropyMap, vAnisotropyMapUv ).rgb;
		vec2 anisotropyV = anisotropyMat * normalize( 2.0 * anisotropyPolar.rg - vec2( 1.0 ) ) * anisotropyPolar.b;
	#else
		vec2 anisotropyV = anisotropyVector;
	#endif
	material.anisotropy = length( anisotropyV );
	if( material.anisotropy == 0.0 ) {
		anisotropyV = vec2( 1.0, 0.0 );
	} else {
		anisotropyV /= material.anisotropy;
		material.anisotropy = saturate( material.anisotropy );
	}
	material.alphaT = mix( pow2( material.roughness ), 1.0, pow2( material.anisotropy ) );
	material.anisotropyT = tbn[ 0 ] * anisotropyV.x + tbn[ 1 ] * anisotropyV.y;
	material.anisotropyB = tbn[ 1 ] * anisotropyV.x - tbn[ 0 ] * anisotropyV.y;
#endif`,EY=`struct PhysicalMaterial {
	vec3 diffuseColor;
	float roughness;
	vec3 specularColor;
	float specularF90;
	float dispersion;
	#ifdef USE_CLEARCOAT
		float clearcoat;
		float clearcoatRoughness;
		vec3 clearcoatF0;
		float clearcoatF90;
	#endif
	#ifdef USE_IRIDESCENCE
		float iridescence;
		float iridescenceIOR;
		float iridescenceThickness;
		vec3 iridescenceFresnel;
		vec3 iridescenceF0;
	#endif
	#ifdef USE_SHEEN
		vec3 sheenColor;
		float sheenRoughness;
	#endif
	#ifdef IOR
		float ior;
	#endif
	#ifdef USE_TRANSMISSION
		float transmission;
		float transmissionAlpha;
		float thickness;
		float attenuationDistance;
		vec3 attenuationColor;
	#endif
	#ifdef USE_ANISOTROPY
		float anisotropy;
		float alphaT;
		vec3 anisotropyT;
		vec3 anisotropyB;
	#endif
};
vec3 clearcoatSpecularDirect = vec3( 0.0 );
vec3 clearcoatSpecularIndirect = vec3( 0.0 );
vec3 sheenSpecularDirect = vec3( 0.0 );
vec3 sheenSpecularIndirect = vec3(0.0 );
vec3 Schlick_to_F0( const in vec3 f, const in float f90, const in float dotVH ) {
    float x = clamp( 1.0 - dotVH, 0.0, 1.0 );
    float x2 = x * x;
    float x5 = clamp( x * x2 * x2, 0.0, 0.9999 );
    return ( f - vec3( f90 ) * x5 ) / ( 1.0 - x5 );
}
float V_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {
	float a2 = pow2( alpha );
	float gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );
	float gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );
	return 0.5 / max( gv + gl, EPSILON );
}
float D_GGX( const in float alpha, const in float dotNH ) {
	float a2 = pow2( alpha );
	float denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;
	return RECIPROCAL_PI * a2 / pow2( denom );
}
#ifdef USE_ANISOTROPY
	float V_GGX_SmithCorrelated_Anisotropic( const in float alphaT, const in float alphaB, const in float dotTV, const in float dotBV, const in float dotTL, const in float dotBL, const in float dotNV, const in float dotNL ) {
		float gv = dotNL * length( vec3( alphaT * dotTV, alphaB * dotBV, dotNV ) );
		float gl = dotNV * length( vec3( alphaT * dotTL, alphaB * dotBL, dotNL ) );
		float v = 0.5 / ( gv + gl );
		return saturate(v);
	}
	float D_GGX_Anisotropic( const in float alphaT, const in float alphaB, const in float dotNH, const in float dotTH, const in float dotBH ) {
		float a2 = alphaT * alphaB;
		highp vec3 v = vec3( alphaB * dotTH, alphaT * dotBH, a2 * dotNH );
		highp float v2 = dot( v, v );
		float w2 = a2 / v2;
		return RECIPROCAL_PI * a2 * pow2 ( w2 );
	}
#endif
#ifdef USE_CLEARCOAT
	vec3 BRDF_GGX_Clearcoat( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material) {
		vec3 f0 = material.clearcoatF0;
		float f90 = material.clearcoatF90;
		float roughness = material.clearcoatRoughness;
		float alpha = pow2( roughness );
		vec3 halfDir = normalize( lightDir + viewDir );
		float dotNL = saturate( dot( normal, lightDir ) );
		float dotNV = saturate( dot( normal, viewDir ) );
		float dotNH = saturate( dot( normal, halfDir ) );
		float dotVH = saturate( dot( viewDir, halfDir ) );
		vec3 F = F_Schlick( f0, f90, dotVH );
		float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );
		float D = D_GGX( alpha, dotNH );
		return F * ( V * D );
	}
#endif
vec3 BRDF_GGX( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material ) {
	vec3 f0 = material.specularColor;
	float f90 = material.specularF90;
	float roughness = material.roughness;
	float alpha = pow2( roughness );
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );
	vec3 F = F_Schlick( f0, f90, dotVH );
	#ifdef USE_IRIDESCENCE
		F = mix( F, material.iridescenceFresnel, material.iridescence );
	#endif
	#ifdef USE_ANISOTROPY
		float dotTL = dot( material.anisotropyT, lightDir );
		float dotTV = dot( material.anisotropyT, viewDir );
		float dotTH = dot( material.anisotropyT, halfDir );
		float dotBL = dot( material.anisotropyB, lightDir );
		float dotBV = dot( material.anisotropyB, viewDir );
		float dotBH = dot( material.anisotropyB, halfDir );
		float V = V_GGX_SmithCorrelated_Anisotropic( material.alphaT, alpha, dotTV, dotBV, dotTL, dotBL, dotNV, dotNL );
		float D = D_GGX_Anisotropic( material.alphaT, alpha, dotNH, dotTH, dotBH );
	#else
		float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );
		float D = D_GGX( alpha, dotNH );
	#endif
	return F * ( V * D );
}
vec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {
	const float LUT_SIZE = 64.0;
	const float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;
	const float LUT_BIAS = 0.5 / LUT_SIZE;
	float dotNV = saturate( dot( N, V ) );
	vec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );
	uv = uv * LUT_SCALE + LUT_BIAS;
	return uv;
}
float LTC_ClippedSphereFormFactor( const in vec3 f ) {
	float l = length( f );
	return max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );
}
vec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {
	float x = dot( v1, v2 );
	float y = abs( x );
	float a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;
	float b = 3.4175940 + ( 4.1616724 + y ) * y;
	float v = a / b;
	float theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;
	return cross( v1, v2 ) * theta_sintheta;
}
vec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {
	vec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];
	vec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];
	vec3 lightNormal = cross( v1, v2 );
	if( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );
	vec3 T1, T2;
	T1 = normalize( V - N * dot( V, N ) );
	T2 = - cross( N, T1 );
	mat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );
	vec3 coords[ 4 ];
	coords[ 0 ] = mat * ( rectCoords[ 0 ] - P );
	coords[ 1 ] = mat * ( rectCoords[ 1 ] - P );
	coords[ 2 ] = mat * ( rectCoords[ 2 ] - P );
	coords[ 3 ] = mat * ( rectCoords[ 3 ] - P );
	coords[ 0 ] = normalize( coords[ 0 ] );
	coords[ 1 ] = normalize( coords[ 1 ] );
	coords[ 2 ] = normalize( coords[ 2 ] );
	coords[ 3 ] = normalize( coords[ 3 ] );
	vec3 vectorFormFactor = vec3( 0.0 );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );
	float result = LTC_ClippedSphereFormFactor( vectorFormFactor );
	return vec3( result );
}
#if defined( USE_SHEEN )
float D_Charlie( float roughness, float dotNH ) {
	float alpha = pow2( roughness );
	float invAlpha = 1.0 / alpha;
	float cos2h = dotNH * dotNH;
	float sin2h = max( 1.0 - cos2h, 0.0078125 );
	return ( 2.0 + invAlpha ) * pow( sin2h, invAlpha * 0.5 ) / ( 2.0 * PI );
}
float V_Neubelt( float dotNV, float dotNL ) {
	return saturate( 1.0 / ( 4.0 * ( dotNL + dotNV - dotNL * dotNV ) ) );
}
vec3 BRDF_Sheen( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, vec3 sheenColor, const in float sheenRoughness ) {
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float D = D_Charlie( sheenRoughness, dotNH );
	float V = V_Neubelt( dotNV, dotNL );
	return sheenColor * ( D * V );
}
#endif
float IBLSheenBRDF( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	float r2 = roughness * roughness;
	float a = roughness < 0.25 ? -339.2 * r2 + 161.4 * roughness - 25.9 : -8.48 * r2 + 14.3 * roughness - 9.95;
	float b = roughness < 0.25 ? 44.0 * r2 - 23.7 * roughness + 3.26 : 1.97 * r2 - 3.27 * roughness + 0.72;
	float DG = exp( a * dotNV + b ) + ( roughness < 0.25 ? 0.0 : 0.1 * ( roughness - 0.25 ) );
	return saturate( DG * RECIPROCAL_PI );
}
vec2 DFGApprox( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	const vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );
	const vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );
	vec4 r = roughness * c0 + c1;
	float a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;
	vec2 fab = vec2( - 1.04, 1.04 ) * a004 + r.zw;
	return fab;
}
vec3 EnvironmentBRDF( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness ) {
	vec2 fab = DFGApprox( normal, viewDir, roughness );
	return specularColor * fab.x + specularF90 * fab.y;
}
#ifdef USE_IRIDESCENCE
void computeMultiscatteringIridescence( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float iridescence, const in vec3 iridescenceF0, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
#else
void computeMultiscattering( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
#endif
	vec2 fab = DFGApprox( normal, viewDir, roughness );
	#ifdef USE_IRIDESCENCE
		vec3 Fr = mix( specularColor, iridescenceF0, iridescence );
	#else
		vec3 Fr = specularColor;
	#endif
	vec3 FssEss = Fr * fab.x + specularF90 * fab.y;
	float Ess = fab.x + fab.y;
	float Ems = 1.0 - Ess;
	vec3 Favg = Fr + ( 1.0 - Fr ) * 0.047619;	vec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );
	singleScatter += FssEss;
	multiScatter += Fms * Ems;
}
#if NUM_RECT_AREA_LIGHTS > 0
	void RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
		vec3 normal = geometryNormal;
		vec3 viewDir = geometryViewDir;
		vec3 position = geometryPosition;
		vec3 lightPos = rectAreaLight.position;
		vec3 halfWidth = rectAreaLight.halfWidth;
		vec3 halfHeight = rectAreaLight.halfHeight;
		vec3 lightColor = rectAreaLight.color;
		float roughness = material.roughness;
		vec3 rectCoords[ 4 ];
		rectCoords[ 0 ] = lightPos + halfWidth - halfHeight;		rectCoords[ 1 ] = lightPos - halfWidth - halfHeight;
		rectCoords[ 2 ] = lightPos - halfWidth + halfHeight;
		rectCoords[ 3 ] = lightPos + halfWidth + halfHeight;
		vec2 uv = LTC_Uv( normal, viewDir, roughness );
		vec4 t1 = texture2D( ltc_1, uv );
		vec4 t2 = texture2D( ltc_2, uv );
		mat3 mInv = mat3(
			vec3( t1.x, 0, t1.y ),
			vec3(    0, 1,    0 ),
			vec3( t1.z, 0, t1.w )
		);
		vec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );
		reflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );
		reflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );
	}
#endif
void RE_Direct_Physical( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	#ifdef USE_CLEARCOAT
		float dotNLcc = saturate( dot( geometryClearcoatNormal, directLight.direction ) );
		vec3 ccIrradiance = dotNLcc * directLight.color;
		clearcoatSpecularDirect += ccIrradiance * BRDF_GGX_Clearcoat( directLight.direction, geometryViewDir, geometryClearcoatNormal, material );
	#endif
	#ifdef USE_SHEEN
		sheenSpecularDirect += irradiance * BRDF_Sheen( directLight.direction, geometryViewDir, geometryNormal, material.sheenColor, material.sheenRoughness );
	#endif
	reflectedLight.directSpecular += irradiance * BRDF_GGX( directLight.direction, geometryViewDir, geometryNormal, material );
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {
	#ifdef USE_CLEARCOAT
		clearcoatSpecularIndirect += clearcoatRadiance * EnvironmentBRDF( geometryClearcoatNormal, geometryViewDir, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );
	#endif
	#ifdef USE_SHEEN
		sheenSpecularIndirect += irradiance * material.sheenColor * IBLSheenBRDF( geometryNormal, geometryViewDir, material.sheenRoughness );
	#endif
	vec3 singleScattering = vec3( 0.0 );
	vec3 multiScattering = vec3( 0.0 );
	vec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;
	#ifdef USE_IRIDESCENCE
		computeMultiscatteringIridescence( geometryNormal, geometryViewDir, material.specularColor, material.specularF90, material.iridescence, material.iridescenceFresnel, material.roughness, singleScattering, multiScattering );
	#else
		computeMultiscattering( geometryNormal, geometryViewDir, material.specularColor, material.specularF90, material.roughness, singleScattering, multiScattering );
	#endif
	vec3 totalScattering = singleScattering + multiScattering;
	vec3 diffuse = material.diffuseColor * ( 1.0 - max( max( totalScattering.r, totalScattering.g ), totalScattering.b ) );
	reflectedLight.indirectSpecular += radiance * singleScattering;
	reflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;
	reflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;
}
#define RE_Direct				RE_Direct_Physical
#define RE_Direct_RectArea		RE_Direct_RectArea_Physical
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Physical
#define RE_IndirectSpecular		RE_IndirectSpecular_Physical
float computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {
	return saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );
}`,MY=`
vec3 geometryPosition = - vViewPosition;
vec3 geometryNormal = normal;
vec3 geometryViewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );
vec3 geometryClearcoatNormal = vec3( 0.0 );
#ifdef USE_CLEARCOAT
	geometryClearcoatNormal = clearcoatNormal;
#endif
#ifdef USE_IRIDESCENCE
	float dotNVi = saturate( dot( normal, geometryViewDir ) );
	if ( material.iridescenceThickness == 0.0 ) {
		material.iridescence = 0.0;
	} else {
		material.iridescence = saturate( material.iridescence );
	}
	if ( material.iridescence > 0.0 ) {
		material.iridescenceFresnel = evalIridescence( 1.0, material.iridescenceIOR, dotNVi, material.iridescenceThickness, material.specularColor );
		material.iridescenceF0 = Schlick_to_F0( material.iridescenceFresnel, 1.0, dotNVi );
	}
#endif
IncidentLight directLight;
#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )
	PointLight pointLight;
	#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {
		pointLight = pointLights[ i ];
		getPointLightInfo( pointLight, geometryPosition, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )
		pointLightShadow = pointLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowIntensity, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;
		#endif
		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )
	SpotLight spotLight;
	vec4 spotColor;
	vec3 spotLightCoord;
	bool inSpotLightMap;
	#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {
		spotLight = spotLights[ i ];
		getSpotLightInfo( spotLight, geometryPosition, directLight );
		#if ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )
		#define SPOT_LIGHT_MAP_INDEX UNROLLED_LOOP_INDEX
		#elif ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		#define SPOT_LIGHT_MAP_INDEX NUM_SPOT_LIGHT_MAPS
		#else
		#define SPOT_LIGHT_MAP_INDEX ( UNROLLED_LOOP_INDEX - NUM_SPOT_LIGHT_SHADOWS + NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )
		#endif
		#if ( SPOT_LIGHT_MAP_INDEX < NUM_SPOT_LIGHT_MAPS )
			spotLightCoord = vSpotLightCoord[ i ].xyz / vSpotLightCoord[ i ].w;
			inSpotLightMap = all( lessThan( abs( spotLightCoord * 2. - 1. ), vec3( 1.0 ) ) );
			spotColor = texture2D( spotLightMap[ SPOT_LIGHT_MAP_INDEX ], spotLightCoord.xy );
			directLight.color = inSpotLightMap ? directLight.color * spotColor.rgb : directLight.color;
		#endif
		#undef SPOT_LIGHT_MAP_INDEX
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		spotLightShadow = spotLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowIntensity, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )
	DirectionalLight directionalLight;
	#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {
		directionalLight = directionalLights[ i ];
		getDirectionalLightInfo( directionalLight, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )
		directionalLightShadow = directionalLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowIntensity, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )
	RectAreaLight rectAreaLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {
		rectAreaLight = rectAreaLights[ i ];
		RE_Direct_RectArea( rectAreaLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if defined( RE_IndirectDiffuse )
	vec3 iblIrradiance = vec3( 0.0 );
	vec3 irradiance = getAmbientLightIrradiance( ambientLightColor );
	#if defined( USE_LIGHT_PROBES )
		irradiance += getLightProbeIrradiance( lightProbe, geometryNormal );
	#endif
	#if ( NUM_HEMI_LIGHTS > 0 )
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {
			irradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometryNormal );
		}
		#pragma unroll_loop_end
	#endif
#endif
#if defined( RE_IndirectSpecular )
	vec3 radiance = vec3( 0.0 );
	vec3 clearcoatRadiance = vec3( 0.0 );
#endif`,TY=`#if defined( RE_IndirectDiffuse )
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel = texture2D( lightMap, vLightMapUv );
		vec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;
		irradiance += lightMapIrradiance;
	#endif
	#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )
		iblIrradiance += getIBLIrradiance( geometryNormal );
	#endif
#endif
#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )
	#ifdef USE_ANISOTROPY
		radiance += getIBLAnisotropyRadiance( geometryViewDir, geometryNormal, material.roughness, material.anisotropyB, material.anisotropy );
	#else
		radiance += getIBLRadiance( geometryViewDir, geometryNormal, material.roughness );
	#endif
	#ifdef USE_CLEARCOAT
		clearcoatRadiance += getIBLRadiance( geometryViewDir, geometryClearcoatNormal, material.clearcoatRoughness );
	#endif
#endif`,CY=`#if defined( RE_IndirectDiffuse )
	RE_IndirectDiffuse( irradiance, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
#endif
#if defined( RE_IndirectSpecular )
	RE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
#endif`,AY=`#if defined( USE_LOGDEPTHBUF )
	gl_FragDepth = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;
#endif`,RY=`#if defined( USE_LOGDEPTHBUF )
	uniform float logDepthBufFC;
	varying float vFragDepth;
	varying float vIsPerspective;
#endif`,NY=`#ifdef USE_LOGDEPTHBUF
	varying float vFragDepth;
	varying float vIsPerspective;
#endif`,PY=`#ifdef USE_LOGDEPTHBUF
	vFragDepth = 1.0 + gl_Position.w;
	vIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );
#endif`,IY=`#ifdef USE_MAP
	vec4 sampledDiffuseColor = texture2D( map, vMapUv );
	#ifdef DECODE_VIDEO_TEXTURE
		sampledDiffuseColor = sRGBTransferEOTF( sampledDiffuseColor );
	#endif
	diffuseColor *= sampledDiffuseColor;
#endif`,kY=`#ifdef USE_MAP
	uniform sampler2D map;
#endif`,DY=`#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
	#if defined( USE_POINTS_UV )
		vec2 uv = vUv;
	#else
		vec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;
	#endif
#endif
#ifdef USE_MAP
	diffuseColor *= texture2D( map, uv );
#endif
#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, uv ).g;
#endif`,LY=`#if defined( USE_POINTS_UV )
	varying vec2 vUv;
#else
	#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
		uniform mat3 uvTransform;
	#endif
#endif
#ifdef USE_MAP
	uniform sampler2D map;
#endif
#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,OY=`float metalnessFactor = metalness;
#ifdef USE_METALNESSMAP
	vec4 texelMetalness = texture2D( metalnessMap, vMetalnessMapUv );
	metalnessFactor *= texelMetalness.b;
#endif`,jY=`#ifdef USE_METALNESSMAP
	uniform sampler2D metalnessMap;
#endif`,FY=`#ifdef USE_INSTANCING_MORPH
	float morphTargetInfluences[ MORPHTARGETS_COUNT ];
	float morphTargetBaseInfluence = texelFetch( morphTexture, ivec2( 0, gl_InstanceID ), 0 ).r;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		morphTargetInfluences[i] =  texelFetch( morphTexture, ivec2( i + 1, gl_InstanceID ), 0 ).r;
	}
#endif`,UY=`#if defined( USE_MORPHCOLORS )
	vColor *= morphTargetBaseInfluence;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		#if defined( USE_COLOR_ALPHA )
			if ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ) * morphTargetInfluences[ i ];
		#elif defined( USE_COLOR )
			if ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ).rgb * morphTargetInfluences[ i ];
		#endif
	}
#endif`,BY=`#ifdef USE_MORPHNORMALS
	objectNormal *= morphTargetBaseInfluence;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		if ( morphTargetInfluences[ i ] != 0.0 ) objectNormal += getMorph( gl_VertexID, i, 1 ).xyz * morphTargetInfluences[ i ];
	}
#endif`,zY=`#ifdef USE_MORPHTARGETS
	#ifndef USE_INSTANCING_MORPH
		uniform float morphTargetBaseInfluence;
		uniform float morphTargetInfluences[ MORPHTARGETS_COUNT ];
	#endif
	uniform sampler2DArray morphTargetsTexture;
	uniform ivec2 morphTargetsTextureSize;
	vec4 getMorph( const in int vertexIndex, const in int morphTargetIndex, const in int offset ) {
		int texelIndex = vertexIndex * MORPHTARGETS_TEXTURE_STRIDE + offset;
		int y = texelIndex / morphTargetsTextureSize.x;
		int x = texelIndex - y * morphTargetsTextureSize.x;
		ivec3 morphUV = ivec3( x, y, morphTargetIndex );
		return texelFetch( morphTargetsTexture, morphUV, 0 );
	}
#endif`,VY=`#ifdef USE_MORPHTARGETS
	transformed *= morphTargetBaseInfluence;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		if ( morphTargetInfluences[ i ] != 0.0 ) transformed += getMorph( gl_VertexID, i, 0 ).xyz * morphTargetInfluences[ i ];
	}
#endif`,HY=`float faceDirection = gl_FrontFacing ? 1.0 : - 1.0;
#ifdef FLAT_SHADED
	vec3 fdx = dFdx( vViewPosition );
	vec3 fdy = dFdy( vViewPosition );
	vec3 normal = normalize( cross( fdx, fdy ) );
#else
	vec3 normal = normalize( vNormal );
	#ifdef DOUBLE_SIDED
		normal *= faceDirection;
	#endif
#endif
#if defined( USE_NORMALMAP_TANGENTSPACE ) || defined( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY )
	#ifdef USE_TANGENT
		mat3 tbn = mat3( normalize( vTangent ), normalize( vBitangent ), normal );
	#else
		mat3 tbn = getTangentFrame( - vViewPosition, normal,
		#if defined( USE_NORMALMAP )
			vNormalMapUv
		#elif defined( USE_CLEARCOAT_NORMALMAP )
			vClearcoatNormalMapUv
		#else
			vUv
		#endif
		);
	#endif
	#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )
		tbn[0] *= faceDirection;
		tbn[1] *= faceDirection;
	#endif
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	#ifdef USE_TANGENT
		mat3 tbn2 = mat3( normalize( vTangent ), normalize( vBitangent ), normal );
	#else
		mat3 tbn2 = getTangentFrame( - vViewPosition, normal, vClearcoatNormalMapUv );
	#endif
	#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )
		tbn2[0] *= faceDirection;
		tbn2[1] *= faceDirection;
	#endif
#endif
vec3 nonPerturbedNormal = normal;`,GY=`#ifdef USE_NORMALMAP_OBJECTSPACE
	normal = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;
	#ifdef FLIP_SIDED
		normal = - normal;
	#endif
	#ifdef DOUBLE_SIDED
		normal = normal * faceDirection;
	#endif
	normal = normalize( normalMatrix * normal );
#elif defined( USE_NORMALMAP_TANGENTSPACE )
	vec3 mapN = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;
	mapN.xy *= normalScale;
	normal = normalize( tbn * mapN );
#elif defined( USE_BUMPMAP )
	normal = perturbNormalArb( - vViewPosition, normal, dHdxy_fwd(), faceDirection );
#endif`,WY=`#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif`,$Y=`#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif`,qY=`#ifndef FLAT_SHADED
	vNormal = normalize( transformedNormal );
	#ifdef USE_TANGENT
		vTangent = normalize( transformedTangent );
		vBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );
	#endif
#endif`,XY=`#ifdef USE_NORMALMAP
	uniform sampler2D normalMap;
	uniform vec2 normalScale;
#endif
#ifdef USE_NORMALMAP_OBJECTSPACE
	uniform mat3 normalMatrix;
#endif
#if ! defined ( USE_TANGENT ) && ( defined ( USE_NORMALMAP_TANGENTSPACE ) || defined ( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY ) )
	mat3 getTangentFrame( vec3 eye_pos, vec3 surf_norm, vec2 uv ) {
		vec3 q0 = dFdx( eye_pos.xyz );
		vec3 q1 = dFdy( eye_pos.xyz );
		vec2 st0 = dFdx( uv.st );
		vec2 st1 = dFdy( uv.st );
		vec3 N = surf_norm;
		vec3 q1perp = cross( q1, N );
		vec3 q0perp = cross( N, q0 );
		vec3 T = q1perp * st0.x + q0perp * st1.x;
		vec3 B = q1perp * st0.y + q0perp * st1.y;
		float det = max( dot( T, T ), dot( B, B ) );
		float scale = ( det == 0.0 ) ? 0.0 : inversesqrt( det );
		return mat3( T * scale, B * scale, N );
	}
#endif`,YY=`#ifdef USE_CLEARCOAT
	vec3 clearcoatNormal = nonPerturbedNormal;
#endif`,KY=`#ifdef USE_CLEARCOAT_NORMALMAP
	vec3 clearcoatMapN = texture2D( clearcoatNormalMap, vClearcoatNormalMapUv ).xyz * 2.0 - 1.0;
	clearcoatMapN.xy *= clearcoatNormalScale;
	clearcoatNormal = normalize( tbn2 * clearcoatMapN );
#endif`,QY=`#ifdef USE_CLEARCOATMAP
	uniform sampler2D clearcoatMap;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	uniform sampler2D clearcoatNormalMap;
	uniform vec2 clearcoatNormalScale;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	uniform sampler2D clearcoatRoughnessMap;
#endif`,JY=`#ifdef USE_IRIDESCENCEMAP
	uniform sampler2D iridescenceMap;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	uniform sampler2D iridescenceThicknessMap;
#endif`,ZY=`#ifdef OPAQUE
diffuseColor.a = 1.0;
#endif
#ifdef USE_TRANSMISSION
diffuseColor.a *= material.transmissionAlpha;
#endif
gl_FragColor = vec4( outgoingLight, diffuseColor.a );`,eK=`vec3 packNormalToRGB( const in vec3 normal ) {
	return normalize( normal ) * 0.5 + 0.5;
}
vec3 unpackRGBToNormal( const in vec3 rgb ) {
	return 2.0 * rgb.xyz - 1.0;
}
const float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;const float ShiftRight8 = 1. / 256.;
const float Inv255 = 1. / 255.;
const vec4 PackFactors = vec4( 1.0, 256.0, 256.0 * 256.0, 256.0 * 256.0 * 256.0 );
const vec2 UnpackFactors2 = vec2( UnpackDownscale, 1.0 / PackFactors.g );
const vec3 UnpackFactors3 = vec3( UnpackDownscale / PackFactors.rg, 1.0 / PackFactors.b );
const vec4 UnpackFactors4 = vec4( UnpackDownscale / PackFactors.rgb, 1.0 / PackFactors.a );
vec4 packDepthToRGBA( const in float v ) {
	if( v <= 0.0 )
		return vec4( 0., 0., 0., 0. );
	if( v >= 1.0 )
		return vec4( 1., 1., 1., 1. );
	float vuf;
	float af = modf( v * PackFactors.a, vuf );
	float bf = modf( vuf * ShiftRight8, vuf );
	float gf = modf( vuf * ShiftRight8, vuf );
	return vec4( vuf * Inv255, gf * PackUpscale, bf * PackUpscale, af );
}
vec3 packDepthToRGB( const in float v ) {
	if( v <= 0.0 )
		return vec3( 0., 0., 0. );
	if( v >= 1.0 )
		return vec3( 1., 1., 1. );
	float vuf;
	float bf = modf( v * PackFactors.b, vuf );
	float gf = modf( vuf * ShiftRight8, vuf );
	return vec3( vuf * Inv255, gf * PackUpscale, bf );
}
vec2 packDepthToRG( const in float v ) {
	if( v <= 0.0 )
		return vec2( 0., 0. );
	if( v >= 1.0 )
		return vec2( 1., 1. );
	float vuf;
	float gf = modf( v * 256., vuf );
	return vec2( vuf * Inv255, gf );
}
float unpackRGBAToDepth( const in vec4 v ) {
	return dot( v, UnpackFactors4 );
}
float unpackRGBToDepth( const in vec3 v ) {
	return dot( v, UnpackFactors3 );
}
float unpackRGToDepth( const in vec2 v ) {
	return v.r * UnpackFactors2.r + v.g * UnpackFactors2.g;
}
vec4 pack2HalfToRGBA( const in vec2 v ) {
	vec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ) );
	return vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w );
}
vec2 unpackRGBATo2Half( const in vec4 v ) {
	return vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );
}
float viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {
	return ( viewZ + near ) / ( near - far );
}
float orthographicDepthToViewZ( const in float depth, const in float near, const in float far ) {
	return depth * ( near - far ) - near;
}
float viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {
	return ( ( near + viewZ ) * far ) / ( ( far - near ) * viewZ );
}
float perspectiveDepthToViewZ( const in float depth, const in float near, const in float far ) {
	return ( near * far ) / ( ( far - near ) * depth - far );
}`,tK=`#ifdef PREMULTIPLIED_ALPHA
	gl_FragColor.rgb *= gl_FragColor.a;
#endif`,nK=`vec4 mvPosition = vec4( transformed, 1.0 );
#ifdef USE_BATCHING
	mvPosition = batchingMatrix * mvPosition;
#endif
#ifdef USE_INSTANCING
	mvPosition = instanceMatrix * mvPosition;
#endif
mvPosition = modelViewMatrix * mvPosition;
gl_Position = projectionMatrix * mvPosition;`,rK=`#ifdef DITHERING
	gl_FragColor.rgb = dithering( gl_FragColor.rgb );
#endif`,sK=`#ifdef DITHERING
	vec3 dithering( vec3 color ) {
		float grid_position = rand( gl_FragCoord.xy );
		vec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );
		dither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );
		return color + dither_shift_RGB;
	}
#endif`,iK=`float roughnessFactor = roughness;
#ifdef USE_ROUGHNESSMAP
	vec4 texelRoughness = texture2D( roughnessMap, vRoughnessMapUv );
	roughnessFactor *= texelRoughness.g;
#endif`,oK=`#ifdef USE_ROUGHNESSMAP
	uniform sampler2D roughnessMap;
#endif`,aK=`#if NUM_SPOT_LIGHT_COORDS > 0
	varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];
#endif
#if NUM_SPOT_LIGHT_MAPS > 0
	uniform sampler2D spotLightMap[ NUM_SPOT_LIGHT_MAPS ];
#endif
#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		uniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];
		struct SpotLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
	float texture2DCompare( sampler2D depths, vec2 uv, float compare ) {
		return step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );
	}
	vec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {
		return unpackRGBATo2Half( texture2D( shadow, uv ) );
	}
	float VSMShadow (sampler2D shadow, vec2 uv, float compare ){
		float occlusion = 1.0;
		vec2 distribution = texture2DDistribution( shadow, uv );
		float hard_shadow = step( compare , distribution.x );
		if (hard_shadow != 1.0 ) {
			float distance = compare - distribution.x ;
			float variance = max( 0.00000, distribution.y * distribution.y );
			float softness_probability = variance / (variance + distance * distance );			softness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );			occlusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );
		}
		return occlusion;
	}
	float getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowIntensity, float shadowBias, float shadowRadius, vec4 shadowCoord ) {
		float shadow = 1.0;
		shadowCoord.xyz /= shadowCoord.w;
		shadowCoord.z += shadowBias;
		bool inFrustum = shadowCoord.x >= 0.0 && shadowCoord.x <= 1.0 && shadowCoord.y >= 0.0 && shadowCoord.y <= 1.0;
		bool frustumTest = inFrustum && shadowCoord.z <= 1.0;
		if ( frustumTest ) {
		#if defined( SHADOWMAP_TYPE_PCF )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx0 = - texelSize.x * shadowRadius;
			float dy0 = - texelSize.y * shadowRadius;
			float dx1 = + texelSize.x * shadowRadius;
			float dy1 = + texelSize.y * shadowRadius;
			float dx2 = dx0 / 2.0;
			float dy2 = dy0 / 2.0;
			float dx3 = dx1 / 2.0;
			float dy3 = dy1 / 2.0;
			shadow = (
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )
			) * ( 1.0 / 17.0 );
		#elif defined( SHADOWMAP_TYPE_PCF_SOFT )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx = texelSize.x;
			float dy = texelSize.y;
			vec2 uv = shadowCoord.xy;
			vec2 f = fract( uv * shadowMapSize + 0.5 );
			uv -= f * texelSize;
			shadow = (
				texture2DCompare( shadowMap, uv, shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ),
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),
						  f.x ),
					 mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ),
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),
						  f.x ),
					 f.y )
			) * ( 1.0 / 9.0 );
		#elif defined( SHADOWMAP_TYPE_VSM )
			shadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );
		#else
			shadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );
		#endif
		}
		return mix( 1.0, shadow, shadowIntensity );
	}
	vec2 cubeToUV( vec3 v, float texelSizeY ) {
		vec3 absV = abs( v );
		float scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );
		absV *= scaleToCube;
		v *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );
		vec2 planar = v.xy;
		float almostATexel = 1.5 * texelSizeY;
		float almostOne = 1.0 - almostATexel;
		if ( absV.z >= almostOne ) {
			if ( v.z > 0.0 )
				planar.x = 4.0 - v.x;
		} else if ( absV.x >= almostOne ) {
			float signX = sign( v.x );
			planar.x = v.z * signX + 2.0 * signX;
		} else if ( absV.y >= almostOne ) {
			float signY = sign( v.y );
			planar.x = v.x + 2.0 * signY + 2.0;
			planar.y = v.z * signY - 2.0;
		}
		return vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );
	}
	float getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowIntensity, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {
		float shadow = 1.0;
		vec3 lightToPosition = shadowCoord.xyz;
		
		float lightToPositionLength = length( lightToPosition );
		if ( lightToPositionLength - shadowCameraFar <= 0.0 && lightToPositionLength - shadowCameraNear >= 0.0 ) {
			float dp = ( lightToPositionLength - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );			dp += shadowBias;
			vec3 bd3D = normalize( lightToPosition );
			vec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );
			#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )
				vec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;
				shadow = (
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )
				) * ( 1.0 / 9.0 );
			#else
				shadow = texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );
			#endif
		}
		return mix( 1.0, shadow, shadowIntensity );
	}
#endif`,lK=`#if NUM_SPOT_LIGHT_COORDS > 0
	uniform mat4 spotLightMatrix[ NUM_SPOT_LIGHT_COORDS ];
	varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];
#endif
#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		struct SpotLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
#endif`,cK=`#if ( defined( USE_SHADOWMAP ) && ( NUM_DIR_LIGHT_SHADOWS > 0 || NUM_POINT_LIGHT_SHADOWS > 0 ) ) || ( NUM_SPOT_LIGHT_COORDS > 0 )
	vec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
	vec4 shadowWorldPosition;
#endif
#if defined( USE_SHADOWMAP )
	#if NUM_DIR_LIGHT_SHADOWS > 0
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
			shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );
			vDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;
		}
		#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
			shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );
			vPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;
		}
		#pragma unroll_loop_end
	#endif
#endif
#if NUM_SPOT_LIGHT_COORDS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_COORDS; i ++ ) {
		shadowWorldPosition = worldPosition;
		#if ( defined( USE_SHADOWMAP ) && UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
			shadowWorldPosition.xyz += shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias;
		#endif
		vSpotLightCoord[ i ] = spotLightMatrix[ i ] * shadowWorldPosition;
	}
	#pragma unroll_loop_end
#endif`,uK=`float getShadowMask() {
	float shadow = 1.0;
	#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
		directionalLight = directionalLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowIntensity, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {
		spotLight = spotLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowIntensity, spotLight.shadowBias, spotLight.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
		pointLight = pointLightShadows[ i ];
		shadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowIntensity, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#endif
	return shadow;
}`,dK=`#ifdef USE_SKINNING
	mat4 boneMatX = getBoneMatrix( skinIndex.x );
	mat4 boneMatY = getBoneMatrix( skinIndex.y );
	mat4 boneMatZ = getBoneMatrix( skinIndex.z );
	mat4 boneMatW = getBoneMatrix( skinIndex.w );
#endif`,hK=`#ifdef USE_SKINNING
	uniform mat4 bindMatrix;
	uniform mat4 bindMatrixInverse;
	uniform highp sampler2D boneTexture;
	mat4 getBoneMatrix( const in float i ) {
		int size = textureSize( boneTexture, 0 ).x;
		int j = int( i ) * 4;
		int x = j % size;
		int y = j / size;
		vec4 v1 = texelFetch( boneTexture, ivec2( x, y ), 0 );
		vec4 v2 = texelFetch( boneTexture, ivec2( x + 1, y ), 0 );
		vec4 v3 = texelFetch( boneTexture, ivec2( x + 2, y ), 0 );
		vec4 v4 = texelFetch( boneTexture, ivec2( x + 3, y ), 0 );
		return mat4( v1, v2, v3, v4 );
	}
#endif`,fK=`#ifdef USE_SKINNING
	vec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );
	vec4 skinned = vec4( 0.0 );
	skinned += boneMatX * skinVertex * skinWeight.x;
	skinned += boneMatY * skinVertex * skinWeight.y;
	skinned += boneMatZ * skinVertex * skinWeight.z;
	skinned += boneMatW * skinVertex * skinWeight.w;
	transformed = ( bindMatrixInverse * skinned ).xyz;
#endif`,pK=`#ifdef USE_SKINNING
	mat4 skinMatrix = mat4( 0.0 );
	skinMatrix += skinWeight.x * boneMatX;
	skinMatrix += skinWeight.y * boneMatY;
	skinMatrix += skinWeight.z * boneMatZ;
	skinMatrix += skinWeight.w * boneMatW;
	skinMatrix = bindMatrixInverse * skinMatrix * bindMatrix;
	objectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;
	#ifdef USE_TANGENT
		objectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;
	#endif
#endif`,mK=`float specularStrength;
#ifdef USE_SPECULARMAP
	vec4 texelSpecular = texture2D( specularMap, vSpecularMapUv );
	specularStrength = texelSpecular.r;
#else
	specularStrength = 1.0;
#endif`,gK=`#ifdef USE_SPECULARMAP
	uniform sampler2D specularMap;
#endif`,vK=`#if defined( TONE_MAPPING )
	gl_FragColor.rgb = toneMapping( gl_FragColor.rgb );
#endif`,xK=`#ifndef saturate
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
uniform float toneMappingExposure;
vec3 LinearToneMapping( vec3 color ) {
	return saturate( toneMappingExposure * color );
}
vec3 ReinhardToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	return saturate( color / ( vec3( 1.0 ) + color ) );
}
vec3 CineonToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	color = max( vec3( 0.0 ), color - 0.004 );
	return pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );
}
vec3 RRTAndODTFit( vec3 v ) {
	vec3 a = v * ( v + 0.0245786 ) - 0.000090537;
	vec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;
	return a / b;
}
vec3 ACESFilmicToneMapping( vec3 color ) {
	const mat3 ACESInputMat = mat3(
		vec3( 0.59719, 0.07600, 0.02840 ),		vec3( 0.35458, 0.90834, 0.13383 ),
		vec3( 0.04823, 0.01566, 0.83777 )
	);
	const mat3 ACESOutputMat = mat3(
		vec3(  1.60475, -0.10208, -0.00327 ),		vec3( -0.53108,  1.10813, -0.07276 ),
		vec3( -0.07367, -0.00605,  1.07602 )
	);
	color *= toneMappingExposure / 0.6;
	color = ACESInputMat * color;
	color = RRTAndODTFit( color );
	color = ACESOutputMat * color;
	return saturate( color );
}
const mat3 LINEAR_REC2020_TO_LINEAR_SRGB = mat3(
	vec3( 1.6605, - 0.1246, - 0.0182 ),
	vec3( - 0.5876, 1.1329, - 0.1006 ),
	vec3( - 0.0728, - 0.0083, 1.1187 )
);
const mat3 LINEAR_SRGB_TO_LINEAR_REC2020 = mat3(
	vec3( 0.6274, 0.0691, 0.0164 ),
	vec3( 0.3293, 0.9195, 0.0880 ),
	vec3( 0.0433, 0.0113, 0.8956 )
);
vec3 agxDefaultContrastApprox( vec3 x ) {
	vec3 x2 = x * x;
	vec3 x4 = x2 * x2;
	return + 15.5 * x4 * x2
		- 40.14 * x4 * x
		+ 31.96 * x4
		- 6.868 * x2 * x
		+ 0.4298 * x2
		+ 0.1191 * x
		- 0.00232;
}
vec3 AgXToneMapping( vec3 color ) {
	const mat3 AgXInsetMatrix = mat3(
		vec3( 0.856627153315983, 0.137318972929847, 0.11189821299995 ),
		vec3( 0.0951212405381588, 0.761241990602591, 0.0767994186031903 ),
		vec3( 0.0482516061458583, 0.101439036467562, 0.811302368396859 )
	);
	const mat3 AgXOutsetMatrix = mat3(
		vec3( 1.1271005818144368, - 0.1413297634984383, - 0.14132976349843826 ),
		vec3( - 0.11060664309660323, 1.157823702216272, - 0.11060664309660294 ),
		vec3( - 0.016493938717834573, - 0.016493938717834257, 1.2519364065950405 )
	);
	const float AgxMinEv = - 12.47393;	const float AgxMaxEv = 4.026069;
	color *= toneMappingExposure;
	color = LINEAR_SRGB_TO_LINEAR_REC2020 * color;
	color = AgXInsetMatrix * color;
	color = max( color, 1e-10 );	color = log2( color );
	color = ( color - AgxMinEv ) / ( AgxMaxEv - AgxMinEv );
	color = clamp( color, 0.0, 1.0 );
	color = agxDefaultContrastApprox( color );
	color = AgXOutsetMatrix * color;
	color = pow( max( vec3( 0.0 ), color ), vec3( 2.2 ) );
	color = LINEAR_REC2020_TO_LINEAR_SRGB * color;
	color = clamp( color, 0.0, 1.0 );
	return color;
}
vec3 NeutralToneMapping( vec3 color ) {
	const float StartCompression = 0.8 - 0.04;
	const float Desaturation = 0.15;
	color *= toneMappingExposure;
	float x = min( color.r, min( color.g, color.b ) );
	float offset = x < 0.08 ? x - 6.25 * x * x : 0.04;
	color -= offset;
	float peak = max( color.r, max( color.g, color.b ) );
	if ( peak < StartCompression ) return color;
	float d = 1. - StartCompression;
	float newPeak = 1. - d * d / ( peak + d - StartCompression );
	color *= newPeak / peak;
	float g = 1. - 1. / ( Desaturation * ( peak - newPeak ) + 1. );
	return mix( color, vec3( newPeak ), g );
}
vec3 CustomToneMapping( vec3 color ) { return color; }`,yK=`#ifdef USE_TRANSMISSION
	material.transmission = transmission;
	material.transmissionAlpha = 1.0;
	material.thickness = thickness;
	material.attenuationDistance = attenuationDistance;
	material.attenuationColor = attenuationColor;
	#ifdef USE_TRANSMISSIONMAP
		material.transmission *= texture2D( transmissionMap, vTransmissionMapUv ).r;
	#endif
	#ifdef USE_THICKNESSMAP
		material.thickness *= texture2D( thicknessMap, vThicknessMapUv ).g;
	#endif
	vec3 pos = vWorldPosition;
	vec3 v = normalize( cameraPosition - pos );
	vec3 n = inverseTransformDirection( normal, viewMatrix );
	vec4 transmitted = getIBLVolumeRefraction(
		n, v, material.roughness, material.diffuseColor, material.specularColor, material.specularF90,
		pos, modelMatrix, viewMatrix, projectionMatrix, material.dispersion, material.ior, material.thickness,
		material.attenuationColor, material.attenuationDistance );
	material.transmissionAlpha = mix( material.transmissionAlpha, transmitted.a, material.transmission );
	totalDiffuse = mix( totalDiffuse, transmitted.rgb, material.transmission );
#endif`,_K=`#ifdef USE_TRANSMISSION
	uniform float transmission;
	uniform float thickness;
	uniform float attenuationDistance;
	uniform vec3 attenuationColor;
	#ifdef USE_TRANSMISSIONMAP
		uniform sampler2D transmissionMap;
	#endif
	#ifdef USE_THICKNESSMAP
		uniform sampler2D thicknessMap;
	#endif
	uniform vec2 transmissionSamplerSize;
	uniform sampler2D transmissionSamplerMap;
	uniform mat4 modelMatrix;
	uniform mat4 projectionMatrix;
	varying vec3 vWorldPosition;
	float w0( float a ) {
		return ( 1.0 / 6.0 ) * ( a * ( a * ( - a + 3.0 ) - 3.0 ) + 1.0 );
	}
	float w1( float a ) {
		return ( 1.0 / 6.0 ) * ( a *  a * ( 3.0 * a - 6.0 ) + 4.0 );
	}
	float w2( float a ){
		return ( 1.0 / 6.0 ) * ( a * ( a * ( - 3.0 * a + 3.0 ) + 3.0 ) + 1.0 );
	}
	float w3( float a ) {
		return ( 1.0 / 6.0 ) * ( a * a * a );
	}
	float g0( float a ) {
		return w0( a ) + w1( a );
	}
	float g1( float a ) {
		return w2( a ) + w3( a );
	}
	float h0( float a ) {
		return - 1.0 + w1( a ) / ( w0( a ) + w1( a ) );
	}
	float h1( float a ) {
		return 1.0 + w3( a ) / ( w2( a ) + w3( a ) );
	}
	vec4 bicubic( sampler2D tex, vec2 uv, vec4 texelSize, float lod ) {
		uv = uv * texelSize.zw + 0.5;
		vec2 iuv = floor( uv );
		vec2 fuv = fract( uv );
		float g0x = g0( fuv.x );
		float g1x = g1( fuv.x );
		float h0x = h0( fuv.x );
		float h1x = h1( fuv.x );
		float h0y = h0( fuv.y );
		float h1y = h1( fuv.y );
		vec2 p0 = ( vec2( iuv.x + h0x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;
		vec2 p1 = ( vec2( iuv.x + h1x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;
		vec2 p2 = ( vec2( iuv.x + h0x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;
		vec2 p3 = ( vec2( iuv.x + h1x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;
		return g0( fuv.y ) * ( g0x * textureLod( tex, p0, lod ) + g1x * textureLod( tex, p1, lod ) ) +
			g1( fuv.y ) * ( g0x * textureLod( tex, p2, lod ) + g1x * textureLod( tex, p3, lod ) );
	}
	vec4 textureBicubic( sampler2D sampler, vec2 uv, float lod ) {
		vec2 fLodSize = vec2( textureSize( sampler, int( lod ) ) );
		vec2 cLodSize = vec2( textureSize( sampler, int( lod + 1.0 ) ) );
		vec2 fLodSizeInv = 1.0 / fLodSize;
		vec2 cLodSizeInv = 1.0 / cLodSize;
		vec4 fSample = bicubic( sampler, uv, vec4( fLodSizeInv, fLodSize ), floor( lod ) );
		vec4 cSample = bicubic( sampler, uv, vec4( cLodSizeInv, cLodSize ), ceil( lod ) );
		return mix( fSample, cSample, fract( lod ) );
	}
	vec3 getVolumeTransmissionRay( const in vec3 n, const in vec3 v, const in float thickness, const in float ior, const in mat4 modelMatrix ) {
		vec3 refractionVector = refract( - v, normalize( n ), 1.0 / ior );
		vec3 modelScale;
		modelScale.x = length( vec3( modelMatrix[ 0 ].xyz ) );
		modelScale.y = length( vec3( modelMatrix[ 1 ].xyz ) );
		modelScale.z = length( vec3( modelMatrix[ 2 ].xyz ) );
		return normalize( refractionVector ) * thickness * modelScale;
	}
	float applyIorToRoughness( const in float roughness, const in float ior ) {
		return roughness * clamp( ior * 2.0 - 2.0, 0.0, 1.0 );
	}
	vec4 getTransmissionSample( const in vec2 fragCoord, const in float roughness, const in float ior ) {
		float lod = log2( transmissionSamplerSize.x ) * applyIorToRoughness( roughness, ior );
		return textureBicubic( transmissionSamplerMap, fragCoord.xy, lod );
	}
	vec3 volumeAttenuation( const in float transmissionDistance, const in vec3 attenuationColor, const in float attenuationDistance ) {
		if ( isinf( attenuationDistance ) ) {
			return vec3( 1.0 );
		} else {
			vec3 attenuationCoefficient = -log( attenuationColor ) / attenuationDistance;
			vec3 transmittance = exp( - attenuationCoefficient * transmissionDistance );			return transmittance;
		}
	}
	vec4 getIBLVolumeRefraction( const in vec3 n, const in vec3 v, const in float roughness, const in vec3 diffuseColor,
		const in vec3 specularColor, const in float specularF90, const in vec3 position, const in mat4 modelMatrix,
		const in mat4 viewMatrix, const in mat4 projMatrix, const in float dispersion, const in float ior, const in float thickness,
		const in vec3 attenuationColor, const in float attenuationDistance ) {
		vec4 transmittedLight;
		vec3 transmittance;
		#ifdef USE_DISPERSION
			float halfSpread = ( ior - 1.0 ) * 0.025 * dispersion;
			vec3 iors = vec3( ior - halfSpread, ior, ior + halfSpread );
			for ( int i = 0; i < 3; i ++ ) {
				vec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, iors[ i ], modelMatrix );
				vec3 refractedRayExit = position + transmissionRay;
				vec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );
				vec2 refractionCoords = ndcPos.xy / ndcPos.w;
				refractionCoords += 1.0;
				refractionCoords /= 2.0;
				vec4 transmissionSample = getTransmissionSample( refractionCoords, roughness, iors[ i ] );
				transmittedLight[ i ] = transmissionSample[ i ];
				transmittedLight.a += transmissionSample.a;
				transmittance[ i ] = diffuseColor[ i ] * volumeAttenuation( length( transmissionRay ), attenuationColor, attenuationDistance )[ i ];
			}
			transmittedLight.a /= 3.0;
		#else
			vec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, ior, modelMatrix );
			vec3 refractedRayExit = position + transmissionRay;
			vec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );
			vec2 refractionCoords = ndcPos.xy / ndcPos.w;
			refractionCoords += 1.0;
			refractionCoords /= 2.0;
			transmittedLight = getTransmissionSample( refractionCoords, roughness, ior );
			transmittance = diffuseColor * volumeAttenuation( length( transmissionRay ), attenuationColor, attenuationDistance );
		#endif
		vec3 attenuatedColor = transmittance * transmittedLight.rgb;
		vec3 F = EnvironmentBRDF( n, v, specularColor, specularF90, roughness );
		float transmittanceFactor = ( transmittance.r + transmittance.g + transmittance.b ) / 3.0;
		return vec4( ( 1.0 - F ) * attenuatedColor, 1.0 - ( 1.0 - transmittedLight.a ) * transmittanceFactor );
	}
#endif`,wK=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	varying vec2 vUv;
#endif
#ifdef USE_MAP
	varying vec2 vMapUv;
#endif
#ifdef USE_ALPHAMAP
	varying vec2 vAlphaMapUv;
#endif
#ifdef USE_LIGHTMAP
	varying vec2 vLightMapUv;
#endif
#ifdef USE_AOMAP
	varying vec2 vAoMapUv;
#endif
#ifdef USE_BUMPMAP
	varying vec2 vBumpMapUv;
#endif
#ifdef USE_NORMALMAP
	varying vec2 vNormalMapUv;
#endif
#ifdef USE_EMISSIVEMAP
	varying vec2 vEmissiveMapUv;
#endif
#ifdef USE_METALNESSMAP
	varying vec2 vMetalnessMapUv;
#endif
#ifdef USE_ROUGHNESSMAP
	varying vec2 vRoughnessMapUv;
#endif
#ifdef USE_ANISOTROPYMAP
	varying vec2 vAnisotropyMapUv;
#endif
#ifdef USE_CLEARCOATMAP
	varying vec2 vClearcoatMapUv;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	varying vec2 vClearcoatNormalMapUv;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	varying vec2 vClearcoatRoughnessMapUv;
#endif
#ifdef USE_IRIDESCENCEMAP
	varying vec2 vIridescenceMapUv;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	varying vec2 vIridescenceThicknessMapUv;
#endif
#ifdef USE_SHEEN_COLORMAP
	varying vec2 vSheenColorMapUv;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	varying vec2 vSheenRoughnessMapUv;
#endif
#ifdef USE_SPECULARMAP
	varying vec2 vSpecularMapUv;
#endif
#ifdef USE_SPECULAR_COLORMAP
	varying vec2 vSpecularColorMapUv;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	varying vec2 vSpecularIntensityMapUv;
#endif
#ifdef USE_TRANSMISSIONMAP
	uniform mat3 transmissionMapTransform;
	varying vec2 vTransmissionMapUv;
#endif
#ifdef USE_THICKNESSMAP
	uniform mat3 thicknessMapTransform;
	varying vec2 vThicknessMapUv;
#endif`,SK=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	varying vec2 vUv;
#endif
#ifdef USE_MAP
	uniform mat3 mapTransform;
	varying vec2 vMapUv;
#endif
#ifdef USE_ALPHAMAP
	uniform mat3 alphaMapTransform;
	varying vec2 vAlphaMapUv;
#endif
#ifdef USE_LIGHTMAP
	uniform mat3 lightMapTransform;
	varying vec2 vLightMapUv;
#endif
#ifdef USE_AOMAP
	uniform mat3 aoMapTransform;
	varying vec2 vAoMapUv;
#endif
#ifdef USE_BUMPMAP
	uniform mat3 bumpMapTransform;
	varying vec2 vBumpMapUv;
#endif
#ifdef USE_NORMALMAP
	uniform mat3 normalMapTransform;
	varying vec2 vNormalMapUv;
#endif
#ifdef USE_DISPLACEMENTMAP
	uniform mat3 displacementMapTransform;
	varying vec2 vDisplacementMapUv;
#endif
#ifdef USE_EMISSIVEMAP
	uniform mat3 emissiveMapTransform;
	varying vec2 vEmissiveMapUv;
#endif
#ifdef USE_METALNESSMAP
	uniform mat3 metalnessMapTransform;
	varying vec2 vMetalnessMapUv;
#endif
#ifdef USE_ROUGHNESSMAP
	uniform mat3 roughnessMapTransform;
	varying vec2 vRoughnessMapUv;
#endif
#ifdef USE_ANISOTROPYMAP
	uniform mat3 anisotropyMapTransform;
	varying vec2 vAnisotropyMapUv;
#endif
#ifdef USE_CLEARCOATMAP
	uniform mat3 clearcoatMapTransform;
	varying vec2 vClearcoatMapUv;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	uniform mat3 clearcoatNormalMapTransform;
	varying vec2 vClearcoatNormalMapUv;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	uniform mat3 clearcoatRoughnessMapTransform;
	varying vec2 vClearcoatRoughnessMapUv;
#endif
#ifdef USE_SHEEN_COLORMAP
	uniform mat3 sheenColorMapTransform;
	varying vec2 vSheenColorMapUv;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	uniform mat3 sheenRoughnessMapTransform;
	varying vec2 vSheenRoughnessMapUv;
#endif
#ifdef USE_IRIDESCENCEMAP
	uniform mat3 iridescenceMapTransform;
	varying vec2 vIridescenceMapUv;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	uniform mat3 iridescenceThicknessMapTransform;
	varying vec2 vIridescenceThicknessMapUv;
#endif
#ifdef USE_SPECULARMAP
	uniform mat3 specularMapTransform;
	varying vec2 vSpecularMapUv;
#endif
#ifdef USE_SPECULAR_COLORMAP
	uniform mat3 specularColorMapTransform;
	varying vec2 vSpecularColorMapUv;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	uniform mat3 specularIntensityMapTransform;
	varying vec2 vSpecularIntensityMapUv;
#endif
#ifdef USE_TRANSMISSIONMAP
	uniform mat3 transmissionMapTransform;
	varying vec2 vTransmissionMapUv;
#endif
#ifdef USE_THICKNESSMAP
	uniform mat3 thicknessMapTransform;
	varying vec2 vThicknessMapUv;
#endif`,bK=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	vUv = vec3( uv, 1 ).xy;
#endif
#ifdef USE_MAP
	vMapUv = ( mapTransform * vec3( MAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ALPHAMAP
	vAlphaMapUv = ( alphaMapTransform * vec3( ALPHAMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_LIGHTMAP
	vLightMapUv = ( lightMapTransform * vec3( LIGHTMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_AOMAP
	vAoMapUv = ( aoMapTransform * vec3( AOMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_BUMPMAP
	vBumpMapUv = ( bumpMapTransform * vec3( BUMPMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_NORMALMAP
	vNormalMapUv = ( normalMapTransform * vec3( NORMALMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_DISPLACEMENTMAP
	vDisplacementMapUv = ( displacementMapTransform * vec3( DISPLACEMENTMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_EMISSIVEMAP
	vEmissiveMapUv = ( emissiveMapTransform * vec3( EMISSIVEMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_METALNESSMAP
	vMetalnessMapUv = ( metalnessMapTransform * vec3( METALNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ROUGHNESSMAP
	vRoughnessMapUv = ( roughnessMapTransform * vec3( ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ANISOTROPYMAP
	vAnisotropyMapUv = ( anisotropyMapTransform * vec3( ANISOTROPYMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOATMAP
	vClearcoatMapUv = ( clearcoatMapTransform * vec3( CLEARCOATMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	vClearcoatNormalMapUv = ( clearcoatNormalMapTransform * vec3( CLEARCOAT_NORMALMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	vClearcoatRoughnessMapUv = ( clearcoatRoughnessMapTransform * vec3( CLEARCOAT_ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_IRIDESCENCEMAP
	vIridescenceMapUv = ( iridescenceMapTransform * vec3( IRIDESCENCEMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	vIridescenceThicknessMapUv = ( iridescenceThicknessMapTransform * vec3( IRIDESCENCE_THICKNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SHEEN_COLORMAP
	vSheenColorMapUv = ( sheenColorMapTransform * vec3( SHEEN_COLORMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	vSheenRoughnessMapUv = ( sheenRoughnessMapTransform * vec3( SHEEN_ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULARMAP
	vSpecularMapUv = ( specularMapTransform * vec3( SPECULARMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULAR_COLORMAP
	vSpecularColorMapUv = ( specularColorMapTransform * vec3( SPECULAR_COLORMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	vSpecularIntensityMapUv = ( specularIntensityMapTransform * vec3( SPECULAR_INTENSITYMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_TRANSMISSIONMAP
	vTransmissionMapUv = ( transmissionMapTransform * vec3( TRANSMISSIONMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_THICKNESSMAP
	vThicknessMapUv = ( thicknessMapTransform * vec3( THICKNESSMAP_UV, 1 ) ).xy;
#endif`,EK=`#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP ) || defined ( USE_TRANSMISSION ) || NUM_SPOT_LIGHT_COORDS > 0
	vec4 worldPosition = vec4( transformed, 1.0 );
	#ifdef USE_BATCHING
		worldPosition = batchingMatrix * worldPosition;
	#endif
	#ifdef USE_INSTANCING
		worldPosition = instanceMatrix * worldPosition;
	#endif
	worldPosition = modelMatrix * worldPosition;
#endif`;const MK=`varying vec2 vUv;
uniform mat3 uvTransform;
void main() {
	vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
	gl_Position = vec4( position.xy, 1.0, 1.0 );
}`,TK=`uniform sampler2D t2D;
uniform float backgroundIntensity;
varying vec2 vUv;
void main() {
	vec4 texColor = texture2D( t2D, vUv );
	#ifdef DECODE_VIDEO_TEXTURE
		texColor = vec4( mix( pow( texColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), texColor.rgb * 0.0773993808, vec3( lessThanEqual( texColor.rgb, vec3( 0.04045 ) ) ) ), texColor.w );
	#endif
	texColor.rgb *= backgroundIntensity;
	gl_FragColor = texColor;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,CK=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,AK=`#ifdef ENVMAP_TYPE_CUBE
	uniform samplerCube envMap;
#elif defined( ENVMAP_TYPE_CUBE_UV )
	uniform sampler2D envMap;
#endif
uniform float flipEnvMap;
uniform float backgroundBlurriness;
uniform float backgroundIntensity;
uniform mat3 backgroundRotation;
varying vec3 vWorldDirection;
#include <cube_uv_reflection_fragment>
void main() {
	#ifdef ENVMAP_TYPE_CUBE
		vec4 texColor = textureCube( envMap, backgroundRotation * vec3( flipEnvMap * vWorldDirection.x, vWorldDirection.yz ) );
	#elif defined( ENVMAP_TYPE_CUBE_UV )
		vec4 texColor = textureCubeUV( envMap, backgroundRotation * vWorldDirection, backgroundBlurriness );
	#else
		vec4 texColor = vec4( 0.0, 0.0, 0.0, 1.0 );
	#endif
	texColor.rgb *= backgroundIntensity;
	gl_FragColor = texColor;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,RK=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,NK=`uniform samplerCube tCube;
uniform float tFlip;
uniform float opacity;
varying vec3 vWorldDirection;
void main() {
	vec4 texColor = textureCube( tCube, vec3( tFlip * vWorldDirection.x, vWorldDirection.yz ) );
	gl_FragColor = texColor;
	gl_FragColor.a *= opacity;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,PK=`#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
varying vec2 vHighPrecisionZW;
void main() {
	#include <uv_vertex>
	#include <batching_vertex>
	#include <skinbase_vertex>
	#include <morphinstance_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vHighPrecisionZW = gl_Position.zw;
}`,IK=`#if DEPTH_PACKING == 3200
	uniform float opacity;
#endif
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
varying vec2 vHighPrecisionZW;
void main() {
	vec4 diffuseColor = vec4( 1.0 );
	#include <clipping_planes_fragment>
	#if DEPTH_PACKING == 3200
		diffuseColor.a = opacity;
	#endif
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <logdepthbuf_fragment>
	float fragCoordZ = 0.5 * vHighPrecisionZW[0] / vHighPrecisionZW[1] + 0.5;
	#if DEPTH_PACKING == 3200
		gl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );
	#elif DEPTH_PACKING == 3201
		gl_FragColor = packDepthToRGBA( fragCoordZ );
	#elif DEPTH_PACKING == 3202
		gl_FragColor = vec4( packDepthToRGB( fragCoordZ ), 1.0 );
	#elif DEPTH_PACKING == 3203
		gl_FragColor = vec4( packDepthToRG( fragCoordZ ), 0.0, 1.0 );
	#endif
}`,kK=`#define DISTANCE
varying vec3 vWorldPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <batching_vertex>
	#include <skinbase_vertex>
	#include <morphinstance_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <worldpos_vertex>
	#include <clipping_planes_vertex>
	vWorldPosition = worldPosition.xyz;
}`,DK=`#define DISTANCE
uniform vec3 referencePosition;
uniform float nearDistance;
uniform float farDistance;
varying vec3 vWorldPosition;
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <clipping_planes_pars_fragment>
void main () {
	vec4 diffuseColor = vec4( 1.0 );
	#include <clipping_planes_fragment>
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	float dist = length( vWorldPosition - referencePosition );
	dist = ( dist - nearDistance ) / ( farDistance - nearDistance );
	dist = saturate( dist );
	gl_FragColor = packDepthToRGBA( dist );
}`,LK=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
}`,OK=`uniform sampler2D tEquirect;
varying vec3 vWorldDirection;
#include <common>
void main() {
	vec3 direction = normalize( vWorldDirection );
	vec2 sampleUV = equirectUv( direction );
	gl_FragColor = texture2D( tEquirect, sampleUV );
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,jK=`uniform float scale;
attribute float lineDistance;
varying float vLineDistance;
#include <common>
#include <uv_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	vLineDistance = scale * lineDistance;
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,FK=`uniform vec3 diffuse;
uniform float opacity;
uniform float dashSize;
uniform float totalSize;
varying float vLineDistance;
#include <common>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	if ( mod( vLineDistance, totalSize ) > dashSize ) {
		discard;
	}
	vec3 outgoingLight = vec3( 0.0 );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,UK=`#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#if defined ( USE_ENVMAP ) || defined ( USE_SKINNING )
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinbase_vertex>
		#include <skinnormal_vertex>
		#include <defaultnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <fog_vertex>
}`,BK=`uniform vec3 diffuse;
uniform float opacity;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel = texture2D( lightMap, vLightMapUv );
		reflectedLight.indirectDiffuse += lightMapTexel.rgb * lightMapIntensity * RECIPROCAL_PI;
	#else
		reflectedLight.indirectDiffuse += vec3( 1.0 );
	#endif
	#include <aomap_fragment>
	reflectedLight.indirectDiffuse *= diffuseColor.rgb;
	vec3 outgoingLight = reflectedLight.indirectDiffuse;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,zK=`#define LAMBERT
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,VK=`#define LAMBERT
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_lambert_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_lambert_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,HK=`#define MATCAP
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <color_pars_vertex>
#include <displacementmap_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
	vViewPosition = - mvPosition.xyz;
}`,GK=`#define MATCAP
uniform vec3 diffuse;
uniform float opacity;
uniform sampler2D matcap;
varying vec3 vViewPosition;
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	vec3 viewDir = normalize( vViewPosition );
	vec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );
	vec3 y = cross( viewDir, x );
	vec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;
	#ifdef USE_MATCAP
		vec4 matcapColor = texture2D( matcap, uv );
	#else
		vec4 matcapColor = vec4( vec3( mix( 0.2, 0.8, uv.y ) ), 1.0 );
	#endif
	vec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,WK=`#define NORMAL
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	varying vec3 vViewPosition;
#endif
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphinstance_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	vViewPosition = - mvPosition.xyz;
#endif
}`,$K=`#define NORMAL
uniform float opacity;
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	varying vec3 vViewPosition;
#endif
#include <packing>
#include <uv_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( 0.0, 0.0, 0.0, opacity );
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	gl_FragColor = vec4( packNormalToRGB( normal ), diffuseColor.a );
	#ifdef OPAQUE
		gl_FragColor.a = 1.0;
	#endif
}`,qK=`#define PHONG
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphinstance_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,XK=`#define PHONG
uniform vec3 diffuse;
uniform vec3 emissive;
uniform vec3 specular;
uniform float shininess;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_phong_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_phong_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,YK=`#define STANDARD
varying vec3 vViewPosition;
#ifdef USE_TRANSMISSION
	varying vec3 vWorldPosition;
#endif
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
#ifdef USE_TRANSMISSION
	vWorldPosition = worldPosition.xyz;
#endif
}`,KK=`#define STANDARD
#ifdef PHYSICAL
	#define IOR
	#define USE_SPECULAR
#endif
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float roughness;
uniform float metalness;
uniform float opacity;
#ifdef IOR
	uniform float ior;
#endif
#ifdef USE_SPECULAR
	uniform float specularIntensity;
	uniform vec3 specularColor;
	#ifdef USE_SPECULAR_COLORMAP
		uniform sampler2D specularColorMap;
	#endif
	#ifdef USE_SPECULAR_INTENSITYMAP
		uniform sampler2D specularIntensityMap;
	#endif
#endif
#ifdef USE_CLEARCOAT
	uniform float clearcoat;
	uniform float clearcoatRoughness;
#endif
#ifdef USE_DISPERSION
	uniform float dispersion;
#endif
#ifdef USE_IRIDESCENCE
	uniform float iridescence;
	uniform float iridescenceIOR;
	uniform float iridescenceThicknessMinimum;
	uniform float iridescenceThicknessMaximum;
#endif
#ifdef USE_SHEEN
	uniform vec3 sheenColor;
	uniform float sheenRoughness;
	#ifdef USE_SHEEN_COLORMAP
		uniform sampler2D sheenColorMap;
	#endif
	#ifdef USE_SHEEN_ROUGHNESSMAP
		uniform sampler2D sheenRoughnessMap;
	#endif
#endif
#ifdef USE_ANISOTROPY
	uniform vec2 anisotropyVector;
	#ifdef USE_ANISOTROPYMAP
		uniform sampler2D anisotropyMap;
	#endif
#endif
varying vec3 vViewPosition;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <iridescence_fragment>
#include <cube_uv_reflection_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_physical_pars_fragment>
#include <fog_pars_fragment>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_physical_pars_fragment>
#include <transmission_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <clearcoat_pars_fragment>
#include <iridescence_pars_fragment>
#include <roughnessmap_pars_fragment>
#include <metalnessmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <roughnessmap_fragment>
	#include <metalnessmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <clearcoat_normal_fragment_begin>
	#include <clearcoat_normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_physical_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 totalDiffuse = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse;
	vec3 totalSpecular = reflectedLight.directSpecular + reflectedLight.indirectSpecular;
	#include <transmission_fragment>
	vec3 outgoingLight = totalDiffuse + totalSpecular + totalEmissiveRadiance;
	#ifdef USE_SHEEN
		float sheenEnergyComp = 1.0 - 0.157 * max3( material.sheenColor );
		outgoingLight = outgoingLight * sheenEnergyComp + sheenSpecularDirect + sheenSpecularIndirect;
	#endif
	#ifdef USE_CLEARCOAT
		float dotNVcc = saturate( dot( geometryClearcoatNormal, geometryViewDir ) );
		vec3 Fcc = F_Schlick( material.clearcoatF0, material.clearcoatF90, dotNVcc );
		outgoingLight = outgoingLight * ( 1.0 - material.clearcoat * Fcc ) + ( clearcoatSpecularDirect + clearcoatSpecularIndirect ) * material.clearcoat;
	#endif
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,QK=`#define TOON
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,JK=`#define TOON
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <gradientmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_toon_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_toon_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,ZK=`uniform float size;
uniform float scale;
#include <common>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
#ifdef USE_POINTS_UV
	varying vec2 vUv;
	uniform mat3 uvTransform;
#endif
void main() {
	#ifdef USE_POINTS_UV
		vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
	#endif
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	gl_PointSize = size;
	#ifdef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );
	#endif
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <fog_vertex>
}`,eQ=`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <color_pars_fragment>
#include <map_particle_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	#include <logdepthbuf_fragment>
	#include <map_particle_fragment>
	#include <color_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,tQ=`#include <common>
#include <batching_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <shadowmap_pars_vertex>
void main() {
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphinstance_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,nQ=`uniform vec3 color;
uniform float opacity;
#include <common>
#include <packing>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <logdepthbuf_pars_fragment>
#include <shadowmap_pars_fragment>
#include <shadowmask_pars_fragment>
void main() {
	#include <logdepthbuf_fragment>
	gl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
}`,rQ=`uniform float rotation;
uniform vec2 center;
#include <common>
#include <uv_pars_vertex>
#include <fog_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	vec4 mvPosition = modelViewMatrix[ 3 ];
	vec2 scale = vec2( length( modelMatrix[ 0 ].xyz ), length( modelMatrix[ 1 ].xyz ) );
	#ifndef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) scale *= - mvPosition.z;
	#endif
	vec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;
	vec2 rotatedPosition;
	rotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;
	rotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;
	mvPosition.xy += rotatedPosition;
	gl_Position = projectionMatrix * mvPosition;
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,sQ=`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
}`,yn={alphahash_fragment:TX,alphahash_pars_fragment:CX,alphamap_fragment:AX,alphamap_pars_fragment:RX,alphatest_fragment:NX,alphatest_pars_fragment:PX,aomap_fragment:IX,aomap_pars_fragment:kX,batching_pars_vertex:DX,batching_vertex:LX,begin_vertex:OX,beginnormal_vertex:jX,bsdfs:FX,iridescence_fragment:UX,bumpmap_pars_fragment:BX,clipping_planes_fragment:zX,clipping_planes_pars_fragment:VX,clipping_planes_pars_vertex:HX,clipping_planes_vertex:GX,color_fragment:WX,color_pars_fragment:$X,color_pars_vertex:qX,color_vertex:XX,common:YX,cube_uv_reflection_fragment:KX,defaultnormal_vertex:QX,displacementmap_pars_vertex:JX,displacementmap_vertex:ZX,emissivemap_fragment:eY,emissivemap_pars_fragment:tY,colorspace_fragment:nY,colorspace_pars_fragment:rY,envmap_fragment:sY,envmap_common_pars_fragment:iY,envmap_pars_fragment:oY,envmap_pars_vertex:aY,envmap_physical_pars_fragment:xY,envmap_vertex:lY,fog_vertex:cY,fog_pars_vertex:uY,fog_fragment:dY,fog_pars_fragment:hY,gradientmap_pars_fragment:fY,lightmap_pars_fragment:pY,lights_lambert_fragment:mY,lights_lambert_pars_fragment:gY,lights_pars_begin:vY,lights_toon_fragment:yY,lights_toon_pars_fragment:_Y,lights_phong_fragment:wY,lights_phong_pars_fragment:SY,lights_physical_fragment:bY,lights_physical_pars_fragment:EY,lights_fragment_begin:MY,lights_fragment_maps:TY,lights_fragment_end:CY,logdepthbuf_fragment:AY,logdepthbuf_pars_fragment:RY,logdepthbuf_pars_vertex:NY,logdepthbuf_vertex:PY,map_fragment:IY,map_pars_fragment:kY,map_particle_fragment:DY,map_particle_pars_fragment:LY,metalnessmap_fragment:OY,metalnessmap_pars_fragment:jY,morphinstance_vertex:FY,morphcolor_vertex:UY,morphnormal_vertex:BY,morphtarget_pars_vertex:zY,morphtarget_vertex:VY,normal_fragment_begin:HY,normal_fragment_maps:GY,normal_pars_fragment:WY,normal_pars_vertex:$Y,normal_vertex:qY,normalmap_pars_fragment:XY,clearcoat_normal_fragment_begin:YY,clearcoat_normal_fragment_maps:KY,clearcoat_pars_fragment:QY,iridescence_pars_fragment:JY,opaque_fragment:ZY,packing:eK,premultiplied_alpha_fragment:tK,project_vertex:nK,dithering_fragment:rK,dithering_pars_fragment:sK,roughnessmap_fragment:iK,roughnessmap_pars_fragment:oK,shadowmap_pars_fragment:aK,shadowmap_pars_vertex:lK,shadowmap_vertex:cK,shadowmask_pars_fragment:uK,skinbase_vertex:dK,skinning_pars_vertex:hK,skinning_vertex:fK,skinnormal_vertex:pK,specularmap_fragment:mK,specularmap_pars_fragment:gK,tonemapping_fragment:vK,tonemapping_pars_fragment:xK,transmission_fragment:yK,transmission_pars_fragment:_K,uv_pars_fragment:wK,uv_pars_vertex:SK,uv_vertex:bK,worldpos_vertex:EK,background_vert:MK,background_frag:TK,backgroundCube_vert:CK,backgroundCube_frag:AK,cube_vert:RK,cube_frag:NK,depth_vert:PK,depth_frag:IK,distanceRGBA_vert:kK,distanceRGBA_frag:DK,equirect_vert:LK,equirect_frag:OK,linedashed_vert:jK,linedashed_frag:FK,meshbasic_vert:UK,meshbasic_frag:BK,meshlambert_vert:zK,meshlambert_frag:VK,meshmatcap_vert:HK,meshmatcap_frag:GK,meshnormal_vert:WK,meshnormal_frag:$K,meshphong_vert:qK,meshphong_frag:XK,meshphysical_vert:YK,meshphysical_frag:KK,meshtoon_vert:QK,meshtoon_frag:JK,points_vert:ZK,points_frag:eQ,shadow_vert:tQ,shadow_frag:nQ,sprite_vert:rQ,sprite_frag:sQ},vt={common:{diffuse:{value:new St(16777215)},opacity:{value:1},map:{value:null},mapTransform:{value:new cn},alphaMap:{value:null},alphaMapTransform:{value:new cn},alphaTest:{value:0}},specularmap:{specularMap:{value:null},specularMapTransform:{value:new cn}},envmap:{envMap:{value:null},envMapRotation:{value:new cn},flipEnvMap:{value:-1},reflectivity:{value:1},ior:{value:1.5},refractionRatio:{value:.98}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1},aoMapTransform:{value:new cn}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1},lightMapTransform:{value:new cn}},bumpmap:{bumpMap:{value:null},bumpMapTransform:{value:new cn},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalMapTransform:{value:new cn},normalScale:{value:new Ve(1,1)}},displacementmap:{displacementMap:{value:null},displacementMapTransform:{value:new cn},displacementScale:{value:1},displacementBias:{value:0}},emissivemap:{emissiveMap:{value:null},emissiveMapTransform:{value:new cn}},metalnessmap:{metalnessMap:{value:null},metalnessMapTransform:{value:new cn}},roughnessmap:{roughnessMap:{value:null},roughnessMapTransform:{value:new cn}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new St(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowIntensity:1,shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowIntensity:1,shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotLightMap:{value:[]},spotShadowMap:{value:[]},spotLightMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowIntensity:1,shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}},ltc_1:{value:null},ltc_2:{value:null}},points:{diffuse:{value:new St(16777215)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},alphaMapTransform:{value:new cn},alphaTest:{value:0},uvTransform:{value:new cn}},sprite:{diffuse:{value:new St(16777215)},opacity:{value:1},center:{value:new Ve(.5,.5)},rotation:{value:0},map:{value:null},mapTransform:{value:new cn},alphaMap:{value:null},alphaMapTransform:{value:new cn},alphaTest:{value:0}}},sa={basic:{uniforms:ii([vt.common,vt.specularmap,vt.envmap,vt.aomap,vt.lightmap,vt.fog]),vertexShader:yn.meshbasic_vert,fragmentShader:yn.meshbasic_frag},lambert:{uniforms:ii([vt.common,vt.specularmap,vt.envmap,vt.aomap,vt.lightmap,vt.emissivemap,vt.bumpmap,vt.normalmap,vt.displacementmap,vt.fog,vt.lights,{emissive:{value:new St(0)}}]),vertexShader:yn.meshlambert_vert,fragmentShader:yn.meshlambert_frag},phong:{uniforms:ii([vt.common,vt.specularmap,vt.envmap,vt.aomap,vt.lightmap,vt.emissivemap,vt.bumpmap,vt.normalmap,vt.displacementmap,vt.fog,vt.lights,{emissive:{value:new St(0)},specular:{value:new St(1118481)},shininess:{value:30}}]),vertexShader:yn.meshphong_vert,fragmentShader:yn.meshphong_frag},standard:{uniforms:ii([vt.common,vt.envmap,vt.aomap,vt.lightmap,vt.emissivemap,vt.bumpmap,vt.normalmap,vt.displacementmap,vt.roughnessmap,vt.metalnessmap,vt.fog,vt.lights,{emissive:{value:new St(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:yn.meshphysical_vert,fragmentShader:yn.meshphysical_frag},toon:{uniforms:ii([vt.common,vt.aomap,vt.lightmap,vt.emissivemap,vt.bumpmap,vt.normalmap,vt.displacementmap,vt.gradientmap,vt.fog,vt.lights,{emissive:{value:new St(0)}}]),vertexShader:yn.meshtoon_vert,fragmentShader:yn.meshtoon_frag},matcap:{uniforms:ii([vt.common,vt.bumpmap,vt.normalmap,vt.displacementmap,vt.fog,{matcap:{value:null}}]),vertexShader:yn.meshmatcap_vert,fragmentShader:yn.meshmatcap_frag},points:{uniforms:ii([vt.points,vt.fog]),vertexShader:yn.points_vert,fragmentShader:yn.points_frag},dashed:{uniforms:ii([vt.common,vt.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:yn.linedashed_vert,fragmentShader:yn.linedashed_frag},depth:{uniforms:ii([vt.common,vt.displacementmap]),vertexShader:yn.depth_vert,fragmentShader:yn.depth_frag},normal:{uniforms:ii([vt.common,vt.bumpmap,vt.normalmap,vt.displacementmap,{opacity:{value:1}}]),vertexShader:yn.meshnormal_vert,fragmentShader:yn.meshnormal_frag},sprite:{uniforms:ii([vt.sprite,vt.fog]),vertexShader:yn.sprite_vert,fragmentShader:yn.sprite_frag},background:{uniforms:{uvTransform:{value:new cn},t2D:{value:null},backgroundIntensity:{value:1}},vertexShader:yn.background_vert,fragmentShader:yn.background_frag},backgroundCube:{uniforms:{envMap:{value:null},flipEnvMap:{value:-1},backgroundBlurriness:{value:0},backgroundIntensity:{value:1},backgroundRotation:{value:new cn}},vertexShader:yn.backgroundCube_vert,fragmentShader:yn.backgroundCube_frag},cube:{uniforms:{tCube:{value:null},tFlip:{value:-1},opacity:{value:1}},vertexShader:yn.cube_vert,fragmentShader:yn.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:yn.equirect_vert,fragmentShader:yn.equirect_frag},distanceRGBA:{uniforms:ii([vt.common,vt.displacementmap,{referencePosition:{value:new J},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:yn.distanceRGBA_vert,fragmentShader:yn.distanceRGBA_frag},shadow:{uniforms:ii([vt.lights,vt.fog,{color:{value:new St(0)},opacity:{value:1}}]),vertexShader:yn.shadow_vert,fragmentShader:yn.shadow_frag}};sa.physical={uniforms:ii([sa.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatMapTransform:{value:new cn},clearcoatNormalMap:{value:null},clearcoatNormalMapTransform:{value:new cn},clearcoatNormalScale:{value:new Ve(1,1)},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatRoughnessMapTransform:{value:new cn},dispersion:{value:0},iridescence:{value:0},iridescenceMap:{value:null},iridescenceMapTransform:{value:new cn},iridescenceIOR:{value:1.3},iridescenceThicknessMinimum:{value:100},iridescenceThicknessMaximum:{value:400},iridescenceThicknessMap:{value:null},iridescenceThicknessMapTransform:{value:new cn},sheen:{value:0},sheenColor:{value:new St(0)},sheenColorMap:{value:null},sheenColorMapTransform:{value:new cn},sheenRoughness:{value:1},sheenRoughnessMap:{value:null},sheenRoughnessMapTransform:{value:new cn},transmission:{value:0},transmissionMap:{value:null},transmissionMapTransform:{value:new cn},transmissionSamplerSize:{value:new Ve},transmissionSamplerMap:{value:null},thickness:{value:0},thicknessMap:{value:null},thicknessMapTransform:{value:new cn},attenuationDistance:{value:0},attenuationColor:{value:new St(0)},specularColor:{value:new St(1,1,1)},specularColorMap:{value:null},specularColorMapTransform:{value:new cn},specularIntensity:{value:1},specularIntensityMap:{value:null},specularIntensityMapTransform:{value:new cn},anisotropyVector:{value:new Ve},anisotropyMap:{value:null},anisotropyMapTransform:{value:new cn}}]),vertexShader:yn.meshphysical_vert,fragmentShader:yn.meshphysical_frag};const ey={r:0,b:0,g:0},Cd=new eo,iQ=new Jt;function oQ(r,e,t,n,s,i,o){const a=new St(0);let c=i===!0?0:1,d,f,m=null,v=0,x=null;function _(T){let A=T.isScene===!0?T.background:null;return A&&A.isTexture&&(A=(T.backgroundBlurriness>0?t:e).get(A)),A}function b(T){let A=!1;const k=_(T);k===null?S(a,c):k&&k.isColor&&(S(k,1),A=!0);const j=r.xr.getEnvironmentBlendMode();j==="additive"?n.buffers.color.setClear(0,0,0,1,o):j==="alpha-blend"&&n.buffers.color.setClear(0,0,0,0,o),(r.autoClear||A)&&(n.buffers.depth.setTest(!0),n.buffers.depth.setMask(!0),n.buffers.color.setMask(!0),r.clear(r.autoClearColor,r.autoClearDepth,r.autoClearStencil))}function w(T,A){const k=_(A);k&&(k.isCubeTexture||k.mapping===hm)?(f===void 0&&(f=new Ur(new Sh(1,1,1),new la({name:"BackgroundCubeMaterial",uniforms:Xp(sa.backgroundCube.uniforms),vertexShader:sa.backgroundCube.vertexShader,fragmentShader:sa.backgroundCube.fragmentShader,side:ci,depthTest:!1,depthWrite:!1,fog:!1,allowOverride:!1})),f.geometry.deleteAttribute("normal"),f.geometry.deleteAttribute("uv"),f.onBeforeRender=function(j,D,L){this.matrixWorld.copyPosition(L.matrixWorld)},Object.defineProperty(f.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),s.update(f)),Cd.copy(A.backgroundRotation),Cd.x*=-1,Cd.y*=-1,Cd.z*=-1,k.isCubeTexture&&k.isRenderTargetTexture===!1&&(Cd.y*=-1,Cd.z*=-1),f.material.uniforms.envMap.value=k,f.material.uniforms.flipEnvMap.value=k.isCubeTexture&&k.isRenderTargetTexture===!1?-1:1,f.material.uniforms.backgroundBlurriness.value=A.backgroundBlurriness,f.material.uniforms.backgroundIntensity.value=A.backgroundIntensity,f.material.uniforms.backgroundRotation.value.setFromMatrix4(iQ.makeRotationFromEuler(Cd)),f.material.toneMapped=kn.getTransfer(k.colorSpace)!==Wn,(m!==k||v!==k.version||x!==r.toneMapping)&&(f.material.needsUpdate=!0,m=k,v=k.version,x=r.toneMapping),f.layers.enableAll(),T.unshift(f,f.geometry,f.material,0,0,null)):k&&k.isTexture&&(d===void 0&&(d=new Ur(new mm(2,2),new la({name:"BackgroundMaterial",uniforms:Xp(sa.background.uniforms),vertexShader:sa.background.vertexShader,fragmentShader:sa.background.fragmentShader,side:Zl,depthTest:!1,depthWrite:!1,fog:!1,allowOverride:!1})),d.geometry.deleteAttribute("normal"),Object.defineProperty(d.material,"map",{get:function(){return this.uniforms.t2D.value}}),s.update(d)),d.material.uniforms.t2D.value=k,d.material.uniforms.backgroundIntensity.value=A.backgroundIntensity,d.material.toneMapped=kn.getTransfer(k.colorSpace)!==Wn,k.matrixAutoUpdate===!0&&k.updateMatrix(),d.material.uniforms.uvTransform.value.copy(k.matrix),(m!==k||v!==k.version||x!==r.toneMapping)&&(d.material.needsUpdate=!0,m=k,v=k.version,x=r.toneMapping),d.layers.enableAll(),T.unshift(d,d.geometry,d.material,0,0,null))}function S(T,A){T.getRGB(ey,z4(r)),n.buffers.color.setClear(ey.r,ey.g,ey.b,A,o)}function C(){f!==void 0&&(f.geometry.dispose(),f.material.dispose(),f=void 0),d!==void 0&&(d.geometry.dispose(),d.material.dispose(),d=void 0)}return{getClearColor:function(){return a},setClearColor:function(T,A=1){a.set(T),c=A,S(a,c)},getClearAlpha:function(){return c},setClearAlpha:function(T){c=T,S(a,c)},render:b,addToRenderList:w,dispose:C}}function aQ(r,e){const t=r.getParameter(r.MAX_VERTEX_ATTRIBS),n={},s=v(null);let i=s,o=!1;function a(I,B,W,K,ee){let oe=!1;const ne=m(K,W,B);i!==ne&&(i=ne,d(i.object)),oe=x(I,K,W,ee),oe&&_(I,K,W,ee),ee!==null&&e.update(ee,r.ELEMENT_ARRAY_BUFFER),(oe||o)&&(o=!1,A(I,B,W,K),ee!==null&&r.bindBuffer(r.ELEMENT_ARRAY_BUFFER,e.get(ee).buffer))}function c(){return r.createVertexArray()}function d(I){return r.bindVertexArray(I)}function f(I){return r.deleteVertexArray(I)}function m(I,B,W){const K=W.wireframe===!0;let ee=n[I.id];ee===void 0&&(ee={},n[I.id]=ee);let oe=ee[B.id];oe===void 0&&(oe={},ee[B.id]=oe);let ne=oe[K];return ne===void 0&&(ne=v(c()),oe[K]=ne),ne}function v(I){const B=[],W=[],K=[];for(let ee=0;ee<t;ee++)B[ee]=0,W[ee]=0,K[ee]=0;return{geometry:null,program:null,wireframe:!1,newAttributes:B,enabledAttributes:W,attributeDivisors:K,object:I,attributes:{},index:null}}function x(I,B,W,K){const ee=i.attributes,oe=B.attributes;let ne=0;const ce=W.getAttributes();for(const V in ce)if(ce[V].location>=0){const Z=ee[V];let X=oe[V];if(X===void 0&&(V==="instanceMatrix"&&I.instanceMatrix&&(X=I.instanceMatrix),V==="instanceColor"&&I.instanceColor&&(X=I.instanceColor)),Z===void 0||Z.attribute!==X||X&&Z.data!==X.data)return!0;ne++}return i.attributesNum!==ne||i.index!==K}function _(I,B,W,K){const ee={},oe=B.attributes;let ne=0;const ce=W.getAttributes();for(const V in ce)if(ce[V].location>=0){let Z=oe[V];Z===void 0&&(V==="instanceMatrix"&&I.instanceMatrix&&(Z=I.instanceMatrix),V==="instanceColor"&&I.instanceColor&&(Z=I.instanceColor));const X={};X.attribute=Z,Z&&Z.data&&(X.data=Z.data),ee[V]=X,ne++}i.attributes=ee,i.attributesNum=ne,i.index=K}function b(){const I=i.newAttributes;for(let B=0,W=I.length;B<W;B++)I[B]=0}function w(I){S(I,0)}function S(I,B){const W=i.newAttributes,K=i.enabledAttributes,ee=i.attributeDivisors;W[I]=1,K[I]===0&&(r.enableVertexAttribArray(I),K[I]=1),ee[I]!==B&&(r.vertexAttribDivisor(I,B),ee[I]=B)}function C(){const I=i.newAttributes,B=i.enabledAttributes;for(let W=0,K=B.length;W<K;W++)B[W]!==I[W]&&(r.disableVertexAttribArray(W),B[W]=0)}function T(I,B,W,K,ee,oe,ne){ne===!0?r.vertexAttribIPointer(I,B,W,ee,oe):r.vertexAttribPointer(I,B,W,K,ee,oe)}function A(I,B,W,K){b();const ee=K.attributes,oe=W.getAttributes(),ne=B.defaultAttributeValues;for(const ce in oe){const V=oe[ce];if(V.location>=0){let q=ee[ce];if(q===void 0&&(ce==="instanceMatrix"&&I.instanceMatrix&&(q=I.instanceMatrix),ce==="instanceColor"&&I.instanceColor&&(q=I.instanceColor)),q!==void 0){const Z=q.normalized,X=q.itemSize,ie=e.get(q);if(ie===void 0)continue;const be=ie.buffer,ue=ie.type,Ee=ie.bytesPerElement,Fe=ue===r.INT||ue===r.UNSIGNED_INT||q.gpuType===ew;if(q.isInterleavedBufferAttribute){const me=q.data,je=me.stride,Xe=q.offset;if(me.isInstancedInterleavedBuffer){for(let $e=0;$e<V.locationSize;$e++)S(V.location+$e,me.meshPerAttribute);I.isInstancedMesh!==!0&&K._maxInstanceCount===void 0&&(K._maxInstanceCount=me.meshPerAttribute*me.count)}else for(let $e=0;$e<V.locationSize;$e++)w(V.location+$e);r.bindBuffer(r.ARRAY_BUFFER,be);for(let $e=0;$e<V.locationSize;$e++)T(V.location+$e,X/V.locationSize,ue,Z,je*Ee,(Xe+X/V.locationSize*$e)*Ee,Fe)}else{if(q.isInstancedBufferAttribute){for(let me=0;me<V.locationSize;me++)S(V.location+me,q.meshPerAttribute);I.isInstancedMesh!==!0&&K._maxInstanceCount===void 0&&(K._maxInstanceCount=q.meshPerAttribute*q.count)}else for(let me=0;me<V.locationSize;me++)w(V.location+me);r.bindBuffer(r.ARRAY_BUFFER,be);for(let me=0;me<V.locationSize;me++)T(V.location+me,X/V.locationSize,ue,Z,X*Ee,X/V.locationSize*me*Ee,Fe)}}else if(ne!==void 0){const Z=ne[ce];if(Z!==void 0)switch(Z.length){case 2:r.vertexAttrib2fv(V.location,Z);break;case 3:r.vertexAttrib3fv(V.location,Z);break;case 4:r.vertexAttrib4fv(V.location,Z);break;default:r.vertexAttrib1fv(V.location,Z)}}}}C()}function k(){L();for(const I in n){const B=n[I];for(const W in B){const K=B[W];for(const ee in K)f(K[ee].object),delete K[ee];delete B[W]}delete n[I]}}function j(I){if(n[I.id]===void 0)return;const B=n[I.id];for(const W in B){const K=B[W];for(const ee in K)f(K[ee].object),delete K[ee];delete B[W]}delete n[I.id]}function D(I){for(const B in n){const W=n[B];if(W[I.id]===void 0)continue;const K=W[I.id];for(const ee in K)f(K[ee].object),delete K[ee];delete W[I.id]}}function L(){O(),o=!0,i!==s&&(i=s,d(i.object))}function O(){s.geometry=null,s.program=null,s.wireframe=!1}return{setup:a,reset:L,resetDefaultState:O,dispose:k,releaseStatesOfGeometry:j,releaseStatesOfProgram:D,initAttributes:b,enableAttribute:w,disableUnusedAttributes:C}}function lQ(r,e,t){let n;function s(d){n=d}function i(d,f){r.drawArrays(n,d,f),t.update(f,n,1)}function o(d,f,m){m!==0&&(r.drawArraysInstanced(n,d,f,m),t.update(f,n,m))}function a(d,f,m){if(m===0)return;e.get("WEBGL_multi_draw").multiDrawArraysWEBGL(n,d,0,f,0,m);let x=0;for(let _=0;_<m;_++)x+=f[_];t.update(x,n,1)}function c(d,f,m,v){if(m===0)return;const x=e.get("WEBGL_multi_draw");if(x===null)for(let _=0;_<d.length;_++)o(d[_],f[_],v[_]);else{x.multiDrawArraysInstancedWEBGL(n,d,0,f,0,v,0,m);let _=0;for(let b=0;b<m;b++)_+=f[b]*v[b];t.update(_,n,1)}}this.setMode=s,this.render=i,this.renderInstances=o,this.renderMultiDraw=a,this.renderMultiDrawInstances=c}function cQ(r,e,t,n){let s;function i(){if(s!==void 0)return s;if(e.has("EXT_texture_filter_anisotropic")===!0){const D=e.get("EXT_texture_filter_anisotropic");s=r.getParameter(D.MAX_TEXTURE_MAX_ANISOTROPY_EXT)}else s=0;return s}function o(D){return!(D!==Vs&&n.convert(D)!==r.getParameter(r.IMPLEMENTATION_COLOR_READ_FORMAT))}function a(D){const L=D===fm&&(e.has("EXT_color_buffer_half_float")||e.has("EXT_color_buffer_float"));return!(D!==_o&&n.convert(D)!==r.getParameter(r.IMPLEMENTATION_COLOR_READ_TYPE)&&D!==Ii&&!L)}function c(D){if(D==="highp"){if(r.getShaderPrecisionFormat(r.VERTEX_SHADER,r.HIGH_FLOAT).precision>0&&r.getShaderPrecisionFormat(r.FRAGMENT_SHADER,r.HIGH_FLOAT).precision>0)return"highp";D="mediump"}return D==="mediump"&&r.getShaderPrecisionFormat(r.VERTEX_SHADER,r.MEDIUM_FLOAT).precision>0&&r.getShaderPrecisionFormat(r.FRAGMENT_SHADER,r.MEDIUM_FLOAT).precision>0?"mediump":"lowp"}let d=t.precision!==void 0?t.precision:"highp";const f=c(d);f!==d&&(console.warn("THREE.WebGLRenderer:",d,"not supported, using",f,"instead."),d=f);const m=t.logarithmicDepthBuffer===!0,v=t.reverseDepthBuffer===!0&&e.has("EXT_clip_control"),x=r.getParameter(r.MAX_TEXTURE_IMAGE_UNITS),_=r.getParameter(r.MAX_VERTEX_TEXTURE_IMAGE_UNITS),b=r.getParameter(r.MAX_TEXTURE_SIZE),w=r.getParameter(r.MAX_CUBE_MAP_TEXTURE_SIZE),S=r.getParameter(r.MAX_VERTEX_ATTRIBS),C=r.getParameter(r.MAX_VERTEX_UNIFORM_VECTORS),T=r.getParameter(r.MAX_VARYING_VECTORS),A=r.getParameter(r.MAX_FRAGMENT_UNIFORM_VECTORS),k=_>0,j=r.getParameter(r.MAX_SAMPLES);return{isWebGL2:!0,getMaxAnisotropy:i,getMaxPrecision:c,textureFormatReadable:o,textureTypeReadable:a,precision:d,logarithmicDepthBuffer:m,reverseDepthBuffer:v,maxTextures:x,maxVertexTextures:_,maxTextureSize:b,maxCubemapSize:w,maxAttributes:S,maxVertexUniforms:C,maxVaryings:T,maxFragmentUniforms:A,vertexTextures:k,maxSamples:j}}function uQ(r){const e=this;let t=null,n=0,s=!1,i=!1;const o=new Bl,a=new cn,c={value:null,needsUpdate:!1};this.uniform=c,this.numPlanes=0,this.numIntersection=0,this.init=function(m,v){const x=m.length!==0||v||n!==0||s;return s=v,n=m.length,x},this.beginShadows=function(){i=!0,f(null)},this.endShadows=function(){i=!1},this.setGlobalState=function(m,v){t=f(m,v,0)},this.setState=function(m,v,x){const _=m.clippingPlanes,b=m.clipIntersection,w=m.clipShadows,S=r.get(m);if(!s||_===null||_.length===0||i&&!w)i?f(null):d();else{const C=i?0:n,T=C*4;let A=S.clippingState||null;c.value=A,A=f(_,v,T,x);for(let k=0;k!==T;++k)A[k]=t[k];S.clippingState=A,this.numIntersection=b?this.numPlanes:0,this.numPlanes+=C}};function d(){c.value!==t&&(c.value=t,c.needsUpdate=n>0),e.numPlanes=n,e.numIntersection=0}function f(m,v,x,_){const b=m!==null?m.length:0;let w=null;if(b!==0){if(w=c.value,_!==!0||w===null){const S=x+b*4,C=v.matrixWorldInverse;a.getNormalMatrix(C),(w===null||w.length<S)&&(w=new Float32Array(S));for(let T=0,A=x;T!==b;++T,A+=4)o.copy(m[T]).applyMatrix4(C,a),o.normal.toArray(w,A),w[A+3]=o.constant}c.value=w,c.needsUpdate=!0}return e.numPlanes=b,e.numIntersection=0,w}}function dQ(r){let e=new WeakMap;function t(o,a){return a===f0?o.mapping=ec:a===p0&&(o.mapping=xu),o}function n(o){if(o&&o.isTexture){const a=o.mapping;if(a===f0||a===p0)if(e.has(o)){const c=e.get(o).texture;return t(c,o.mapping)}else{const c=o.image;if(c&&c.height>0){const d=new G4(c.height);return d.fromEquirectangularTexture(r,o),e.set(o,d),o.addEventListener("dispose",s),t(d.texture,o.mapping)}else return null}}return o}function s(o){const a=o.target;a.removeEventListener("dispose",s);const c=e.get(a);c!==void 0&&(e.delete(a),c.dispose())}function i(){e=new WeakMap}return{get:n,dispose:i}}const _p=4,SA=[.125,.215,.35,.446,.526,.582],Ld=20,_S=new hu,bA=new St;let wS=null,SS=0,bS=0,ES=!1;const kd=(1+Math.sqrt(5))/2,lp=1/kd,EA=[new J(-kd,lp,0),new J(kd,lp,0),new J(-lp,0,kd),new J(lp,0,kd),new J(0,kd,-lp),new J(0,kd,lp),new J(-1,1,-1),new J(1,1,-1),new J(-1,1,1),new J(1,1,1)],hQ=new J;class $b{constructor(e){this._renderer=e,this._pingPongRenderTarget=null,this._lodMax=0,this._cubeSize=0,this._lodPlanes=[],this._sizeLods=[],this._sigmas=[],this._blurMaterial=null,this._cubemapMaterial=null,this._equirectMaterial=null,this._compileMaterial(this._blurMaterial)}fromScene(e,t=0,n=.1,s=100,i={}){const{size:o=256,position:a=hQ}=i;wS=this._renderer.getRenderTarget(),SS=this._renderer.getActiveCubeFace(),bS=this._renderer.getActiveMipmapLevel(),ES=this._renderer.xr.enabled,this._renderer.xr.enabled=!1,this._setSize(o);const c=this._allocateTargets();return c.depthBuffer=!0,this._sceneToCubeUV(e,n,s,c,a),t>0&&this._blur(c,0,0,t),this._applyPMREM(c),this._cleanup(c),c}fromEquirectangular(e,t=null){return this._fromTexture(e,t)}fromCubemap(e,t=null){return this._fromTexture(e,t)}compileCubemapShader(){this._cubemapMaterial===null&&(this._cubemapMaterial=CA(),this._compileMaterial(this._cubemapMaterial))}compileEquirectangularShader(){this._equirectMaterial===null&&(this._equirectMaterial=TA(),this._compileMaterial(this._equirectMaterial))}dispose(){this._dispose(),this._cubemapMaterial!==null&&this._cubemapMaterial.dispose(),this._equirectMaterial!==null&&this._equirectMaterial.dispose()}_setSize(e){this._lodMax=Math.floor(Math.log2(e)),this._cubeSize=Math.pow(2,this._lodMax)}_dispose(){this._blurMaterial!==null&&this._blurMaterial.dispose(),this._pingPongRenderTarget!==null&&this._pingPongRenderTarget.dispose();for(let e=0;e<this._lodPlanes.length;e++)this._lodPlanes[e].dispose()}_cleanup(e){this._renderer.setRenderTarget(wS,SS,bS),this._renderer.xr.enabled=ES,e.scissorTest=!1,ty(e,0,0,e.width,e.height)}_fromTexture(e,t){e.mapping===ec||e.mapping===xu?this._setSize(e.image.length===0?16:e.image[0].width||e.image[0].image.width):this._setSize(e.image.width/4),wS=this._renderer.getRenderTarget(),SS=this._renderer.getActiveCubeFace(),bS=this._renderer.getActiveMipmapLevel(),ES=this._renderer.xr.enabled,this._renderer.xr.enabled=!1;const n=t||this._allocateTargets();return this._textureToCubeUV(e,n),this._applyPMREM(n),this._cleanup(n),n}_allocateTargets(){const e=3*Math.max(this._cubeSize,112),t=4*this._cubeSize,n={magFilter:Qr,minFilter:Qr,generateMipmaps:!1,type:fm,format:Vs,colorSpace:hh,depthBuffer:!1},s=MA(e,t,n);if(this._pingPongRenderTarget===null||this._pingPongRenderTarget.width!==e||this._pingPongRenderTarget.height!==t){this._pingPongRenderTarget!==null&&this._dispose(),this._pingPongRenderTarget=MA(e,t,n);const{_lodMax:i}=this;({sizeLods:this._sizeLods,lodPlanes:this._lodPlanes,sigmas:this._sigmas}=fQ(i)),this._blurMaterial=pQ(i,e,t)}return s}_compileMaterial(e){const t=new Ur(this._lodPlanes[0],e);this._renderer.compile(t,_S)}_sceneToCubeUV(e,t,n,s,i){const c=new Cr(90,1,t,n),d=[1,-1,1,1,1,1],f=[1,1,1,-1,-1,-1],m=this._renderer,v=m.autoClear,x=m.toneMapping;m.getClearColor(bA),m.toneMapping=Ua,m.autoClear=!1;const _=new Tu({name:"PMREM.Background",side:ci,depthWrite:!1,depthTest:!1}),b=new Ur(new Sh,_);let w=!1;const S=e.background;S?S.isColor&&(_.color.copy(S),e.background=null,w=!0):(_.color.copy(bA),w=!0);for(let C=0;C<6;C++){const T=C%3;T===0?(c.up.set(0,d[C],0),c.position.set(i.x,i.y,i.z),c.lookAt(i.x+f[C],i.y,i.z)):T===1?(c.up.set(0,0,d[C]),c.position.set(i.x,i.y,i.z),c.lookAt(i.x,i.y+f[C],i.z)):(c.up.set(0,d[C],0),c.position.set(i.x,i.y,i.z),c.lookAt(i.x,i.y,i.z+f[C]));const A=this._cubeSize;ty(s,T*A,C>2?A:0,A,A),m.setRenderTarget(s),w&&m.render(b,c),m.render(e,c)}b.geometry.dispose(),b.material.dispose(),m.toneMapping=x,m.autoClear=v,e.background=S}_textureToCubeUV(e,t){const n=this._renderer,s=e.mapping===ec||e.mapping===xu;s?(this._cubemapMaterial===null&&(this._cubemapMaterial=CA()),this._cubemapMaterial.uniforms.flipEnvMap.value=e.isRenderTargetTexture===!1?-1:1):this._equirectMaterial===null&&(this._equirectMaterial=TA());const i=s?this._cubemapMaterial:this._equirectMaterial,o=new Ur(this._lodPlanes[0],i),a=i.uniforms;a.envMap.value=e;const c=this._cubeSize;ty(t,0,0,3*c,2*c),n.setRenderTarget(t),n.render(o,_S)}_applyPMREM(e){const t=this._renderer,n=t.autoClear;t.autoClear=!1;const s=this._lodPlanes.length;for(let i=1;i<s;i++){const o=Math.sqrt(this._sigmas[i]*this._sigmas[i]-this._sigmas[i-1]*this._sigmas[i-1]),a=EA[(s-i-1)%EA.length];this._blur(e,i-1,i,o,a)}t.autoClear=n}_blur(e,t,n,s,i){const o=this._pingPongRenderTarget;this._halfBlur(e,o,t,n,s,"latitudinal",i),this._halfBlur(o,e,n,n,s,"longitudinal",i)}_halfBlur(e,t,n,s,i,o,a){const c=this._renderer,d=this._blurMaterial;o!=="latitudinal"&&o!=="longitudinal"&&console.error("blur direction must be either latitudinal or longitudinal!");const f=3,m=new Ur(this._lodPlanes[s],d),v=d.uniforms,x=this._sizeLods[n]-1,_=isFinite(i)?Math.PI/(2*x):2*Math.PI/(2*Ld-1),b=i/_,w=isFinite(i)?1+Math.floor(f*b):Ld;w>Ld&&console.warn(`sigmaRadians, ${i}, is too large and will clip, as it requested ${w} samples when the maximum is set to ${Ld}`);const S=[];let C=0;for(let D=0;D<Ld;++D){const L=D/b,O=Math.exp(-L*L/2);S.push(O),D===0?C+=O:D<w&&(C+=2*O)}for(let D=0;D<S.length;D++)S[D]=S[D]/C;v.envMap.value=e.texture,v.samples.value=w,v.weights.value=S,v.latitudinal.value=o==="latitudinal",a&&(v.poleAxis.value=a);const{_lodMax:T}=this;v.dTheta.value=_,v.mipInt.value=T-n;const A=this._sizeLods[s],k=3*A*(s>T-_p?s-T+_p:0),j=4*(this._cubeSize-A);ty(t,k,j,3*A,2*A),c.setRenderTarget(t),c.render(m,_S)}}function fQ(r){const e=[],t=[],n=[];let s=r;const i=r-_p+1+SA.length;for(let o=0;o<i;o++){const a=Math.pow(2,s);t.push(a);let c=1/a;o>r-_p?c=SA[o-r+_p-1]:o===0&&(c=0),n.push(c);const d=1/(a-2),f=-d,m=1+d,v=[f,f,m,f,m,m,f,f,m,m,f,m],x=6,_=6,b=3,w=2,S=1,C=new Float32Array(b*_*x),T=new Float32Array(w*_*x),A=new Float32Array(S*_*x);for(let j=0;j<x;j++){const D=j%3*2/3-1,L=j>2?0:-1,O=[D,L,0,D+2/3,L,0,D+2/3,L+1,0,D,L,0,D+2/3,L+1,0,D,L+1,0];C.set(O,b*_*j),T.set(v,w*_*j);const I=[j,j,j,j,j,j];A.set(I,S*_*j)}const k=new mn;k.setAttribute("position",new Kn(C,b)),k.setAttribute("uv",new Kn(T,w)),k.setAttribute("faceIndex",new Kn(A,S)),e.push(k),s>_p&&s--}return{lodPlanes:e,sizeLods:t,sigmas:n}}function MA(r,e,t){const n=new Ga(r,e,t);return n.texture.mapping=hm,n.texture.name="PMREM.cubeUv",n.scissorTest=!0,n}function ty(r,e,t,n,s){r.viewport.set(e,t,n,s),r.scissor.set(e,t,n,s)}function pQ(r,e,t){const n=new Float32Array(Ld),s=new J(0,1,0);return new la({name:"SphericalGaussianBlur",defines:{n:Ld,CUBEUV_TEXEL_WIDTH:1/e,CUBEUV_TEXEL_HEIGHT:1/t,CUBEUV_MAX_MIP:`${r}.0`},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:n},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:s}},vertexShader:WM(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;
			uniform int samples;
			uniform float weights[ n ];
			uniform bool latitudinal;
			uniform float dTheta;
			uniform float mipInt;
			uniform vec3 poleAxis;

			#define ENVMAP_TYPE_CUBE_UV
			#include <cube_uv_reflection_fragment>

			vec3 getSample( float theta, vec3 axis ) {

				float cosTheta = cos( theta );
				// Rodrigues' axis-angle rotation
				vec3 sampleDirection = vOutputDirection * cosTheta
					+ cross( axis, vOutputDirection ) * sin( theta )
					+ axis * dot( axis, vOutputDirection ) * ( 1.0 - cosTheta );

				return bilinearCubeUV( envMap, sampleDirection, mipInt );

			}

			void main() {

				vec3 axis = latitudinal ? poleAxis : cross( poleAxis, vOutputDirection );

				if ( all( equal( axis, vec3( 0.0 ) ) ) ) {

					axis = vec3( vOutputDirection.z, 0.0, - vOutputDirection.x );

				}

				axis = normalize( axis );

				gl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );
				gl_FragColor.rgb += weights[ 0 ] * getSample( 0.0, axis );

				for ( int i = 1; i < n; i++ ) {

					if ( i >= samples ) {

						break;

					}

					float theta = dTheta * float( i );
					gl_FragColor.rgb += weights[ i ] * getSample( -1.0 * theta, axis );
					gl_FragColor.rgb += weights[ i ] * getSample( theta, axis );

				}

			}
		`,blending:Wl,depthTest:!1,depthWrite:!1})}function TA(){return new la({name:"EquirectangularToCubeUV",uniforms:{envMap:{value:null}},vertexShader:WM(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;

			#include <common>

			void main() {

				vec3 outputDirection = normalize( vOutputDirection );
				vec2 uv = equirectUv( outputDirection );

				gl_FragColor = vec4( texture2D ( envMap, uv ).rgb, 1.0 );

			}
		`,blending:Wl,depthTest:!1,depthWrite:!1})}function CA(){return new la({name:"CubemapToCubeUV",uniforms:{envMap:{value:null},flipEnvMap:{value:-1}},vertexShader:WM(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			uniform float flipEnvMap;

			varying vec3 vOutputDirection;

			uniform samplerCube envMap;

			void main() {

				gl_FragColor = textureCube( envMap, vec3( flipEnvMap * vOutputDirection.x, vOutputDirection.yz ) );

			}
		`,blending:Wl,depthTest:!1,depthWrite:!1})}function WM(){return`

		precision mediump float;
		precision mediump int;

		attribute float faceIndex;

		varying vec3 vOutputDirection;

		// RH coordinate system; PMREM face-indexing convention
		vec3 getDirection( vec2 uv, float face ) {

			uv = 2.0 * uv - 1.0;

			vec3 direction = vec3( uv, 1.0 );

			if ( face == 0.0 ) {

				direction = direction.zyx; // ( 1, v, u ) pos x

			} else if ( face == 1.0 ) {

				direction = direction.xzy;
				direction.xz *= -1.0; // ( -u, 1, -v ) pos y

			} else if ( face == 2.0 ) {

				direction.x *= -1.0; // ( -u, v, 1 ) pos z

			} else if ( face == 3.0 ) {

				direction = direction.zyx;
				direction.xz *= -1.0; // ( -1, v, -u ) neg x

			} else if ( face == 4.0 ) {

				direction = direction.xzy;
				direction.xy *= -1.0; // ( -u, -1, v ) neg y

			} else if ( face == 5.0 ) {

				direction.z *= -1.0; // ( u, v, -1 ) neg z

			}

			return direction;

		}

		void main() {

			vOutputDirection = getDirection( uv, faceIndex );
			gl_Position = vec4( position, 1.0 );

		}
	`}function mQ(r){let e=new WeakMap,t=null;function n(a){if(a&&a.isTexture){const c=a.mapping,d=c===f0||c===p0,f=c===ec||c===xu;if(d||f){let m=e.get(a);const v=m!==void 0?m.texture.pmremVersion:0;if(a.isRenderTargetTexture&&a.pmremVersion!==v)return t===null&&(t=new $b(r)),m=d?t.fromEquirectangular(a,m):t.fromCubemap(a,m),m.texture.pmremVersion=a.pmremVersion,e.set(a,m),m.texture;if(m!==void 0)return m.texture;{const x=a.image;return d&&x&&x.height>0||f&&x&&s(x)?(t===null&&(t=new $b(r)),m=d?t.fromEquirectangular(a):t.fromCubemap(a),m.texture.pmremVersion=a.pmremVersion,e.set(a,m),a.addEventListener("dispose",i),m.texture):null}}}return a}function s(a){let c=0;const d=6;for(let f=0;f<d;f++)a[f]!==void 0&&c++;return c===d}function i(a){const c=a.target;c.removeEventListener("dispose",i);const d=e.get(c);d!==void 0&&(e.delete(c),d.dispose())}function o(){e=new WeakMap,t!==null&&(t.dispose(),t=null)}return{get:n,dispose:o}}function gQ(r){const e={};function t(n){if(e[n]!==void 0)return e[n];let s;switch(n){case"WEBGL_depth_texture":s=r.getExtension("WEBGL_depth_texture")||r.getExtension("MOZ_WEBGL_depth_texture")||r.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":s=r.getExtension("EXT_texture_filter_anisotropic")||r.getExtension("MOZ_EXT_texture_filter_anisotropic")||r.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":s=r.getExtension("WEBGL_compressed_texture_s3tc")||r.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||r.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":s=r.getExtension("WEBGL_compressed_texture_pvrtc")||r.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:s=r.getExtension(n)}return e[n]=s,s}return{has:function(n){return t(n)!==null},init:function(){t("EXT_color_buffer_float"),t("WEBGL_clip_cull_distance"),t("OES_texture_float_linear"),t("EXT_color_buffer_half_float"),t("WEBGL_multisampled_render_to_texture"),t("WEBGL_render_shared_exponent")},get:function(n){const s=t(n);return s===null&&Tp("THREE.WebGLRenderer: "+n+" extension not supported."),s}}}function vQ(r,e,t,n){const s={},i=new WeakMap;function o(m){const v=m.target;v.index!==null&&e.remove(v.index);for(const _ in v.attributes)e.remove(v.attributes[_]);v.removeEventListener("dispose",o),delete s[v.id];const x=i.get(v);x&&(e.remove(x),i.delete(v)),n.releaseStatesOfGeometry(v),v.isInstancedBufferGeometry===!0&&delete v._maxInstanceCount,t.memory.geometries--}function a(m,v){return s[v.id]===!0||(v.addEventListener("dispose",o),s[v.id]=!0,t.memory.geometries++),v}function c(m){const v=m.attributes;for(const x in v)e.update(v[x],r.ARRAY_BUFFER)}function d(m){const v=[],x=m.index,_=m.attributes.position;let b=0;if(x!==null){const C=x.array;b=x.version;for(let T=0,A=C.length;T<A;T+=3){const k=C[T+0],j=C[T+1],D=C[T+2];v.push(k,j,j,D,D,k)}}else if(_!==void 0){const C=_.array;b=_.version;for(let T=0,A=C.length/3-1;T<A;T+=3){const k=T+0,j=T+1,D=T+2;v.push(k,j,j,D,D,k)}}else return;const w=new(j4(v)?yM:xM)(v,1);w.version=b;const S=i.get(m);S&&e.remove(S),i.set(m,w)}function f(m){const v=i.get(m);if(v){const x=m.index;x!==null&&v.version<x.version&&d(m)}else d(m);return i.get(m)}return{get:a,update:c,getWireframeAttribute:f}}function xQ(r,e,t){let n;function s(v){n=v}let i,o;function a(v){i=v.type,o=v.bytesPerElement}function c(v,x){r.drawElements(n,x,i,v*o),t.update(x,n,1)}function d(v,x,_){_!==0&&(r.drawElementsInstanced(n,x,i,v*o,_),t.update(x,n,_))}function f(v,x,_){if(_===0)return;e.get("WEBGL_multi_draw").multiDrawElementsWEBGL(n,x,0,i,v,0,_);let w=0;for(let S=0;S<_;S++)w+=x[S];t.update(w,n,1)}function m(v,x,_,b){if(_===0)return;const w=e.get("WEBGL_multi_draw");if(w===null)for(let S=0;S<v.length;S++)d(v[S]/o,x[S],b[S]);else{w.multiDrawElementsInstancedWEBGL(n,x,0,i,v,0,b,0,_);let S=0;for(let C=0;C<_;C++)S+=x[C]*b[C];t.update(S,n,1)}}this.setMode=s,this.setIndex=a,this.render=c,this.renderInstances=d,this.renderMultiDraw=f,this.renderMultiDrawInstances=m}function yQ(r){const e={geometries:0,textures:0},t={frame:0,calls:0,triangles:0,points:0,lines:0};function n(i,o,a){switch(t.calls++,o){case r.TRIANGLES:t.triangles+=a*(i/3);break;case r.LINES:t.lines+=a*(i/2);break;case r.LINE_STRIP:t.lines+=a*(i-1);break;case r.LINE_LOOP:t.lines+=a*i;break;case r.POINTS:t.points+=a*i;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",o);break}}function s(){t.calls=0,t.triangles=0,t.points=0,t.lines=0}return{memory:e,render:t,programs:null,autoReset:!0,reset:s,update:n}}function _Q(r,e,t){const n=new WeakMap,s=new On;function i(o,a,c){const d=o.morphTargetInfluences,f=a.morphAttributes.position||a.morphAttributes.normal||a.morphAttributes.color,m=f!==void 0?f.length:0;let v=n.get(a);if(v===void 0||v.count!==m){let I=function(){L.dispose(),n.delete(a),a.removeEventListener("dispose",I)};var x=I;v!==void 0&&v.texture.dispose();const _=a.morphAttributes.position!==void 0,b=a.morphAttributes.normal!==void 0,w=a.morphAttributes.color!==void 0,S=a.morphAttributes.position||[],C=a.morphAttributes.normal||[],T=a.morphAttributes.color||[];let A=0;_===!0&&(A=1),b===!0&&(A=2),w===!0&&(A=3);let k=a.attributes.position.count*A,j=1;k>e.maxTextureSize&&(j=Math.ceil(k/e.maxTextureSize),k=e.maxTextureSize);const D=new Float32Array(k*j*4*m),L=new aw(D,k,j,m);L.type=Ii,L.needsUpdate=!0;const O=A*4;for(let B=0;B<m;B++){const W=S[B],K=C[B],ee=T[B],oe=k*j*4*B;for(let ne=0;ne<W.count;ne++){const ce=ne*O;_===!0&&(s.fromBufferAttribute(W,ne),D[oe+ce+0]=s.x,D[oe+ce+1]=s.y,D[oe+ce+2]=s.z,D[oe+ce+3]=0),b===!0&&(s.fromBufferAttribute(K,ne),D[oe+ce+4]=s.x,D[oe+ce+5]=s.y,D[oe+ce+6]=s.z,D[oe+ce+7]=0),w===!0&&(s.fromBufferAttribute(ee,ne),D[oe+ce+8]=s.x,D[oe+ce+9]=s.y,D[oe+ce+10]=s.z,D[oe+ce+11]=ee.itemSize===4?s.w:1)}}v={count:m,texture:L,size:new Ve(k,j)},n.set(a,v),a.addEventListener("dispose",I)}if(o.isInstancedMesh===!0&&o.morphTexture!==null)c.getUniforms().setValue(r,"morphTexture",o.morphTexture,t);else{let _=0;for(let w=0;w<d.length;w++)_+=d[w];const b=a.morphTargetsRelative?1:1-_;c.getUniforms().setValue(r,"morphTargetBaseInfluence",b),c.getUniforms().setValue(r,"morphTargetInfluences",d)}c.getUniforms().setValue(r,"morphTargetsTexture",v.texture,t),c.getUniforms().setValue(r,"morphTargetsTextureSize",v.size)}return{update:i}}function wQ(r,e,t,n){let s=new WeakMap;function i(c){const d=n.render.frame,f=c.geometry,m=e.get(c,f);if(s.get(m)!==d&&(e.update(m),s.set(m,d)),c.isInstancedMesh&&(c.hasEventListener("dispose",a)===!1&&c.addEventListener("dispose",a),s.get(c)!==d&&(t.update(c.instanceMatrix,r.ARRAY_BUFFER),c.instanceColor!==null&&t.update(c.instanceColor,r.ARRAY_BUFFER),s.set(c,d))),c.isSkinnedMesh){const v=c.skeleton;s.get(v)!==d&&(v.update(),s.set(v,d))}return m}function o(){s=new WeakMap}function a(c){const d=c.target;d.removeEventListener("dispose",a),t.remove(d.instanceMatrix),d.instanceColor!==null&&t.remove(d.instanceColor)}return{update:i,dispose:o}}const HD=new _r,AA=new EM(1,1),GD=new aw,WD=new lw,$D=new X0,RA=[],NA=[],PA=new Float32Array(16),IA=new Float32Array(9),kA=new Float32Array(4);function gm(r,e,t){const n=r[0];if(n<=0||n>0)return r;const s=e*t;let i=RA[s];if(i===void 0&&(i=new Float32Array(s),RA[s]=i),e!==0){n.toArray(i,0);for(let o=1,a=0;o!==e;++o)a+=t,r[o].toArray(i,a)}return i}function Jr(r,e){if(r.length!==e.length)return!1;for(let t=0,n=r.length;t<n;t++)if(r[t]!==e[t])return!1;return!0}function Zr(r,e){for(let t=0,n=e.length;t<n;t++)r[t]=e[t]}function Rw(r,e){let t=NA[e];t===void 0&&(t=new Int32Array(e),NA[e]=t);for(let n=0;n!==e;++n)t[n]=r.allocateTextureUnit();return t}function SQ(r,e){const t=this.cache;t[0]!==e&&(r.uniform1f(this.addr,e),t[0]=e)}function bQ(r,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y)&&(r.uniform2f(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(Jr(t,e))return;r.uniform2fv(this.addr,e),Zr(t,e)}}function EQ(r,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(r.uniform3f(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else if(e.r!==void 0)(t[0]!==e.r||t[1]!==e.g||t[2]!==e.b)&&(r.uniform3f(this.addr,e.r,e.g,e.b),t[0]=e.r,t[1]=e.g,t[2]=e.b);else{if(Jr(t,e))return;r.uniform3fv(this.addr,e),Zr(t,e)}}function MQ(r,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(r.uniform4f(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(Jr(t,e))return;r.uniform4fv(this.addr,e),Zr(t,e)}}function TQ(r,e){const t=this.cache,n=e.elements;if(n===void 0){if(Jr(t,e))return;r.uniformMatrix2fv(this.addr,!1,e),Zr(t,e)}else{if(Jr(t,n))return;kA.set(n),r.uniformMatrix2fv(this.addr,!1,kA),Zr(t,n)}}function CQ(r,e){const t=this.cache,n=e.elements;if(n===void 0){if(Jr(t,e))return;r.uniformMatrix3fv(this.addr,!1,e),Zr(t,e)}else{if(Jr(t,n))return;IA.set(n),r.uniformMatrix3fv(this.addr,!1,IA),Zr(t,n)}}function AQ(r,e){const t=this.cache,n=e.elements;if(n===void 0){if(Jr(t,e))return;r.uniformMatrix4fv(this.addr,!1,e),Zr(t,e)}else{if(Jr(t,n))return;PA.set(n),r.uniformMatrix4fv(this.addr,!1,PA),Zr(t,n)}}function RQ(r,e){const t=this.cache;t[0]!==e&&(r.uniform1i(this.addr,e),t[0]=e)}function NQ(r,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y)&&(r.uniform2i(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(Jr(t,e))return;r.uniform2iv(this.addr,e),Zr(t,e)}}function PQ(r,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(r.uniform3i(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else{if(Jr(t,e))return;r.uniform3iv(this.addr,e),Zr(t,e)}}function IQ(r,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(r.uniform4i(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(Jr(t,e))return;r.uniform4iv(this.addr,e),Zr(t,e)}}function kQ(r,e){const t=this.cache;t[0]!==e&&(r.uniform1ui(this.addr,e),t[0]=e)}function DQ(r,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y)&&(r.uniform2ui(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(Jr(t,e))return;r.uniform2uiv(this.addr,e),Zr(t,e)}}function LQ(r,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(r.uniform3ui(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else{if(Jr(t,e))return;r.uniform3uiv(this.addr,e),Zr(t,e)}}function OQ(r,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(r.uniform4ui(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(Jr(t,e))return;r.uniform4uiv(this.addr,e),Zr(t,e)}}function jQ(r,e,t){const n=this.cache,s=t.allocateTextureUnit();n[0]!==s&&(r.uniform1i(this.addr,s),n[0]=s);let i;this.type===r.SAMPLER_2D_SHADOW?(AA.compareFunction=mM,i=AA):i=HD,t.setTexture2D(e||i,s)}function FQ(r,e,t){const n=this.cache,s=t.allocateTextureUnit();n[0]!==s&&(r.uniform1i(this.addr,s),n[0]=s),t.setTexture3D(e||WD,s)}function UQ(r,e,t){const n=this.cache,s=t.allocateTextureUnit();n[0]!==s&&(r.uniform1i(this.addr,s),n[0]=s),t.setTextureCube(e||$D,s)}function BQ(r,e,t){const n=this.cache,s=t.allocateTextureUnit();n[0]!==s&&(r.uniform1i(this.addr,s),n[0]=s),t.setTexture2DArray(e||GD,s)}function zQ(r){switch(r){case 5126:return SQ;case 35664:return bQ;case 35665:return EQ;case 35666:return MQ;case 35674:return TQ;case 35675:return CQ;case 35676:return AQ;case 5124:case 35670:return RQ;case 35667:case 35671:return NQ;case 35668:case 35672:return PQ;case 35669:case 35673:return IQ;case 5125:return kQ;case 36294:return DQ;case 36295:return LQ;case 36296:return OQ;case 35678:case 36198:case 36298:case 36306:case 35682:return jQ;case 35679:case 36299:case 36307:return FQ;case 35680:case 36300:case 36308:case 36293:return UQ;case 36289:case 36303:case 36311:case 36292:return BQ}}function VQ(r,e){r.uniform1fv(this.addr,e)}function HQ(r,e){const t=gm(e,this.size,2);r.uniform2fv(this.addr,t)}function GQ(r,e){const t=gm(e,this.size,3);r.uniform3fv(this.addr,t)}function WQ(r,e){const t=gm(e,this.size,4);r.uniform4fv(this.addr,t)}function $Q(r,e){const t=gm(e,this.size,4);r.uniformMatrix2fv(this.addr,!1,t)}function qQ(r,e){const t=gm(e,this.size,9);r.uniformMatrix3fv(this.addr,!1,t)}function XQ(r,e){const t=gm(e,this.size,16);r.uniformMatrix4fv(this.addr,!1,t)}function YQ(r,e){r.uniform1iv(this.addr,e)}function KQ(r,e){r.uniform2iv(this.addr,e)}function QQ(r,e){r.uniform3iv(this.addr,e)}function JQ(r,e){r.uniform4iv(this.addr,e)}function ZQ(r,e){r.uniform1uiv(this.addr,e)}function eJ(r,e){r.uniform2uiv(this.addr,e)}function tJ(r,e){r.uniform3uiv(this.addr,e)}function nJ(r,e){r.uniform4uiv(this.addr,e)}function rJ(r,e,t){const n=this.cache,s=e.length,i=Rw(t,s);Jr(n,i)||(r.uniform1iv(this.addr,i),Zr(n,i));for(let o=0;o!==s;++o)t.setTexture2D(e[o]||HD,i[o])}function sJ(r,e,t){const n=this.cache,s=e.length,i=Rw(t,s);Jr(n,i)||(r.uniform1iv(this.addr,i),Zr(n,i));for(let o=0;o!==s;++o)t.setTexture3D(e[o]||WD,i[o])}function iJ(r,e,t){const n=this.cache,s=e.length,i=Rw(t,s);Jr(n,i)||(r.uniform1iv(this.addr,i),Zr(n,i));for(let o=0;o!==s;++o)t.setTextureCube(e[o]||$D,i[o])}function oJ(r,e,t){const n=this.cache,s=e.length,i=Rw(t,s);Jr(n,i)||(r.uniform1iv(this.addr,i),Zr(n,i));for(let o=0;o!==s;++o)t.setTexture2DArray(e[o]||GD,i[o])}function aJ(r){switch(r){case 5126:return VQ;case 35664:return HQ;case 35665:return GQ;case 35666:return WQ;case 35674:return $Q;case 35675:return qQ;case 35676:return XQ;case 5124:case 35670:return YQ;case 35667:case 35671:return KQ;case 35668:case 35672:return QQ;case 35669:case 35673:return JQ;case 5125:return ZQ;case 36294:return eJ;case 36295:return tJ;case 36296:return nJ;case 35678:case 36198:case 36298:case 36306:case 35682:return rJ;case 35679:case 36299:case 36307:return sJ;case 35680:case 36300:case 36308:case 36293:return iJ;case 36289:case 36303:case 36311:case 36292:return oJ}}class lJ{constructor(e,t,n){this.id=e,this.addr=n,this.cache=[],this.type=t.type,this.setValue=zQ(t.type)}}class cJ{constructor(e,t,n){this.id=e,this.addr=n,this.cache=[],this.type=t.type,this.size=t.size,this.setValue=aJ(t.type)}}class uJ{constructor(e){this.id=e,this.seq=[],this.map={}}setValue(e,t,n){const s=this.seq;for(let i=0,o=s.length;i!==o;++i){const a=s[i];a.setValue(e,t[a.id],n)}}}const MS=/(\w+)(\])?(\[|\.)?/g;function DA(r,e){r.seq.push(e),r.map[e.id]=e}function dJ(r,e,t){const n=r.name,s=n.length;for(MS.lastIndex=0;;){const i=MS.exec(n),o=MS.lastIndex;let a=i[1];const c=i[2]==="]",d=i[3];if(c&&(a=a|0),d===void 0||d==="["&&o+2===s){DA(t,d===void 0?new lJ(a,r,e):new cJ(a,r,e));break}else{let m=t.map[a];m===void 0&&(m=new uJ(a),DA(t,m)),t=m}}}class vy{constructor(e,t){this.seq=[],this.map={};const n=e.getProgramParameter(t,e.ACTIVE_UNIFORMS);for(let s=0;s<n;++s){const i=e.getActiveUniform(t,s),o=e.getUniformLocation(t,i.name);dJ(i,o,this)}}setValue(e,t,n,s){const i=this.map[t];i!==void 0&&i.setValue(e,n,s)}setOptional(e,t,n){const s=t[n];s!==void 0&&this.setValue(e,n,s)}static upload(e,t,n,s){for(let i=0,o=t.length;i!==o;++i){const a=t[i],c=n[a.id];c.needsUpdate!==!1&&a.setValue(e,c.value,s)}}static seqWithValue(e,t){const n=[];for(let s=0,i=e.length;s!==i;++s){const o=e[s];o.id in t&&n.push(o)}return n}}function LA(r,e,t){const n=r.createShader(e);return r.shaderSource(n,t),r.compileShader(n),n}const hJ=37297;let fJ=0;function pJ(r,e){const t=r.split(`
`),n=[],s=Math.max(e-6,0),i=Math.min(e+6,t.length);for(let o=s;o<i;o++){const a=o+1;n.push(`${a===e?">":" "} ${a}: ${t[o]}`)}return n.join(`
`)}const OA=new cn;function mJ(r){kn._getMatrix(OA,kn.workingColorSpace,r);const e=`mat3( ${OA.elements.map(t=>t.toFixed(4))} )`;switch(kn.getTransfer(r)){case y0:return[e,"LinearTransferOETF"];case Wn:return[e,"sRGBTransferOETF"];default:return console.warn("THREE.WebGLProgram: Unsupported color space: ",r),[e,"LinearTransferOETF"]}}function jA(r,e,t){const n=r.getShaderParameter(e,r.COMPILE_STATUS),s=r.getShaderInfoLog(e).trim();if(n&&s==="")return"";const i=/ERROR: 0:(\d+)/.exec(s);if(i){const o=parseInt(i[1]);return t.toUpperCase()+`

`+s+`

`+pJ(r.getShaderSource(e),o)}else return s}function gJ(r,e){const t=mJ(e);return[`vec4 ${r}( vec4 value ) {`,`	return ${t[1]}( vec4( value.rgb * ${t[0]}, value.a ) );`,"}"].join(`
`)}function vJ(r,e){let t;switch(e){case v4:t="Linear";break;case x4:t="Reinhard";break;case y4:t="Cineon";break;case iM:t="ACESFilmic";break;case w4:t="AgX";break;case S4:t="Neutral";break;case _4:t="Custom";break;default:console.warn("THREE.WebGLProgram: Unsupported toneMapping:",e),t="Linear"}return"vec3 "+r+"( vec3 color ) { return "+t+"ToneMapping( color ); }"}const ny=new J;function xJ(){kn.getLuminanceCoefficients(ny);const r=ny.x.toFixed(4),e=ny.y.toFixed(4),t=ny.z.toFixed(4);return["float luminance( const in vec3 rgb ) {",`	const vec3 weights = vec3( ${r}, ${e}, ${t} );`,"	return dot( weights, rgb );","}"].join(`
`)}function yJ(r){return[r.extensionClipCullDistance?"#extension GL_ANGLE_clip_cull_distance : require":"",r.extensionMultiDraw?"#extension GL_ANGLE_multi_draw : require":""].filter(Fg).join(`
`)}function _J(r){const e=[];for(const t in r){const n=r[t];n!==!1&&e.push("#define "+t+" "+n)}return e.join(`
`)}function wJ(r,e){const t={},n=r.getProgramParameter(e,r.ACTIVE_ATTRIBUTES);for(let s=0;s<n;s++){const i=r.getActiveAttrib(e,s),o=i.name;let a=1;i.type===r.FLOAT_MAT2&&(a=2),i.type===r.FLOAT_MAT3&&(a=3),i.type===r.FLOAT_MAT4&&(a=4),t[o]={type:i.type,location:r.getAttribLocation(e,o),locationSize:a}}return t}function Fg(r){return r!==""}function FA(r,e){const t=e.numSpotLightShadows+e.numSpotLightMaps-e.numSpotLightShadowsWithMaps;return r.replace(/NUM_DIR_LIGHTS/g,e.numDirLights).replace(/NUM_SPOT_LIGHTS/g,e.numSpotLights).replace(/NUM_SPOT_LIGHT_MAPS/g,e.numSpotLightMaps).replace(/NUM_SPOT_LIGHT_COORDS/g,t).replace(/NUM_RECT_AREA_LIGHTS/g,e.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,e.numPointLights).replace(/NUM_HEMI_LIGHTS/g,e.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,e.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS/g,e.numSpotLightShadowsWithMaps).replace(/NUM_SPOT_LIGHT_SHADOWS/g,e.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,e.numPointLightShadows)}function UA(r,e){return r.replace(/NUM_CLIPPING_PLANES/g,e.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,e.numClippingPlanes-e.numClipIntersection)}const SJ=/^[ \t]*#include +<([\w\d./]+)>/gm;function qb(r){return r.replace(SJ,EJ)}const bJ=new Map;function EJ(r,e){let t=yn[e];if(t===void 0){const n=bJ.get(e);if(n!==void 0)t=yn[n],console.warn('THREE.WebGLRenderer: Shader chunk "%s" has been deprecated. Use "%s" instead.',e,n);else throw new Error("Can not resolve #include <"+e+">")}return qb(t)}const MJ=/#pragma unroll_loop_start\s+for\s*\(\s*int\s+i\s*=\s*(\d+)\s*;\s*i\s*<\s*(\d+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#pragma unroll_loop_end/g;function BA(r){return r.replace(MJ,TJ)}function TJ(r,e,t,n){let s="";for(let i=parseInt(e);i<parseInt(t);i++)s+=n.replace(/\[\s*i\s*\]/g,"[ "+i+" ]").replace(/UNROLLED_LOOP_INDEX/g,i);return s}function zA(r){let e=`precision ${r.precision} float;
	precision ${r.precision} int;
	precision ${r.precision} sampler2D;
	precision ${r.precision} samplerCube;
	precision ${r.precision} sampler3D;
	precision ${r.precision} sampler2DArray;
	precision ${r.precision} sampler2DShadow;
	precision ${r.precision} samplerCubeShadow;
	precision ${r.precision} sampler2DArrayShadow;
	precision ${r.precision} isampler2D;
	precision ${r.precision} isampler3D;
	precision ${r.precision} isamplerCube;
	precision ${r.precision} isampler2DArray;
	precision ${r.precision} usampler2D;
	precision ${r.precision} usampler3D;
	precision ${r.precision} usamplerCube;
	precision ${r.precision} usampler2DArray;
	`;return r.precision==="highp"?e+=`
#define HIGH_PRECISION`:r.precision==="mediump"?e+=`
#define MEDIUM_PRECISION`:r.precision==="lowp"&&(e+=`
#define LOW_PRECISION`),e}function CJ(r){let e="SHADOWMAP_TYPE_BASIC";return r.shadowMapType===J_?e="SHADOWMAP_TYPE_PCF":r.shadowMapType===Wg?e="SHADOWMAP_TYPE_PCF_SOFT":r.shadowMapType===Zo&&(e="SHADOWMAP_TYPE_VSM"),e}function AJ(r){let e="ENVMAP_TYPE_CUBE";if(r.envMap)switch(r.envMapMode){case ec:case xu:e="ENVMAP_TYPE_CUBE";break;case hm:e="ENVMAP_TYPE_CUBE_UV";break}return e}function RJ(r){let e="ENVMAP_MODE_REFLECTION";if(r.envMap)switch(r.envMapMode){case xu:e="ENVMAP_MODE_REFRACTION";break}return e}function NJ(r){let e="ENVMAP_BLENDING_NONE";if(r.envMap)switch(r.combine){case W0:e="ENVMAP_BLENDING_MULTIPLY";break;case m4:e="ENVMAP_BLENDING_MIX";break;case g4:e="ENVMAP_BLENDING_ADD";break}return e}function PJ(r){const e=r.envMapCubeUVHeight;if(e===null)return null;const t=Math.log2(e)-2,n=1/e;return{texelWidth:1/(3*Math.max(Math.pow(2,t),7*16)),texelHeight:n,maxMip:t}}function IJ(r,e,t,n){const s=r.getContext(),i=t.defines;let o=t.vertexShader,a=t.fragmentShader;const c=CJ(t),d=AJ(t),f=RJ(t),m=NJ(t),v=PJ(t),x=yJ(t),_=_J(i),b=s.createProgram();let w,S,C=t.glslVersion?"#version "+t.glslVersion+`
`:"";t.isRawShaderMaterial?(w=["#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,_].filter(Fg).join(`
`),w.length>0&&(w+=`
`),S=["#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,_].filter(Fg).join(`
`),S.length>0&&(S+=`
`)):(w=[zA(t),"#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,_,t.extensionClipCullDistance?"#define USE_CLIP_DISTANCE":"",t.batching?"#define USE_BATCHING":"",t.batchingColor?"#define USE_BATCHING_COLOR":"",t.instancing?"#define USE_INSTANCING":"",t.instancingColor?"#define USE_INSTANCING_COLOR":"",t.instancingMorph?"#define USE_INSTANCING_MORPH":"",t.useFog&&t.fog?"#define USE_FOG":"",t.useFog&&t.fogExp2?"#define FOG_EXP2":"",t.map?"#define USE_MAP":"",t.envMap?"#define USE_ENVMAP":"",t.envMap?"#define "+f:"",t.lightMap?"#define USE_LIGHTMAP":"",t.aoMap?"#define USE_AOMAP":"",t.bumpMap?"#define USE_BUMPMAP":"",t.normalMap?"#define USE_NORMALMAP":"",t.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",t.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",t.displacementMap?"#define USE_DISPLACEMENTMAP":"",t.emissiveMap?"#define USE_EMISSIVEMAP":"",t.anisotropy?"#define USE_ANISOTROPY":"",t.anisotropyMap?"#define USE_ANISOTROPYMAP":"",t.clearcoatMap?"#define USE_CLEARCOATMAP":"",t.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",t.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",t.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",t.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",t.specularMap?"#define USE_SPECULARMAP":"",t.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",t.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",t.roughnessMap?"#define USE_ROUGHNESSMAP":"",t.metalnessMap?"#define USE_METALNESSMAP":"",t.alphaMap?"#define USE_ALPHAMAP":"",t.alphaHash?"#define USE_ALPHAHASH":"",t.transmission?"#define USE_TRANSMISSION":"",t.transmissionMap?"#define USE_TRANSMISSIONMAP":"",t.thicknessMap?"#define USE_THICKNESSMAP":"",t.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",t.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",t.mapUv?"#define MAP_UV "+t.mapUv:"",t.alphaMapUv?"#define ALPHAMAP_UV "+t.alphaMapUv:"",t.lightMapUv?"#define LIGHTMAP_UV "+t.lightMapUv:"",t.aoMapUv?"#define AOMAP_UV "+t.aoMapUv:"",t.emissiveMapUv?"#define EMISSIVEMAP_UV "+t.emissiveMapUv:"",t.bumpMapUv?"#define BUMPMAP_UV "+t.bumpMapUv:"",t.normalMapUv?"#define NORMALMAP_UV "+t.normalMapUv:"",t.displacementMapUv?"#define DISPLACEMENTMAP_UV "+t.displacementMapUv:"",t.metalnessMapUv?"#define METALNESSMAP_UV "+t.metalnessMapUv:"",t.roughnessMapUv?"#define ROUGHNESSMAP_UV "+t.roughnessMapUv:"",t.anisotropyMapUv?"#define ANISOTROPYMAP_UV "+t.anisotropyMapUv:"",t.clearcoatMapUv?"#define CLEARCOATMAP_UV "+t.clearcoatMapUv:"",t.clearcoatNormalMapUv?"#define CLEARCOAT_NORMALMAP_UV "+t.clearcoatNormalMapUv:"",t.clearcoatRoughnessMapUv?"#define CLEARCOAT_ROUGHNESSMAP_UV "+t.clearcoatRoughnessMapUv:"",t.iridescenceMapUv?"#define IRIDESCENCEMAP_UV "+t.iridescenceMapUv:"",t.iridescenceThicknessMapUv?"#define IRIDESCENCE_THICKNESSMAP_UV "+t.iridescenceThicknessMapUv:"",t.sheenColorMapUv?"#define SHEEN_COLORMAP_UV "+t.sheenColorMapUv:"",t.sheenRoughnessMapUv?"#define SHEEN_ROUGHNESSMAP_UV "+t.sheenRoughnessMapUv:"",t.specularMapUv?"#define SPECULARMAP_UV "+t.specularMapUv:"",t.specularColorMapUv?"#define SPECULAR_COLORMAP_UV "+t.specularColorMapUv:"",t.specularIntensityMapUv?"#define SPECULAR_INTENSITYMAP_UV "+t.specularIntensityMapUv:"",t.transmissionMapUv?"#define TRANSMISSIONMAP_UV "+t.transmissionMapUv:"",t.thicknessMapUv?"#define THICKNESSMAP_UV "+t.thicknessMapUv:"",t.vertexTangents&&t.flatShading===!1?"#define USE_TANGENT":"",t.vertexColors?"#define USE_COLOR":"",t.vertexAlphas?"#define USE_COLOR_ALPHA":"",t.vertexUv1s?"#define USE_UV1":"",t.vertexUv2s?"#define USE_UV2":"",t.vertexUv3s?"#define USE_UV3":"",t.pointsUvs?"#define USE_POINTS_UV":"",t.flatShading?"#define FLAT_SHADED":"",t.skinning?"#define USE_SKINNING":"",t.morphTargets?"#define USE_MORPHTARGETS":"",t.morphNormals&&t.flatShading===!1?"#define USE_MORPHNORMALS":"",t.morphColors?"#define USE_MORPHCOLORS":"",t.morphTargetsCount>0?"#define MORPHTARGETS_TEXTURE_STRIDE "+t.morphTextureStride:"",t.morphTargetsCount>0?"#define MORPHTARGETS_COUNT "+t.morphTargetsCount:"",t.doubleSided?"#define DOUBLE_SIDED":"",t.flipSided?"#define FLIP_SIDED":"",t.shadowMapEnabled?"#define USE_SHADOWMAP":"",t.shadowMapEnabled?"#define "+c:"",t.sizeAttenuation?"#define USE_SIZEATTENUATION":"",t.numLightProbes>0?"#define USE_LIGHT_PROBES":"",t.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",t.reverseDepthBuffer?"#define USE_REVERSEDEPTHBUF":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING","	attribute mat4 instanceMatrix;","#endif","#ifdef USE_INSTANCING_COLOR","	attribute vec3 instanceColor;","#endif","#ifdef USE_INSTANCING_MORPH","	uniform sampler2D morphTexture;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_UV1","	attribute vec2 uv1;","#endif","#ifdef USE_UV2","	attribute vec2 uv2;","#endif","#ifdef USE_UV3","	attribute vec2 uv3;","#endif","#ifdef USE_TANGENT","	attribute vec4 tangent;","#endif","#if defined( USE_COLOR_ALPHA )","	attribute vec4 color;","#elif defined( USE_COLOR )","	attribute vec3 color;","#endif","#ifdef USE_SKINNING","	attribute vec4 skinIndex;","	attribute vec4 skinWeight;","#endif",`
`].filter(Fg).join(`
`),S=[zA(t),"#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,_,t.useFog&&t.fog?"#define USE_FOG":"",t.useFog&&t.fogExp2?"#define FOG_EXP2":"",t.alphaToCoverage?"#define ALPHA_TO_COVERAGE":"",t.map?"#define USE_MAP":"",t.matcap?"#define USE_MATCAP":"",t.envMap?"#define USE_ENVMAP":"",t.envMap?"#define "+d:"",t.envMap?"#define "+f:"",t.envMap?"#define "+m:"",v?"#define CUBEUV_TEXEL_WIDTH "+v.texelWidth:"",v?"#define CUBEUV_TEXEL_HEIGHT "+v.texelHeight:"",v?"#define CUBEUV_MAX_MIP "+v.maxMip+".0":"",t.lightMap?"#define USE_LIGHTMAP":"",t.aoMap?"#define USE_AOMAP":"",t.bumpMap?"#define USE_BUMPMAP":"",t.normalMap?"#define USE_NORMALMAP":"",t.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",t.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",t.emissiveMap?"#define USE_EMISSIVEMAP":"",t.anisotropy?"#define USE_ANISOTROPY":"",t.anisotropyMap?"#define USE_ANISOTROPYMAP":"",t.clearcoat?"#define USE_CLEARCOAT":"",t.clearcoatMap?"#define USE_CLEARCOATMAP":"",t.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",t.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",t.dispersion?"#define USE_DISPERSION":"",t.iridescence?"#define USE_IRIDESCENCE":"",t.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",t.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",t.specularMap?"#define USE_SPECULARMAP":"",t.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",t.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",t.roughnessMap?"#define USE_ROUGHNESSMAP":"",t.metalnessMap?"#define USE_METALNESSMAP":"",t.alphaMap?"#define USE_ALPHAMAP":"",t.alphaTest?"#define USE_ALPHATEST":"",t.alphaHash?"#define USE_ALPHAHASH":"",t.sheen?"#define USE_SHEEN":"",t.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",t.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",t.transmission?"#define USE_TRANSMISSION":"",t.transmissionMap?"#define USE_TRANSMISSIONMAP":"",t.thicknessMap?"#define USE_THICKNESSMAP":"",t.vertexTangents&&t.flatShading===!1?"#define USE_TANGENT":"",t.vertexColors||t.instancingColor||t.batchingColor?"#define USE_COLOR":"",t.vertexAlphas?"#define USE_COLOR_ALPHA":"",t.vertexUv1s?"#define USE_UV1":"",t.vertexUv2s?"#define USE_UV2":"",t.vertexUv3s?"#define USE_UV3":"",t.pointsUvs?"#define USE_POINTS_UV":"",t.gradientMap?"#define USE_GRADIENTMAP":"",t.flatShading?"#define FLAT_SHADED":"",t.doubleSided?"#define DOUBLE_SIDED":"",t.flipSided?"#define FLIP_SIDED":"",t.shadowMapEnabled?"#define USE_SHADOWMAP":"",t.shadowMapEnabled?"#define "+c:"",t.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",t.numLightProbes>0?"#define USE_LIGHT_PROBES":"",t.decodeVideoTexture?"#define DECODE_VIDEO_TEXTURE":"",t.decodeVideoTextureEmissive?"#define DECODE_VIDEO_TEXTURE_EMISSIVE":"",t.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",t.reverseDepthBuffer?"#define USE_REVERSEDEPTHBUF":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",t.toneMapping!==Ua?"#define TONE_MAPPING":"",t.toneMapping!==Ua?yn.tonemapping_pars_fragment:"",t.toneMapping!==Ua?vJ("toneMapping",t.toneMapping):"",t.dithering?"#define DITHERING":"",t.opaque?"#define OPAQUE":"",yn.colorspace_pars_fragment,gJ("linearToOutputTexel",t.outputColorSpace),xJ(),t.useDepthPacking?"#define DEPTH_PACKING "+t.depthPacking:"",`
`].filter(Fg).join(`
`)),o=qb(o),o=FA(o,t),o=UA(o,t),a=qb(a),a=FA(a,t),a=UA(a,t),o=BA(o),a=BA(a),t.isRawShaderMaterial!==!0&&(C=`#version 300 es
`,w=[x,"#define attribute in","#define varying out","#define texture2D texture"].join(`
`)+`
`+w,S=["#define varying in",t.glslVersion===jb?"":"layout(location = 0) out highp vec4 pc_fragColor;",t.glslVersion===jb?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join(`
`)+`
`+S);const T=C+w+o,A=C+S+a,k=LA(s,s.VERTEX_SHADER,T),j=LA(s,s.FRAGMENT_SHADER,A);s.attachShader(b,k),s.attachShader(b,j),t.index0AttributeName!==void 0?s.bindAttribLocation(b,0,t.index0AttributeName):t.morphTargets===!0&&s.bindAttribLocation(b,0,"position"),s.linkProgram(b);function D(B){if(r.debug.checkShaderErrors){const W=s.getProgramInfoLog(b).trim(),K=s.getShaderInfoLog(k).trim(),ee=s.getShaderInfoLog(j).trim();let oe=!0,ne=!0;if(s.getProgramParameter(b,s.LINK_STATUS)===!1)if(oe=!1,typeof r.debug.onShaderError=="function")r.debug.onShaderError(s,b,k,j);else{const ce=jA(s,k,"vertex"),V=jA(s,j,"fragment");console.error("THREE.WebGLProgram: Shader Error "+s.getError()+" - VALIDATE_STATUS "+s.getProgramParameter(b,s.VALIDATE_STATUS)+`

Material Name: `+B.name+`
Material Type: `+B.type+`

Program Info Log: `+W+`
`+ce+`
`+V)}else W!==""?console.warn("THREE.WebGLProgram: Program Info Log:",W):(K===""||ee==="")&&(ne=!1);ne&&(B.diagnostics={runnable:oe,programLog:W,vertexShader:{log:K,prefix:w},fragmentShader:{log:ee,prefix:S}})}s.deleteShader(k),s.deleteShader(j),L=new vy(s,b),O=wJ(s,b)}let L;this.getUniforms=function(){return L===void 0&&D(this),L};let O;this.getAttributes=function(){return O===void 0&&D(this),O};let I=t.rendererExtensionParallelShaderCompile===!1;return this.isReady=function(){return I===!1&&(I=s.getProgramParameter(b,hJ)),I},this.destroy=function(){n.releaseStatesOfProgram(this),s.deleteProgram(b),this.program=void 0},this.type=t.shaderType,this.name=t.shaderName,this.id=fJ++,this.cacheKey=e,this.usedTimes=1,this.program=b,this.vertexShader=k,this.fragmentShader=j,this}let kJ=0;class DJ{constructor(){this.shaderCache=new Map,this.materialCache=new Map}update(e){const t=e.vertexShader,n=e.fragmentShader,s=this._getShaderStage(t),i=this._getShaderStage(n),o=this._getShaderCacheForMaterial(e);return o.has(s)===!1&&(o.add(s),s.usedTimes++),o.has(i)===!1&&(o.add(i),i.usedTimes++),this}remove(e){const t=this.materialCache.get(e);for(const n of t)n.usedTimes--,n.usedTimes===0&&this.shaderCache.delete(n.code);return this.materialCache.delete(e),this}getVertexShaderID(e){return this._getShaderStage(e.vertexShader).id}getFragmentShaderID(e){return this._getShaderStage(e.fragmentShader).id}dispose(){this.shaderCache.clear(),this.materialCache.clear()}_getShaderCacheForMaterial(e){const t=this.materialCache;let n=t.get(e);return n===void 0&&(n=new Set,t.set(e,n)),n}_getShaderStage(e){const t=this.shaderCache;let n=t.get(e);return n===void 0&&(n=new LJ(e),t.set(e,n)),n}}class LJ{constructor(e){this.id=kJ++,this.code=e,this.usedTimes=0}}function OJ(r,e,t,n,s,i,o){const a=new Zd,c=new DJ,d=new Set,f=[],m=s.logarithmicDepthBuffer,v=s.vertexTextures;let x=s.precision;const _={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"};function b(O){return d.add(O),O===0?"uv":`uv${O}`}function w(O,I,B,W,K){const ee=W.fog,oe=K.geometry,ne=O.isMeshStandardMaterial?W.environment:null,ce=(O.isMeshStandardMaterial?t:e).get(O.envMap||ne),V=ce&&ce.mapping===hm?ce.image.height:null,q=_[O.type];O.precision!==null&&(x=s.getMaxPrecision(O.precision),x!==O.precision&&console.warn("THREE.WebGLProgram.getParameters:",O.precision,"not supported, using",x,"instead."));const Z=oe.morphAttributes.position||oe.morphAttributes.normal||oe.morphAttributes.color,X=Z!==void 0?Z.length:0;let ie=0;oe.morphAttributes.position!==void 0&&(ie=1),oe.morphAttributes.normal!==void 0&&(ie=2),oe.morphAttributes.color!==void 0&&(ie=3);let be,ue,Ee,Fe;if(q){const Ht=sa[q];be=Ht.vertexShader,ue=Ht.fragmentShader}else be=O.vertexShader,ue=O.fragmentShader,c.update(O),Ee=c.getVertexShaderID(O),Fe=c.getFragmentShaderID(O);const me=r.getRenderTarget(),je=r.state.buffers.depth.getReversed(),Xe=K.isInstancedMesh===!0,$e=K.isBatchedMesh===!0,dt=!!O.map,ht=!!O.matcap,Ie=!!ce,$=!!O.aoMap,Ce=!!O.lightMap,ke=!!O.bumpMap,Ge=!!O.normalMap,Ae=!!O.displacementMap,rt=!!O.emissiveMap,qe=!!O.metalnessMap,nt=!!O.roughnessMap,jt=O.anisotropy>0,Q=O.clearcoat>0,H=O.dispersion>0,ye=O.iridescence>0,Re=O.sheen>0,Ue=O.transmission>0,Le=jt&&!!O.anisotropyMap,bt=Q&&!!O.clearcoatMap,st=Q&&!!O.clearcoatNormalMap,xt=Q&&!!O.clearcoatRoughnessMap,Et=ye&&!!O.iridescenceMap,We=ye&&!!O.iridescenceThicknessMap,ft=Re&&!!O.sheenColorMap,Bt=Re&&!!O.sheenRoughnessMap,le=!!O.specularMap,Se=!!O.specularColorMap,Ze=!!O.specularIntensityMap,ae=Ue&&!!O.transmissionMap,Je=Ue&&!!O.thicknessMap,He=!!O.gradientMap,ct=!!O.alphaMap,Ye=O.alphaTest>0,ze=!!O.alphaHash,Be=!!O.extensions;let lt=Ua;O.toneMapped&&(me===null||me.isXRRenderTarget===!0)&&(lt=r.toneMapping);const Dt={shaderID:q,shaderType:O.type,shaderName:O.name,vertexShader:be,fragmentShader:ue,defines:O.defines,customVertexShaderID:Ee,customFragmentShaderID:Fe,isRawShaderMaterial:O.isRawShaderMaterial===!0,glslVersion:O.glslVersion,precision:x,batching:$e,batchingColor:$e&&K._colorsTexture!==null,instancing:Xe,instancingColor:Xe&&K.instanceColor!==null,instancingMorph:Xe&&K.morphTexture!==null,supportsVertexTextures:v,outputColorSpace:me===null?r.outputColorSpace:me.isXRRenderTarget===!0?me.texture.colorSpace:hh,alphaToCoverage:!!O.alphaToCoverage,map:dt,matcap:ht,envMap:Ie,envMapMode:Ie&&ce.mapping,envMapCubeUVHeight:V,aoMap:$,lightMap:Ce,bumpMap:ke,normalMap:Ge,displacementMap:v&&Ae,emissiveMap:rt,normalMapObjectSpace:Ge&&O.normalMapType===R4,normalMapTangentSpace:Ge&&O.normalMapType===Mu,metalnessMap:qe,roughnessMap:nt,anisotropy:jt,anisotropyMap:Le,clearcoat:Q,clearcoatMap:bt,clearcoatNormalMap:st,clearcoatRoughnessMap:xt,dispersion:H,iridescence:ye,iridescenceMap:Et,iridescenceThicknessMap:We,sheen:Re,sheenColorMap:ft,sheenRoughnessMap:Bt,specularMap:le,specularColorMap:Se,specularIntensityMap:Ze,transmission:Ue,transmissionMap:ae,thicknessMap:Je,gradientMap:He,opaque:O.transparent===!1&&O.blending===Qd&&O.alphaToCoverage===!1,alphaMap:ct,alphaTest:Ye,alphaHash:ze,combine:O.combine,mapUv:dt&&b(O.map.channel),aoMapUv:$&&b(O.aoMap.channel),lightMapUv:Ce&&b(O.lightMap.channel),bumpMapUv:ke&&b(O.bumpMap.channel),normalMapUv:Ge&&b(O.normalMap.channel),displacementMapUv:Ae&&b(O.displacementMap.channel),emissiveMapUv:rt&&b(O.emissiveMap.channel),metalnessMapUv:qe&&b(O.metalnessMap.channel),roughnessMapUv:nt&&b(O.roughnessMap.channel),anisotropyMapUv:Le&&b(O.anisotropyMap.channel),clearcoatMapUv:bt&&b(O.clearcoatMap.channel),clearcoatNormalMapUv:st&&b(O.clearcoatNormalMap.channel),clearcoatRoughnessMapUv:xt&&b(O.clearcoatRoughnessMap.channel),iridescenceMapUv:Et&&b(O.iridescenceMap.channel),iridescenceThicknessMapUv:We&&b(O.iridescenceThicknessMap.channel),sheenColorMapUv:ft&&b(O.sheenColorMap.channel),sheenRoughnessMapUv:Bt&&b(O.sheenRoughnessMap.channel),specularMapUv:le&&b(O.specularMap.channel),specularColorMapUv:Se&&b(O.specularColorMap.channel),specularIntensityMapUv:Ze&&b(O.specularIntensityMap.channel),transmissionMapUv:ae&&b(O.transmissionMap.channel),thicknessMapUv:Je&&b(O.thicknessMap.channel),alphaMapUv:ct&&b(O.alphaMap.channel),vertexTangents:!!oe.attributes.tangent&&(Ge||jt),vertexColors:O.vertexColors,vertexAlphas:O.vertexColors===!0&&!!oe.attributes.color&&oe.attributes.color.itemSize===4,pointsUvs:K.isPoints===!0&&!!oe.attributes.uv&&(dt||ct),fog:!!ee,useFog:O.fog===!0,fogExp2:!!ee&&ee.isFogExp2,flatShading:O.flatShading===!0,sizeAttenuation:O.sizeAttenuation===!0,logarithmicDepthBuffer:m,reverseDepthBuffer:je,skinning:K.isSkinnedMesh===!0,morphTargets:oe.morphAttributes.position!==void 0,morphNormals:oe.morphAttributes.normal!==void 0,morphColors:oe.morphAttributes.color!==void 0,morphTargetsCount:X,morphTextureStride:ie,numDirLights:I.directional.length,numPointLights:I.point.length,numSpotLights:I.spot.length,numSpotLightMaps:I.spotLightMap.length,numRectAreaLights:I.rectArea.length,numHemiLights:I.hemi.length,numDirLightShadows:I.directionalShadowMap.length,numPointLightShadows:I.pointShadowMap.length,numSpotLightShadows:I.spotShadowMap.length,numSpotLightShadowsWithMaps:I.numSpotLightShadowsWithMaps,numLightProbes:I.numLightProbes,numClippingPlanes:o.numPlanes,numClipIntersection:o.numIntersection,dithering:O.dithering,shadowMapEnabled:r.shadowMap.enabled&&B.length>0,shadowMapType:r.shadowMap.type,toneMapping:lt,decodeVideoTexture:dt&&O.map.isVideoTexture===!0&&kn.getTransfer(O.map.colorSpace)===Wn,decodeVideoTextureEmissive:rt&&O.emissiveMap.isVideoTexture===!0&&kn.getTransfer(O.emissiveMap.colorSpace)===Wn,premultipliedAlpha:O.premultipliedAlpha,doubleSided:O.side===ka,flipSided:O.side===ci,useDepthPacking:O.depthPacking>=0,depthPacking:O.depthPacking||0,index0AttributeName:O.index0AttributeName,extensionClipCullDistance:Be&&O.extensions.clipCullDistance===!0&&n.has("WEBGL_clip_cull_distance"),extensionMultiDraw:(Be&&O.extensions.multiDraw===!0||$e)&&n.has("WEBGL_multi_draw"),rendererExtensionParallelShaderCompile:n.has("KHR_parallel_shader_compile"),customProgramCacheKey:O.customProgramCacheKey()};return Dt.vertexUv1s=d.has(1),Dt.vertexUv2s=d.has(2),Dt.vertexUv3s=d.has(3),d.clear(),Dt}function S(O){const I=[];if(O.shaderID?I.push(O.shaderID):(I.push(O.customVertexShaderID),I.push(O.customFragmentShaderID)),O.defines!==void 0)for(const B in O.defines)I.push(B),I.push(O.defines[B]);return O.isRawShaderMaterial===!1&&(C(I,O),T(I,O),I.push(r.outputColorSpace)),I.push(O.customProgramCacheKey),I.join()}function C(O,I){O.push(I.precision),O.push(I.outputColorSpace),O.push(I.envMapMode),O.push(I.envMapCubeUVHeight),O.push(I.mapUv),O.push(I.alphaMapUv),O.push(I.lightMapUv),O.push(I.aoMapUv),O.push(I.bumpMapUv),O.push(I.normalMapUv),O.push(I.displacementMapUv),O.push(I.emissiveMapUv),O.push(I.metalnessMapUv),O.push(I.roughnessMapUv),O.push(I.anisotropyMapUv),O.push(I.clearcoatMapUv),O.push(I.clearcoatNormalMapUv),O.push(I.clearcoatRoughnessMapUv),O.push(I.iridescenceMapUv),O.push(I.iridescenceThicknessMapUv),O.push(I.sheenColorMapUv),O.push(I.sheenRoughnessMapUv),O.push(I.specularMapUv),O.push(I.specularColorMapUv),O.push(I.specularIntensityMapUv),O.push(I.transmissionMapUv),O.push(I.thicknessMapUv),O.push(I.combine),O.push(I.fogExp2),O.push(I.sizeAttenuation),O.push(I.morphTargetsCount),O.push(I.morphAttributeCount),O.push(I.numDirLights),O.push(I.numPointLights),O.push(I.numSpotLights),O.push(I.numSpotLightMaps),O.push(I.numHemiLights),O.push(I.numRectAreaLights),O.push(I.numDirLightShadows),O.push(I.numPointLightShadows),O.push(I.numSpotLightShadows),O.push(I.numSpotLightShadowsWithMaps),O.push(I.numLightProbes),O.push(I.shadowMapType),O.push(I.toneMapping),O.push(I.numClippingPlanes),O.push(I.numClipIntersection),O.push(I.depthPacking)}function T(O,I){a.disableAll(),I.supportsVertexTextures&&a.enable(0),I.instancing&&a.enable(1),I.instancingColor&&a.enable(2),I.instancingMorph&&a.enable(3),I.matcap&&a.enable(4),I.envMap&&a.enable(5),I.normalMapObjectSpace&&a.enable(6),I.normalMapTangentSpace&&a.enable(7),I.clearcoat&&a.enable(8),I.iridescence&&a.enable(9),I.alphaTest&&a.enable(10),I.vertexColors&&a.enable(11),I.vertexAlphas&&a.enable(12),I.vertexUv1s&&a.enable(13),I.vertexUv2s&&a.enable(14),I.vertexUv3s&&a.enable(15),I.vertexTangents&&a.enable(16),I.anisotropy&&a.enable(17),I.alphaHash&&a.enable(18),I.batching&&a.enable(19),I.dispersion&&a.enable(20),I.batchingColor&&a.enable(21),O.push(a.mask),a.disableAll(),I.fog&&a.enable(0),I.useFog&&a.enable(1),I.flatShading&&a.enable(2),I.logarithmicDepthBuffer&&a.enable(3),I.reverseDepthBuffer&&a.enable(4),I.skinning&&a.enable(5),I.morphTargets&&a.enable(6),I.morphNormals&&a.enable(7),I.morphColors&&a.enable(8),I.premultipliedAlpha&&a.enable(9),I.shadowMapEnabled&&a.enable(10),I.doubleSided&&a.enable(11),I.flipSided&&a.enable(12),I.useDepthPacking&&a.enable(13),I.dithering&&a.enable(14),I.transmission&&a.enable(15),I.sheen&&a.enable(16),I.opaque&&a.enable(17),I.pointsUvs&&a.enable(18),I.decodeVideoTexture&&a.enable(19),I.decodeVideoTextureEmissive&&a.enable(20),I.alphaToCoverage&&a.enable(21),O.push(a.mask)}function A(O){const I=_[O.type];let B;if(I){const W=sa[I];B=V4.clone(W.uniforms)}else B=O.uniforms;return B}function k(O,I){let B;for(let W=0,K=f.length;W<K;W++){const ee=f[W];if(ee.cacheKey===I){B=ee,++B.usedTimes;break}}return B===void 0&&(B=new IJ(r,I,O,i),f.push(B)),B}function j(O){if(--O.usedTimes===0){const I=f.indexOf(O);f[I]=f[f.length-1],f.pop(),O.destroy()}}function D(O){c.remove(O)}function L(){c.dispose()}return{getParameters:w,getProgramCacheKey:S,getUniforms:A,acquireProgram:k,releaseProgram:j,releaseShaderCache:D,programs:f,dispose:L}}function jJ(){let r=new WeakMap;function e(o){return r.has(o)}function t(o){let a=r.get(o);return a===void 0&&(a={},r.set(o,a)),a}function n(o){r.delete(o)}function s(o,a,c){r.get(o)[a]=c}function i(){r=new WeakMap}return{has:e,get:t,remove:n,update:s,dispose:i}}function FJ(r,e){return r.groupOrder!==e.groupOrder?r.groupOrder-e.groupOrder:r.renderOrder!==e.renderOrder?r.renderOrder-e.renderOrder:r.material.id!==e.material.id?r.material.id-e.material.id:r.z!==e.z?r.z-e.z:r.id-e.id}function VA(r,e){return r.groupOrder!==e.groupOrder?r.groupOrder-e.groupOrder:r.renderOrder!==e.renderOrder?r.renderOrder-e.renderOrder:r.z!==e.z?e.z-r.z:r.id-e.id}function HA(){const r=[];let e=0;const t=[],n=[],s=[];function i(){e=0,t.length=0,n.length=0,s.length=0}function o(m,v,x,_,b,w){let S=r[e];return S===void 0?(S={id:m.id,object:m,geometry:v,material:x,groupOrder:_,renderOrder:m.renderOrder,z:b,group:w},r[e]=S):(S.id=m.id,S.object=m,S.geometry=v,S.material=x,S.groupOrder=_,S.renderOrder=m.renderOrder,S.z=b,S.group=w),e++,S}function a(m,v,x,_,b,w){const S=o(m,v,x,_,b,w);x.transmission>0?n.push(S):x.transparent===!0?s.push(S):t.push(S)}function c(m,v,x,_,b,w){const S=o(m,v,x,_,b,w);x.transmission>0?n.unshift(S):x.transparent===!0?s.unshift(S):t.unshift(S)}function d(m,v){t.length>1&&t.sort(m||FJ),n.length>1&&n.sort(v||VA),s.length>1&&s.sort(v||VA)}function f(){for(let m=e,v=r.length;m<v;m++){const x=r[m];if(x.id===null)break;x.id=null,x.object=null,x.geometry=null,x.material=null,x.group=null}}return{opaque:t,transmissive:n,transparent:s,init:i,push:a,unshift:c,finish:f,sort:d}}function UJ(){let r=new WeakMap;function e(n,s){const i=r.get(n);let o;return i===void 0?(o=new HA,r.set(n,[o])):s>=i.length?(o=new HA,i.push(o)):o=i[s],o}function t(){r=new WeakMap}return{get:e,dispose:t}}function BJ(){const r={};return{get:function(e){if(r[e.id]!==void 0)return r[e.id];let t;switch(e.type){case"DirectionalLight":t={direction:new J,color:new St};break;case"SpotLight":t={position:new J,direction:new J,color:new St,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":t={position:new J,color:new St,distance:0,decay:0};break;case"HemisphereLight":t={direction:new J,skyColor:new St,groundColor:new St};break;case"RectAreaLight":t={color:new St,position:new J,halfWidth:new J,halfHeight:new J};break}return r[e.id]=t,t}}}function zJ(){const r={};return{get:function(e){if(r[e.id]!==void 0)return r[e.id];let t;switch(e.type){case"DirectionalLight":t={shadowIntensity:1,shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Ve};break;case"SpotLight":t={shadowIntensity:1,shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Ve};break;case"PointLight":t={shadowIntensity:1,shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Ve,shadowCameraNear:1,shadowCameraFar:1e3};break}return r[e.id]=t,t}}}let VJ=0;function HJ(r,e){return(e.castShadow?2:0)-(r.castShadow?2:0)+(e.map?1:0)-(r.map?1:0)}function GJ(r){const e=new BJ,t=zJ(),n={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1,numSpotMaps:-1,numLightProbes:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotLightMap:[],spotShadow:[],spotShadowMap:[],spotLightMatrix:[],rectArea:[],rectAreaLTC1:null,rectAreaLTC2:null,point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[],numSpotLightShadowsWithMaps:0,numLightProbes:0};for(let d=0;d<9;d++)n.probe.push(new J);const s=new J,i=new Jt,o=new Jt;function a(d){let f=0,m=0,v=0;for(let O=0;O<9;O++)n.probe[O].set(0,0,0);let x=0,_=0,b=0,w=0,S=0,C=0,T=0,A=0,k=0,j=0,D=0;d.sort(HJ);for(let O=0,I=d.length;O<I;O++){const B=d[O],W=B.color,K=B.intensity,ee=B.distance,oe=B.shadow&&B.shadow.map?B.shadow.map.texture:null;if(B.isAmbientLight)f+=W.r*K,m+=W.g*K,v+=W.b*K;else if(B.isLightProbe){for(let ne=0;ne<9;ne++)n.probe[ne].addScaledVector(B.sh.coefficients[ne],K);D++}else if(B.isDirectionalLight){const ne=e.get(B);if(ne.color.copy(B.color).multiplyScalar(B.intensity),B.castShadow){const ce=B.shadow,V=t.get(B);V.shadowIntensity=ce.intensity,V.shadowBias=ce.bias,V.shadowNormalBias=ce.normalBias,V.shadowRadius=ce.radius,V.shadowMapSize=ce.mapSize,n.directionalShadow[x]=V,n.directionalShadowMap[x]=oe,n.directionalShadowMatrix[x]=B.shadow.matrix,C++}n.directional[x]=ne,x++}else if(B.isSpotLight){const ne=e.get(B);ne.position.setFromMatrixPosition(B.matrixWorld),ne.color.copy(W).multiplyScalar(K),ne.distance=ee,ne.coneCos=Math.cos(B.angle),ne.penumbraCos=Math.cos(B.angle*(1-B.penumbra)),ne.decay=B.decay,n.spot[b]=ne;const ce=B.shadow;if(B.map&&(n.spotLightMap[k]=B.map,k++,ce.updateMatrices(B),B.castShadow&&j++),n.spotLightMatrix[b]=ce.matrix,B.castShadow){const V=t.get(B);V.shadowIntensity=ce.intensity,V.shadowBias=ce.bias,V.shadowNormalBias=ce.normalBias,V.shadowRadius=ce.radius,V.shadowMapSize=ce.mapSize,n.spotShadow[b]=V,n.spotShadowMap[b]=oe,A++}b++}else if(B.isRectAreaLight){const ne=e.get(B);ne.color.copy(W).multiplyScalar(K),ne.halfWidth.set(B.width*.5,0,0),ne.halfHeight.set(0,B.height*.5,0),n.rectArea[w]=ne,w++}else if(B.isPointLight){const ne=e.get(B);if(ne.color.copy(B.color).multiplyScalar(B.intensity),ne.distance=B.distance,ne.decay=B.decay,B.castShadow){const ce=B.shadow,V=t.get(B);V.shadowIntensity=ce.intensity,V.shadowBias=ce.bias,V.shadowNormalBias=ce.normalBias,V.shadowRadius=ce.radius,V.shadowMapSize=ce.mapSize,V.shadowCameraNear=ce.camera.near,V.shadowCameraFar=ce.camera.far,n.pointShadow[_]=V,n.pointShadowMap[_]=oe,n.pointShadowMatrix[_]=B.shadow.matrix,T++}n.point[_]=ne,_++}else if(B.isHemisphereLight){const ne=e.get(B);ne.skyColor.copy(B.color).multiplyScalar(K),ne.groundColor.copy(B.groundColor).multiplyScalar(K),n.hemi[S]=ne,S++}}w>0&&(r.has("OES_texture_float_linear")===!0?(n.rectAreaLTC1=vt.LTC_FLOAT_1,n.rectAreaLTC2=vt.LTC_FLOAT_2):(n.rectAreaLTC1=vt.LTC_HALF_1,n.rectAreaLTC2=vt.LTC_HALF_2)),n.ambient[0]=f,n.ambient[1]=m,n.ambient[2]=v;const L=n.hash;(L.directionalLength!==x||L.pointLength!==_||L.spotLength!==b||L.rectAreaLength!==w||L.hemiLength!==S||L.numDirectionalShadows!==C||L.numPointShadows!==T||L.numSpotShadows!==A||L.numSpotMaps!==k||L.numLightProbes!==D)&&(n.directional.length=x,n.spot.length=b,n.rectArea.length=w,n.point.length=_,n.hemi.length=S,n.directionalShadow.length=C,n.directionalShadowMap.length=C,n.pointShadow.length=T,n.pointShadowMap.length=T,n.spotShadow.length=A,n.spotShadowMap.length=A,n.directionalShadowMatrix.length=C,n.pointShadowMatrix.length=T,n.spotLightMatrix.length=A+k-j,n.spotLightMap.length=k,n.numSpotLightShadowsWithMaps=j,n.numLightProbes=D,L.directionalLength=x,L.pointLength=_,L.spotLength=b,L.rectAreaLength=w,L.hemiLength=S,L.numDirectionalShadows=C,L.numPointShadows=T,L.numSpotShadows=A,L.numSpotMaps=k,L.numLightProbes=D,n.version=VJ++)}function c(d,f){let m=0,v=0,x=0,_=0,b=0;const w=f.matrixWorldInverse;for(let S=0,C=d.length;S<C;S++){const T=d[S];if(T.isDirectionalLight){const A=n.directional[m];A.direction.setFromMatrixPosition(T.matrixWorld),s.setFromMatrixPosition(T.target.matrixWorld),A.direction.sub(s),A.direction.transformDirection(w),m++}else if(T.isSpotLight){const A=n.spot[x];A.position.setFromMatrixPosition(T.matrixWorld),A.position.applyMatrix4(w),A.direction.setFromMatrixPosition(T.matrixWorld),s.setFromMatrixPosition(T.target.matrixWorld),A.direction.sub(s),A.direction.transformDirection(w),x++}else if(T.isRectAreaLight){const A=n.rectArea[_];A.position.setFromMatrixPosition(T.matrixWorld),A.position.applyMatrix4(w),o.identity(),i.copy(T.matrixWorld),i.premultiply(w),o.extractRotation(i),A.halfWidth.set(T.width*.5,0,0),A.halfHeight.set(0,T.height*.5,0),A.halfWidth.applyMatrix4(o),A.halfHeight.applyMatrix4(o),_++}else if(T.isPointLight){const A=n.point[v];A.position.setFromMatrixPosition(T.matrixWorld),A.position.applyMatrix4(w),v++}else if(T.isHemisphereLight){const A=n.hemi[b];A.direction.setFromMatrixPosition(T.matrixWorld),A.direction.transformDirection(w),b++}}}return{setup:a,setupView:c,state:n}}function GA(r){const e=new GJ(r),t=[],n=[];function s(f){d.camera=f,t.length=0,n.length=0}function i(f){t.push(f)}function o(f){n.push(f)}function a(){e.setup(t)}function c(f){e.setupView(t,f)}const d={lightsArray:t,shadowsArray:n,camera:null,lights:e,transmissionRenderTarget:{}};return{init:s,state:d,setupLights:a,setupLightsView:c,pushLight:i,pushShadow:o}}function WJ(r){let e=new WeakMap;function t(s,i=0){const o=e.get(s);let a;return o===void 0?(a=new GA(r),e.set(s,[a])):i>=o.length?(a=new GA(r),o.push(a)):a=o[i],a}function n(){e=new WeakMap}return{get:t,dispose:n}}const $J=`void main() {
	gl_Position = vec4( position, 1.0 );
}`,qJ=`uniform sampler2D shadow_pass;
uniform vec2 resolution;
uniform float radius;
#include <packing>
void main() {
	const float samples = float( VSM_SAMPLES );
	float mean = 0.0;
	float squared_mean = 0.0;
	float uvStride = samples <= 1.0 ? 0.0 : 2.0 / ( samples - 1.0 );
	float uvStart = samples <= 1.0 ? 0.0 : - 1.0;
	for ( float i = 0.0; i < samples; i ++ ) {
		float uvOffset = uvStart + i * uvStride;
		#ifdef HORIZONTAL_PASS
			vec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( uvOffset, 0.0 ) * radius ) / resolution ) );
			mean += distribution.x;
			squared_mean += distribution.y * distribution.y + distribution.x * distribution.x;
		#else
			float depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0, uvOffset ) * radius ) / resolution ) );
			mean += depth;
			squared_mean += depth * depth;
		#endif
	}
	mean = mean / samples;
	squared_mean = squared_mean / samples;
	float std_dev = sqrt( squared_mean - mean * mean );
	gl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );
}`;function XJ(r,e,t){let n=new pm;const s=new Ve,i=new Ve,o=new On,a=new IM({depthPacking:A4}),c=new kM,d={},f=t.maxTextureSize,m={[Zl]:ci,[ci]:Zl,[ka]:ka},v=new la({defines:{VSM_SAMPLES:8},uniforms:{shadow_pass:{value:null},resolution:{value:new Ve},radius:{value:4}},vertexShader:$J,fragmentShader:qJ}),x=v.clone();x.defines.HORIZONTAL_PASS=1;const _=new mn;_.setAttribute("position",new Kn(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));const b=new Ur(_,v),w=this;this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=J_;let S=this.type;this.render=function(j,D,L){if(w.enabled===!1||w.autoUpdate===!1&&w.needsUpdate===!1||j.length===0)return;const O=r.getRenderTarget(),I=r.getActiveCubeFace(),B=r.getActiveMipmapLevel(),W=r.state;W.setBlending(Wl),W.buffers.color.setClear(1,1,1,1),W.buffers.depth.setTest(!0),W.setScissorTest(!1);const K=S!==Zo&&this.type===Zo,ee=S===Zo&&this.type!==Zo;for(let oe=0,ne=j.length;oe<ne;oe++){const ce=j[oe],V=ce.shadow;if(V===void 0){console.warn("THREE.WebGLShadowMap:",ce,"has no shadow.");continue}if(V.autoUpdate===!1&&V.needsUpdate===!1)continue;s.copy(V.mapSize);const q=V.getFrameExtents();if(s.multiply(q),i.copy(V.mapSize),(s.x>f||s.y>f)&&(s.x>f&&(i.x=Math.floor(f/q.x),s.x=i.x*q.x,V.mapSize.x=i.x),s.y>f&&(i.y=Math.floor(f/q.y),s.y=i.y*q.y,V.mapSize.y=i.y)),V.map===null||K===!0||ee===!0){const X=this.type!==Zo?{minFilter:Ss,magFilter:Ss}:{};V.map!==null&&V.map.dispose(),V.map=new Ga(s.x,s.y,X),V.map.texture.name=ce.name+".shadowMap",V.camera.updateProjectionMatrix()}r.setRenderTarget(V.map),r.clear();const Z=V.getViewportCount();for(let X=0;X<Z;X++){const ie=V.getViewport(X);o.set(i.x*ie.x,i.y*ie.y,i.x*ie.z,i.y*ie.w),W.viewport(o),V.updateMatrices(ce,X),n=V.getFrustum(),A(D,L,V.camera,ce,this.type)}V.isPointLightShadow!==!0&&this.type===Zo&&C(V,L),V.needsUpdate=!1}S=this.type,w.needsUpdate=!1,r.setRenderTarget(O,I,B)};function C(j,D){const L=e.update(b);v.defines.VSM_SAMPLES!==j.blurSamples&&(v.defines.VSM_SAMPLES=j.blurSamples,x.defines.VSM_SAMPLES=j.blurSamples,v.needsUpdate=!0,x.needsUpdate=!0),j.mapPass===null&&(j.mapPass=new Ga(s.x,s.y)),v.uniforms.shadow_pass.value=j.map.texture,v.uniforms.resolution.value=j.mapSize,v.uniforms.radius.value=j.radius,r.setRenderTarget(j.mapPass),r.clear(),r.renderBufferDirect(D,null,L,v,b,null),x.uniforms.shadow_pass.value=j.mapPass.texture,x.uniforms.resolution.value=j.mapSize,x.uniforms.radius.value=j.radius,r.setRenderTarget(j.map),r.clear(),r.renderBufferDirect(D,null,L,x,b,null)}function T(j,D,L,O){let I=null;const B=L.isPointLight===!0?j.customDistanceMaterial:j.customDepthMaterial;if(B!==void 0)I=B;else if(I=L.isPointLight===!0?c:a,r.localClippingEnabled&&D.clipShadows===!0&&Array.isArray(D.clippingPlanes)&&D.clippingPlanes.length!==0||D.displacementMap&&D.displacementScale!==0||D.alphaMap&&D.alphaTest>0||D.map&&D.alphaTest>0||D.alphaToCoverage===!0){const W=I.uuid,K=D.uuid;let ee=d[W];ee===void 0&&(ee={},d[W]=ee);let oe=ee[K];oe===void 0&&(oe=I.clone(),ee[K]=oe,D.addEventListener("dispose",k)),I=oe}if(I.visible=D.visible,I.wireframe=D.wireframe,O===Zo?I.side=D.shadowSide!==null?D.shadowSide:D.side:I.side=D.shadowSide!==null?D.shadowSide:m[D.side],I.alphaMap=D.alphaMap,I.alphaTest=D.alphaToCoverage===!0?.5:D.alphaTest,I.map=D.map,I.clipShadows=D.clipShadows,I.clippingPlanes=D.clippingPlanes,I.clipIntersection=D.clipIntersection,I.displacementMap=D.displacementMap,I.displacementScale=D.displacementScale,I.displacementBias=D.displacementBias,I.wireframeLinewidth=D.wireframeLinewidth,I.linewidth=D.linewidth,L.isPointLight===!0&&I.isMeshDistanceMaterial===!0){const W=r.properties.get(I);W.light=L}return I}function A(j,D,L,O,I){if(j.visible===!1)return;if(j.layers.test(D.layers)&&(j.isMesh||j.isLine||j.isPoints)&&(j.castShadow||j.receiveShadow&&I===Zo)&&(!j.frustumCulled||n.intersectsObject(j))){j.modelViewMatrix.multiplyMatrices(L.matrixWorldInverse,j.matrixWorld);const K=e.update(j),ee=j.material;if(Array.isArray(ee)){const oe=K.groups;for(let ne=0,ce=oe.length;ne<ce;ne++){const V=oe[ne],q=ee[V.materialIndex];if(q&&q.visible){const Z=T(j,q,O,I);j.onBeforeShadow(r,j,D,L,K,Z,V),r.renderBufferDirect(L,null,K,Z,j,V),j.onAfterShadow(r,j,D,L,K,Z,V)}}}else if(ee.visible){const oe=T(j,ee,O,I);j.onBeforeShadow(r,j,D,L,K,oe,null),r.renderBufferDirect(L,null,K,oe,j,null),j.onAfterShadow(r,j,D,L,K,oe,null)}}const W=j.children;for(let K=0,ee=W.length;K<ee;K++)A(W[K],D,L,O,I)}function k(j){j.target.removeEventListener("dispose",k);for(const L in d){const O=d[L],I=j.target.uuid;I in O&&(O[I].dispose(),delete O[I])}}}const YJ={[Dy]:Ly,[Oy]:Uy,[jy]:By,[dh]:Fy,[Ly]:Dy,[Uy]:Oy,[By]:jy,[Fy]:dh};function KJ(r,e){function t(){let ae=!1;const Je=new On;let He=null;const ct=new On(0,0,0,0);return{setMask:function(Ye){He!==Ye&&!ae&&(r.colorMask(Ye,Ye,Ye,Ye),He=Ye)},setLocked:function(Ye){ae=Ye},setClear:function(Ye,ze,Be,lt,Dt){Dt===!0&&(Ye*=lt,ze*=lt,Be*=lt),Je.set(Ye,ze,Be,lt),ct.equals(Je)===!1&&(r.clearColor(Ye,ze,Be,lt),ct.copy(Je))},reset:function(){ae=!1,He=null,ct.set(-1,0,0,0)}}}function n(){let ae=!1,Je=!1,He=null,ct=null,Ye=null;return{setReversed:function(ze){if(Je!==ze){const Be=e.get("EXT_clip_control");ze?Be.clipControlEXT(Be.LOWER_LEFT_EXT,Be.ZERO_TO_ONE_EXT):Be.clipControlEXT(Be.LOWER_LEFT_EXT,Be.NEGATIVE_ONE_TO_ONE_EXT),Je=ze;const lt=Ye;Ye=null,this.setClear(lt)}},getReversed:function(){return Je},setTest:function(ze){ze?me(r.DEPTH_TEST):je(r.DEPTH_TEST)},setMask:function(ze){He!==ze&&!ae&&(r.depthMask(ze),He=ze)},setFunc:function(ze){if(Je&&(ze=YJ[ze]),ct!==ze){switch(ze){case Dy:r.depthFunc(r.NEVER);break;case Ly:r.depthFunc(r.ALWAYS);break;case Oy:r.depthFunc(r.LESS);break;case dh:r.depthFunc(r.LEQUAL);break;case jy:r.depthFunc(r.EQUAL);break;case Fy:r.depthFunc(r.GEQUAL);break;case Uy:r.depthFunc(r.GREATER);break;case By:r.depthFunc(r.NOTEQUAL);break;default:r.depthFunc(r.LEQUAL)}ct=ze}},setLocked:function(ze){ae=ze},setClear:function(ze){Ye!==ze&&(Je&&(ze=1-ze),r.clearDepth(ze),Ye=ze)},reset:function(){ae=!1,He=null,ct=null,Ye=null,Je=!1}}}function s(){let ae=!1,Je=null,He=null,ct=null,Ye=null,ze=null,Be=null,lt=null,Dt=null;return{setTest:function(Ht){ae||(Ht?me(r.STENCIL_TEST):je(r.STENCIL_TEST))},setMask:function(Ht){Je!==Ht&&!ae&&(r.stencilMask(Ht),Je=Ht)},setFunc:function(Ht,An,Bn){(He!==Ht||ct!==An||Ye!==Bn)&&(r.stencilFunc(Ht,An,Bn),He=Ht,ct=An,Ye=Bn)},setOp:function(Ht,An,Bn){(ze!==Ht||Be!==An||lt!==Bn)&&(r.stencilOp(Ht,An,Bn),ze=Ht,Be=An,lt=Bn)},setLocked:function(Ht){ae=Ht},setClear:function(Ht){Dt!==Ht&&(r.clearStencil(Ht),Dt=Ht)},reset:function(){ae=!1,Je=null,He=null,ct=null,Ye=null,ze=null,Be=null,lt=null,Dt=null}}}const i=new t,o=new n,a=new s,c=new WeakMap,d=new WeakMap;let f={},m={},v=new WeakMap,x=[],_=null,b=!1,w=null,S=null,C=null,T=null,A=null,k=null,j=null,D=new St(0,0,0),L=0,O=!1,I=null,B=null,W=null,K=null,ee=null;const oe=r.getParameter(r.MAX_COMBINED_TEXTURE_IMAGE_UNITS);let ne=!1,ce=0;const V=r.getParameter(r.VERSION);V.indexOf("WebGL")!==-1?(ce=parseFloat(/^WebGL (\d)/.exec(V)[1]),ne=ce>=1):V.indexOf("OpenGL ES")!==-1&&(ce=parseFloat(/^OpenGL ES (\d)/.exec(V)[1]),ne=ce>=2);let q=null,Z={};const X=r.getParameter(r.SCISSOR_BOX),ie=r.getParameter(r.VIEWPORT),be=new On().fromArray(X),ue=new On().fromArray(ie);function Ee(ae,Je,He,ct){const Ye=new Uint8Array(4),ze=r.createTexture();r.bindTexture(ae,ze),r.texParameteri(ae,r.TEXTURE_MIN_FILTER,r.NEAREST),r.texParameteri(ae,r.TEXTURE_MAG_FILTER,r.NEAREST);for(let Be=0;Be<He;Be++)ae===r.TEXTURE_3D||ae===r.TEXTURE_2D_ARRAY?r.texImage3D(Je,0,r.RGBA,1,1,ct,0,r.RGBA,r.UNSIGNED_BYTE,Ye):r.texImage2D(Je+Be,0,r.RGBA,1,1,0,r.RGBA,r.UNSIGNED_BYTE,Ye);return ze}const Fe={};Fe[r.TEXTURE_2D]=Ee(r.TEXTURE_2D,r.TEXTURE_2D,1),Fe[r.TEXTURE_CUBE_MAP]=Ee(r.TEXTURE_CUBE_MAP,r.TEXTURE_CUBE_MAP_POSITIVE_X,6),Fe[r.TEXTURE_2D_ARRAY]=Ee(r.TEXTURE_2D_ARRAY,r.TEXTURE_2D_ARRAY,1,1),Fe[r.TEXTURE_3D]=Ee(r.TEXTURE_3D,r.TEXTURE_3D,1,1),i.setClear(0,0,0,1),o.setClear(1),a.setClear(0),me(r.DEPTH_TEST),o.setFunc(dh),ke(!1),Ge(Pb),me(r.CULL_FACE),$(Wl);function me(ae){f[ae]!==!0&&(r.enable(ae),f[ae]=!0)}function je(ae){f[ae]!==!1&&(r.disable(ae),f[ae]=!1)}function Xe(ae,Je){return m[ae]!==Je?(r.bindFramebuffer(ae,Je),m[ae]=Je,ae===r.DRAW_FRAMEBUFFER&&(m[r.FRAMEBUFFER]=Je),ae===r.FRAMEBUFFER&&(m[r.DRAW_FRAMEBUFFER]=Je),!0):!1}function $e(ae,Je){let He=x,ct=!1;if(ae){He=v.get(Je),He===void 0&&(He=[],v.set(Je,He));const Ye=ae.textures;if(He.length!==Ye.length||He[0]!==r.COLOR_ATTACHMENT0){for(let ze=0,Be=Ye.length;ze<Be;ze++)He[ze]=r.COLOR_ATTACHMENT0+ze;He.length=Ye.length,ct=!0}}else He[0]!==r.BACK&&(He[0]=r.BACK,ct=!0);ct&&r.drawBuffers(He)}function dt(ae){return _!==ae?(r.useProgram(ae),_=ae,!0):!1}const ht={[Qc]:r.FUNC_ADD,[Jk]:r.FUNC_SUBTRACT,[Zk]:r.FUNC_REVERSE_SUBTRACT};ht[e4]=r.MIN,ht[t4]=r.MAX;const Ie={[n4]:r.ZERO,[r4]:r.ONE,[s4]:r.SRC_COLOR,[Iy]:r.SRC_ALPHA,[u4]:r.SRC_ALPHA_SATURATE,[l4]:r.DST_COLOR,[o4]:r.DST_ALPHA,[i4]:r.ONE_MINUS_SRC_COLOR,[ky]:r.ONE_MINUS_SRC_ALPHA,[c4]:r.ONE_MINUS_DST_COLOR,[a4]:r.ONE_MINUS_DST_ALPHA,[d4]:r.CONSTANT_COLOR,[h4]:r.ONE_MINUS_CONSTANT_COLOR,[f4]:r.CONSTANT_ALPHA,[p4]:r.ONE_MINUS_CONSTANT_ALPHA};function $(ae,Je,He,ct,Ye,ze,Be,lt,Dt,Ht){if(ae===Wl){b===!0&&(je(r.BLEND),b=!1);return}if(b===!1&&(me(r.BLEND),b=!0),ae!==Qk){if(ae!==w||Ht!==O){if((S!==Qc||A!==Qc)&&(r.blendEquation(r.FUNC_ADD),S=Qc,A=Qc),Ht)switch(ae){case Qd:r.blendFuncSeparate(r.ONE,r.ONE_MINUS_SRC_ALPHA,r.ONE,r.ONE_MINUS_SRC_ALPHA);break;case Ib:r.blendFunc(r.ONE,r.ONE);break;case kb:r.blendFuncSeparate(r.ZERO,r.ONE_MINUS_SRC_COLOR,r.ZERO,r.ONE);break;case Db:r.blendFuncSeparate(r.ZERO,r.SRC_COLOR,r.ZERO,r.SRC_ALPHA);break;default:console.error("THREE.WebGLState: Invalid blending: ",ae);break}else switch(ae){case Qd:r.blendFuncSeparate(r.SRC_ALPHA,r.ONE_MINUS_SRC_ALPHA,r.ONE,r.ONE_MINUS_SRC_ALPHA);break;case Ib:r.blendFunc(r.SRC_ALPHA,r.ONE);break;case kb:r.blendFuncSeparate(r.ZERO,r.ONE_MINUS_SRC_COLOR,r.ZERO,r.ONE);break;case Db:r.blendFunc(r.ZERO,r.SRC_COLOR);break;default:console.error("THREE.WebGLState: Invalid blending: ",ae);break}C=null,T=null,k=null,j=null,D.set(0,0,0),L=0,w=ae,O=Ht}return}Ye=Ye||Je,ze=ze||He,Be=Be||ct,(Je!==S||Ye!==A)&&(r.blendEquationSeparate(ht[Je],ht[Ye]),S=Je,A=Ye),(He!==C||ct!==T||ze!==k||Be!==j)&&(r.blendFuncSeparate(Ie[He],Ie[ct],Ie[ze],Ie[Be]),C=He,T=ct,k=ze,j=Be),(lt.equals(D)===!1||Dt!==L)&&(r.blendColor(lt.r,lt.g,lt.b,Dt),D.copy(lt),L=Dt),w=ae,O=!1}function Ce(ae,Je){ae.side===ka?je(r.CULL_FACE):me(r.CULL_FACE);let He=ae.side===ci;Je&&(He=!He),ke(He),ae.blending===Qd&&ae.transparent===!1?$(Wl):$(ae.blending,ae.blendEquation,ae.blendSrc,ae.blendDst,ae.blendEquationAlpha,ae.blendSrcAlpha,ae.blendDstAlpha,ae.blendColor,ae.blendAlpha,ae.premultipliedAlpha),o.setFunc(ae.depthFunc),o.setTest(ae.depthTest),o.setMask(ae.depthWrite),i.setMask(ae.colorWrite);const ct=ae.stencilWrite;a.setTest(ct),ct&&(a.setMask(ae.stencilWriteMask),a.setFunc(ae.stencilFunc,ae.stencilRef,ae.stencilFuncMask),a.setOp(ae.stencilFail,ae.stencilZFail,ae.stencilZPass)),rt(ae.polygonOffset,ae.polygonOffsetFactor,ae.polygonOffsetUnits),ae.alphaToCoverage===!0?me(r.SAMPLE_ALPHA_TO_COVERAGE):je(r.SAMPLE_ALPHA_TO_COVERAGE)}function ke(ae){I!==ae&&(ae?r.frontFace(r.CW):r.frontFace(r.CCW),I=ae)}function Ge(ae){ae!==Xk?(me(r.CULL_FACE),ae!==B&&(ae===Pb?r.cullFace(r.BACK):ae===Yk?r.cullFace(r.FRONT):r.cullFace(r.FRONT_AND_BACK))):je(r.CULL_FACE),B=ae}function Ae(ae){ae!==W&&(ne&&r.lineWidth(ae),W=ae)}function rt(ae,Je,He){ae?(me(r.POLYGON_OFFSET_FILL),(K!==Je||ee!==He)&&(r.polygonOffset(Je,He),K=Je,ee=He)):je(r.POLYGON_OFFSET_FILL)}function qe(ae){ae?me(r.SCISSOR_TEST):je(r.SCISSOR_TEST)}function nt(ae){ae===void 0&&(ae=r.TEXTURE0+oe-1),q!==ae&&(r.activeTexture(ae),q=ae)}function jt(ae,Je,He){He===void 0&&(q===null?He=r.TEXTURE0+oe-1:He=q);let ct=Z[He];ct===void 0&&(ct={type:void 0,texture:void 0},Z[He]=ct),(ct.type!==ae||ct.texture!==Je)&&(q!==He&&(r.activeTexture(He),q=He),r.bindTexture(ae,Je||Fe[ae]),ct.type=ae,ct.texture=Je)}function Q(){const ae=Z[q];ae!==void 0&&ae.type!==void 0&&(r.bindTexture(ae.type,null),ae.type=void 0,ae.texture=void 0)}function H(){try{r.compressedTexImage2D(...arguments)}catch(ae){console.error("THREE.WebGLState:",ae)}}function ye(){try{r.compressedTexImage3D(...arguments)}catch(ae){console.error("THREE.WebGLState:",ae)}}function Re(){try{r.texSubImage2D(...arguments)}catch(ae){console.error("THREE.WebGLState:",ae)}}function Ue(){try{r.texSubImage3D(...arguments)}catch(ae){console.error("THREE.WebGLState:",ae)}}function Le(){try{r.compressedTexSubImage2D(...arguments)}catch(ae){console.error("THREE.WebGLState:",ae)}}function bt(){try{r.compressedTexSubImage3D(...arguments)}catch(ae){console.error("THREE.WebGLState:",ae)}}function st(){try{r.texStorage2D(...arguments)}catch(ae){console.error("THREE.WebGLState:",ae)}}function xt(){try{r.texStorage3D(...arguments)}catch(ae){console.error("THREE.WebGLState:",ae)}}function Et(){try{r.texImage2D(...arguments)}catch(ae){console.error("THREE.WebGLState:",ae)}}function We(){try{r.texImage3D(...arguments)}catch(ae){console.error("THREE.WebGLState:",ae)}}function ft(ae){be.equals(ae)===!1&&(r.scissor(ae.x,ae.y,ae.z,ae.w),be.copy(ae))}function Bt(ae){ue.equals(ae)===!1&&(r.viewport(ae.x,ae.y,ae.z,ae.w),ue.copy(ae))}function le(ae,Je){let He=d.get(Je);He===void 0&&(He=new WeakMap,d.set(Je,He));let ct=He.get(ae);ct===void 0&&(ct=r.getUniformBlockIndex(Je,ae.name),He.set(ae,ct))}function Se(ae,Je){const ct=d.get(Je).get(ae);c.get(Je)!==ct&&(r.uniformBlockBinding(Je,ct,ae.__bindingPointIndex),c.set(Je,ct))}function Ze(){r.disable(r.BLEND),r.disable(r.CULL_FACE),r.disable(r.DEPTH_TEST),r.disable(r.POLYGON_OFFSET_FILL),r.disable(r.SCISSOR_TEST),r.disable(r.STENCIL_TEST),r.disable(r.SAMPLE_ALPHA_TO_COVERAGE),r.blendEquation(r.FUNC_ADD),r.blendFunc(r.ONE,r.ZERO),r.blendFuncSeparate(r.ONE,r.ZERO,r.ONE,r.ZERO),r.blendColor(0,0,0,0),r.colorMask(!0,!0,!0,!0),r.clearColor(0,0,0,0),r.depthMask(!0),r.depthFunc(r.LESS),o.setReversed(!1),r.clearDepth(1),r.stencilMask(4294967295),r.stencilFunc(r.ALWAYS,0,4294967295),r.stencilOp(r.KEEP,r.KEEP,r.KEEP),r.clearStencil(0),r.cullFace(r.BACK),r.frontFace(r.CCW),r.polygonOffset(0,0),r.activeTexture(r.TEXTURE0),r.bindFramebuffer(r.FRAMEBUFFER,null),r.bindFramebuffer(r.DRAW_FRAMEBUFFER,null),r.bindFramebuffer(r.READ_FRAMEBUFFER,null),r.useProgram(null),r.lineWidth(1),r.scissor(0,0,r.canvas.width,r.canvas.height),r.viewport(0,0,r.canvas.width,r.canvas.height),f={},q=null,Z={},m={},v=new WeakMap,x=[],_=null,b=!1,w=null,S=null,C=null,T=null,A=null,k=null,j=null,D=new St(0,0,0),L=0,O=!1,I=null,B=null,W=null,K=null,ee=null,be.set(0,0,r.canvas.width,r.canvas.height),ue.set(0,0,r.canvas.width,r.canvas.height),i.reset(),o.reset(),a.reset()}return{buffers:{color:i,depth:o,stencil:a},enable:me,disable:je,bindFramebuffer:Xe,drawBuffers:$e,useProgram:dt,setBlending:$,setMaterial:Ce,setFlipSided:ke,setCullFace:Ge,setLineWidth:Ae,setPolygonOffset:rt,setScissorTest:qe,activeTexture:nt,bindTexture:jt,unbindTexture:Q,compressedTexImage2D:H,compressedTexImage3D:ye,texImage2D:Et,texImage3D:We,updateUBOMapping:le,uniformBlockBinding:Se,texStorage2D:st,texStorage3D:xt,texSubImage2D:Re,texSubImage3D:Ue,compressedTexSubImage2D:Le,compressedTexSubImage3D:bt,scissor:ft,viewport:Bt,reset:Ze}}function QJ(r,e,t,n,s,i,o){const a=e.has("WEBGL_multisampled_render_to_texture")?e.get("WEBGL_multisampled_render_to_texture"):null,c=typeof navigator>"u"?!1:/OculusBrowser/g.test(navigator.userAgent),d=new Ve,f=new WeakMap;let m;const v=new WeakMap;let x=!1;try{x=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")!==null}catch{}function _(Q,H){return x?new OffscreenCanvas(Q,H):S0("canvas")}function b(Q,H,ye){let Re=1;const Ue=jt(Q);if((Ue.width>ye||Ue.height>ye)&&(Re=ye/Math.max(Ue.width,Ue.height)),Re<1)if(typeof HTMLImageElement<"u"&&Q instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&Q instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&Q instanceof ImageBitmap||typeof VideoFrame<"u"&&Q instanceof VideoFrame){const Le=Math.floor(Re*Ue.width),bt=Math.floor(Re*Ue.height);m===void 0&&(m=_(Le,bt));const st=H?_(Le,bt):m;return st.width=Le,st.height=bt,st.getContext("2d").drawImage(Q,0,0,Le,bt),console.warn("THREE.WebGLRenderer: Texture has been resized from ("+Ue.width+"x"+Ue.height+") to ("+Le+"x"+bt+")."),st}else return"data"in Q&&console.warn("THREE.WebGLRenderer: Image in DataTexture is too big ("+Ue.width+"x"+Ue.height+")."),Q;return Q}function w(Q){return Q.generateMipmaps}function S(Q){r.generateMipmap(Q)}function C(Q){return Q.isWebGLCubeRenderTarget?r.TEXTURE_CUBE_MAP:Q.isWebGL3DRenderTarget?r.TEXTURE_3D:Q.isWebGLArrayRenderTarget||Q.isCompressedArrayTexture?r.TEXTURE_2D_ARRAY:r.TEXTURE_2D}function T(Q,H,ye,Re,Ue=!1){if(Q!==null){if(r[Q]!==void 0)return r[Q];console.warn("THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '"+Q+"'")}let Le=H;if(H===r.RED&&(ye===r.FLOAT&&(Le=r.R32F),ye===r.HALF_FLOAT&&(Le=r.R16F),ye===r.UNSIGNED_BYTE&&(Le=r.R8)),H===r.RED_INTEGER&&(ye===r.UNSIGNED_BYTE&&(Le=r.R8UI),ye===r.UNSIGNED_SHORT&&(Le=r.R16UI),ye===r.UNSIGNED_INT&&(Le=r.R32UI),ye===r.BYTE&&(Le=r.R8I),ye===r.SHORT&&(Le=r.R16I),ye===r.INT&&(Le=r.R32I)),H===r.RG&&(ye===r.FLOAT&&(Le=r.RG32F),ye===r.HALF_FLOAT&&(Le=r.RG16F),ye===r.UNSIGNED_BYTE&&(Le=r.RG8)),H===r.RG_INTEGER&&(ye===r.UNSIGNED_BYTE&&(Le=r.RG8UI),ye===r.UNSIGNED_SHORT&&(Le=r.RG16UI),ye===r.UNSIGNED_INT&&(Le=r.RG32UI),ye===r.BYTE&&(Le=r.RG8I),ye===r.SHORT&&(Le=r.RG16I),ye===r.INT&&(Le=r.RG32I)),H===r.RGB_INTEGER&&(ye===r.UNSIGNED_BYTE&&(Le=r.RGB8UI),ye===r.UNSIGNED_SHORT&&(Le=r.RGB16UI),ye===r.UNSIGNED_INT&&(Le=r.RGB32UI),ye===r.BYTE&&(Le=r.RGB8I),ye===r.SHORT&&(Le=r.RGB16I),ye===r.INT&&(Le=r.RGB32I)),H===r.RGBA_INTEGER&&(ye===r.UNSIGNED_BYTE&&(Le=r.RGBA8UI),ye===r.UNSIGNED_SHORT&&(Le=r.RGBA16UI),ye===r.UNSIGNED_INT&&(Le=r.RGBA32UI),ye===r.BYTE&&(Le=r.RGBA8I),ye===r.SHORT&&(Le=r.RGBA16I),ye===r.INT&&(Le=r.RGBA32I)),H===r.RGB&&ye===r.UNSIGNED_INT_5_9_9_9_REV&&(Le=r.RGB9_E5),H===r.RGBA){const bt=Ue?y0:kn.getTransfer(Re);ye===r.FLOAT&&(Le=r.RGBA32F),ye===r.HALF_FLOAT&&(Le=r.RGBA16F),ye===r.UNSIGNED_BYTE&&(Le=bt===Wn?r.SRGB8_ALPHA8:r.RGBA8),ye===r.UNSIGNED_SHORT_4_4_4_4&&(Le=r.RGBA4),ye===r.UNSIGNED_SHORT_5_5_5_1&&(Le=r.RGB5_A1)}return(Le===r.R16F||Le===r.R32F||Le===r.RG16F||Le===r.RG32F||Le===r.RGBA16F||Le===r.RGBA32F)&&e.get("EXT_color_buffer_float"),Le}function A(Q,H){let ye;return Q?H===null||H===tc||H===Gp?ye=r.DEPTH24_STENCIL8:H===Ii?ye=r.DEPTH32F_STENCIL8:H===Hp&&(ye=r.DEPTH24_STENCIL8,console.warn("DepthTexture: 16 bit depth attachment is not supported with stencil. Using 24-bit attachment.")):H===null||H===tc||H===Gp?ye=r.DEPTH_COMPONENT24:H===Ii?ye=r.DEPTH_COMPONENT32F:H===Hp&&(ye=r.DEPTH_COMPONENT16),ye}function k(Q,H){return w(Q)===!0||Q.isFramebufferTexture&&Q.minFilter!==Ss&&Q.minFilter!==Qr?Math.log2(Math.max(H.width,H.height))+1:Q.mipmaps!==void 0&&Q.mipmaps.length>0?Q.mipmaps.length:Q.isCompressedTexture&&Array.isArray(Q.image)?H.mipmaps.length:1}function j(Q){const H=Q.target;H.removeEventListener("dispose",j),L(H),H.isVideoTexture&&f.delete(H)}function D(Q){const H=Q.target;H.removeEventListener("dispose",D),I(H)}function L(Q){const H=n.get(Q);if(H.__webglInit===void 0)return;const ye=Q.source,Re=v.get(ye);if(Re){const Ue=Re[H.__cacheKey];Ue.usedTimes--,Ue.usedTimes===0&&O(Q),Object.keys(Re).length===0&&v.delete(ye)}n.remove(Q)}function O(Q){const H=n.get(Q);r.deleteTexture(H.__webglTexture);const ye=Q.source,Re=v.get(ye);delete Re[H.__cacheKey],o.memory.textures--}function I(Q){const H=n.get(Q);if(Q.depthTexture&&(Q.depthTexture.dispose(),n.remove(Q.depthTexture)),Q.isWebGLCubeRenderTarget)for(let Re=0;Re<6;Re++){if(Array.isArray(H.__webglFramebuffer[Re]))for(let Ue=0;Ue<H.__webglFramebuffer[Re].length;Ue++)r.deleteFramebuffer(H.__webglFramebuffer[Re][Ue]);else r.deleteFramebuffer(H.__webglFramebuffer[Re]);H.__webglDepthbuffer&&r.deleteRenderbuffer(H.__webglDepthbuffer[Re])}else{if(Array.isArray(H.__webglFramebuffer))for(let Re=0;Re<H.__webglFramebuffer.length;Re++)r.deleteFramebuffer(H.__webglFramebuffer[Re]);else r.deleteFramebuffer(H.__webglFramebuffer);if(H.__webglDepthbuffer&&r.deleteRenderbuffer(H.__webglDepthbuffer),H.__webglMultisampledFramebuffer&&r.deleteFramebuffer(H.__webglMultisampledFramebuffer),H.__webglColorRenderbuffer)for(let Re=0;Re<H.__webglColorRenderbuffer.length;Re++)H.__webglColorRenderbuffer[Re]&&r.deleteRenderbuffer(H.__webglColorRenderbuffer[Re]);H.__webglDepthRenderbuffer&&r.deleteRenderbuffer(H.__webglDepthRenderbuffer)}const ye=Q.textures;for(let Re=0,Ue=ye.length;Re<Ue;Re++){const Le=n.get(ye[Re]);Le.__webglTexture&&(r.deleteTexture(Le.__webglTexture),o.memory.textures--),n.remove(ye[Re])}n.remove(Q)}let B=0;function W(){B=0}function K(){const Q=B;return Q>=s.maxTextures&&console.warn("THREE.WebGLTextures: Trying to use "+Q+" texture units while this GPU supports only "+s.maxTextures),B+=1,Q}function ee(Q){const H=[];return H.push(Q.wrapS),H.push(Q.wrapT),H.push(Q.wrapR||0),H.push(Q.magFilter),H.push(Q.minFilter),H.push(Q.anisotropy),H.push(Q.internalFormat),H.push(Q.format),H.push(Q.type),H.push(Q.generateMipmaps),H.push(Q.premultiplyAlpha),H.push(Q.flipY),H.push(Q.unpackAlignment),H.push(Q.colorSpace),H.join()}function oe(Q,H){const ye=n.get(Q);if(Q.isVideoTexture&&qe(Q),Q.isRenderTargetTexture===!1&&Q.version>0&&ye.__version!==Q.version){const Re=Q.image;if(Re===null)console.warn("THREE.WebGLRenderer: Texture marked for update but no image data found.");else if(Re.complete===!1)console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete");else{Fe(ye,Q,H);return}}t.bindTexture(r.TEXTURE_2D,ye.__webglTexture,r.TEXTURE0+H)}function ne(Q,H){const ye=n.get(Q);if(Q.version>0&&ye.__version!==Q.version){Fe(ye,Q,H);return}t.bindTexture(r.TEXTURE_2D_ARRAY,ye.__webglTexture,r.TEXTURE0+H)}function ce(Q,H){const ye=n.get(Q);if(Q.version>0&&ye.__version!==Q.version){Fe(ye,Q,H);return}t.bindTexture(r.TEXTURE_3D,ye.__webglTexture,r.TEXTURE0+H)}function V(Q,H){const ye=n.get(Q);if(Q.version>0&&ye.__version!==Q.version){me(ye,Q,H);return}t.bindTexture(r.TEXTURE_CUBE_MAP,ye.__webglTexture,r.TEXTURE0+H)}const q={[m0]:r.REPEAT,[vo]:r.CLAMP_TO_EDGE,[g0]:r.MIRRORED_REPEAT},Z={[Ss]:r.NEAREST,[oM]:r.NEAREST_MIPMAP_NEAREST,[vp]:r.NEAREST_MIPMAP_LINEAR,[Qr]:r.LINEAR,[$g]:r.LINEAR_MIPMAP_NEAREST,[La]:r.LINEAR_MIPMAP_LINEAR},X={[N4]:r.NEVER,[O4]:r.ALWAYS,[P4]:r.LESS,[mM]:r.LEQUAL,[I4]:r.EQUAL,[L4]:r.GEQUAL,[k4]:r.GREATER,[D4]:r.NOTEQUAL};function ie(Q,H){if(H.type===Ii&&e.has("OES_texture_float_linear")===!1&&(H.magFilter===Qr||H.magFilter===$g||H.magFilter===vp||H.magFilter===La||H.minFilter===Qr||H.minFilter===$g||H.minFilter===vp||H.minFilter===La)&&console.warn("THREE.WebGLRenderer: Unable to use linear filtering with floating point textures. OES_texture_float_linear not supported on this device."),r.texParameteri(Q,r.TEXTURE_WRAP_S,q[H.wrapS]),r.texParameteri(Q,r.TEXTURE_WRAP_T,q[H.wrapT]),(Q===r.TEXTURE_3D||Q===r.TEXTURE_2D_ARRAY)&&r.texParameteri(Q,r.TEXTURE_WRAP_R,q[H.wrapR]),r.texParameteri(Q,r.TEXTURE_MAG_FILTER,Z[H.magFilter]),r.texParameteri(Q,r.TEXTURE_MIN_FILTER,Z[H.minFilter]),H.compareFunction&&(r.texParameteri(Q,r.TEXTURE_COMPARE_MODE,r.COMPARE_REF_TO_TEXTURE),r.texParameteri(Q,r.TEXTURE_COMPARE_FUNC,X[H.compareFunction])),e.has("EXT_texture_filter_anisotropic")===!0){if(H.magFilter===Ss||H.minFilter!==vp&&H.minFilter!==La||H.type===Ii&&e.has("OES_texture_float_linear")===!1)return;if(H.anisotropy>1||n.get(H).__currentAnisotropy){const ye=e.get("EXT_texture_filter_anisotropic");r.texParameterf(Q,ye.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(H.anisotropy,s.getMaxAnisotropy())),n.get(H).__currentAnisotropy=H.anisotropy}}}function be(Q,H){let ye=!1;Q.__webglInit===void 0&&(Q.__webglInit=!0,H.addEventListener("dispose",j));const Re=H.source;let Ue=v.get(Re);Ue===void 0&&(Ue={},v.set(Re,Ue));const Le=ee(H);if(Le!==Q.__cacheKey){Ue[Le]===void 0&&(Ue[Le]={texture:r.createTexture(),usedTimes:0},o.memory.textures++,ye=!0),Ue[Le].usedTimes++;const bt=Ue[Q.__cacheKey];bt!==void 0&&(Ue[Q.__cacheKey].usedTimes--,bt.usedTimes===0&&O(H)),Q.__cacheKey=Le,Q.__webglTexture=Ue[Le].texture}return ye}function ue(Q,H,ye){return Math.floor(Math.floor(Q/ye)/H)}function Ee(Q,H,ye,Re){const Le=Q.updateRanges;if(Le.length===0)t.texSubImage2D(r.TEXTURE_2D,0,0,0,H.width,H.height,ye,Re,H.data);else{Le.sort((We,ft)=>We.start-ft.start);let bt=0;for(let We=1;We<Le.length;We++){const ft=Le[bt],Bt=Le[We],le=ft.start+ft.count,Se=ue(Bt.start,H.width,4),Ze=ue(ft.start,H.width,4);Bt.start<=le+1&&Se===Ze&&ue(Bt.start+Bt.count-1,H.width,4)===Se?ft.count=Math.max(ft.count,Bt.start+Bt.count-ft.start):(++bt,Le[bt]=Bt)}Le.length=bt+1;const st=r.getParameter(r.UNPACK_ROW_LENGTH),xt=r.getParameter(r.UNPACK_SKIP_PIXELS),Et=r.getParameter(r.UNPACK_SKIP_ROWS);r.pixelStorei(r.UNPACK_ROW_LENGTH,H.width);for(let We=0,ft=Le.length;We<ft;We++){const Bt=Le[We],le=Math.floor(Bt.start/4),Se=Math.ceil(Bt.count/4),Ze=le%H.width,ae=Math.floor(le/H.width),Je=Se,He=1;r.pixelStorei(r.UNPACK_SKIP_PIXELS,Ze),r.pixelStorei(r.UNPACK_SKIP_ROWS,ae),t.texSubImage2D(r.TEXTURE_2D,0,Ze,ae,Je,He,ye,Re,H.data)}Q.clearUpdateRanges(),r.pixelStorei(r.UNPACK_ROW_LENGTH,st),r.pixelStorei(r.UNPACK_SKIP_PIXELS,xt),r.pixelStorei(r.UNPACK_SKIP_ROWS,Et)}}function Fe(Q,H,ye){let Re=r.TEXTURE_2D;(H.isDataArrayTexture||H.isCompressedArrayTexture)&&(Re=r.TEXTURE_2D_ARRAY),H.isData3DTexture&&(Re=r.TEXTURE_3D);const Ue=be(Q,H),Le=H.source;t.bindTexture(Re,Q.__webglTexture,r.TEXTURE0+ye);const bt=n.get(Le);if(Le.version!==bt.__version||Ue===!0){t.activeTexture(r.TEXTURE0+ye);const st=kn.getPrimaries(kn.workingColorSpace),xt=H.colorSpace===Vl?null:kn.getPrimaries(H.colorSpace),Et=H.colorSpace===Vl||st===xt?r.NONE:r.BROWSER_DEFAULT_WEBGL;r.pixelStorei(r.UNPACK_FLIP_Y_WEBGL,H.flipY),r.pixelStorei(r.UNPACK_PREMULTIPLY_ALPHA_WEBGL,H.premultiplyAlpha),r.pixelStorei(r.UNPACK_ALIGNMENT,H.unpackAlignment),r.pixelStorei(r.UNPACK_COLORSPACE_CONVERSION_WEBGL,Et);let We=b(H.image,!1,s.maxTextureSize);We=nt(H,We);const ft=i.convert(H.format,H.colorSpace),Bt=i.convert(H.type);let le=T(H.internalFormat,ft,Bt,H.colorSpace,H.isVideoTexture);ie(Re,H);let Se;const Ze=H.mipmaps,ae=H.isVideoTexture!==!0,Je=bt.__version===void 0||Ue===!0,He=Le.dataReady,ct=k(H,We);if(H.isDepthTexture)le=A(H.format===$p,H.type),Je&&(ae?t.texStorage2D(r.TEXTURE_2D,1,le,We.width,We.height):t.texImage2D(r.TEXTURE_2D,0,le,We.width,We.height,0,ft,Bt,null));else if(H.isDataTexture)if(Ze.length>0){ae&&Je&&t.texStorage2D(r.TEXTURE_2D,ct,le,Ze[0].width,Ze[0].height);for(let Ye=0,ze=Ze.length;Ye<ze;Ye++)Se=Ze[Ye],ae?He&&t.texSubImage2D(r.TEXTURE_2D,Ye,0,0,Se.width,Se.height,ft,Bt,Se.data):t.texImage2D(r.TEXTURE_2D,Ye,le,Se.width,Se.height,0,ft,Bt,Se.data);H.generateMipmaps=!1}else ae?(Je&&t.texStorage2D(r.TEXTURE_2D,ct,le,We.width,We.height),He&&Ee(H,We,ft,Bt)):t.texImage2D(r.TEXTURE_2D,0,le,We.width,We.height,0,ft,Bt,We.data);else if(H.isCompressedTexture)if(H.isCompressedArrayTexture){ae&&Je&&t.texStorage3D(r.TEXTURE_2D_ARRAY,ct,le,Ze[0].width,Ze[0].height,We.depth);for(let Ye=0,ze=Ze.length;Ye<ze;Ye++)if(Se=Ze[Ye],H.format!==Vs)if(ft!==null)if(ae){if(He)if(H.layerUpdates.size>0){const Be=Wb(Se.width,Se.height,H.format,H.type);for(const lt of H.layerUpdates){const Dt=Se.data.subarray(lt*Be/Se.data.BYTES_PER_ELEMENT,(lt+1)*Be/Se.data.BYTES_PER_ELEMENT);t.compressedTexSubImage3D(r.TEXTURE_2D_ARRAY,Ye,0,0,lt,Se.width,Se.height,1,ft,Dt)}H.clearLayerUpdates()}else t.compressedTexSubImage3D(r.TEXTURE_2D_ARRAY,Ye,0,0,0,Se.width,Se.height,We.depth,ft,Se.data)}else t.compressedTexImage3D(r.TEXTURE_2D_ARRAY,Ye,le,Se.width,Se.height,We.depth,0,Se.data,0,0);else console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()");else ae?He&&t.texSubImage3D(r.TEXTURE_2D_ARRAY,Ye,0,0,0,Se.width,Se.height,We.depth,ft,Bt,Se.data):t.texImage3D(r.TEXTURE_2D_ARRAY,Ye,le,Se.width,Se.height,We.depth,0,ft,Bt,Se.data)}else{ae&&Je&&t.texStorage2D(r.TEXTURE_2D,ct,le,Ze[0].width,Ze[0].height);for(let Ye=0,ze=Ze.length;Ye<ze;Ye++)Se=Ze[Ye],H.format!==Vs?ft!==null?ae?He&&t.compressedTexSubImage2D(r.TEXTURE_2D,Ye,0,0,Se.width,Se.height,ft,Se.data):t.compressedTexImage2D(r.TEXTURE_2D,Ye,le,Se.width,Se.height,0,Se.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):ae?He&&t.texSubImage2D(r.TEXTURE_2D,Ye,0,0,Se.width,Se.height,ft,Bt,Se.data):t.texImage2D(r.TEXTURE_2D,Ye,le,Se.width,Se.height,0,ft,Bt,Se.data)}else if(H.isDataArrayTexture)if(ae){if(Je&&t.texStorage3D(r.TEXTURE_2D_ARRAY,ct,le,We.width,We.height,We.depth),He)if(H.layerUpdates.size>0){const Ye=Wb(We.width,We.height,H.format,H.type);for(const ze of H.layerUpdates){const Be=We.data.subarray(ze*Ye/We.data.BYTES_PER_ELEMENT,(ze+1)*Ye/We.data.BYTES_PER_ELEMENT);t.texSubImage3D(r.TEXTURE_2D_ARRAY,0,0,0,ze,We.width,We.height,1,ft,Bt,Be)}H.clearLayerUpdates()}else t.texSubImage3D(r.TEXTURE_2D_ARRAY,0,0,0,0,We.width,We.height,We.depth,ft,Bt,We.data)}else t.texImage3D(r.TEXTURE_2D_ARRAY,0,le,We.width,We.height,We.depth,0,ft,Bt,We.data);else if(H.isData3DTexture)ae?(Je&&t.texStorage3D(r.TEXTURE_3D,ct,le,We.width,We.height,We.depth),He&&t.texSubImage3D(r.TEXTURE_3D,0,0,0,0,We.width,We.height,We.depth,ft,Bt,We.data)):t.texImage3D(r.TEXTURE_3D,0,le,We.width,We.height,We.depth,0,ft,Bt,We.data);else if(H.isFramebufferTexture){if(Je)if(ae)t.texStorage2D(r.TEXTURE_2D,ct,le,We.width,We.height);else{let Ye=We.width,ze=We.height;for(let Be=0;Be<ct;Be++)t.texImage2D(r.TEXTURE_2D,Be,le,Ye,ze,0,ft,Bt,null),Ye>>=1,ze>>=1}}else if(Ze.length>0){if(ae&&Je){const Ye=jt(Ze[0]);t.texStorage2D(r.TEXTURE_2D,ct,le,Ye.width,Ye.height)}for(let Ye=0,ze=Ze.length;Ye<ze;Ye++)Se=Ze[Ye],ae?He&&t.texSubImage2D(r.TEXTURE_2D,Ye,0,0,ft,Bt,Se):t.texImage2D(r.TEXTURE_2D,Ye,le,ft,Bt,Se);H.generateMipmaps=!1}else if(ae){if(Je){const Ye=jt(We);t.texStorage2D(r.TEXTURE_2D,ct,le,Ye.width,Ye.height)}He&&t.texSubImage2D(r.TEXTURE_2D,0,0,0,ft,Bt,We)}else t.texImage2D(r.TEXTURE_2D,0,le,ft,Bt,We);w(H)&&S(Re),bt.__version=Le.version,H.onUpdate&&H.onUpdate(H)}Q.__version=H.version}function me(Q,H,ye){if(H.image.length!==6)return;const Re=be(Q,H),Ue=H.source;t.bindTexture(r.TEXTURE_CUBE_MAP,Q.__webglTexture,r.TEXTURE0+ye);const Le=n.get(Ue);if(Ue.version!==Le.__version||Re===!0){t.activeTexture(r.TEXTURE0+ye);const bt=kn.getPrimaries(kn.workingColorSpace),st=H.colorSpace===Vl?null:kn.getPrimaries(H.colorSpace),xt=H.colorSpace===Vl||bt===st?r.NONE:r.BROWSER_DEFAULT_WEBGL;r.pixelStorei(r.UNPACK_FLIP_Y_WEBGL,H.flipY),r.pixelStorei(r.UNPACK_PREMULTIPLY_ALPHA_WEBGL,H.premultiplyAlpha),r.pixelStorei(r.UNPACK_ALIGNMENT,H.unpackAlignment),r.pixelStorei(r.UNPACK_COLORSPACE_CONVERSION_WEBGL,xt);const Et=H.isCompressedTexture||H.image[0].isCompressedTexture,We=H.image[0]&&H.image[0].isDataTexture,ft=[];for(let ze=0;ze<6;ze++)!Et&&!We?ft[ze]=b(H.image[ze],!0,s.maxCubemapSize):ft[ze]=We?H.image[ze].image:H.image[ze],ft[ze]=nt(H,ft[ze]);const Bt=ft[0],le=i.convert(H.format,H.colorSpace),Se=i.convert(H.type),Ze=T(H.internalFormat,le,Se,H.colorSpace),ae=H.isVideoTexture!==!0,Je=Le.__version===void 0||Re===!0,He=Ue.dataReady;let ct=k(H,Bt);ie(r.TEXTURE_CUBE_MAP,H);let Ye;if(Et){ae&&Je&&t.texStorage2D(r.TEXTURE_CUBE_MAP,ct,Ze,Bt.width,Bt.height);for(let ze=0;ze<6;ze++){Ye=ft[ze].mipmaps;for(let Be=0;Be<Ye.length;Be++){const lt=Ye[Be];H.format!==Vs?le!==null?ae?He&&t.compressedTexSubImage2D(r.TEXTURE_CUBE_MAP_POSITIVE_X+ze,Be,0,0,lt.width,lt.height,le,lt.data):t.compressedTexImage2D(r.TEXTURE_CUBE_MAP_POSITIVE_X+ze,Be,Ze,lt.width,lt.height,0,lt.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):ae?He&&t.texSubImage2D(r.TEXTURE_CUBE_MAP_POSITIVE_X+ze,Be,0,0,lt.width,lt.height,le,Se,lt.data):t.texImage2D(r.TEXTURE_CUBE_MAP_POSITIVE_X+ze,Be,Ze,lt.width,lt.height,0,le,Se,lt.data)}}}else{if(Ye=H.mipmaps,ae&&Je){Ye.length>0&&ct++;const ze=jt(ft[0]);t.texStorage2D(r.TEXTURE_CUBE_MAP,ct,Ze,ze.width,ze.height)}for(let ze=0;ze<6;ze++)if(We){ae?He&&t.texSubImage2D(r.TEXTURE_CUBE_MAP_POSITIVE_X+ze,0,0,0,ft[ze].width,ft[ze].height,le,Se,ft[ze].data):t.texImage2D(r.TEXTURE_CUBE_MAP_POSITIVE_X+ze,0,Ze,ft[ze].width,ft[ze].height,0,le,Se,ft[ze].data);for(let Be=0;Be<Ye.length;Be++){const Dt=Ye[Be].image[ze].image;ae?He&&t.texSubImage2D(r.TEXTURE_CUBE_MAP_POSITIVE_X+ze,Be+1,0,0,Dt.width,Dt.height,le,Se,Dt.data):t.texImage2D(r.TEXTURE_CUBE_MAP_POSITIVE_X+ze,Be+1,Ze,Dt.width,Dt.height,0,le,Se,Dt.data)}}else{ae?He&&t.texSubImage2D(r.TEXTURE_CUBE_MAP_POSITIVE_X+ze,0,0,0,le,Se,ft[ze]):t.texImage2D(r.TEXTURE_CUBE_MAP_POSITIVE_X+ze,0,Ze,le,Se,ft[ze]);for(let Be=0;Be<Ye.length;Be++){const lt=Ye[Be];ae?He&&t.texSubImage2D(r.TEXTURE_CUBE_MAP_POSITIVE_X+ze,Be+1,0,0,le,Se,lt.image[ze]):t.texImage2D(r.TEXTURE_CUBE_MAP_POSITIVE_X+ze,Be+1,Ze,le,Se,lt.image[ze])}}}w(H)&&S(r.TEXTURE_CUBE_MAP),Le.__version=Ue.version,H.onUpdate&&H.onUpdate(H)}Q.__version=H.version}function je(Q,H,ye,Re,Ue,Le){const bt=i.convert(ye.format,ye.colorSpace),st=i.convert(ye.type),xt=T(ye.internalFormat,bt,st,ye.colorSpace),Et=n.get(H),We=n.get(ye);if(We.__renderTarget=H,!Et.__hasExternalTextures){const ft=Math.max(1,H.width>>Le),Bt=Math.max(1,H.height>>Le);Ue===r.TEXTURE_3D||Ue===r.TEXTURE_2D_ARRAY?t.texImage3D(Ue,Le,xt,ft,Bt,H.depth,0,bt,st,null):t.texImage2D(Ue,Le,xt,ft,Bt,0,bt,st,null)}t.bindFramebuffer(r.FRAMEBUFFER,Q),rt(H)?a.framebufferTexture2DMultisampleEXT(r.FRAMEBUFFER,Re,Ue,We.__webglTexture,0,Ae(H)):(Ue===r.TEXTURE_2D||Ue>=r.TEXTURE_CUBE_MAP_POSITIVE_X&&Ue<=r.TEXTURE_CUBE_MAP_NEGATIVE_Z)&&r.framebufferTexture2D(r.FRAMEBUFFER,Re,Ue,We.__webglTexture,Le),t.bindFramebuffer(r.FRAMEBUFFER,null)}function Xe(Q,H,ye){if(r.bindRenderbuffer(r.RENDERBUFFER,Q),H.depthBuffer){const Re=H.depthTexture,Ue=Re&&Re.isDepthTexture?Re.type:null,Le=A(H.stencilBuffer,Ue),bt=H.stencilBuffer?r.DEPTH_STENCIL_ATTACHMENT:r.DEPTH_ATTACHMENT,st=Ae(H);rt(H)?a.renderbufferStorageMultisampleEXT(r.RENDERBUFFER,st,Le,H.width,H.height):ye?r.renderbufferStorageMultisample(r.RENDERBUFFER,st,Le,H.width,H.height):r.renderbufferStorage(r.RENDERBUFFER,Le,H.width,H.height),r.framebufferRenderbuffer(r.FRAMEBUFFER,bt,r.RENDERBUFFER,Q)}else{const Re=H.textures;for(let Ue=0;Ue<Re.length;Ue++){const Le=Re[Ue],bt=i.convert(Le.format,Le.colorSpace),st=i.convert(Le.type),xt=T(Le.internalFormat,bt,st,Le.colorSpace),Et=Ae(H);ye&&rt(H)===!1?r.renderbufferStorageMultisample(r.RENDERBUFFER,Et,xt,H.width,H.height):rt(H)?a.renderbufferStorageMultisampleEXT(r.RENDERBUFFER,Et,xt,H.width,H.height):r.renderbufferStorage(r.RENDERBUFFER,xt,H.width,H.height)}}r.bindRenderbuffer(r.RENDERBUFFER,null)}function $e(Q,H){if(H&&H.isWebGLCubeRenderTarget)throw new Error("Depth Texture with cube render targets is not supported");if(t.bindFramebuffer(r.FRAMEBUFFER,Q),!(H.depthTexture&&H.depthTexture.isDepthTexture))throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");const Re=n.get(H.depthTexture);Re.__renderTarget=H,(!Re.__webglTexture||H.depthTexture.image.width!==H.width||H.depthTexture.image.height!==H.height)&&(H.depthTexture.image.width=H.width,H.depthTexture.image.height=H.height,H.depthTexture.needsUpdate=!0),oe(H.depthTexture,0);const Ue=Re.__webglTexture,Le=Ae(H);if(H.depthTexture.format===Wp)rt(H)?a.framebufferTexture2DMultisampleEXT(r.FRAMEBUFFER,r.DEPTH_ATTACHMENT,r.TEXTURE_2D,Ue,0,Le):r.framebufferTexture2D(r.FRAMEBUFFER,r.DEPTH_ATTACHMENT,r.TEXTURE_2D,Ue,0);else if(H.depthTexture.format===$p)rt(H)?a.framebufferTexture2DMultisampleEXT(r.FRAMEBUFFER,r.DEPTH_STENCIL_ATTACHMENT,r.TEXTURE_2D,Ue,0,Le):r.framebufferTexture2D(r.FRAMEBUFFER,r.DEPTH_STENCIL_ATTACHMENT,r.TEXTURE_2D,Ue,0);else throw new Error("Unknown depthTexture format")}function dt(Q){const H=n.get(Q),ye=Q.isWebGLCubeRenderTarget===!0;if(H.__boundDepthTexture!==Q.depthTexture){const Re=Q.depthTexture;if(H.__depthDisposeCallback&&H.__depthDisposeCallback(),Re){const Ue=()=>{delete H.__boundDepthTexture,delete H.__depthDisposeCallback,Re.removeEventListener("dispose",Ue)};Re.addEventListener("dispose",Ue),H.__depthDisposeCallback=Ue}H.__boundDepthTexture=Re}if(Q.depthTexture&&!H.__autoAllocateDepthBuffer){if(ye)throw new Error("target.depthTexture not supported in Cube render targets");const Re=Q.texture.mipmaps;Re&&Re.length>0?$e(H.__webglFramebuffer[0],Q):$e(H.__webglFramebuffer,Q)}else if(ye){H.__webglDepthbuffer=[];for(let Re=0;Re<6;Re++)if(t.bindFramebuffer(r.FRAMEBUFFER,H.__webglFramebuffer[Re]),H.__webglDepthbuffer[Re]===void 0)H.__webglDepthbuffer[Re]=r.createRenderbuffer(),Xe(H.__webglDepthbuffer[Re],Q,!1);else{const Ue=Q.stencilBuffer?r.DEPTH_STENCIL_ATTACHMENT:r.DEPTH_ATTACHMENT,Le=H.__webglDepthbuffer[Re];r.bindRenderbuffer(r.RENDERBUFFER,Le),r.framebufferRenderbuffer(r.FRAMEBUFFER,Ue,r.RENDERBUFFER,Le)}}else{const Re=Q.texture.mipmaps;if(Re&&Re.length>0?t.bindFramebuffer(r.FRAMEBUFFER,H.__webglFramebuffer[0]):t.bindFramebuffer(r.FRAMEBUFFER,H.__webglFramebuffer),H.__webglDepthbuffer===void 0)H.__webglDepthbuffer=r.createRenderbuffer(),Xe(H.__webglDepthbuffer,Q,!1);else{const Ue=Q.stencilBuffer?r.DEPTH_STENCIL_ATTACHMENT:r.DEPTH_ATTACHMENT,Le=H.__webglDepthbuffer;r.bindRenderbuffer(r.RENDERBUFFER,Le),r.framebufferRenderbuffer(r.FRAMEBUFFER,Ue,r.RENDERBUFFER,Le)}}t.bindFramebuffer(r.FRAMEBUFFER,null)}function ht(Q,H,ye){const Re=n.get(Q);H!==void 0&&je(Re.__webglFramebuffer,Q,Q.texture,r.COLOR_ATTACHMENT0,r.TEXTURE_2D,0),ye!==void 0&&dt(Q)}function Ie(Q){const H=Q.texture,ye=n.get(Q),Re=n.get(H);Q.addEventListener("dispose",D);const Ue=Q.textures,Le=Q.isWebGLCubeRenderTarget===!0,bt=Ue.length>1;if(bt||(Re.__webglTexture===void 0&&(Re.__webglTexture=r.createTexture()),Re.__version=H.version,o.memory.textures++),Le){ye.__webglFramebuffer=[];for(let st=0;st<6;st++)if(H.mipmaps&&H.mipmaps.length>0){ye.__webglFramebuffer[st]=[];for(let xt=0;xt<H.mipmaps.length;xt++)ye.__webglFramebuffer[st][xt]=r.createFramebuffer()}else ye.__webglFramebuffer[st]=r.createFramebuffer()}else{if(H.mipmaps&&H.mipmaps.length>0){ye.__webglFramebuffer=[];for(let st=0;st<H.mipmaps.length;st++)ye.__webglFramebuffer[st]=r.createFramebuffer()}else ye.__webglFramebuffer=r.createFramebuffer();if(bt)for(let st=0,xt=Ue.length;st<xt;st++){const Et=n.get(Ue[st]);Et.__webglTexture===void 0&&(Et.__webglTexture=r.createTexture(),o.memory.textures++)}if(Q.samples>0&&rt(Q)===!1){ye.__webglMultisampledFramebuffer=r.createFramebuffer(),ye.__webglColorRenderbuffer=[],t.bindFramebuffer(r.FRAMEBUFFER,ye.__webglMultisampledFramebuffer);for(let st=0;st<Ue.length;st++){const xt=Ue[st];ye.__webglColorRenderbuffer[st]=r.createRenderbuffer(),r.bindRenderbuffer(r.RENDERBUFFER,ye.__webglColorRenderbuffer[st]);const Et=i.convert(xt.format,xt.colorSpace),We=i.convert(xt.type),ft=T(xt.internalFormat,Et,We,xt.colorSpace,Q.isXRRenderTarget===!0),Bt=Ae(Q);r.renderbufferStorageMultisample(r.RENDERBUFFER,Bt,ft,Q.width,Q.height),r.framebufferRenderbuffer(r.FRAMEBUFFER,r.COLOR_ATTACHMENT0+st,r.RENDERBUFFER,ye.__webglColorRenderbuffer[st])}r.bindRenderbuffer(r.RENDERBUFFER,null),Q.depthBuffer&&(ye.__webglDepthRenderbuffer=r.createRenderbuffer(),Xe(ye.__webglDepthRenderbuffer,Q,!0)),t.bindFramebuffer(r.FRAMEBUFFER,null)}}if(Le){t.bindTexture(r.TEXTURE_CUBE_MAP,Re.__webglTexture),ie(r.TEXTURE_CUBE_MAP,H);for(let st=0;st<6;st++)if(H.mipmaps&&H.mipmaps.length>0)for(let xt=0;xt<H.mipmaps.length;xt++)je(ye.__webglFramebuffer[st][xt],Q,H,r.COLOR_ATTACHMENT0,r.TEXTURE_CUBE_MAP_POSITIVE_X+st,xt);else je(ye.__webglFramebuffer[st],Q,H,r.COLOR_ATTACHMENT0,r.TEXTURE_CUBE_MAP_POSITIVE_X+st,0);w(H)&&S(r.TEXTURE_CUBE_MAP),t.unbindTexture()}else if(bt){for(let st=0,xt=Ue.length;st<xt;st++){const Et=Ue[st],We=n.get(Et);t.bindTexture(r.TEXTURE_2D,We.__webglTexture),ie(r.TEXTURE_2D,Et),je(ye.__webglFramebuffer,Q,Et,r.COLOR_ATTACHMENT0+st,r.TEXTURE_2D,0),w(Et)&&S(r.TEXTURE_2D)}t.unbindTexture()}else{let st=r.TEXTURE_2D;if((Q.isWebGL3DRenderTarget||Q.isWebGLArrayRenderTarget)&&(st=Q.isWebGL3DRenderTarget?r.TEXTURE_3D:r.TEXTURE_2D_ARRAY),t.bindTexture(st,Re.__webglTexture),ie(st,H),H.mipmaps&&H.mipmaps.length>0)for(let xt=0;xt<H.mipmaps.length;xt++)je(ye.__webglFramebuffer[xt],Q,H,r.COLOR_ATTACHMENT0,st,xt);else je(ye.__webglFramebuffer,Q,H,r.COLOR_ATTACHMENT0,st,0);w(H)&&S(st),t.unbindTexture()}Q.depthBuffer&&dt(Q)}function $(Q){const H=Q.textures;for(let ye=0,Re=H.length;ye<Re;ye++){const Ue=H[ye];if(w(Ue)){const Le=C(Q),bt=n.get(Ue).__webglTexture;t.bindTexture(Le,bt),S(Le),t.unbindTexture()}}}const Ce=[],ke=[];function Ge(Q){if(Q.samples>0){if(rt(Q)===!1){const H=Q.textures,ye=Q.width,Re=Q.height;let Ue=r.COLOR_BUFFER_BIT;const Le=Q.stencilBuffer?r.DEPTH_STENCIL_ATTACHMENT:r.DEPTH_ATTACHMENT,bt=n.get(Q),st=H.length>1;if(st)for(let Et=0;Et<H.length;Et++)t.bindFramebuffer(r.FRAMEBUFFER,bt.__webglMultisampledFramebuffer),r.framebufferRenderbuffer(r.FRAMEBUFFER,r.COLOR_ATTACHMENT0+Et,r.RENDERBUFFER,null),t.bindFramebuffer(r.FRAMEBUFFER,bt.__webglFramebuffer),r.framebufferTexture2D(r.DRAW_FRAMEBUFFER,r.COLOR_ATTACHMENT0+Et,r.TEXTURE_2D,null,0);t.bindFramebuffer(r.READ_FRAMEBUFFER,bt.__webglMultisampledFramebuffer);const xt=Q.texture.mipmaps;xt&&xt.length>0?t.bindFramebuffer(r.DRAW_FRAMEBUFFER,bt.__webglFramebuffer[0]):t.bindFramebuffer(r.DRAW_FRAMEBUFFER,bt.__webglFramebuffer);for(let Et=0;Et<H.length;Et++){if(Q.resolveDepthBuffer&&(Q.depthBuffer&&(Ue|=r.DEPTH_BUFFER_BIT),Q.stencilBuffer&&Q.resolveStencilBuffer&&(Ue|=r.STENCIL_BUFFER_BIT)),st){r.framebufferRenderbuffer(r.READ_FRAMEBUFFER,r.COLOR_ATTACHMENT0,r.RENDERBUFFER,bt.__webglColorRenderbuffer[Et]);const We=n.get(H[Et]).__webglTexture;r.framebufferTexture2D(r.DRAW_FRAMEBUFFER,r.COLOR_ATTACHMENT0,r.TEXTURE_2D,We,0)}r.blitFramebuffer(0,0,ye,Re,0,0,ye,Re,Ue,r.NEAREST),c===!0&&(Ce.length=0,ke.length=0,Ce.push(r.COLOR_ATTACHMENT0+Et),Q.depthBuffer&&Q.resolveDepthBuffer===!1&&(Ce.push(Le),ke.push(Le),r.invalidateFramebuffer(r.DRAW_FRAMEBUFFER,ke)),r.invalidateFramebuffer(r.READ_FRAMEBUFFER,Ce))}if(t.bindFramebuffer(r.READ_FRAMEBUFFER,null),t.bindFramebuffer(r.DRAW_FRAMEBUFFER,null),st)for(let Et=0;Et<H.length;Et++){t.bindFramebuffer(r.FRAMEBUFFER,bt.__webglMultisampledFramebuffer),r.framebufferRenderbuffer(r.FRAMEBUFFER,r.COLOR_ATTACHMENT0+Et,r.RENDERBUFFER,bt.__webglColorRenderbuffer[Et]);const We=n.get(H[Et]).__webglTexture;t.bindFramebuffer(r.FRAMEBUFFER,bt.__webglFramebuffer),r.framebufferTexture2D(r.DRAW_FRAMEBUFFER,r.COLOR_ATTACHMENT0+Et,r.TEXTURE_2D,We,0)}t.bindFramebuffer(r.DRAW_FRAMEBUFFER,bt.__webglMultisampledFramebuffer)}else if(Q.depthBuffer&&Q.resolveDepthBuffer===!1&&c){const H=Q.stencilBuffer?r.DEPTH_STENCIL_ATTACHMENT:r.DEPTH_ATTACHMENT;r.invalidateFramebuffer(r.DRAW_FRAMEBUFFER,[H])}}}function Ae(Q){return Math.min(s.maxSamples,Q.samples)}function rt(Q){const H=n.get(Q);return Q.samples>0&&e.has("WEBGL_multisampled_render_to_texture")===!0&&H.__useRenderToTexture!==!1}function qe(Q){const H=o.render.frame;f.get(Q)!==H&&(f.set(Q,H),Q.update())}function nt(Q,H){const ye=Q.colorSpace,Re=Q.format,Ue=Q.type;return Q.isCompressedTexture===!0||Q.isVideoTexture===!0||ye!==hh&&ye!==Vl&&(kn.getTransfer(ye)===Wn?(Re!==Vs||Ue!==_o)&&console.warn("THREE.WebGLTextures: sRGB encoded textures have to use RGBAFormat and UnsignedByteType."):console.error("THREE.WebGLTextures: Unsupported texture color space:",ye)),H}function jt(Q){return typeof HTMLImageElement<"u"&&Q instanceof HTMLImageElement?(d.width=Q.naturalWidth||Q.width,d.height=Q.naturalHeight||Q.height):typeof VideoFrame<"u"&&Q instanceof VideoFrame?(d.width=Q.displayWidth,d.height=Q.displayHeight):(d.width=Q.width,d.height=Q.height),d}this.allocateTextureUnit=K,this.resetTextureUnits=W,this.setTexture2D=oe,this.setTexture2DArray=ne,this.setTexture3D=ce,this.setTextureCube=V,this.rebindTextures=ht,this.setupRenderTarget=Ie,this.updateRenderTargetMipmap=$,this.updateMultisampleRenderTarget=Ge,this.setupDepthRenderbuffer=dt,this.setupFrameBufferTexture=je,this.useMultisampledRTT=rt}function qD(r,e){function t(n,s=Vl){let i;const o=kn.getTransfer(s);if(n===_o)return r.UNSIGNED_BYTE;if(n===tw)return r.UNSIGNED_SHORT_4_4_4_4;if(n===nw)return r.UNSIGNED_SHORT_5_5_5_1;if(n===cM)return r.UNSIGNED_INT_5_9_9_9_REV;if(n===aM)return r.BYTE;if(n===lM)return r.SHORT;if(n===Hp)return r.UNSIGNED_SHORT;if(n===ew)return r.INT;if(n===tc)return r.UNSIGNED_INT;if(n===Ii)return r.FLOAT;if(n===fm)return r.HALF_FLOAT;if(n===uM)return r.ALPHA;if(n===dM)return r.RGB;if(n===Vs)return r.RGBA;if(n===Wp)return r.DEPTH_COMPONENT;if(n===$p)return r.DEPTH_STENCIL;if(n===rw)return r.RED;if(n===$0)return r.RED_INTEGER;if(n===hM)return r.RG;if(n===sw)return r.RG_INTEGER;if(n===iw)return r.RGBA_INTEGER;if(n===qg||n===Xg||n===Yg||n===Kg)if(o===Wn)if(i=e.get("WEBGL_compressed_texture_s3tc_srgb"),i!==null){if(n===qg)return i.COMPRESSED_SRGB_S3TC_DXT1_EXT;if(n===Xg)return i.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT;if(n===Yg)return i.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT;if(n===Kg)return i.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT}else return null;else if(i=e.get("WEBGL_compressed_texture_s3tc"),i!==null){if(n===qg)return i.COMPRESSED_RGB_S3TC_DXT1_EXT;if(n===Xg)return i.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(n===Yg)return i.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(n===Kg)return i.COMPRESSED_RGBA_S3TC_DXT5_EXT}else return null;if(n===zy||n===Vy||n===Hy||n===Gy)if(i=e.get("WEBGL_compressed_texture_pvrtc"),i!==null){if(n===zy)return i.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(n===Vy)return i.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(n===Hy)return i.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(n===Gy)return i.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}else return null;if(n===Wy||n===$y||n===qy)if(i=e.get("WEBGL_compressed_texture_etc"),i!==null){if(n===Wy||n===$y)return o===Wn?i.COMPRESSED_SRGB8_ETC2:i.COMPRESSED_RGB8_ETC2;if(n===qy)return o===Wn?i.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:i.COMPRESSED_RGBA8_ETC2_EAC}else return null;if(n===Xy||n===Yy||n===Ky||n===Qy||n===Jy||n===Zy||n===e_||n===t_||n===n_||n===r_||n===s_||n===i_||n===o_||n===a_)if(i=e.get("WEBGL_compressed_texture_astc"),i!==null){if(n===Xy)return o===Wn?i.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR:i.COMPRESSED_RGBA_ASTC_4x4_KHR;if(n===Yy)return o===Wn?i.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR:i.COMPRESSED_RGBA_ASTC_5x4_KHR;if(n===Ky)return o===Wn?i.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR:i.COMPRESSED_RGBA_ASTC_5x5_KHR;if(n===Qy)return o===Wn?i.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR:i.COMPRESSED_RGBA_ASTC_6x5_KHR;if(n===Jy)return o===Wn?i.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR:i.COMPRESSED_RGBA_ASTC_6x6_KHR;if(n===Zy)return o===Wn?i.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR:i.COMPRESSED_RGBA_ASTC_8x5_KHR;if(n===e_)return o===Wn?i.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR:i.COMPRESSED_RGBA_ASTC_8x6_KHR;if(n===t_)return o===Wn?i.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR:i.COMPRESSED_RGBA_ASTC_8x8_KHR;if(n===n_)return o===Wn?i.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR:i.COMPRESSED_RGBA_ASTC_10x5_KHR;if(n===r_)return o===Wn?i.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR:i.COMPRESSED_RGBA_ASTC_10x6_KHR;if(n===s_)return o===Wn?i.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR:i.COMPRESSED_RGBA_ASTC_10x8_KHR;if(n===i_)return o===Wn?i.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR:i.COMPRESSED_RGBA_ASTC_10x10_KHR;if(n===o_)return o===Wn?i.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR:i.COMPRESSED_RGBA_ASTC_12x10_KHR;if(n===a_)return o===Wn?i.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR:i.COMPRESSED_RGBA_ASTC_12x12_KHR}else return null;if(n===Qg||n===l_||n===c_)if(i=e.get("EXT_texture_compression_bptc"),i!==null){if(n===Qg)return o===Wn?i.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT:i.COMPRESSED_RGBA_BPTC_UNORM_EXT;if(n===l_)return i.COMPRESSED_RGB_BPTC_SIGNED_FLOAT_EXT;if(n===c_)return i.COMPRESSED_RGB_BPTC_UNSIGNED_FLOAT_EXT}else return null;if(n===fM||n===u_||n===d_||n===h_)if(i=e.get("EXT_texture_compression_rgtc"),i!==null){if(n===Qg)return i.COMPRESSED_RED_RGTC1_EXT;if(n===u_)return i.COMPRESSED_SIGNED_RED_RGTC1_EXT;if(n===d_)return i.COMPRESSED_RED_GREEN_RGTC2_EXT;if(n===h_)return i.COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT}else return null;return n===Gp?r.UNSIGNED_INT_24_8:r[n]!==void 0?r[n]:null}return{convert:t}}const JJ=`
void main() {

	gl_Position = vec4( position, 1.0 );

}`,ZJ=`
uniform sampler2DArray depthColor;
uniform float depthWidth;
uniform float depthHeight;

void main() {

	vec2 coord = vec2( gl_FragCoord.x / depthWidth, gl_FragCoord.y / depthHeight );

	if ( coord.x >= 1.0 ) {

		gl_FragDepth = texture( depthColor, vec3( coord.x - 1.0, coord.y, 1 ) ).r;

	} else {

		gl_FragDepth = texture( depthColor, vec3( coord.x, coord.y, 0 ) ).r;

	}

}`;class eZ{constructor(){this.texture=null,this.mesh=null,this.depthNear=0,this.depthFar=0}init(e,t,n){if(this.texture===null){const s=new _r,i=e.properties.get(s);i.__webglTexture=t.texture,(t.depthNear!==n.depthNear||t.depthFar!==n.depthFar)&&(this.depthNear=t.depthNear,this.depthFar=t.depthFar),this.texture=s}}getMesh(e){if(this.texture!==null&&this.mesh===null){const t=e.cameras[0].viewport,n=new la({vertexShader:JJ,fragmentShader:ZJ,uniforms:{depthColor:{value:this.texture},depthWidth:{value:t.z},depthHeight:{value:t.w}}});this.mesh=new Ur(new mm(20,20),n)}return this.mesh}reset(){this.texture=null,this.mesh=null}getDepthTexture(){return this.texture}}class tZ extends Xa{constructor(e,t){super();const n=this;let s=null,i=1,o=null,a="local-floor",c=1,d=null,f=null,m=null,v=null,x=null,_=null;const b=new eZ,w=t.getContextAttributes();let S=null,C=null;const T=[],A=[],k=new Ve;let j=null;const D=new Cr;D.viewport=new On;const L=new Cr;L.viewport=new On;const O=[D,L],I=new OD;let B=null,W=null;this.cameraAutoUpdate=!0,this.enabled=!1,this.isPresenting=!1,this.getController=function(ue){let Ee=T[ue];return Ee===void 0&&(Ee=new gy,T[ue]=Ee),Ee.getTargetRaySpace()},this.getControllerGrip=function(ue){let Ee=T[ue];return Ee===void 0&&(Ee=new gy,T[ue]=Ee),Ee.getGripSpace()},this.getHand=function(ue){let Ee=T[ue];return Ee===void 0&&(Ee=new gy,T[ue]=Ee),Ee.getHandSpace()};function K(ue){const Ee=A.indexOf(ue.inputSource);if(Ee===-1)return;const Fe=T[Ee];Fe!==void 0&&(Fe.update(ue.inputSource,ue.frame,d||o),Fe.dispatchEvent({type:ue.type,data:ue.inputSource}))}function ee(){s.removeEventListener("select",K),s.removeEventListener("selectstart",K),s.removeEventListener("selectend",K),s.removeEventListener("squeeze",K),s.removeEventListener("squeezestart",K),s.removeEventListener("squeezeend",K),s.removeEventListener("end",ee),s.removeEventListener("inputsourceschange",oe);for(let ue=0;ue<T.length;ue++){const Ee=A[ue];Ee!==null&&(A[ue]=null,T[ue].disconnect(Ee))}B=null,W=null,b.reset(),e.setRenderTarget(S),x=null,v=null,m=null,s=null,C=null,be.stop(),n.isPresenting=!1,e.setPixelRatio(j),e.setSize(k.width,k.height,!1),n.dispatchEvent({type:"sessionend"})}this.setFramebufferScaleFactor=function(ue){i=ue,n.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change framebuffer scale while presenting.")},this.setReferenceSpaceType=function(ue){a=ue,n.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change reference space type while presenting.")},this.getReferenceSpace=function(){return d||o},this.setReferenceSpace=function(ue){d=ue},this.getBaseLayer=function(){return v!==null?v:x},this.getBinding=function(){return m},this.getFrame=function(){return _},this.getSession=function(){return s},this.setSession=async function(ue){if(s=ue,s!==null){if(S=e.getRenderTarget(),s.addEventListener("select",K),s.addEventListener("selectstart",K),s.addEventListener("selectend",K),s.addEventListener("squeeze",K),s.addEventListener("squeezestart",K),s.addEventListener("squeezeend",K),s.addEventListener("end",ee),s.addEventListener("inputsourceschange",oe),w.xrCompatible!==!0&&await t.makeXRCompatible(),j=e.getPixelRatio(),e.getSize(k),typeof XRWebGLBinding<"u"&&"createProjectionLayer"in XRWebGLBinding.prototype){let Fe=null,me=null,je=null;w.depth&&(je=w.stencil?t.DEPTH24_STENCIL8:t.DEPTH_COMPONENT24,Fe=w.stencil?$p:Wp,me=w.stencil?Gp:tc);const Xe={colorFormat:t.RGBA8,depthFormat:je,scaleFactor:i};m=new XRWebGLBinding(s,t),v=m.createProjectionLayer(Xe),s.updateRenderState({layers:[v]}),e.setPixelRatio(1),e.setSize(v.textureWidth,v.textureHeight,!1),C=new Ga(v.textureWidth,v.textureHeight,{format:Vs,type:_o,depthTexture:new EM(v.textureWidth,v.textureHeight,me,void 0,void 0,void 0,void 0,void 0,void 0,Fe),stencilBuffer:w.stencil,colorSpace:e.outputColorSpace,samples:w.antialias?4:0,resolveDepthBuffer:v.ignoreDepthValues===!1,resolveStencilBuffer:v.ignoreDepthValues===!1})}else{const Fe={antialias:w.antialias,alpha:!0,depth:w.depth,stencil:w.stencil,framebufferScaleFactor:i};x=new XRWebGLLayer(s,t,Fe),s.updateRenderState({baseLayer:x}),e.setPixelRatio(1),e.setSize(x.framebufferWidth,x.framebufferHeight,!1),C=new Ga(x.framebufferWidth,x.framebufferHeight,{format:Vs,type:_o,colorSpace:e.outputColorSpace,stencilBuffer:w.stencil,resolveDepthBuffer:x.ignoreDepthValues===!1,resolveStencilBuffer:x.ignoreDepthValues===!1})}C.isXRRenderTarget=!0,this.setFoveation(c),d=null,o=await s.requestReferenceSpace(a),be.setContext(s),be.start(),n.isPresenting=!0,n.dispatchEvent({type:"sessionstart"})}},this.getEnvironmentBlendMode=function(){if(s!==null)return s.environmentBlendMode},this.getDepthTexture=function(){return b.getDepthTexture()};function oe(ue){for(let Ee=0;Ee<ue.removed.length;Ee++){const Fe=ue.removed[Ee],me=A.indexOf(Fe);me>=0&&(A[me]=null,T[me].disconnect(Fe))}for(let Ee=0;Ee<ue.added.length;Ee++){const Fe=ue.added[Ee];let me=A.indexOf(Fe);if(me===-1){for(let Xe=0;Xe<T.length;Xe++)if(Xe>=A.length){A.push(Fe),me=Xe;break}else if(A[Xe]===null){A[Xe]=Fe,me=Xe;break}if(me===-1)break}const je=T[me];je&&je.connect(Fe)}}const ne=new J,ce=new J;function V(ue,Ee,Fe){ne.setFromMatrixPosition(Ee.matrixWorld),ce.setFromMatrixPosition(Fe.matrixWorld);const me=ne.distanceTo(ce),je=Ee.projectionMatrix.elements,Xe=Fe.projectionMatrix.elements,$e=je[14]/(je[10]-1),dt=je[14]/(je[10]+1),ht=(je[9]+1)/je[5],Ie=(je[9]-1)/je[5],$=(je[8]-1)/je[0],Ce=(Xe[8]+1)/Xe[0],ke=$e*$,Ge=$e*Ce,Ae=me/(-$+Ce),rt=Ae*-$;if(Ee.matrixWorld.decompose(ue.position,ue.quaternion,ue.scale),ue.translateX(rt),ue.translateZ(Ae),ue.matrixWorld.compose(ue.position,ue.quaternion,ue.scale),ue.matrixWorldInverse.copy(ue.matrixWorld).invert(),je[10]===-1)ue.projectionMatrix.copy(Ee.projectionMatrix),ue.projectionMatrixInverse.copy(Ee.projectionMatrixInverse);else{const qe=$e+Ae,nt=dt+Ae,jt=ke-rt,Q=Ge+(me-rt),H=ht*dt/nt*qe,ye=Ie*dt/nt*qe;ue.projectionMatrix.makePerspective(jt,Q,H,ye,qe,nt),ue.projectionMatrixInverse.copy(ue.projectionMatrix).invert()}}function q(ue,Ee){Ee===null?ue.matrixWorld.copy(ue.matrix):ue.matrixWorld.multiplyMatrices(Ee.matrixWorld,ue.matrix),ue.matrixWorldInverse.copy(ue.matrixWorld).invert()}this.updateCamera=function(ue){if(s===null)return;let Ee=ue.near,Fe=ue.far;b.texture!==null&&(b.depthNear>0&&(Ee=b.depthNear),b.depthFar>0&&(Fe=b.depthFar)),I.near=L.near=D.near=Ee,I.far=L.far=D.far=Fe,(B!==I.near||W!==I.far)&&(s.updateRenderState({depthNear:I.near,depthFar:I.far}),B=I.near,W=I.far),D.layers.mask=ue.layers.mask|2,L.layers.mask=ue.layers.mask|4,I.layers.mask=D.layers.mask|L.layers.mask;const me=ue.parent,je=I.cameras;q(I,me);for(let Xe=0;Xe<je.length;Xe++)q(je[Xe],me);je.length===2?V(I,D,L):I.projectionMatrix.copy(D.projectionMatrix),Z(ue,I,me)};function Z(ue,Ee,Fe){Fe===null?ue.matrix.copy(Ee.matrixWorld):(ue.matrix.copy(Fe.matrixWorld),ue.matrix.invert(),ue.matrix.multiply(Ee.matrixWorld)),ue.matrix.decompose(ue.position,ue.quaternion,ue.scale),ue.updateMatrixWorld(!0),ue.projectionMatrix.copy(Ee.projectionMatrix),ue.projectionMatrixInverse.copy(Ee.projectionMatrixInverse),ue.isPerspectiveCamera&&(ue.fov=qp*2*Math.atan(1/ue.projectionMatrix.elements[5]),ue.zoom=1)}this.getCamera=function(){return I},this.getFoveation=function(){if(!(v===null&&x===null))return c},this.setFoveation=function(ue){c=ue,v!==null&&(v.fixedFoveation=ue),x!==null&&x.fixedFoveation!==void 0&&(x.fixedFoveation=ue)},this.hasDepthSensing=function(){return b.texture!==null},this.getDepthSensingMesh=function(){return b.getMesh(I)};let X=null;function ie(ue,Ee){if(f=Ee.getViewerPose(d||o),_=Ee,f!==null){const Fe=f.views;x!==null&&(e.setRenderTargetFramebuffer(C,x.framebuffer),e.setRenderTarget(C));let me=!1;Fe.length!==I.cameras.length&&(I.cameras.length=0,me=!0);for(let $e=0;$e<Fe.length;$e++){const dt=Fe[$e];let ht=null;if(x!==null)ht=x.getViewport(dt);else{const $=m.getViewSubImage(v,dt);ht=$.viewport,$e===0&&(e.setRenderTargetTextures(C,$.colorTexture,$.depthStencilTexture),e.setRenderTarget(C))}let Ie=O[$e];Ie===void 0&&(Ie=new Cr,Ie.layers.enable($e),Ie.viewport=new On,O[$e]=Ie),Ie.matrix.fromArray(dt.transform.matrix),Ie.matrix.decompose(Ie.position,Ie.quaternion,Ie.scale),Ie.projectionMatrix.fromArray(dt.projectionMatrix),Ie.projectionMatrixInverse.copy(Ie.projectionMatrix).invert(),Ie.viewport.set(ht.x,ht.y,ht.width,ht.height),$e===0&&(I.matrix.copy(Ie.matrix),I.matrix.decompose(I.position,I.quaternion,I.scale)),me===!0&&I.cameras.push(Ie)}const je=s.enabledFeatures;if(je&&je.includes("depth-sensing")&&s.depthUsage=="gpu-optimized"&&m){const $e=m.getDepthInformation(Fe[0]);$e&&$e.isValid&&$e.texture&&b.init(e,$e,s.renderState)}}for(let Fe=0;Fe<T.length;Fe++){const me=A[Fe],je=T[Fe];me!==null&&je!==void 0&&je.update(me,Ee,d||o)}X&&X(ue,Ee),Ee.detectedPlanes&&n.dispatchEvent({type:"planesdetected",data:Ee}),_=null}const be=new VD;be.setAnimationLoop(ie),this.setAnimationLoop=function(ue){X=ue},this.dispose=function(){}}}const Ad=new eo,nZ=new Jt;function rZ(r,e){function t(w,S){w.matrixAutoUpdate===!0&&w.updateMatrix(),S.value.copy(w.matrix)}function n(w,S){S.color.getRGB(w.fogColor.value,z4(r)),S.isFog?(w.fogNear.value=S.near,w.fogFar.value=S.far):S.isFogExp2&&(w.fogDensity.value=S.density)}function s(w,S,C,T,A){S.isMeshBasicMaterial||S.isMeshLambertMaterial?i(w,S):S.isMeshToonMaterial?(i(w,S),m(w,S)):S.isMeshPhongMaterial?(i(w,S),f(w,S)):S.isMeshStandardMaterial?(i(w,S),v(w,S),S.isMeshPhysicalMaterial&&x(w,S,A)):S.isMeshMatcapMaterial?(i(w,S),_(w,S)):S.isMeshDepthMaterial?i(w,S):S.isMeshDistanceMaterial?(i(w,S),b(w,S)):S.isMeshNormalMaterial?i(w,S):S.isLineBasicMaterial?(o(w,S),S.isLineDashedMaterial&&a(w,S)):S.isPointsMaterial?c(w,S,C,T):S.isSpriteMaterial?d(w,S):S.isShadowMaterial?(w.color.value.copy(S.color),w.opacity.value=S.opacity):S.isShaderMaterial&&(S.uniformsNeedUpdate=!1)}function i(w,S){w.opacity.value=S.opacity,S.color&&w.diffuse.value.copy(S.color),S.emissive&&w.emissive.value.copy(S.emissive).multiplyScalar(S.emissiveIntensity),S.map&&(w.map.value=S.map,t(S.map,w.mapTransform)),S.alphaMap&&(w.alphaMap.value=S.alphaMap,t(S.alphaMap,w.alphaMapTransform)),S.bumpMap&&(w.bumpMap.value=S.bumpMap,t(S.bumpMap,w.bumpMapTransform),w.bumpScale.value=S.bumpScale,S.side===ci&&(w.bumpScale.value*=-1)),S.normalMap&&(w.normalMap.value=S.normalMap,t(S.normalMap,w.normalMapTransform),w.normalScale.value.copy(S.normalScale),S.side===ci&&w.normalScale.value.negate()),S.displacementMap&&(w.displacementMap.value=S.displacementMap,t(S.displacementMap,w.displacementMapTransform),w.displacementScale.value=S.displacementScale,w.displacementBias.value=S.displacementBias),S.emissiveMap&&(w.emissiveMap.value=S.emissiveMap,t(S.emissiveMap,w.emissiveMapTransform)),S.specularMap&&(w.specularMap.value=S.specularMap,t(S.specularMap,w.specularMapTransform)),S.alphaTest>0&&(w.alphaTest.value=S.alphaTest);const C=e.get(S),T=C.envMap,A=C.envMapRotation;T&&(w.envMap.value=T,Ad.copy(A),Ad.x*=-1,Ad.y*=-1,Ad.z*=-1,T.isCubeTexture&&T.isRenderTargetTexture===!1&&(Ad.y*=-1,Ad.z*=-1),w.envMapRotation.value.setFromMatrix4(nZ.makeRotationFromEuler(Ad)),w.flipEnvMap.value=T.isCubeTexture&&T.isRenderTargetTexture===!1?-1:1,w.reflectivity.value=S.reflectivity,w.ior.value=S.ior,w.refractionRatio.value=S.refractionRatio),S.lightMap&&(w.lightMap.value=S.lightMap,w.lightMapIntensity.value=S.lightMapIntensity,t(S.lightMap,w.lightMapTransform)),S.aoMap&&(w.aoMap.value=S.aoMap,w.aoMapIntensity.value=S.aoMapIntensity,t(S.aoMap,w.aoMapTransform))}function o(w,S){w.diffuse.value.copy(S.color),w.opacity.value=S.opacity,S.map&&(w.map.value=S.map,t(S.map,w.mapTransform))}function a(w,S){w.dashSize.value=S.dashSize,w.totalSize.value=S.dashSize+S.gapSize,w.scale.value=S.scale}function c(w,S,C,T){w.diffuse.value.copy(S.color),w.opacity.value=S.opacity,w.size.value=S.size*C,w.scale.value=T*.5,S.map&&(w.map.value=S.map,t(S.map,w.uvTransform)),S.alphaMap&&(w.alphaMap.value=S.alphaMap,t(S.alphaMap,w.alphaMapTransform)),S.alphaTest>0&&(w.alphaTest.value=S.alphaTest)}function d(w,S){w.diffuse.value.copy(S.color),w.opacity.value=S.opacity,w.rotation.value=S.rotation,S.map&&(w.map.value=S.map,t(S.map,w.mapTransform)),S.alphaMap&&(w.alphaMap.value=S.alphaMap,t(S.alphaMap,w.alphaMapTransform)),S.alphaTest>0&&(w.alphaTest.value=S.alphaTest)}function f(w,S){w.specular.value.copy(S.specular),w.shininess.value=Math.max(S.shininess,1e-4)}function m(w,S){S.gradientMap&&(w.gradientMap.value=S.gradientMap)}function v(w,S){w.metalness.value=S.metalness,S.metalnessMap&&(w.metalnessMap.value=S.metalnessMap,t(S.metalnessMap,w.metalnessMapTransform)),w.roughness.value=S.roughness,S.roughnessMap&&(w.roughnessMap.value=S.roughnessMap,t(S.roughnessMap,w.roughnessMapTransform)),S.envMap&&(w.envMapIntensity.value=S.envMapIntensity)}function x(w,S,C){w.ior.value=S.ior,S.sheen>0&&(w.sheenColor.value.copy(S.sheenColor).multiplyScalar(S.sheen),w.sheenRoughness.value=S.sheenRoughness,S.sheenColorMap&&(w.sheenColorMap.value=S.sheenColorMap,t(S.sheenColorMap,w.sheenColorMapTransform)),S.sheenRoughnessMap&&(w.sheenRoughnessMap.value=S.sheenRoughnessMap,t(S.sheenRoughnessMap,w.sheenRoughnessMapTransform))),S.clearcoat>0&&(w.clearcoat.value=S.clearcoat,w.clearcoatRoughness.value=S.clearcoatRoughness,S.clearcoatMap&&(w.clearcoatMap.value=S.clearcoatMap,t(S.clearcoatMap,w.clearcoatMapTransform)),S.clearcoatRoughnessMap&&(w.clearcoatRoughnessMap.value=S.clearcoatRoughnessMap,t(S.clearcoatRoughnessMap,w.clearcoatRoughnessMapTransform)),S.clearcoatNormalMap&&(w.clearcoatNormalMap.value=S.clearcoatNormalMap,t(S.clearcoatNormalMap,w.clearcoatNormalMapTransform),w.clearcoatNormalScale.value.copy(S.clearcoatNormalScale),S.side===ci&&w.clearcoatNormalScale.value.negate())),S.dispersion>0&&(w.dispersion.value=S.dispersion),S.iridescence>0&&(w.iridescence.value=S.iridescence,w.iridescenceIOR.value=S.iridescenceIOR,w.iridescenceThicknessMinimum.value=S.iridescenceThicknessRange[0],w.iridescenceThicknessMaximum.value=S.iridescenceThicknessRange[1],S.iridescenceMap&&(w.iridescenceMap.value=S.iridescenceMap,t(S.iridescenceMap,w.iridescenceMapTransform)),S.iridescenceThicknessMap&&(w.iridescenceThicknessMap.value=S.iridescenceThicknessMap,t(S.iridescenceThicknessMap,w.iridescenceThicknessMapTransform))),S.transmission>0&&(w.transmission.value=S.transmission,w.transmissionSamplerMap.value=C.texture,w.transmissionSamplerSize.value.set(C.width,C.height),S.transmissionMap&&(w.transmissionMap.value=S.transmissionMap,t(S.transmissionMap,w.transmissionMapTransform)),w.thickness.value=S.thickness,S.thicknessMap&&(w.thicknessMap.value=S.thicknessMap,t(S.thicknessMap,w.thicknessMapTransform)),w.attenuationDistance.value=S.attenuationDistance,w.attenuationColor.value.copy(S.attenuationColor)),S.anisotropy>0&&(w.anisotropyVector.value.set(S.anisotropy*Math.cos(S.anisotropyRotation),S.anisotropy*Math.sin(S.anisotropyRotation)),S.anisotropyMap&&(w.anisotropyMap.value=S.anisotropyMap,t(S.anisotropyMap,w.anisotropyMapTransform))),w.specularIntensity.value=S.specularIntensity,w.specularColor.value.copy(S.specularColor),S.specularColorMap&&(w.specularColorMap.value=S.specularColorMap,t(S.specularColorMap,w.specularColorMapTransform)),S.specularIntensityMap&&(w.specularIntensityMap.value=S.specularIntensityMap,t(S.specularIntensityMap,w.specularIntensityMapTransform))}function _(w,S){S.matcap&&(w.matcap.value=S.matcap)}function b(w,S){const C=e.get(S).light;w.referencePosition.value.setFromMatrixPosition(C.matrixWorld),w.nearDistance.value=C.shadow.camera.near,w.farDistance.value=C.shadow.camera.far}return{refreshFogUniforms:n,refreshMaterialUniforms:s}}function sZ(r,e,t,n){let s={},i={},o=[];const a=r.getParameter(r.MAX_UNIFORM_BUFFER_BINDINGS);function c(C,T){const A=T.program;n.uniformBlockBinding(C,A)}function d(C,T){let A=s[C.id];A===void 0&&(_(C),A=f(C),s[C.id]=A,C.addEventListener("dispose",w));const k=T.program;n.updateUBOMapping(C,k);const j=e.render.frame;i[C.id]!==j&&(v(C),i[C.id]=j)}function f(C){const T=m();C.__bindingPointIndex=T;const A=r.createBuffer(),k=C.__size,j=C.usage;return r.bindBuffer(r.UNIFORM_BUFFER,A),r.bufferData(r.UNIFORM_BUFFER,k,j),r.bindBuffer(r.UNIFORM_BUFFER,null),r.bindBufferBase(r.UNIFORM_BUFFER,T,A),A}function m(){for(let C=0;C<a;C++)if(o.indexOf(C)===-1)return o.push(C),C;return console.error("THREE.WebGLRenderer: Maximum number of simultaneously usable uniforms groups reached."),0}function v(C){const T=s[C.id],A=C.uniforms,k=C.__cache;r.bindBuffer(r.UNIFORM_BUFFER,T);for(let j=0,D=A.length;j<D;j++){const L=Array.isArray(A[j])?A[j]:[A[j]];for(let O=0,I=L.length;O<I;O++){const B=L[O];if(x(B,j,O,k)===!0){const W=B.__offset,K=Array.isArray(B.value)?B.value:[B.value];let ee=0;for(let oe=0;oe<K.length;oe++){const ne=K[oe],ce=b(ne);typeof ne=="number"||typeof ne=="boolean"?(B.__data[0]=ne,r.bufferSubData(r.UNIFORM_BUFFER,W+ee,B.__data)):ne.isMatrix3?(B.__data[0]=ne.elements[0],B.__data[1]=ne.elements[1],B.__data[2]=ne.elements[2],B.__data[3]=0,B.__data[4]=ne.elements[3],B.__data[5]=ne.elements[4],B.__data[6]=ne.elements[5],B.__data[7]=0,B.__data[8]=ne.elements[6],B.__data[9]=ne.elements[7],B.__data[10]=ne.elements[8],B.__data[11]=0):(ne.toArray(B.__data,ee),ee+=ce.storage/Float32Array.BYTES_PER_ELEMENT)}r.bufferSubData(r.UNIFORM_BUFFER,W,B.__data)}}}r.bindBuffer(r.UNIFORM_BUFFER,null)}function x(C,T,A,k){const j=C.value,D=T+"_"+A;if(k[D]===void 0)return typeof j=="number"||typeof j=="boolean"?k[D]=j:k[D]=j.clone(),!0;{const L=k[D];if(typeof j=="number"||typeof j=="boolean"){if(L!==j)return k[D]=j,!0}else if(L.equals(j)===!1)return L.copy(j),!0}return!1}function _(C){const T=C.uniforms;let A=0;const k=16;for(let D=0,L=T.length;D<L;D++){const O=Array.isArray(T[D])?T[D]:[T[D]];for(let I=0,B=O.length;I<B;I++){const W=O[I],K=Array.isArray(W.value)?W.value:[W.value];for(let ee=0,oe=K.length;ee<oe;ee++){const ne=K[ee],ce=b(ne),V=A%k,q=V%ce.boundary,Z=V+q;A+=q,Z!==0&&k-Z<ce.storage&&(A+=k-Z),W.__data=new Float32Array(ce.storage/Float32Array.BYTES_PER_ELEMENT),W.__offset=A,A+=ce.storage}}}const j=A%k;return j>0&&(A+=k-j),C.__size=A,C.__cache={},this}function b(C){const T={boundary:0,storage:0};return typeof C=="number"||typeof C=="boolean"?(T.boundary=4,T.storage=4):C.isVector2?(T.boundary=8,T.storage=8):C.isVector3||C.isColor?(T.boundary=16,T.storage=12):C.isVector4?(T.boundary=16,T.storage=16):C.isMatrix3?(T.boundary=48,T.storage=48):C.isMatrix4?(T.boundary=64,T.storage=64):C.isTexture?console.warn("THREE.WebGLRenderer: Texture samplers can not be part of an uniforms group."):console.warn("THREE.WebGLRenderer: Unsupported uniform value type.",C),T}function w(C){const T=C.target;T.removeEventListener("dispose",w);const A=o.indexOf(T.__bindingPointIndex);o.splice(A,1),r.deleteBuffer(s[T.id]),delete s[T.id],delete i[T.id]}function S(){for(const C in s)r.deleteBuffer(s[C]);o=[],s={},i={}}return{bind:c,update:d,dispose:S}}class XD{constructor(e={}){const{canvas:t=F4(),context:n=null,depth:s=!0,stencil:i=!1,alpha:o=!1,antialias:a=!1,premultipliedAlpha:c=!0,preserveDrawingBuffer:d=!1,powerPreference:f="default",failIfMajorPerformanceCaveat:m=!1,reverseDepthBuffer:v=!1}=e;this.isWebGLRenderer=!0;let x;if(n!==null){if(typeof WebGLRenderingContext<"u"&&n instanceof WebGLRenderingContext)throw new Error("THREE.WebGLRenderer: WebGL 1 is not supported since r163.");x=n.getContextAttributes().alpha}else x=o;const _=new Uint32Array(4),b=new Int32Array(4);let w=null,S=null;const C=[],T=[];this.domElement=t,this.debug={checkShaderErrors:!0,onShaderError:null},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this.toneMapping=Ua,this.toneMappingExposure=1,this.transmissionResolutionScale=1;const A=this;let k=!1;this._outputColorSpace=Ni;let j=0,D=0,L=null,O=-1,I=null;const B=new On,W=new On;let K=null;const ee=new St(0);let oe=0,ne=t.width,ce=t.height,V=1,q=null,Z=null;const X=new On(0,0,ne,ce),ie=new On(0,0,ne,ce);let be=!1;const ue=new pm;let Ee=!1,Fe=!1;const me=new Jt,je=new Jt,Xe=new J,$e=new On,dt={background:null,fog:null,environment:null,overrideMaterial:null,isScene:!0};let ht=!1;function Ie(){return L===null?V:1}let $=n;function Ce(Y,xe){return t.getContext(Y,xe)}try{const Y={alpha:!0,depth:s,stencil:i,antialias:a,premultipliedAlpha:c,preserveDrawingBuffer:d,powerPreference:f,failIfMajorPerformanceCaveat:m};if("setAttribute"in t&&t.setAttribute("data-engine",`three.js r${Q_}`),t.addEventListener("webglcontextlost",ct,!1),t.addEventListener("webglcontextrestored",Ye,!1),t.addEventListener("webglcontextcreationerror",ze,!1),$===null){const xe="webgl2";if($=Ce(xe,Y),$===null)throw Ce(xe)?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.")}}catch(Y){throw console.error("THREE.WebGLRenderer: "+Y.message),Y}let ke,Ge,Ae,rt,qe,nt,jt,Q,H,ye,Re,Ue,Le,bt,st,xt,Et,We,ft,Bt,le,Se,Ze,ae;function Je(){ke=new gQ($),ke.init(),Se=new qD($,ke),Ge=new cQ($,ke,e,Se),Ae=new KJ($,ke),Ge.reverseDepthBuffer&&v&&Ae.buffers.depth.setReversed(!0),rt=new yQ($),qe=new jJ,nt=new QJ($,ke,Ae,qe,Ge,Se,rt),jt=new dQ(A),Q=new mQ(A),H=new MX($),Ze=new aQ($,H),ye=new vQ($,H,rt,Ze),Re=new wQ($,ye,H,rt),ft=new _Q($,Ge,nt),xt=new uQ(qe),Ue=new OJ(A,jt,Q,ke,Ge,Ze,xt),Le=new rZ(A,qe),bt=new UJ,st=new WJ(ke),We=new oQ(A,jt,Q,Ae,Re,x,c),Et=new XJ(A,Re,Ge),ae=new sZ($,rt,Ge,Ae),Bt=new lQ($,ke,rt),le=new xQ($,ke,rt),rt.programs=Ue.programs,A.capabilities=Ge,A.extensions=ke,A.properties=qe,A.renderLists=bt,A.shadowMap=Et,A.state=Ae,A.info=rt}Je();const He=new tZ(A,$);this.xr=He,this.getContext=function(){return $},this.getContextAttributes=function(){return $.getContextAttributes()},this.forceContextLoss=function(){const Y=ke.get("WEBGL_lose_context");Y&&Y.loseContext()},this.forceContextRestore=function(){const Y=ke.get("WEBGL_lose_context");Y&&Y.restoreContext()},this.getPixelRatio=function(){return V},this.setPixelRatio=function(Y){Y!==void 0&&(V=Y,this.setSize(ne,ce,!1))},this.getSize=function(Y){return Y.set(ne,ce)},this.setSize=function(Y,xe,Ne=!0){if(He.isPresenting){console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting.");return}ne=Y,ce=xe,t.width=Math.floor(Y*V),t.height=Math.floor(xe*V),Ne===!0&&(t.style.width=Y+"px",t.style.height=xe+"px"),this.setViewport(0,0,Y,xe)},this.getDrawingBufferSize=function(Y){return Y.set(ne*V,ce*V).floor()},this.setDrawingBufferSize=function(Y,xe,Ne){ne=Y,ce=xe,V=Ne,t.width=Math.floor(Y*Ne),t.height=Math.floor(xe*Ne),this.setViewport(0,0,Y,xe)},this.getCurrentViewport=function(Y){return Y.copy(B)},this.getViewport=function(Y){return Y.copy(X)},this.setViewport=function(Y,xe,Ne,_e){Y.isVector4?X.set(Y.x,Y.y,Y.z,Y.w):X.set(Y,xe,Ne,_e),Ae.viewport(B.copy(X).multiplyScalar(V).round())},this.getScissor=function(Y){return Y.copy(ie)},this.setScissor=function(Y,xe,Ne,_e){Y.isVector4?ie.set(Y.x,Y.y,Y.z,Y.w):ie.set(Y,xe,Ne,_e),Ae.scissor(W.copy(ie).multiplyScalar(V).round())},this.getScissorTest=function(){return be},this.setScissorTest=function(Y){Ae.setScissorTest(be=Y)},this.setOpaqueSort=function(Y){q=Y},this.setTransparentSort=function(Y){Z=Y},this.getClearColor=function(Y){return Y.copy(We.getClearColor())},this.setClearColor=function(){We.setClearColor(...arguments)},this.getClearAlpha=function(){return We.getClearAlpha()},this.setClearAlpha=function(){We.setClearAlpha(...arguments)},this.clear=function(Y=!0,xe=!0,Ne=!0){let _e=0;if(Y){let ve=!1;if(L!==null){const et=L.texture.format;ve=et===iw||et===sw||et===$0}if(ve){const et=L.texture.type,pt=et===_o||et===tc||et===Hp||et===Gp||et===tw||et===nw,Mt=We.getClearColor(),_t=We.getClearAlpha(),Vt=Mt.r,Ft=Mt.g,it=Mt.b;pt?(_[0]=Vt,_[1]=Ft,_[2]=it,_[3]=_t,$.clearBufferuiv($.COLOR,0,_)):(b[0]=Vt,b[1]=Ft,b[2]=it,b[3]=_t,$.clearBufferiv($.COLOR,0,b))}else _e|=$.COLOR_BUFFER_BIT}xe&&(_e|=$.DEPTH_BUFFER_BIT),Ne&&(_e|=$.STENCIL_BUFFER_BIT,this.state.buffers.stencil.setMask(4294967295)),$.clear(_e)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){t.removeEventListener("webglcontextlost",ct,!1),t.removeEventListener("webglcontextrestored",Ye,!1),t.removeEventListener("webglcontextcreationerror",ze,!1),We.dispose(),bt.dispose(),st.dispose(),qe.dispose(),jt.dispose(),Q.dispose(),Re.dispose(),Ze.dispose(),ae.dispose(),Ue.dispose(),He.dispose(),He.removeEventListener("sessionstart",Ts),He.removeEventListener("sessionend",pr),wr.stop()};function ct(Y){Y.preventDefault(),console.log("THREE.WebGLRenderer: Context Lost."),k=!0}function Ye(){console.log("THREE.WebGLRenderer: Context Restored."),k=!1;const Y=rt.autoReset,xe=Et.enabled,Ne=Et.autoUpdate,_e=Et.needsUpdate,ve=Et.type;Je(),rt.autoReset=Y,Et.enabled=xe,Et.autoUpdate=Ne,Et.needsUpdate=_e,Et.type=ve}function ze(Y){console.error("THREE.WebGLRenderer: A WebGL context could not be created. Reason: ",Y.statusMessage)}function Be(Y){const xe=Y.target;xe.removeEventListener("dispose",Be),lt(xe)}function lt(Y){Dt(Y),qe.remove(Y)}function Dt(Y){const xe=qe.get(Y).programs;xe!==void 0&&(xe.forEach(function(Ne){Ue.releaseProgram(Ne)}),Y.isShaderMaterial&&Ue.releaseShaderCache(Y))}this.renderBufferDirect=function(Y,xe,Ne,_e,ve,et){xe===null&&(xe=dt);const pt=ve.isMesh&&ve.matrixWorld.determinant()<0,Mt=Ch(Y,xe,Ne,_e,ve);Ae.setMaterial(_e,pt);let _t=Ne.index,Vt=1;if(_e.wireframe===!0){if(_t=ye.getWireframeAttribute(Ne),_t===void 0)return;Vt=2}const Ft=Ne.drawRange,it=Ne.attributes.position;let Nt=Ft.start*Vt,Kt=(Ft.start+Ft.count)*Vt;et!==null&&(Nt=Math.max(Nt,et.start*Vt),Kt=Math.min(Kt,(et.start+et.count)*Vt)),_t!==null?(Nt=Math.max(Nt,0),Kt=Math.min(Kt,_t.count)):it!=null&&(Nt=Math.max(Nt,0),Kt=Math.min(Kt,it.count));const un=Kt-Nt;if(un<0||un===1/0)return;Ze.setup(ve,_e,Mt,Ne,_t);let _n,dn=Bt;if(_t!==null&&(_n=H.get(_t),dn=le,dn.setIndex(_n)),ve.isMesh)_e.wireframe===!0?(Ae.setLineWidth(_e.wireframeLinewidth*Ie()),dn.setMode($.LINES)):dn.setMode($.TRIANGLES);else if(ve.isLine){let kt=_e.linewidth;kt===void 0&&(kt=1),Ae.setLineWidth(kt*Ie()),ve.isLineSegments?dn.setMode($.LINES):ve.isLineLoop?dn.setMode($.LINE_LOOP):dn.setMode($.LINE_STRIP)}else ve.isPoints?dn.setMode($.POINTS):ve.isSprite&&dn.setMode($.TRIANGLES);if(ve.isBatchedMesh)if(ve._multiDrawInstances!==null)Tp("THREE.WebGLRenderer: renderMultiDrawInstances has been deprecated and will be removed in r184. Append to renderMultiDraw arguments and use indirection."),dn.renderMultiDrawInstances(ve._multiDrawStarts,ve._multiDrawCounts,ve._multiDrawCount,ve._multiDrawInstances);else if(ke.get("WEBGL_multi_draw"))dn.renderMultiDraw(ve._multiDrawStarts,ve._multiDrawCounts,ve._multiDrawCount);else{const kt=ve._multiDrawStarts,En=ve._multiDrawCounts,gn=ve._multiDrawCount,Br=_t?H.get(_t).bytesPerElement:1,bo=qe.get(_e).currentProgram.getUniforms();for(let Nr=0;Nr<gn;Nr++)bo.setValue($,"_gl_DrawID",Nr),dn.render(kt[Nr]/Br,En[Nr])}else if(ve.isInstancedMesh)dn.renderInstances(Nt,un,ve.count);else if(Ne.isInstancedBufferGeometry){const kt=Ne._maxInstanceCount!==void 0?Ne._maxInstanceCount:1/0,En=Math.min(Ne.instanceCount,kt);dn.renderInstances(Nt,un,En)}else dn.render(Nt,un)};function Ht(Y,xe,Ne){Y.transparent===!0&&Y.side===ka&&Y.forceSinglePass===!1?(Y.side=ci,Y.needsUpdate=!0,ic(Y,xe,Ne),Y.side=Zl,Y.needsUpdate=!0,ic(Y,xe,Ne),Y.side=ka):ic(Y,xe,Ne)}this.compile=function(Y,xe,Ne=null){Ne===null&&(Ne=Y),S=st.get(Ne),S.init(xe),T.push(S),Ne.traverseVisible(function(ve){ve.isLight&&ve.layers.test(xe.layers)&&(S.pushLight(ve),ve.castShadow&&S.pushShadow(ve))}),Y!==Ne&&Y.traverseVisible(function(ve){ve.isLight&&ve.layers.test(xe.layers)&&(S.pushLight(ve),ve.castShadow&&S.pushShadow(ve))}),S.setupLights();const _e=new Set;return Y.traverse(function(ve){if(!(ve.isMesh||ve.isPoints||ve.isLine||ve.isSprite))return;const et=ve.material;if(et)if(Array.isArray(et))for(let pt=0;pt<et.length;pt++){const Mt=et[pt];Ht(Mt,Ne,ve),_e.add(Mt)}else Ht(et,Ne,ve),_e.add(et)}),S=T.pop(),_e},this.compileAsync=function(Y,xe,Ne=null){const _e=this.compile(Y,xe,Ne);return new Promise(ve=>{function et(){if(_e.forEach(function(pt){qe.get(pt).currentProgram.isReady()&&_e.delete(pt)}),_e.size===0){ve(Y);return}setTimeout(et,10)}ke.get("KHR_parallel_shader_compile")!==null?et():setTimeout(et,10)})};let An=null;function Bn(Y){An&&An(Y)}function Ts(){wr.stop()}function pr(){wr.start()}const wr=new VD;wr.setAnimationLoop(Bn),typeof self<"u"&&wr.setContext(self),this.setAnimationLoop=function(Y){An=Y,He.setAnimationLoop(Y),Y===null?wr.stop():wr.start()},He.addEventListener("sessionstart",Ts),He.addEventListener("sessionend",pr),this.render=function(Y,xe){if(xe!==void 0&&xe.isCamera!==!0){console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.");return}if(k===!0)return;if(Y.matrixWorldAutoUpdate===!0&&Y.updateMatrixWorld(),xe.parent===null&&xe.matrixWorldAutoUpdate===!0&&xe.updateMatrixWorld(),He.enabled===!0&&He.isPresenting===!0&&(He.cameraAutoUpdate===!0&&He.updateCamera(xe),xe=He.getCamera()),Y.isScene===!0&&Y.onBeforeRender(A,Y,xe,L),S=st.get(Y,T.length),S.init(xe),T.push(S),je.multiplyMatrices(xe.projectionMatrix,xe.matrixWorldInverse),ue.setFromProjectionMatrix(je),Fe=this.localClippingEnabled,Ee=xt.init(this.clippingPlanes,Fe),w=bt.get(Y,C.length),w.init(),C.push(w),He.enabled===!0&&He.isPresenting===!0){const et=A.xr.getDepthSensingMesh();et!==null&&Oi(et,xe,-1/0,A.sortObjects)}Oi(Y,xe,0,A.sortObjects),w.finish(),A.sortObjects===!0&&w.sort(q,Z),ht=He.enabled===!1||He.isPresenting===!1||He.hasDepthSensing()===!1,ht&&We.addToRenderList(w,Y),this.info.render.frame++,Ee===!0&&xt.beginShadows();const Ne=S.state.shadowsArray;Et.render(Ne,Y,xe),Ee===!0&&xt.endShadows(),this.info.autoReset===!0&&this.info.reset();const _e=w.opaque,ve=w.transmissive;if(S.setupLights(),xe.isArrayCamera){const et=xe.cameras;if(ve.length>0)for(let pt=0,Mt=et.length;pt<Mt;pt++){const _t=et[pt];ji(_e,ve,Y,_t)}ht&&We.render(Y);for(let pt=0,Mt=et.length;pt<Mt;pt++){const _t=et[pt];Ka(w,Y,_t,_t.viewport)}}else ve.length>0&&ji(_e,ve,Y,xe),ht&&We.render(Y),Ka(w,Y,xe);L!==null&&D===0&&(nt.updateMultisampleRenderTarget(L),nt.updateRenderTargetMipmap(L)),Y.isScene===!0&&Y.onAfterRender(A,Y,xe),Ze.resetDefaultState(),O=-1,I=null,T.pop(),T.length>0?(S=T[T.length-1],Ee===!0&&xt.setGlobalState(A.clippingPlanes,S.state.camera)):S=null,C.pop(),C.length>0?w=C[C.length-1]:w=null};function Oi(Y,xe,Ne,_e){if(Y.visible===!1)return;if(Y.layers.test(xe.layers)){if(Y.isGroup)Ne=Y.renderOrder;else if(Y.isLOD)Y.autoUpdate===!0&&Y.update(xe);else if(Y.isLight)S.pushLight(Y),Y.castShadow&&S.pushShadow(Y);else if(Y.isSprite){if(!Y.frustumCulled||ue.intersectsSprite(Y)){_e&&$e.setFromMatrixPosition(Y.matrixWorld).applyMatrix4(je);const pt=Re.update(Y),Mt=Y.material;Mt.visible&&w.push(Y,pt,Mt,Ne,$e.z,null)}}else if((Y.isMesh||Y.isLine||Y.isPoints)&&(!Y.frustumCulled||ue.intersectsObject(Y))){const pt=Re.update(Y),Mt=Y.material;if(_e&&(Y.boundingSphere!==void 0?(Y.boundingSphere===null&&Y.computeBoundingSphere(),$e.copy(Y.boundingSphere.center)):(pt.boundingSphere===null&&pt.computeBoundingSphere(),$e.copy(pt.boundingSphere.center)),$e.applyMatrix4(Y.matrixWorld).applyMatrix4(je)),Array.isArray(Mt)){const _t=pt.groups;for(let Vt=0,Ft=_t.length;Vt<Ft;Vt++){const it=_t[Vt],Nt=Mt[it.materialIndex];Nt&&Nt.visible&&w.push(Y,pt,Nt,Ne,$e.z,it)}}else Mt.visible&&w.push(Y,pt,Mt,Ne,$e.z,null)}}const et=Y.children;for(let pt=0,Mt=et.length;pt<Mt;pt++)Oi(et[pt],xe,Ne,_e)}function Ka(Y,xe,Ne,_e){const ve=Y.opaque,et=Y.transmissive,pt=Y.transparent;S.setupLightsView(Ne),Ee===!0&&xt.setGlobalState(A.clippingPlanes,Ne),_e&&Ae.viewport(B.copy(_e)),ve.length>0&&ha(ve,xe,Ne),et.length>0&&ha(et,xe,Ne),pt.length>0&&ha(pt,xe,Ne),Ae.buffers.depth.setTest(!0),Ae.buffers.depth.setMask(!0),Ae.buffers.color.setMask(!0),Ae.setPolygonOffset(!1)}function ji(Y,xe,Ne,_e){if((Ne.isScene===!0?Ne.overrideMaterial:null)!==null)return;S.state.transmissionRenderTarget[_e.id]===void 0&&(S.state.transmissionRenderTarget[_e.id]=new Ga(1,1,{generateMipmaps:!0,type:ke.has("EXT_color_buffer_half_float")||ke.has("EXT_color_buffer_float")?fm:_o,minFilter:La,samples:4,stencilBuffer:i,resolveDepthBuffer:!1,resolveStencilBuffer:!1,colorSpace:kn.workingColorSpace}));const et=S.state.transmissionRenderTarget[_e.id],pt=_e.viewport||B;et.setSize(pt.z*A.transmissionResolutionScale,pt.w*A.transmissionResolutionScale);const Mt=A.getRenderTarget();A.setRenderTarget(et),A.getClearColor(ee),oe=A.getClearAlpha(),oe<1&&A.setClearColor(16777215,.5),A.clear(),ht&&We.render(Ne);const _t=A.toneMapping;A.toneMapping=Ua;const Vt=_e.viewport;if(_e.viewport!==void 0&&(_e.viewport=void 0),S.setupLightsView(_e),Ee===!0&&xt.setGlobalState(A.clippingPlanes,_e),ha(Y,Ne,_e),nt.updateMultisampleRenderTarget(et),nt.updateRenderTargetMipmap(et),ke.has("WEBGL_multisampled_render_to_texture")===!1){let Ft=!1;for(let it=0,Nt=xe.length;it<Nt;it++){const Kt=xe[it],un=Kt.object,_n=Kt.geometry,dn=Kt.material,kt=Kt.group;if(dn.side===ka&&un.layers.test(_e.layers)){const En=dn.side;dn.side=ci,dn.needsUpdate=!0,Mh(un,Ne,_e,_n,dn,kt),dn.side=En,dn.needsUpdate=!0,Ft=!0}}Ft===!0&&(nt.updateMultisampleRenderTarget(et),nt.updateRenderTargetMipmap(et))}A.setRenderTarget(Mt),A.setClearColor(ee,oe),Vt!==void 0&&(_e.viewport=Vt),A.toneMapping=_t}function ha(Y,xe,Ne){const _e=xe.isScene===!0?xe.overrideMaterial:null;for(let ve=0,et=Y.length;ve<et;ve++){const pt=Y[ve],Mt=pt.object,_t=pt.geometry,Vt=pt.group;let Ft=pt.material;Ft.allowOverride===!0&&_e!==null&&(Ft=_e),Mt.layers.test(Ne.layers)&&Mh(Mt,xe,Ne,_t,Ft,Vt)}}function Mh(Y,xe,Ne,_e,ve,et){Y.onBeforeRender(A,xe,Ne,_e,ve,et),Y.modelViewMatrix.multiplyMatrices(Ne.matrixWorldInverse,Y.matrixWorld),Y.normalMatrix.getNormalMatrix(Y.modelViewMatrix),ve.onBeforeRender(A,xe,Ne,_e,Y,et),ve.transparent===!0&&ve.side===ka&&ve.forceSinglePass===!1?(ve.side=ci,ve.needsUpdate=!0,A.renderBufferDirect(Ne,xe,_e,ve,Y,et),ve.side=Zl,ve.needsUpdate=!0,A.renderBufferDirect(Ne,xe,_e,ve,Y,et),ve.side=ka):A.renderBufferDirect(Ne,xe,_e,ve,Y,et),Y.onAfterRender(A,xe,Ne,_e,ve,et)}function ic(Y,xe,Ne){xe.isScene!==!0&&(xe=dt);const _e=qe.get(Y),ve=S.state.lights,et=S.state.shadowsArray,pt=ve.state.version,Mt=Ue.getParameters(Y,ve.state,et,xe,Ne),_t=Ue.getProgramCacheKey(Mt);let Vt=_e.programs;_e.environment=Y.isMeshStandardMaterial?xe.environment:null,_e.fog=xe.fog,_e.envMap=(Y.isMeshStandardMaterial?Q:jt).get(Y.envMap||_e.environment),_e.envMapRotation=_e.environment!==null&&Y.envMap===null?xe.environmentRotation:Y.envMapRotation,Vt===void 0&&(Y.addEventListener("dispose",Be),Vt=new Map,_e.programs=Vt);let Ft=Vt.get(_t);if(Ft!==void 0){if(_e.currentProgram===Ft&&_e.lightsStateVersion===pt)return no(Y,Mt),Ft}else Mt.uniforms=Ue.getUniforms(Y),Y.onBeforeCompile(Mt,A),Ft=Ue.acquireProgram(Mt,_t),Vt.set(_t,Ft),_e.uniforms=Mt.uniforms;const it=_e.uniforms;return(!Y.isShaderMaterial&&!Y.isRawShaderMaterial||Y.clipping===!0)&&(it.clippingPlanes=xt.uniform),no(Y,Mt),_e.needsLights=Rh(Y),_e.lightsStateVersion=pt,_e.needsLights&&(it.ambientLightColor.value=ve.state.ambient,it.lightProbe.value=ve.state.probe,it.directionalLights.value=ve.state.directional,it.directionalLightShadows.value=ve.state.directionalShadow,it.spotLights.value=ve.state.spot,it.spotLightShadows.value=ve.state.spotShadow,it.rectAreaLights.value=ve.state.rectArea,it.ltc_1.value=ve.state.rectAreaLTC1,it.ltc_2.value=ve.state.rectAreaLTC2,it.pointLights.value=ve.state.point,it.pointLightShadows.value=ve.state.pointShadow,it.hemisphereLights.value=ve.state.hemi,it.directionalShadowMap.value=ve.state.directionalShadowMap,it.directionalShadowMatrix.value=ve.state.directionalShadowMatrix,it.spotShadowMap.value=ve.state.spotShadowMap,it.spotLightMatrix.value=ve.state.spotLightMatrix,it.spotLightMap.value=ve.state.spotLightMap,it.pointShadowMap.value=ve.state.pointShadowMap,it.pointShadowMatrix.value=ve.state.pointShadowMatrix),_e.currentProgram=Ft,_e.uniformsList=null,Ft}function Th(Y){if(Y.uniformsList===null){const xe=Y.currentProgram.getUniforms();Y.uniformsList=vy.seqWithValue(xe.seq,Y.uniforms)}return Y.uniformsList}function no(Y,xe){const Ne=qe.get(Y);Ne.outputColorSpace=xe.outputColorSpace,Ne.batching=xe.batching,Ne.batchingColor=xe.batchingColor,Ne.instancing=xe.instancing,Ne.instancingColor=xe.instancingColor,Ne.instancingMorph=xe.instancingMorph,Ne.skinning=xe.skinning,Ne.morphTargets=xe.morphTargets,Ne.morphNormals=xe.morphNormals,Ne.morphColors=xe.morphColors,Ne.morphTargetsCount=xe.morphTargetsCount,Ne.numClippingPlanes=xe.numClippingPlanes,Ne.numIntersection=xe.numClipIntersection,Ne.vertexAlphas=xe.vertexAlphas,Ne.vertexTangents=xe.vertexTangents,Ne.toneMapping=xe.toneMapping}function Ch(Y,xe,Ne,_e,ve){xe.isScene!==!0&&(xe=dt),nt.resetTextureUnits();const et=xe.fog,pt=_e.isMeshStandardMaterial?xe.environment:null,Mt=L===null?A.outputColorSpace:L.isXRRenderTarget===!0?L.texture.colorSpace:hh,_t=(_e.isMeshStandardMaterial?Q:jt).get(_e.envMap||pt),Vt=_e.vertexColors===!0&&!!Ne.attributes.color&&Ne.attributes.color.itemSize===4,Ft=!!Ne.attributes.tangent&&(!!_e.normalMap||_e.anisotropy>0),it=!!Ne.morphAttributes.position,Nt=!!Ne.morphAttributes.normal,Kt=!!Ne.morphAttributes.color;let un=Ua;_e.toneMapped&&(L===null||L.isXRRenderTarget===!0)&&(un=A.toneMapping);const _n=Ne.morphAttributes.position||Ne.morphAttributes.normal||Ne.morphAttributes.color,dn=_n!==void 0?_n.length:0,kt=qe.get(_e),En=S.state.lights;if(Ee===!0&&(Fe===!0||Y!==I)){const zr=Y===I&&_e.id===O;xt.setState(_e,Y,zr)}let gn=!1;_e.version===kt.__version?(kt.needsLights&&kt.lightsStateVersion!==En.state.version||kt.outputColorSpace!==Mt||ve.isBatchedMesh&&kt.batching===!1||!ve.isBatchedMesh&&kt.batching===!0||ve.isBatchedMesh&&kt.batchingColor===!0&&ve.colorTexture===null||ve.isBatchedMesh&&kt.batchingColor===!1&&ve.colorTexture!==null||ve.isInstancedMesh&&kt.instancing===!1||!ve.isInstancedMesh&&kt.instancing===!0||ve.isSkinnedMesh&&kt.skinning===!1||!ve.isSkinnedMesh&&kt.skinning===!0||ve.isInstancedMesh&&kt.instancingColor===!0&&ve.instanceColor===null||ve.isInstancedMesh&&kt.instancingColor===!1&&ve.instanceColor!==null||ve.isInstancedMesh&&kt.instancingMorph===!0&&ve.morphTexture===null||ve.isInstancedMesh&&kt.instancingMorph===!1&&ve.morphTexture!==null||kt.envMap!==_t||_e.fog===!0&&kt.fog!==et||kt.numClippingPlanes!==void 0&&(kt.numClippingPlanes!==xt.numPlanes||kt.numIntersection!==xt.numIntersection)||kt.vertexAlphas!==Vt||kt.vertexTangents!==Ft||kt.morphTargets!==it||kt.morphNormals!==Nt||kt.morphColors!==Kt||kt.toneMapping!==un||kt.morphTargetsCount!==dn)&&(gn=!0):(gn=!0,kt.__version=_e.version);let Br=kt.currentProgram;gn===!0&&(Br=ic(_e,xe,ve));let bo=!1,Nr=!1,ro=!1;const wn=Br.getUniforms(),es=kt.uniforms;if(Ae.useProgram(Br.program)&&(bo=!0,Nr=!0,ro=!0),_e.id!==O&&(O=_e.id,Nr=!0),bo||I!==Y){Ae.buffers.depth.getReversed()?(me.copy(Y.projectionMatrix),qW(me),XW(me),wn.setValue($,"projectionMatrix",me)):wn.setValue($,"projectionMatrix",Y.projectionMatrix),wn.setValue($,"viewMatrix",Y.matrixWorldInverse);const ur=wn.map.cameraPosition;ur!==void 0&&ur.setValue($,Xe.setFromMatrixPosition(Y.matrixWorld)),Ge.logarithmicDepthBuffer&&wn.setValue($,"logDepthBufFC",2/(Math.log(Y.far+1)/Math.LN2)),(_e.isMeshPhongMaterial||_e.isMeshToonMaterial||_e.isMeshLambertMaterial||_e.isMeshBasicMaterial||_e.isMeshStandardMaterial||_e.isShaderMaterial)&&wn.setValue($,"isOrthographic",Y.isOrthographicCamera===!0),I!==Y&&(I=Y,Nr=!0,ro=!0)}if(ve.isSkinnedMesh){wn.setOptional($,ve,"bindMatrix"),wn.setOptional($,ve,"bindMatrixInverse");const zr=ve.skeleton;zr&&(zr.boneTexture===null&&zr.computeBoneTexture(),wn.setValue($,"boneTexture",zr.boneTexture,nt))}ve.isBatchedMesh&&(wn.setOptional($,ve,"batchingTexture"),wn.setValue($,"batchingTexture",ve._matricesTexture,nt),wn.setOptional($,ve,"batchingIdTexture"),wn.setValue($,"batchingIdTexture",ve._indirectTexture,nt),wn.setOptional($,ve,"batchingColorTexture"),ve._colorsTexture!==null&&wn.setValue($,"batchingColorTexture",ve._colorsTexture,nt));const Pr=Ne.morphAttributes;if((Pr.position!==void 0||Pr.normal!==void 0||Pr.color!==void 0)&&ft.update(ve,Ne,Br),(Nr||kt.receiveShadow!==ve.receiveShadow)&&(kt.receiveShadow=ve.receiveShadow,wn.setValue($,"receiveShadow",ve.receiveShadow)),_e.isMeshGouraudMaterial&&_e.envMap!==null&&(es.envMap.value=_t,es.flipEnvMap.value=_t.isCubeTexture&&_t.isRenderTargetTexture===!1?-1:1),_e.isMeshStandardMaterial&&_e.envMap===null&&xe.environment!==null&&(es.envMapIntensity.value=xe.environmentIntensity),Nr&&(wn.setValue($,"toneMappingExposure",A.toneMappingExposure),kt.needsLights&&Ah(es,ro),et&&_e.fog===!0&&Le.refreshFogUniforms(es,et),Le.refreshMaterialUniforms(es,_e,V,ce,S.state.transmissionRenderTarget[Y.id]),vy.upload($,Th(kt),es,nt)),_e.isShaderMaterial&&_e.uniformsNeedUpdate===!0&&(vy.upload($,Th(kt),es,nt),_e.uniformsNeedUpdate=!1),_e.isSpriteMaterial&&wn.setValue($,"center",ve.center),wn.setValue($,"modelViewMatrix",ve.modelViewMatrix),wn.setValue($,"normalMatrix",ve.normalMatrix),wn.setValue($,"modelMatrix",ve.matrixWorld),_e.isShaderMaterial||_e.isRawShaderMaterial){const zr=_e.uniformsGroups;for(let ur=0,Sn=zr.length;ur<Sn;ur++){const Cs=zr[ur];ae.update(Cs,Br),ae.bind(Cs,Br)}}return Br}function Ah(Y,xe){Y.ambientLightColor.needsUpdate=xe,Y.lightProbe.needsUpdate=xe,Y.directionalLights.needsUpdate=xe,Y.directionalLightShadows.needsUpdate=xe,Y.pointLights.needsUpdate=xe,Y.pointLightShadows.needsUpdate=xe,Y.spotLights.needsUpdate=xe,Y.spotLightShadows.needsUpdate=xe,Y.rectAreaLights.needsUpdate=xe,Y.hemisphereLights.needsUpdate=xe}function Rh(Y){return Y.isMeshLambertMaterial||Y.isMeshToonMaterial||Y.isMeshPhongMaterial||Y.isMeshStandardMaterial||Y.isShadowMaterial||Y.isShaderMaterial&&Y.lights===!0}this.getActiveCubeFace=function(){return j},this.getActiveMipmapLevel=function(){return D},this.getRenderTarget=function(){return L},this.setRenderTargetTextures=function(Y,xe,Ne){const _e=qe.get(Y);_e.__autoAllocateDepthBuffer=Y.resolveDepthBuffer===!1,_e.__autoAllocateDepthBuffer===!1&&(_e.__useRenderToTexture=!1),qe.get(Y.texture).__webglTexture=xe,qe.get(Y.depthTexture).__webglTexture=_e.__autoAllocateDepthBuffer?void 0:Ne,_e.__hasExternalTextures=!0},this.setRenderTargetFramebuffer=function(Y,xe){const Ne=qe.get(Y);Ne.__webglFramebuffer=xe,Ne.__useDefaultFramebuffer=xe===void 0};const Nh=$.createFramebuffer();this.setRenderTarget=function(Y,xe=0,Ne=0){L=Y,j=xe,D=Ne;let _e=!0,ve=null,et=!1,pt=!1;if(Y){const _t=qe.get(Y);if(_t.__useDefaultFramebuffer!==void 0)Ae.bindFramebuffer($.FRAMEBUFFER,null),_e=!1;else if(_t.__webglFramebuffer===void 0)nt.setupRenderTarget(Y);else if(_t.__hasExternalTextures)nt.rebindTextures(Y,qe.get(Y.texture).__webglTexture,qe.get(Y.depthTexture).__webglTexture);else if(Y.depthBuffer){const it=Y.depthTexture;if(_t.__boundDepthTexture!==it){if(it!==null&&qe.has(it)&&(Y.width!==it.image.width||Y.height!==it.image.height))throw new Error("WebGLRenderTarget: Attached DepthTexture is initialized to the incorrect size.");nt.setupDepthRenderbuffer(Y)}}const Vt=Y.texture;(Vt.isData3DTexture||Vt.isDataArrayTexture||Vt.isCompressedArrayTexture)&&(pt=!0);const Ft=qe.get(Y).__webglFramebuffer;Y.isWebGLCubeRenderTarget?(Array.isArray(Ft[xe])?ve=Ft[xe][Ne]:ve=Ft[xe],et=!0):Y.samples>0&&nt.useMultisampledRTT(Y)===!1?ve=qe.get(Y).__webglMultisampledFramebuffer:Array.isArray(Ft)?ve=Ft[Ne]:ve=Ft,B.copy(Y.viewport),W.copy(Y.scissor),K=Y.scissorTest}else B.copy(X).multiplyScalar(V).floor(),W.copy(ie).multiplyScalar(V).floor(),K=be;if(Ne!==0&&(ve=Nh),Ae.bindFramebuffer($.FRAMEBUFFER,ve)&&_e&&Ae.drawBuffers(Y,ve),Ae.viewport(B),Ae.scissor(W),Ae.setScissorTest(K),et){const _t=qe.get(Y.texture);$.framebufferTexture2D($.FRAMEBUFFER,$.COLOR_ATTACHMENT0,$.TEXTURE_CUBE_MAP_POSITIVE_X+xe,_t.__webglTexture,Ne)}else if(pt){const _t=qe.get(Y.texture),Vt=xe;$.framebufferTextureLayer($.FRAMEBUFFER,$.COLOR_ATTACHMENT0,_t.__webglTexture,Ne,Vt)}else if(Y!==null&&Ne!==0){const _t=qe.get(Y.texture);$.framebufferTexture2D($.FRAMEBUFFER,$.COLOR_ATTACHMENT0,$.TEXTURE_2D,_t.__webglTexture,Ne)}O=-1},this.readRenderTargetPixels=function(Y,xe,Ne,_e,ve,et,pt,Mt=0){if(!(Y&&Y.isWebGLRenderTarget)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");return}let _t=qe.get(Y).__webglFramebuffer;if(Y.isWebGLCubeRenderTarget&&pt!==void 0&&(_t=_t[pt]),_t){Ae.bindFramebuffer($.FRAMEBUFFER,_t);try{const Vt=Y.textures[Mt],Ft=Vt.format,it=Vt.type;if(!Ge.textureFormatReadable(Ft)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");return}if(!Ge.textureTypeReadable(it)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");return}xe>=0&&xe<=Y.width-_e&&Ne>=0&&Ne<=Y.height-ve&&(Y.textures.length>1&&$.readBuffer($.COLOR_ATTACHMENT0+Mt),$.readPixels(xe,Ne,_e,ve,Se.convert(Ft),Se.convert(it),et))}finally{const Vt=L!==null?qe.get(L).__webglFramebuffer:null;Ae.bindFramebuffer($.FRAMEBUFFER,Vt)}}},this.readRenderTargetPixelsAsync=async function(Y,xe,Ne,_e,ve,et,pt,Mt=0){if(!(Y&&Y.isWebGLRenderTarget))throw new Error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");let _t=qe.get(Y).__webglFramebuffer;if(Y.isWebGLCubeRenderTarget&&pt!==void 0&&(_t=_t[pt]),_t)if(xe>=0&&xe<=Y.width-_e&&Ne>=0&&Ne<=Y.height-ve){Ae.bindFramebuffer($.FRAMEBUFFER,_t);const Vt=Y.textures[Mt],Ft=Vt.format,it=Vt.type;if(!Ge.textureFormatReadable(Ft))throw new Error("THREE.WebGLRenderer.readRenderTargetPixelsAsync: renderTarget is not in RGBA or implementation defined format.");if(!Ge.textureTypeReadable(it))throw new Error("THREE.WebGLRenderer.readRenderTargetPixelsAsync: renderTarget is not in UnsignedByteType or implementation defined type.");const Nt=$.createBuffer();$.bindBuffer($.PIXEL_PACK_BUFFER,Nt),$.bufferData($.PIXEL_PACK_BUFFER,et.byteLength,$.STREAM_READ),Y.textures.length>1&&$.readBuffer($.COLOR_ATTACHMENT0+Mt),$.readPixels(xe,Ne,_e,ve,Se.convert(Ft),Se.convert(it),0);const Kt=L!==null?qe.get(L).__webglFramebuffer:null;Ae.bindFramebuffer($.FRAMEBUFFER,Kt);const un=$.fenceSync($.SYNC_GPU_COMMANDS_COMPLETE,0);return $.flush(),await $W($,un,4),$.bindBuffer($.PIXEL_PACK_BUFFER,Nt),$.getBufferSubData($.PIXEL_PACK_BUFFER,0,et),$.deleteBuffer(Nt),$.deleteSync(un),et}else throw new Error("THREE.WebGLRenderer.readRenderTargetPixelsAsync: requested read bounds are out of range.")},this.copyFramebufferToTexture=function(Y,xe=null,Ne=0){const _e=Math.pow(2,-Ne),ve=Math.floor(Y.image.width*_e),et=Math.floor(Y.image.height*_e),pt=xe!==null?xe.x:0,Mt=xe!==null?xe.y:0;nt.setTexture2D(Y,0),$.copyTexSubImage2D($.TEXTURE_2D,Ne,0,0,pt,Mt,ve,et),Ae.unbindTexture()};const Ph=$.createFramebuffer(),Ih=$.createFramebuffer();this.copyTextureToTexture=function(Y,xe,Ne=null,_e=null,ve=0,et=null){et===null&&(ve!==0?(Tp("WebGLRenderer: copyTextureToTexture function signature has changed to support src and dst mipmap levels."),et=ve,ve=0):et=0);let pt,Mt,_t,Vt,Ft,it,Nt,Kt,un;const _n=Y.isCompressedTexture?Y.mipmaps[et]:Y.image;if(Ne!==null)pt=Ne.max.x-Ne.min.x,Mt=Ne.max.y-Ne.min.y,_t=Ne.isBox3?Ne.max.z-Ne.min.z:1,Vt=Ne.min.x,Ft=Ne.min.y,it=Ne.isBox3?Ne.min.z:0;else{const Pr=Math.pow(2,-ve);pt=Math.floor(_n.width*Pr),Mt=Math.floor(_n.height*Pr),Y.isDataArrayTexture?_t=_n.depth:Y.isData3DTexture?_t=Math.floor(_n.depth*Pr):_t=1,Vt=0,Ft=0,it=0}_e!==null?(Nt=_e.x,Kt=_e.y,un=_e.z):(Nt=0,Kt=0,un=0);const dn=Se.convert(xe.format),kt=Se.convert(xe.type);let En;xe.isData3DTexture?(nt.setTexture3D(xe,0),En=$.TEXTURE_3D):xe.isDataArrayTexture||xe.isCompressedArrayTexture?(nt.setTexture2DArray(xe,0),En=$.TEXTURE_2D_ARRAY):(nt.setTexture2D(xe,0),En=$.TEXTURE_2D),$.pixelStorei($.UNPACK_FLIP_Y_WEBGL,xe.flipY),$.pixelStorei($.UNPACK_PREMULTIPLY_ALPHA_WEBGL,xe.premultiplyAlpha),$.pixelStorei($.UNPACK_ALIGNMENT,xe.unpackAlignment);const gn=$.getParameter($.UNPACK_ROW_LENGTH),Br=$.getParameter($.UNPACK_IMAGE_HEIGHT),bo=$.getParameter($.UNPACK_SKIP_PIXELS),Nr=$.getParameter($.UNPACK_SKIP_ROWS),ro=$.getParameter($.UNPACK_SKIP_IMAGES);$.pixelStorei($.UNPACK_ROW_LENGTH,_n.width),$.pixelStorei($.UNPACK_IMAGE_HEIGHT,_n.height),$.pixelStorei($.UNPACK_SKIP_PIXELS,Vt),$.pixelStorei($.UNPACK_SKIP_ROWS,Ft),$.pixelStorei($.UNPACK_SKIP_IMAGES,it);const wn=Y.isDataArrayTexture||Y.isData3DTexture,es=xe.isDataArrayTexture||xe.isData3DTexture;if(Y.isDepthTexture){const Pr=qe.get(Y),zr=qe.get(xe),ur=qe.get(Pr.__renderTarget),Sn=qe.get(zr.__renderTarget);Ae.bindFramebuffer($.READ_FRAMEBUFFER,ur.__webglFramebuffer),Ae.bindFramebuffer($.DRAW_FRAMEBUFFER,Sn.__webglFramebuffer);for(let Cs=0;Cs<_t;Cs++)wn&&($.framebufferTextureLayer($.READ_FRAMEBUFFER,$.COLOR_ATTACHMENT0,qe.get(Y).__webglTexture,ve,it+Cs),$.framebufferTextureLayer($.DRAW_FRAMEBUFFER,$.COLOR_ATTACHMENT0,qe.get(xe).__webglTexture,et,un+Cs)),$.blitFramebuffer(Vt,Ft,pt,Mt,Nt,Kt,pt,Mt,$.DEPTH_BUFFER_BIT,$.NEAREST);Ae.bindFramebuffer($.READ_FRAMEBUFFER,null),Ae.bindFramebuffer($.DRAW_FRAMEBUFFER,null)}else if(ve!==0||Y.isRenderTargetTexture||qe.has(Y)){const Pr=qe.get(Y),zr=qe.get(xe);Ae.bindFramebuffer($.READ_FRAMEBUFFER,Ph),Ae.bindFramebuffer($.DRAW_FRAMEBUFFER,Ih);for(let ur=0;ur<_t;ur++)wn?$.framebufferTextureLayer($.READ_FRAMEBUFFER,$.COLOR_ATTACHMENT0,Pr.__webglTexture,ve,it+ur):$.framebufferTexture2D($.READ_FRAMEBUFFER,$.COLOR_ATTACHMENT0,$.TEXTURE_2D,Pr.__webglTexture,ve),es?$.framebufferTextureLayer($.DRAW_FRAMEBUFFER,$.COLOR_ATTACHMENT0,zr.__webglTexture,et,un+ur):$.framebufferTexture2D($.DRAW_FRAMEBUFFER,$.COLOR_ATTACHMENT0,$.TEXTURE_2D,zr.__webglTexture,et),ve!==0?$.blitFramebuffer(Vt,Ft,pt,Mt,Nt,Kt,pt,Mt,$.COLOR_BUFFER_BIT,$.NEAREST):es?$.copyTexSubImage3D(En,et,Nt,Kt,un+ur,Vt,Ft,pt,Mt):$.copyTexSubImage2D(En,et,Nt,Kt,Vt,Ft,pt,Mt);Ae.bindFramebuffer($.READ_FRAMEBUFFER,null),Ae.bindFramebuffer($.DRAW_FRAMEBUFFER,null)}else es?Y.isDataTexture||Y.isData3DTexture?$.texSubImage3D(En,et,Nt,Kt,un,pt,Mt,_t,dn,kt,_n.data):xe.isCompressedArrayTexture?$.compressedTexSubImage3D(En,et,Nt,Kt,un,pt,Mt,_t,dn,_n.data):$.texSubImage3D(En,et,Nt,Kt,un,pt,Mt,_t,dn,kt,_n):Y.isDataTexture?$.texSubImage2D($.TEXTURE_2D,et,Nt,Kt,pt,Mt,dn,kt,_n.data):Y.isCompressedTexture?$.compressedTexSubImage2D($.TEXTURE_2D,et,Nt,Kt,_n.width,_n.height,dn,_n.data):$.texSubImage2D($.TEXTURE_2D,et,Nt,Kt,pt,Mt,dn,kt,_n);$.pixelStorei($.UNPACK_ROW_LENGTH,gn),$.pixelStorei($.UNPACK_IMAGE_HEIGHT,Br),$.pixelStorei($.UNPACK_SKIP_PIXELS,bo),$.pixelStorei($.UNPACK_SKIP_ROWS,Nr),$.pixelStorei($.UNPACK_SKIP_IMAGES,ro),et===0&&xe.generateMipmaps&&$.generateMipmap(En),Ae.unbindTexture()},this.copyTextureToTexture3D=function(Y,xe,Ne=null,_e=null,ve=0){return Tp('WebGLRenderer: copyTextureToTexture3D function has been deprecated. Use "copyTextureToTexture" instead.'),this.copyTextureToTexture(Y,xe,Ne,_e,ve)},this.initRenderTarget=function(Y){qe.get(Y).__webglFramebuffer===void 0&&nt.setupRenderTarget(Y)},this.initTexture=function(Y){Y.isCubeTexture?nt.setTextureCube(Y,0):Y.isData3DTexture?nt.setTexture3D(Y,0):Y.isDataArrayTexture||Y.isCompressedArrayTexture?nt.setTexture2DArray(Y,0):nt.setTexture2D(Y,0),Ae.unbindTexture()},this.resetState=function(){j=0,D=0,L=null,Ae.reset(),Ze.reset()},typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}get coordinateSystem(){return xo}get outputColorSpace(){return this._outputColorSpace}set outputColorSpace(e){this._outputColorSpace=e;const t=this.getContext();t.drawingBufferColorSpace=kn._getDrawingBufferColorSpace(e),t.unpackColorSpace=kn._getUnpackColorSpace()}}const iZ=Object.freeze(Object.defineProperty({__proto__:null,ACESFilmicToneMapping:iM,AddEquation:Qc,AddOperation:g4,AdditiveAnimationBlendMode:pM,AdditiveBlending:Ib,AgXToneMapping:w4,AlphaFormat:uM,AlwaysCompare:O4,AlwaysDepth:Ly,AlwaysStencilFunc:Ob,AmbientLight:ND,AnimationAction:UD,AnimationClip:A0,AnimationLoader:_q,AnimationMixer:Yq,AnimationObjectGroup:qq,AnimationUtils:gq,ArcCurve:tD,ArrayCamera:OD,ArrowHelper:gX,AttachedBindMode:Lb,Audio:jD,AudioAnalyser:jq,AudioContext:UM,AudioListener:Dq,AudioLoader:Pq,AxesHelper:vX,BackSide:ci,BasicDepthPacking:C4,BasicShadowMap:Kk,BatchedMesh:K4,Bone:SM,BooleanKeyframeTrack:bh,Box2:nX,Box3:Ws,Box3Helper:pX,BoxGeometry:Sh,BoxHelper:fX,BufferAttribute:Kn,BufferGeometry:mn,BufferGeometryLoader:LD,ByteType:aM,Cache:Gl,Camera:q0,CameraHelper:hX,CanvasTexture:U$,CapsuleGeometry:mw,CatmullRomCurve3:nD,CineonToneMapping:y4,CircleGeometry:gw,ClampToEdgeWrapping:vo,Clock:BM,Color:St,ColorKeyframeTrack:OM,ColorManagement:kn,CompressedArrayTexture:j$,CompressedCubeTexture:F$,CompressedTexture:pw,CompressedTextureLoader:wq,ConeGeometry:K0,ConstantAlphaFactor:f4,ConstantColorFactor:d4,Controls:yX,CubeCamera:H4,CubeReflectionMapping:ec,CubeRefractionMapping:xu,CubeTexture:X0,CubeTextureLoader:Sq,CubeUVReflectionMapping:hm,CubicBezierCurve:TM,CubicBezierCurve3:rD,CubicInterpolant:SD,CullFaceBack:Pb,CullFaceFront:Yk,CullFaceFrontBack:WG,CullFaceNone:Xk,Curve:da,CurvePath:iD,CustomBlending:Qk,CustomToneMapping:_4,CylinderGeometry:Y0,Cylindrical:tX,Data3DTexture:lw,DataArrayTexture:aw,DataTexture:Ba,DataTextureLoader:bq,DataUtils:c$,DecrementStencilOp:iW,DecrementWrapStencilOp:aW,DefaultLoadingManager:MD,DepthFormat:Wp,DepthStencilFormat:$p,DepthTexture:EM,DetachedBindMode:b4,DirectionalLight:RD,DirectionalLightHelper:dX,DiscreteInterpolant:bD,DodecahedronGeometry:vw,DoubleSide:ka,DstAlphaFactor:o4,DstColorFactor:l4,DynamicCopyUsage:SW,DynamicDrawUsage:gW,DynamicReadUsage:yW,EdgesGeometry:eD,EllipseCurve:xw,EqualCompare:I4,EqualDepth:jy,EqualStencilFunc:dW,EquirectangularReflectionMapping:f0,EquirectangularRefractionMapping:p0,Euler:eo,EventDispatcher:Xa,ExtrudeGeometry:yw,FileLoader:nc,Float16BufferAttribute:g$,Float32BufferAttribute:It,FloatType:Ii,Fog:uw,FogExp2:cw,FramebufferTexture:O$,FrontSide:Zl,Frustum:pm,FrustumArray:fw,GLBufferAttribute:eX,GLSL1:EW,GLSL3:jb,GreaterCompare:k4,GreaterDepth:Uy,GreaterEqualCompare:L4,GreaterEqualDepth:Fy,GreaterEqualStencilFunc:mW,GreaterStencilFunc:fW,GridHelper:cX,Group:yp,HalfFloatType:fm,HemisphereLight:TD,HemisphereLightHelper:lX,IcosahedronGeometry:_w,ImageBitmapLoader:Nq,ImageLoader:R0,ImageUtils:U4,IncrementStencilOp:sW,IncrementWrapStencilOp:oW,InstancedBufferAttribute:Yp,InstancedBufferGeometry:DD,InstancedInterleavedBuffer:Zq,InstancedMesh:Y4,Int16BufferAttribute:p$,Int32BufferAttribute:m$,Int8BufferAttribute:d$,IntType:ew,InterleavedBuffer:dw,InterleavedBufferAttribute:fh,Interpolant:Z0,InterpolateDiscrete:v0,InterpolateLinear:f_,InterpolateSmooth:my,InterpolationSamplingMode:CW,InterpolationSamplingType:TW,InvertStencilOp:lW,KeepStencilOp:Id,KeyframeTrack:So,LOD:q4,LatheGeometry:ww,Layers:Zd,LessCompare:P4,LessDepth:Oy,LessEqualCompare:mM,LessEqualDepth:dh,LessEqualStencilFunc:hW,LessStencilFunc:uW,Light:Au,LightProbe:kD,Line:yu,Line3:rX,LineBasicMaterial:di,LineCurve:CM,LineCurve3:sD,LineDashedMaterial:yD,LineLoop:Q4,LineSegments:Ya,LinearFilter:Qr,LinearInterpolant:LM,LinearMipMapLinearFilter:YG,LinearMipMapNearestFilter:XG,LinearMipmapLinearFilter:La,LinearMipmapNearestFilter:$g,LinearSRGBColorSpace:hh,LinearToneMapping:v4,LinearTransfer:y0,Loader:Li,LoaderUtils:Vb,LoadingManager:jM,LoopOnce:E4,LoopPingPong:T4,LoopRepeat:M4,MOUSE:Nd,Material:$s,MaterialLoader:Aw,MathUtils:GW,Matrix2:GM,Matrix3:cn,Matrix4:Jt,MaxEquation:t4,Mesh:Ur,MeshBasicMaterial:Tu,MeshDepthMaterial:IM,MeshDistanceMaterial:kM,MeshLambertMaterial:vD,MeshMatcapMaterial:xD,MeshNormalMaterial:gD,MeshPhongMaterial:pD,MeshPhysicalMaterial:fD,MeshStandardMaterial:PM,MeshToonMaterial:mD,MinEquation:e4,MirroredRepeatWrapping:g0,MixOperation:m4,MultiplyBlending:Db,MultiplyOperation:W0,NearestFilter:Ss,NearestMipMapLinearFilter:qG,NearestMipMapNearestFilter:$G,NearestMipmapLinearFilter:vp,NearestMipmapNearestFilter:oM,NeutralToneMapping:S4,NeverCompare:N4,NeverDepth:Dy,NeverStencilFunc:cW,NoBlending:Wl,NoColorSpace:Vl,NoToneMapping:Ua,NormalAnimationBlendMode:ow,NormalBlending:Qd,NotEqualCompare:D4,NotEqualDepth:By,NotEqualStencilFunc:pW,NumberKeyframeTrack:T0,Object3D:jn,ObjectLoader:Aq,ObjectSpaceNormalMap:R4,OctahedronGeometry:Q0,OneFactor:r4,OneMinusConstantAlphaFactor:p4,OneMinusConstantColorFactor:h4,OneMinusDstAlphaFactor:a4,OneMinusDstColorFactor:c4,OneMinusSrcAlphaFactor:ky,OneMinusSrcColorFactor:i4,OrthographicCamera:hu,PCFShadowMap:J_,PCFSoftShadowMap:Wg,PMREMGenerator:$b,Path:v_,PerspectiveCamera:Cr,Plane:Bl,PlaneGeometry:mm,PlaneHelper:mX,PointLight:AD,PointLightHelper:oX,Points:J4,PointsMaterial:bM,PolarGridHelper:uX,PolyhedronGeometry:Cu,PositionalAudio:Oq,PropertyBinding:Ln,PropertyMixer:FD,QuadraticBezierCurve:AM,QuadraticBezierCurve3:RM,Quaternion:Gs,QuaternionKeyframeTrack:ev,QuaternionLinearInterpolant:ED,RED_GREEN_RGTC2_Format:d_,RED_RGTC1_Format:fM,REVISION:Q_,RGBADepthPacking:A4,RGBAFormat:Vs,RGBAIntegerFormat:iw,RGBA_ASTC_10x10_Format:i_,RGBA_ASTC_10x5_Format:n_,RGBA_ASTC_10x6_Format:r_,RGBA_ASTC_10x8_Format:s_,RGBA_ASTC_12x10_Format:o_,RGBA_ASTC_12x12_Format:a_,RGBA_ASTC_4x4_Format:Xy,RGBA_ASTC_5x4_Format:Yy,RGBA_ASTC_5x5_Format:Ky,RGBA_ASTC_6x5_Format:Qy,RGBA_ASTC_6x6_Format:Jy,RGBA_ASTC_8x5_Format:Zy,RGBA_ASTC_8x6_Format:e_,RGBA_ASTC_8x8_Format:t_,RGBA_BPTC_Format:Qg,RGBA_ETC2_EAC_Format:qy,RGBA_PVRTC_2BPPV1_Format:Gy,RGBA_PVRTC_4BPPV1_Format:Hy,RGBA_S3TC_DXT1_Format:Xg,RGBA_S3TC_DXT3_Format:Yg,RGBA_S3TC_DXT5_Format:Kg,RGBDepthPacking:eW,RGBFormat:dM,RGBIntegerFormat:KG,RGB_BPTC_SIGNED_Format:l_,RGB_BPTC_UNSIGNED_Format:c_,RGB_ETC1_Format:Wy,RGB_ETC2_Format:$y,RGB_PVRTC_2BPPV1_Format:Vy,RGB_PVRTC_4BPPV1_Format:zy,RGB_S3TC_DXT1_Format:qg,RGDepthPacking:tW,RGFormat:hM,RGIntegerFormat:sw,RawShaderMaterial:hD,Ray:wh,Raycaster:BD,RectAreaLight:PD,RedFormat:rw,RedIntegerFormat:$0,ReinhardToneMapping:x4,RenderTarget:vM,RenderTarget3D:Kq,RepeatWrapping:m0,ReplaceStencilOp:rW,ReverseSubtractEquation:Zk,RingGeometry:Sw,SIGNED_RED_GREEN_RGTC2_Format:h_,SIGNED_RED_RGTC1_Format:u_,SRGBColorSpace:Ni,SRGBTransfer:Wn,Scene:_M,ShaderChunk:yn,ShaderLib:sa,ShaderMaterial:la,ShadowMaterial:dD,Shape:eh,ShapeGeometry:bw,ShapePath:xX,ShapeUtils:ia,ShortType:lM,Skeleton:hw,SkeletonHelper:iX,SkinnedMesh:X4,Source:au,Sphere:bs,SphereGeometry:J0,Spherical:Gb,SphericalHarmonics3:ID,SplineCurve:NM,SpotLight:CD,SpotLightHelper:sX,Sprite:$4,SpriteMaterial:wM,SrcAlphaFactor:Iy,SrcAlphaSaturateFactor:u4,SrcColorFactor:s4,StaticCopyUsage:wW,StaticDrawUsage:_0,StaticReadUsage:xW,StereoCamera:Iq,StreamCopyUsage:bW,StreamDrawUsage:vW,StreamReadUsage:_W,StringKeyframeTrack:Eh,SubtractEquation:Jk,SubtractiveBlending:kb,TOUCH:Pd,TangentSpaceNormalMap:Mu,TetrahedronGeometry:Ew,Texture:_r,TextureLoader:Eq,TextureUtils:EX,TimestampQuery:MW,TorusGeometry:Mw,TorusKnotGeometry:Tw,Triangle:Pi,TriangleFanDrawMode:ZG,TriangleStripDrawMode:JG,TrianglesDrawMode:QG,TubeGeometry:Cw,UVMapping:Z_,Uint16BufferAttribute:xM,Uint32BufferAttribute:yM,Uint8BufferAttribute:h$,Uint8ClampedBufferAttribute:f$,Uniform:HM,UniformsGroup:Jq,UniformsLib:vt,UniformsUtils:V4,UnsignedByteType:_o,UnsignedInt248Type:Gp,UnsignedInt5999Type:cM,UnsignedIntType:tc,UnsignedShort4444Type:tw,UnsignedShort5551Type:nw,UnsignedShortType:Hp,VSMShadowMap:Zo,Vector2:Ve,Vector3:J,Vector4:On,VectorKeyframeTrack:C0,VideoFrameTexture:L$,VideoTexture:Z4,WebGL3DRenderTarget:ZW,WebGLArrayRenderTarget:JW,WebGLCoordinateSystem:xo,WebGLCubeRenderTarget:G4,WebGLRenderTarget:Ga,WebGLRenderer:XD,WebGLUtils:qD,WebGPUCoordinateSystem:w0,WebXRController:gy,WireframeGeometry:uD,WrapAroundEnding:x0,ZeroCurvatureEnding:jd,ZeroFactor:n4,ZeroSlopeEnding:Fd,ZeroStencilOp:nW,createCanvasElement:F4},Symbol.toStringTag,{value:"Module"})),oZ=800,aZ=600,lZ=.5,cZ=.1,WA="#FF1493",YD=["#00CED1","#FF6347","#FFD700","#9ACD32","#FFA500"],uZ=r=>{const e=R.useMemo(()=>(r||[]).map((s,i)=>{const o=s.x/oZ*40-20,a=s.y/aZ*20-10,c=i*cZ;return[o,c,a]}),[r]),t=R.useMemo(()=>{if(!e||e.length===0)return[];const s=YD,i=e.length,o=new Array(i).fill(null);i>0&&(o[i-1]=WA);const a=o.filter(c=>c===null).length;if(a>0){const c=[],f=(v=>{let x=v.length,_;for(;x!==0;)_=Math.floor(Math.random()*x),x--,[v[x],v[_]]=[v[_],v[x]];return v})([...s]);for(c.push(...f.slice(0,Math.min(a,5)));c.length<a;){const v=c.slice(-4),x=s.filter(w=>!v.includes(w)),_=x.length>0?x:s,b=_[Math.floor(Math.random()*_.length)];c.push(b)}let m=0;for(let v=0;v<i;v++)o[v]===null&&(o[v]=c[m++])}return o},[e]),n=R.useMemo(()=>{if(!e||e.length===0)return[0,0,0];const s=e[0];return[s[0],s[1]+.1+.2,s[2]]},[e]);return{worldPoints:e,tileColors:t,playerTokenPosition:n,TILE_SIZE:lZ,RAINBOW_COLOR:WA}},dZ=r=>[...r].sort(()=>Math.random()-.5),hZ=({lesson:r,lessonNumber:e,currentQuestionIndex:t,onAnswerSubmit:n,colors:s})=>{const[i,o]=R.useState(null),a=r.questions[t],c=R.useMemo(()=>{if(!a)return{};const m=dZ(s),v={};return a.choices.forEach((x,_)=>{v[x.id]=m[_%m.length]}),v},[a,s]);if(R.useEffect(()=>{o(null)},[a]),!a)return h.jsxs(Wt,{children:[h.jsx(or,{children:h.jsx(ws,{children:"Quiz Complete!"})}),h.jsx(nn,{children:h.jsx("p",{children:"Great work finishing the lesson!"})})]});const d=m=>{o(m)},f=()=>{if(!i){Yr.warning("Please select an answer.");return}const m=i===a.correctAnswerId,v=c[i];n(i,m,v)};return h.jsxs(Wt,{children:[h.jsxs(or,{children:[h.jsxs(ws,{children:["Lesson #",e," - Question ",a.id]}),h.jsx(CE,{children:"Read the question and select the best answer."})]}),h.jsxs(nn,{className:"space-y-6",children:[h.jsxs("div",{children:[h.jsx("h3",{className:"font-semibold text-xl pb-2 mb-4",children:a.question}),h.jsx("div",{className:"space-y-3",children:a.choices.map(m=>{const v=i===m.id,x=c[m.id];return h.jsx("div",{className:`flex items-center gap-4 p-4 rounded-lg transition-all border-4 cursor-pointer ${v?"border-blue-500":"border-transparent"}`,style:{backgroundColor:x},onClick:()=>d(m.id),children:h.jsxs("label",{htmlFor:`q-${a.id}-c-${m.id}-l-${e}`,className:"flex-1 cursor-pointer text-white font-semibold",style:{textShadow:"1px 1px 3px rgba(0,0,0,0.7)"},children:[m.id.toUpperCase(),". ",m.text]})},m.id)})})]}),h.jsx("div",{className:"flex justify-end items-center mt-6 gap-2",children:h.jsxs(zt,{onClick:f,disabled:!i,children:[h.jsx(C_,{}),"Submit Answer"]})})]})]})},fZ=({shouldShowQuiz:r,isHudMinimized:e,currentLesson:t,numericLessonNumber:n,currentQuestionIndex:s,onMinimizeToggle:i,onAnswerSubmit:o})=>r?e?h.jsx("div",{className:"absolute top-4 right-4 z-20",children:h.jsxs(zt,{onClick:i,className:"bg-blue-600 hover:bg-blue-700 text-white",children:[h.jsx(GS,{className:"h-4 w-4 mr-2"}),"Next Question"]})}):h.jsx("div",{className:"absolute inset-0 z-10 flex items-center justify-center p-4",children:h.jsx(Wt,{className:"w-full max-w-2xl bg-white/95 backdrop-blur-sm shadow-2xl",children:h.jsxs("div",{className:"relative",children:[h.jsx(zt,{onClick:i,className:"absolute top-4 right-4 text-gray-500 hover:text-gray-700",variant:"ghost",children:""}),t?h.jsx(hZ,{lesson:t,lessonNumber:n,currentQuestionIndex:s,onAnswerSubmit:o,colors:YD}):h.jsxs("div",{className:"p-6",children:[h.jsx("h2",{className:"text-xl font-bold mb-4",children:"Quiz Question"}),h.jsx("p",{className:"mb-4",children:"This is a test question to verify the HUD is working."}),h.jsx(zt,{onClick:i,children:"Test Answer"})]})]})})}):null,pZ=({isHudMinimized:r,isPlayerMoving:e,shouldShowQuiz:t,currentLesson:n})=>h.jsxs("div",{className:"absolute bottom-4 left-4 z-30 text-white bg-black/80 p-3 rounded text-sm",children:[h.jsxs("div",{children:["HUD: ",r?"minimized":"visible"]}),h.jsxs("div",{children:["Moving: ",e?"yes":"no"]}),h.jsxs("div",{children:["Should show: ",t?"yes":"no"]}),h.jsxs("div",{children:["Lesson: ",n?"found":"missing"]})]});var TS={exports:{}},Wc={};/**
 * @license React
 * react-reconciler-constants.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var $A;function mZ(){return $A||($A=1,Wc.ConcurrentRoot=1,Wc.ContinuousEventPriority=4,Wc.DefaultEventPriority=16,Wc.DiscreteEventPriority=1,Wc.IdleEventPriority=536870912,Wc.LegacyRoot=0),Wc}var qA;function gZ(){return qA||(qA=1,TS.exports=mZ()),TS.exports}var wp=gZ();function vZ(r){let e;const t=new Set,n=(d,f)=>{const m=typeof d=="function"?d(e):d;if(m!==e){const v=e;e=f?m:Object.assign({},e,m),t.forEach(x=>x(e,v))}},s=()=>e,i=(d,f=s,m=Object.is)=>{console.warn("[DEPRECATED] Please use `subscribeWithSelector` middleware");let v=f(e);function x(){const _=f(e);if(!m(v,_)){const b=v;d(v=_,b)}}return t.add(x),()=>t.delete(x)},c={setState:n,getState:s,subscribe:(d,f,m)=>f||m?i(d,f,m):(t.add(d),()=>t.delete(d)),destroy:()=>t.clear()};return e=r(n,s,c),c}const xZ=typeof window>"u"||!window.navigator||/ServerSideRendering|^Deno\//.test(window.navigator.userAgent),XA=xZ?R.useEffect:R.useLayoutEffect;function yZ(r){const e=typeof r=="function"?vZ(r):r,t=(n=e.getState,s=Object.is)=>{const[,i]=R.useReducer(w=>w+1,0),o=e.getState(),a=R.useRef(o),c=R.useRef(n),d=R.useRef(s),f=R.useRef(!1),m=R.useRef();m.current===void 0&&(m.current=n(o));let v,x=!1;(a.current!==o||c.current!==n||d.current!==s||f.current)&&(v=n(o),x=!s(m.current,v)),XA(()=>{x&&(m.current=v),a.current=o,c.current=n,d.current=s,f.current=!1});const _=R.useRef(o);XA(()=>{const w=()=>{try{const C=e.getState(),T=c.current(C);d.current(m.current,T)||(a.current=C,m.current=T,i())}catch{f.current=!0,i()}},S=e.subscribe(w);return e.getState()!==_.current&&w(),S},[]);const b=x?v:m.current;return R.useDebugValue(b),b};return Object.assign(t,e),t[Symbol.iterator]=function(){console.warn("[useStore, api] = create() is deprecated and will be removed in v4");const n=[t,e];return{next(){const s=n.length<=0;return{value:n.shift(),done:s}}}},t}var CS={exports:{}},AS={exports:{}},RS={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var YA;function _Z(){return YA||(YA=1,function(r){function e(V,q){var Z=V.length;V.push(q);e:for(;0<Z;){var X=Z-1>>>1,ie=V[X];if(0<s(ie,q))V[X]=q,V[Z]=ie,Z=X;else break e}}function t(V){return V.length===0?null:V[0]}function n(V){if(V.length===0)return null;var q=V[0],Z=V.pop();if(Z!==q){V[0]=Z;e:for(var X=0,ie=V.length,be=ie>>>1;X<be;){var ue=2*(X+1)-1,Ee=V[ue],Fe=ue+1,me=V[Fe];if(0>s(Ee,Z))Fe<ie&&0>s(me,Ee)?(V[X]=me,V[Fe]=Z,X=Fe):(V[X]=Ee,V[ue]=Z,X=ue);else if(Fe<ie&&0>s(me,Z))V[X]=me,V[Fe]=Z,X=Fe;else break e}}return q}function s(V,q){var Z=V.sortIndex-q.sortIndex;return Z!==0?Z:V.id-q.id}if(typeof performance=="object"&&typeof performance.now=="function"){var i=performance;r.unstable_now=function(){return i.now()}}else{var o=Date,a=o.now();r.unstable_now=function(){return o.now()-a}}var c=[],d=[],f=1,m=null,v=3,x=!1,_=!1,b=!1,w=typeof setTimeout=="function"?setTimeout:null,S=typeof clearTimeout=="function"?clearTimeout:null,C=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function T(V){for(var q=t(d);q!==null;){if(q.callback===null)n(d);else if(q.startTime<=V)n(d),q.sortIndex=q.expirationTime,e(c,q);else break;q=t(d)}}function A(V){if(b=!1,T(V),!_)if(t(c)!==null)_=!0,ne(k);else{var q=t(d);q!==null&&ce(A,q.startTime-V)}}function k(V,q){_=!1,b&&(b=!1,S(L),L=-1),x=!0;var Z=v;try{for(T(q),m=t(c);m!==null&&(!(m.expirationTime>q)||V&&!B());){var X=m.callback;if(typeof X=="function"){m.callback=null,v=m.priorityLevel;var ie=X(m.expirationTime<=q);q=r.unstable_now(),typeof ie=="function"?m.callback=ie:m===t(c)&&n(c),T(q)}else n(c);m=t(c)}if(m!==null)var be=!0;else{var ue=t(d);ue!==null&&ce(A,ue.startTime-q),be=!1}return be}finally{m=null,v=Z,x=!1}}var j=!1,D=null,L=-1,O=5,I=-1;function B(){return!(r.unstable_now()-I<O)}function W(){if(D!==null){var V=r.unstable_now();I=V;var q=!0;try{q=D(!0,V)}finally{q?K():(j=!1,D=null)}}else j=!1}var K;if(typeof C=="function")K=function(){C(W)};else if(typeof MessageChannel<"u"){var ee=new MessageChannel,oe=ee.port2;ee.port1.onmessage=W,K=function(){oe.postMessage(null)}}else K=function(){w(W,0)};function ne(V){D=V,j||(j=!0,K())}function ce(V,q){L=w(function(){V(r.unstable_now())},q)}r.unstable_IdlePriority=5,r.unstable_ImmediatePriority=1,r.unstable_LowPriority=4,r.unstable_NormalPriority=3,r.unstable_Profiling=null,r.unstable_UserBlockingPriority=2,r.unstable_cancelCallback=function(V){V.callback=null},r.unstable_continueExecution=function(){_||x||(_=!0,ne(k))},r.unstable_forceFrameRate=function(V){0>V||125<V?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):O=0<V?Math.floor(1e3/V):5},r.unstable_getCurrentPriorityLevel=function(){return v},r.unstable_getFirstCallbackNode=function(){return t(c)},r.unstable_next=function(V){switch(v){case 1:case 2:case 3:var q=3;break;default:q=v}var Z=v;v=q;try{return V()}finally{v=Z}},r.unstable_pauseExecution=function(){},r.unstable_requestPaint=function(){},r.unstable_runWithPriority=function(V,q){switch(V){case 1:case 2:case 3:case 4:case 5:break;default:V=3}var Z=v;v=V;try{return q()}finally{v=Z}},r.unstable_scheduleCallback=function(V,q,Z){var X=r.unstable_now();switch(typeof Z=="object"&&Z!==null?(Z=Z.delay,Z=typeof Z=="number"&&0<Z?X+Z:X):Z=X,V){case 1:var ie=-1;break;case 2:ie=250;break;case 5:ie=1073741823;break;case 4:ie=1e4;break;default:ie=5e3}return ie=Z+ie,V={id:f++,callback:q,priorityLevel:V,startTime:Z,expirationTime:ie,sortIndex:-1},Z>X?(V.sortIndex=Z,e(d,V),t(c)===null&&V===t(d)&&(b?(S(L),L=-1):b=!0,ce(A,Z-X))):(V.sortIndex=ie,e(c,V),_||x||(_=!0,ne(k))),V},r.unstable_shouldYield=B,r.unstable_wrapCallback=function(V){var q=v;return function(){var Z=v;v=q;try{return V.apply(this,arguments)}finally{v=Z}}}}(RS)),RS}var KA;function KD(){return KA||(KA=1,AS.exports=_Z()),AS.exports}/**
 * @license React
 * react-reconciler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var NS,QA;function wZ(){return QA||(QA=1,NS=function(e){var t={},n=__(),s=KD(),i=Object.assign;function o(p){for(var g="https://reactjs.org/docs/error-decoder.html?invariant="+p,E=1;E<arguments.length;E++)g+="&args[]="+encodeURIComponent(arguments[E]);return"Minified React error #"+p+"; visit "+g+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var a=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,c=Symbol.for("react.element"),d=Symbol.for("react.portal"),f=Symbol.for("react.fragment"),m=Symbol.for("react.strict_mode"),v=Symbol.for("react.profiler"),x=Symbol.for("react.provider"),_=Symbol.for("react.context"),b=Symbol.for("react.forward_ref"),w=Symbol.for("react.suspense"),S=Symbol.for("react.suspense_list"),C=Symbol.for("react.memo"),T=Symbol.for("react.lazy"),A=Symbol.for("react.offscreen"),k=Symbol.iterator;function j(p){return p===null||typeof p!="object"?null:(p=k&&p[k]||p["@@iterator"],typeof p=="function"?p:null)}function D(p){if(p==null)return null;if(typeof p=="function")return p.displayName||p.name||null;if(typeof p=="string")return p;switch(p){case f:return"Fragment";case d:return"Portal";case v:return"Profiler";case m:return"StrictMode";case w:return"Suspense";case S:return"SuspenseList"}if(typeof p=="object")switch(p.$$typeof){case _:return(p.displayName||"Context")+".Consumer";case x:return(p._context.displayName||"Context")+".Provider";case b:var g=p.render;return p=p.displayName,p||(p=g.displayName||g.name||"",p=p!==""?"ForwardRef("+p+")":"ForwardRef"),p;case C:return g=p.displayName||null,g!==null?g:D(p.type)||"Memo";case T:g=p._payload,p=p._init;try{return D(p(g))}catch{}}return null}function L(p){var g=p.type;switch(p.tag){case 24:return"Cache";case 9:return(g.displayName||"Context")+".Consumer";case 10:return(g._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return p=g.render,p=p.displayName||p.name||"",g.displayName||(p!==""?"ForwardRef("+p+")":"ForwardRef");case 7:return"Fragment";case 5:return g;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return D(g);case 8:return g===m?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof g=="function")return g.displayName||g.name||null;if(typeof g=="string")return g}return null}function O(p){var g=p,E=p;if(p.alternate)for(;g.return;)g=g.return;else{p=g;do g=p,(g.flags&4098)!==0&&(E=g.return),p=g.return;while(p)}return g.tag===3?E:null}function I(p){if(O(p)!==p)throw Error(o(188))}function B(p){var g=p.alternate;if(!g){if(g=O(p),g===null)throw Error(o(188));return g!==p?null:p}for(var E=p,N=g;;){var F=E.return;if(F===null)break;var z=F.alternate;if(z===null){if(N=F.return,N!==null){E=N;continue}break}if(F.child===z.child){for(z=F.child;z;){if(z===E)return I(F),p;if(z===N)return I(F),g;z=z.sibling}throw Error(o(188))}if(E.return!==N.return)E=F,N=z;else{for(var te=!1,pe=F.child;pe;){if(pe===E){te=!0,E=F,N=z;break}if(pe===N){te=!0,N=F,E=z;break}pe=pe.sibling}if(!te){for(pe=z.child;pe;){if(pe===E){te=!0,E=z,N=F;break}if(pe===N){te=!0,N=z,E=F;break}pe=pe.sibling}if(!te)throw Error(o(189))}}if(E.alternate!==N)throw Error(o(190))}if(E.tag!==3)throw Error(o(188));return E.stateNode.current===E?p:g}function W(p){return p=B(p),p!==null?K(p):null}function K(p){if(p.tag===5||p.tag===6)return p;for(p=p.child;p!==null;){var g=K(p);if(g!==null)return g;p=p.sibling}return null}function ee(p){if(p.tag===5||p.tag===6)return p;for(p=p.child;p!==null;){if(p.tag!==4){var g=ee(p);if(g!==null)return g}p=p.sibling}return null}var oe=Array.isArray,ne=e.getPublicInstance,ce=e.getRootHostContext,V=e.getChildHostContext,q=e.prepareForCommit,Z=e.resetAfterCommit,X=e.createInstance,ie=e.appendInitialChild,be=e.finalizeInitialChildren,ue=e.prepareUpdate,Ee=e.shouldSetTextContent,Fe=e.createTextInstance,me=e.scheduleTimeout,je=e.cancelTimeout,Xe=e.noTimeout,$e=e.isPrimaryRenderer,dt=e.supportsMutation,ht=e.supportsPersistence,Ie=e.supportsHydration,$=e.getInstanceFromNode,Ce=e.preparePortalMount,ke=e.getCurrentEventPriority,Ge=e.detachDeletedInstance,Ae=e.supportsMicrotasks,rt=e.scheduleMicrotask,qe=e.supportsTestSelectors,nt=e.findFiberRoot,jt=e.getBoundingRect,Q=e.getTextContent,H=e.isHiddenSubtree,ye=e.matchAccessibilityRole,Re=e.setFocusIfFocusable,Ue=e.setupIntersectionObserver,Le=e.appendChild,bt=e.appendChildToContainer,st=e.commitTextUpdate,xt=e.commitMount,Et=e.commitUpdate,We=e.insertBefore,ft=e.insertInContainerBefore,Bt=e.removeChild,le=e.removeChildFromContainer,Se=e.resetTextContent,Ze=e.hideInstance,ae=e.hideTextInstance,Je=e.unhideInstance,He=e.unhideTextInstance,ct=e.clearContainer,Ye=e.cloneInstance,ze=e.createContainerChildSet,Be=e.appendChildToContainerChildSet,lt=e.finalizeContainerChildren,Dt=e.replaceContainerChildren,Ht=e.cloneHiddenInstance,An=e.cloneHiddenTextInstance,Bn=e.canHydrateInstance,Ts=e.canHydrateTextInstance,pr=e.canHydrateSuspenseInstance,wr=e.isSuspenseInstancePending,Oi=e.isSuspenseInstanceFallback,Ka=e.registerSuspenseInstanceRetry,ji=e.getNextHydratableSibling,ha=e.getFirstHydratableChild,Mh=e.getFirstHydratableChildWithinContainer,ic=e.getFirstHydratableChildWithinSuspenseInstance,Th=e.hydrateInstance,no=e.hydrateTextInstance,Ch=e.hydrateSuspenseInstance,Ah=e.getNextHydratableInstanceAfterSuspenseInstance,Rh=e.commitHydratedContainer,Nh=e.commitHydratedSuspenseInstance,Ph=e.clearSuspenseBoundary,Ih=e.clearSuspenseBoundaryFromContainer,Y=e.shouldDeleteUnhydratedTailInstances,xe=e.didNotMatchHydratedContainerTextInstance,Ne=e.didNotMatchHydratedTextInstance,_e;function ve(p){if(_e===void 0)try{throw Error()}catch(E){var g=E.stack.trim().match(/\n( *(at )?)/);_e=g&&g[1]||""}return`
`+_e+p}var et=!1;function pt(p,g){if(!p||et)return"";et=!0;var E=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(g)if(g=function(){throw Error()},Object.defineProperty(g.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(g,[])}catch(ot){var N=ot}Reflect.construct(p,[],g)}else{try{g.call()}catch(ot){N=ot}p.call(g.prototype)}else{try{throw Error()}catch(ot){N=ot}p()}}catch(ot){if(ot&&N&&typeof ot.stack=="string"){for(var F=ot.stack.split(`
`),z=N.stack.split(`
`),te=F.length-1,pe=z.length-1;1<=te&&0<=pe&&F[te]!==z[pe];)pe--;for(;1<=te&&0<=pe;te--,pe--)if(F[te]!==z[pe]){if(te!==1||pe!==1)do if(te--,pe--,0>pe||F[te]!==z[pe]){var Oe=`
`+F[te].replace(" at new "," at ");return p.displayName&&Oe.includes("<anonymous>")&&(Oe=Oe.replace("<anonymous>",p.displayName)),Oe}while(1<=te&&0<=pe);break}}}finally{et=!1,Error.prepareStackTrace=E}return(p=p?p.displayName||p.name:"")?ve(p):""}var Mt=Object.prototype.hasOwnProperty,_t=[],Vt=-1;function Ft(p){return{current:p}}function it(p){0>Vt||(p.current=_t[Vt],_t[Vt]=null,Vt--)}function Nt(p,g){Vt++,_t[Vt]=p.current,p.current=g}var Kt={},un=Ft(Kt),_n=Ft(!1),dn=Kt;function kt(p,g){var E=p.type.contextTypes;if(!E)return Kt;var N=p.stateNode;if(N&&N.__reactInternalMemoizedUnmaskedChildContext===g)return N.__reactInternalMemoizedMaskedChildContext;var F={},z;for(z in E)F[z]=g[z];return N&&(p=p.stateNode,p.__reactInternalMemoizedUnmaskedChildContext=g,p.__reactInternalMemoizedMaskedChildContext=F),F}function En(p){return p=p.childContextTypes,p!=null}function gn(){it(_n),it(un)}function Br(p,g,E){if(un.current!==Kt)throw Error(o(168));Nt(un,g),Nt(_n,E)}function bo(p,g,E){var N=p.stateNode;if(g=g.childContextTypes,typeof N.getChildContext!="function")return E;N=N.getChildContext();for(var F in N)if(!(F in g))throw Error(o(108,L(p)||"Unknown",F));return i({},E,N)}function Nr(p){return p=(p=p.stateNode)&&p.__reactInternalMemoizedMergedChildContext||Kt,dn=un.current,Nt(un,p),Nt(_n,_n.current),!0}function ro(p,g,E){var N=p.stateNode;if(!N)throw Error(o(169));E?(p=bo(p,g,dn),N.__reactInternalMemoizedMergedChildContext=p,it(_n),it(un),Nt(un,p)):it(_n),Nt(_n,E)}var wn=Math.clz32?Math.clz32:zr,es=Math.log,Pr=Math.LN2;function zr(p){return p>>>=0,p===0?32:31-(es(p)/Pr|0)|0}var ur=64,Sn=4194304;function Cs(p){switch(p&-p){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return p&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return p&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return p}}function Ru(p,g){var E=p.pendingLanes;if(E===0)return 0;var N=0,F=p.suspendedLanes,z=p.pingedLanes,te=E&268435455;if(te!==0){var pe=te&~F;pe!==0?N=Cs(pe):(z&=te,z!==0&&(N=Cs(z)))}else te=E&~F,te!==0?N=Cs(te):z!==0&&(N=Cs(z));if(N===0)return 0;if(g!==0&&g!==N&&(g&F)===0&&(F=N&-N,z=g&-g,F>=z||F===16&&(z&4194240)!==0))return g;if((N&4)!==0&&(N|=E&16),g=p.entangledLanes,g!==0)for(p=p.entanglements,g&=N;0<g;)E=31-wn(g),F=1<<E,N|=p[E],g&=~F;return N}function vm(p,g){switch(p){case 1:case 2:case 4:return g+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return g+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function nv(p,g){for(var E=p.suspendedLanes,N=p.pingedLanes,F=p.expirationTimes,z=p.pendingLanes;0<z;){var te=31-wn(z),pe=1<<te,Oe=F[te];Oe===-1?((pe&E)===0||(pe&N)!==0)&&(F[te]=vm(pe,g)):Oe<=g&&(p.expiredLanes|=pe),z&=~pe}}function kh(p){return p=p.pendingLanes&-1073741825,p!==0?p:p&1073741824?1073741824:0}function Dh(p){for(var g=[],E=0;31>E;E++)g.push(p);return g}function Qa(p,g,E){p.pendingLanes|=g,g!==536870912&&(p.suspendedLanes=0,p.pingedLanes=0),p=p.eventTimes,g=31-wn(g),p[g]=E}function Lh(p,g){var E=p.pendingLanes&~g;p.pendingLanes=g,p.suspendedLanes=0,p.pingedLanes=0,p.expiredLanes&=g,p.mutableReadLanes&=g,p.entangledLanes&=g,g=p.entanglements;var N=p.eventTimes;for(p=p.expirationTimes;0<E;){var F=31-wn(E),z=1<<F;g[F]=0,N[F]=-1,p[F]=-1,E&=~z}}function so(p,g){var E=p.entangledLanes|=g;for(p=p.entanglements;E;){var N=31-wn(E),F=1<<N;F&g|p[N]&g&&(p[N]|=g),E&=~F}}var vn=0;function Eo(p){return p&=-p,1<p?4<p?(p&268435455)!==0?16:536870912:4:1}var Ja=s.unstable_scheduleCallback,oc=s.unstable_cancelCallback,fa=s.unstable_shouldYield,Pw=s.unstable_requestPaint,Sr=s.unstable_now,Za=s.unstable_ImmediatePriority,Iw=s.unstable_UserBlockingPriority,Oh=s.unstable_NormalPriority,jh=s.unstable_IdlePriority,Nu=null,io=null;function Pu(p){if(io&&typeof io.onCommitFiberRoot=="function")try{io.onCommitFiberRoot(Nu,p,void 0,(p.current.flags&128)===128)}catch{}}function Iu(p,g){return p===g&&(p!==0||1/p===1/g)||p!==p&&g!==g}var cs=typeof Object.is=="function"?Object.is:Iu,hi=null,Fh=!1,xm=!1;function Uh(p){hi===null?hi=[p]:hi.push(p)}function Bh(p){Fh=!0,Uh(p)}function fi(){if(!xm&&hi!==null){xm=!0;var p=0,g=vn;try{var E=hi;for(vn=1;p<E.length;p++){var N=E[p];do N=N(!0);while(N!==null)}hi=null,Fh=!1}catch(F){throw hi!==null&&(hi=hi.slice(p+1)),Ja(Za,fi),F}finally{vn=g,xm=!1}}return null}var rv=a.ReactCurrentBatchConfig;function Fi(p,g){if(cs(p,g))return!0;if(typeof p!="object"||p===null||typeof g!="object"||g===null)return!1;var E=Object.keys(p),N=Object.keys(g);if(E.length!==N.length)return!1;for(N=0;N<E.length;N++){var F=E[N];if(!Mt.call(g,F)||!cs(p[F],g[F]))return!1}return!0}function ym(p){switch(p.tag){case 5:return ve(p.type);case 16:return ve("Lazy");case 13:return ve("Suspense");case 19:return ve("SuspenseList");case 0:case 2:case 15:return p=pt(p.type,!1),p;case 11:return p=pt(p.type.render,!1),p;case 1:return p=pt(p.type,!0),p;default:return""}}function As(p,g){if(p&&p.defaultProps){g=i({},g),p=p.defaultProps;for(var E in p)g[E]===void 0&&(g[E]=p[E]);return g}return g}var ku=Ft(null),el=null,Mo=null,zh=null;function us(){zh=Mo=el=null}function tl(p,g,E){$e?(Nt(ku,g._currentValue),g._currentValue=E):(Nt(ku,g._currentValue2),g._currentValue2=E)}function Du(p){var g=ku.current;it(ku),$e?p._currentValue=g:p._currentValue2=g}function nl(p,g,E){for(;p!==null;){var N=p.alternate;if((p.childLanes&g)!==g?(p.childLanes|=g,N!==null&&(N.childLanes|=g)):N!==null&&(N.childLanes&g)!==g&&(N.childLanes|=g),p===E)break;p=p.return}}function ac(p,g){el=p,zh=Mo=null,p=p.dependencies,p!==null&&p.firstContext!==null&&((p.lanes&g)!==0&&(Lr=!0),p.firstContext=null)}function Rs(p){var g=$e?p._currentValue:p._currentValue2;if(zh!==p)if(p={context:p,memoizedValue:g,next:null},Mo===null){if(el===null)throw Error(o(308));Mo=p,el.dependencies={lanes:0,firstContext:p}}else Mo=Mo.next=p;return g}var pi=null,mi=!1;function lc(p){p.updateQueue={baseState:p.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function _m(p,g){p=p.updateQueue,g.updateQueue===p&&(g.updateQueue={baseState:p.baseState,firstBaseUpdate:p.firstBaseUpdate,lastBaseUpdate:p.lastBaseUpdate,shared:p.shared,effects:p.effects})}function To(p,g){return{eventTime:p,lane:g,tag:0,payload:null,callback:null,next:null}}function pa(p,g){var E=p.updateQueue;E!==null&&(E=E.shared,hr!==null&&(p.mode&1)!==0&&(ln&2)===0?(p=E.interleaved,p===null?(g.next=g,pi===null?pi=[E]:pi.push(E)):(g.next=p.next,p.next=g),E.interleaved=g):(p=E.pending,p===null?g.next=g:(g.next=p.next,p.next=g),E.pending=g))}function Vh(p,g,E){if(g=g.updateQueue,g!==null&&(g=g.shared,(E&4194240)!==0)){var N=g.lanes;N&=p.pendingLanes,E|=N,g.lanes=E,so(p,E)}}function Hh(p,g){var E=p.updateQueue,N=p.alternate;if(N!==null&&(N=N.updateQueue,E===N)){var F=null,z=null;if(E=E.firstBaseUpdate,E!==null){do{var te={eventTime:E.eventTime,lane:E.lane,tag:E.tag,payload:E.payload,callback:E.callback,next:null};z===null?F=z=te:z=z.next=te,E=E.next}while(E!==null);z===null?F=z=g:z=z.next=g}else F=z=g;E={baseState:N.baseState,firstBaseUpdate:F,lastBaseUpdate:z,shared:N.shared,effects:N.effects},p.updateQueue=E;return}p=E.lastBaseUpdate,p===null?E.firstBaseUpdate=g:p.next=g,E.lastBaseUpdate=g}function Gh(p,g,E,N){var F=p.updateQueue;mi=!1;var z=F.firstBaseUpdate,te=F.lastBaseUpdate,pe=F.shared.pending;if(pe!==null){F.shared.pending=null;var Oe=pe,ot=Oe.next;Oe.next=null,te===null?z=ot:te.next=ot,te=Oe;var Tt=p.alternate;Tt!==null&&(Tt=Tt.updateQueue,pe=Tt.lastBaseUpdate,pe!==te&&(pe===null?Tt.firstBaseUpdate=ot:pe.next=ot,Tt.lastBaseUpdate=Oe))}if(z!==null){var rn=F.baseState;te=0,Tt=ot=Oe=null,pe=z;do{var Gt=pe.lane,hn=pe.eventTime;if((N&Gt)===Gt){Tt!==null&&(Tt=Tt.next={eventTime:hn,lane:0,tag:pe.tag,payload:pe.payload,callback:pe.callback,next:null});e:{var yt=p,qr=pe;switch(Gt=g,hn=E,qr.tag){case 1:if(yt=qr.payload,typeof yt=="function"){rn=yt.call(hn,rn,Gt);break e}rn=yt;break e;case 3:yt.flags=yt.flags&-65537|128;case 0:if(yt=qr.payload,Gt=typeof yt=="function"?yt.call(hn,rn,Gt):yt,Gt==null)break e;rn=i({},rn,Gt);break e;case 2:mi=!0}}pe.callback!==null&&pe.lane!==0&&(p.flags|=64,Gt=F.effects,Gt===null?F.effects=[pe]:Gt.push(pe))}else hn={eventTime:hn,lane:Gt,tag:pe.tag,payload:pe.payload,callback:pe.callback,next:null},Tt===null?(ot=Tt=hn,Oe=rn):Tt=Tt.next=hn,te|=Gt;if(pe=pe.next,pe===null){if(pe=F.shared.pending,pe===null)break;Gt=pe,pe=Gt.next,Gt.next=null,F.lastBaseUpdate=Gt,F.shared.pending=null}}while(!0);if(Tt===null&&(Oe=rn),F.baseState=Oe,F.firstBaseUpdate=ot,F.lastBaseUpdate=Tt,g=F.shared.interleaved,g!==null){F=g;do te|=F.lane,F=F.next;while(F!==g)}else z===null&&(F.shared.lanes=0);co|=te,p.lanes=te,p.memoizedState=rn}}function sv(p,g,E){if(p=g.effects,g.effects=null,p!==null)for(g=0;g<p.length;g++){var N=p[g],F=N.callback;if(F!==null){if(N.callback=null,N=E,typeof F!="function")throw Error(o(191,F));F.call(N)}}}var iv=new n.Component().refs;function wm(p,g,E,N){g=p.memoizedState,E=E(N,g),E=E==null?g:i({},g,E),p.memoizedState=E,p.lanes===0&&(p.updateQueue.baseState=E)}var Wh={isMounted:function(p){return(p=p._reactInternals)?O(p)===p:!1},enqueueSetState:function(p,g,E){p=p._reactInternals;var N=In(),F=Wi(p),z=To(N,F);z.payload=g,E!=null&&(z.callback=E),pa(p,z),g=rs(p,F,N),g!==null&&Vh(g,p,F)},enqueueReplaceState:function(p,g,E){p=p._reactInternals;var N=In(),F=Wi(p),z=To(N,F);z.tag=1,z.payload=g,E!=null&&(z.callback=E),pa(p,z),g=rs(p,F,N),g!==null&&Vh(g,p,F)},enqueueForceUpdate:function(p,g){p=p._reactInternals;var E=In(),N=Wi(p),F=To(E,N);F.tag=2,g!=null&&(F.callback=g),pa(p,F),g=rs(p,N,E),g!==null&&Vh(g,p,N)}};function Sm(p,g,E,N,F,z,te){return p=p.stateNode,typeof p.shouldComponentUpdate=="function"?p.shouldComponentUpdate(N,z,te):g.prototype&&g.prototype.isPureReactComponent?!Fi(E,N)||!Fi(F,z):!0}function ov(p,g,E){var N=!1,F=Kt,z=g.contextType;return typeof z=="object"&&z!==null?z=Rs(z):(F=En(g)?dn:un.current,N=g.contextTypes,z=(N=N!=null)?kt(p,F):Kt),g=new g(E,z),p.memoizedState=g.state!==null&&g.state!==void 0?g.state:null,g.updater=Wh,p.stateNode=g,g._reactInternals=p,N&&(p=p.stateNode,p.__reactInternalMemoizedUnmaskedChildContext=F,p.__reactInternalMemoizedMaskedChildContext=z),g}function av(p,g,E,N){p=g.state,typeof g.componentWillReceiveProps=="function"&&g.componentWillReceiveProps(E,N),typeof g.UNSAFE_componentWillReceiveProps=="function"&&g.UNSAFE_componentWillReceiveProps(E,N),g.state!==p&&Wh.enqueueReplaceState(g,g.state,null)}function bm(p,g,E,N){var F=p.stateNode;F.props=E,F.state=p.memoizedState,F.refs=iv,lc(p);var z=g.contextType;typeof z=="object"&&z!==null?F.context=Rs(z):(z=En(g)?dn:un.current,F.context=kt(p,z)),F.state=p.memoizedState,z=g.getDerivedStateFromProps,typeof z=="function"&&(wm(p,g,z,E),F.state=p.memoizedState),typeof g.getDerivedStateFromProps=="function"||typeof F.getSnapshotBeforeUpdate=="function"||typeof F.UNSAFE_componentWillMount!="function"&&typeof F.componentWillMount!="function"||(g=F.state,typeof F.componentWillMount=="function"&&F.componentWillMount(),typeof F.UNSAFE_componentWillMount=="function"&&F.UNSAFE_componentWillMount(),g!==F.state&&Wh.enqueueReplaceState(F,F.state,null),Gh(p,E,F,N),F.state=p.memoizedState),typeof F.componentDidMount=="function"&&(p.flags|=4194308)}var cc=[],ma=0,$h=null,qh=0,gi=[],qs=0,rl=null,Co=1,Ao="";function sl(p,g){cc[ma++]=qh,cc[ma++]=$h,$h=p,qh=g}function lv(p,g,E){gi[qs++]=Co,gi[qs++]=Ao,gi[qs++]=rl,rl=p;var N=Co;p=Ao;var F=32-wn(N)-1;N&=~(1<<F),E+=1;var z=32-wn(g)+F;if(30<z){var te=F-F%5;z=(N&(1<<te)-1).toString(32),N>>=te,F-=te,Co=1<<32-wn(g)+F|E<<F|N,Ao=z+p}else Co=1<<z|E<<F|N,Ao=p}function Em(p){p.return!==null&&(sl(p,1),lv(p,1,0))}function Mm(p){for(;p===$h;)$h=cc[--ma],cc[ma]=null,qh=cc[--ma],cc[ma]=null;for(;p===rl;)rl=gi[--qs],gi[qs]=null,Ao=gi[--qs],gi[qs]=null,Co=gi[--qs],gi[qs]=null}var ds=null,Vr=null,Zn=!1,uc=!1,vi=null;function Tm(p,g){var E=ei(5,null,null,0);E.elementType="DELETED",E.stateNode=g,E.return=p,g=p.deletions,g===null?(p.deletions=[E],p.flags|=16):g.push(E)}function Cm(p,g){switch(p.tag){case 5:return g=Bn(g,p.type,p.pendingProps),g!==null?(p.stateNode=g,ds=p,Vr=ha(g),!0):!1;case 6:return g=Ts(g,p.pendingProps),g!==null?(p.stateNode=g,ds=p,Vr=null,!0):!1;case 13:if(g=pr(g),g!==null){var E=rl!==null?{id:Co,overflow:Ao}:null;return p.memoizedState={dehydrated:g,treeContext:E,retryLane:1073741824},E=ei(18,null,null,0),E.stateNode=g,E.return=p,p.child=E,ds=p,Vr=null,!0}return!1;default:return!1}}function Xh(p){return(p.mode&1)!==0&&(p.flags&128)===0}function ga(p){if(Zn){var g=Vr;if(g){var E=g;if(!Cm(p,g)){if(Xh(p))throw Error(o(418));g=ji(E);var N=ds;g&&Cm(p,g)?Tm(N,E):(p.flags=p.flags&-4097|2,Zn=!1,ds=p)}}else{if(Xh(p))throw Error(o(418));p.flags=p.flags&-4097|2,Zn=!1,ds=p}}}function cv(p){for(p=p.return;p!==null&&p.tag!==5&&p.tag!==3&&p.tag!==13;)p=p.return;ds=p}function Lu(p){if(!Ie||p!==ds)return!1;if(!Zn)return cv(p),Zn=!0,!1;if(p.tag!==3&&(p.tag!==5||Y(p.type)&&!Ee(p.type,p.memoizedProps))){var g=Vr;if(g){if(Xh(p)){for(p=Vr;p;)p=ji(p);throw Error(o(418))}for(;g;)Tm(p,g),g=ji(g)}}if(cv(p),p.tag===13){if(!Ie)throw Error(o(316));if(p=p.memoizedState,p=p!==null?p.dehydrated:null,!p)throw Error(o(317));Vr=Ah(p)}else Vr=ds?ji(p.stateNode):null;return!0}function dc(){Ie&&(Vr=ds=null,uc=Zn=!1)}function Yh(p){vi===null?vi=[p]:vi.push(p)}function hc(p,g,E){if(p=E.ref,p!==null&&typeof p!="function"&&typeof p!="object"){if(E._owner){if(E=E._owner,E){if(E.tag!==1)throw Error(o(309));var N=E.stateNode}if(!N)throw Error(o(147,p));var F=N,z=""+p;return g!==null&&g.ref!==null&&typeof g.ref=="function"&&g.ref._stringRef===z?g.ref:(g=function(te){var pe=F.refs;pe===iv&&(pe=F.refs={}),te===null?delete pe[z]:pe[z]=te},g._stringRef=z,g)}if(typeof p!="string")throw Error(o(284));if(!E._owner)throw Error(o(290,p))}return p}function va(p,g){throw p=Object.prototype.toString.call(g),Error(o(31,p==="[object Object]"?"object with keys {"+Object.keys(g).join(", ")+"}":p))}function fc(p){var g=p._init;return g(p._payload)}function uv(p){function g(Te,ge){if(p){var De=Te.deletions;De===null?(Te.deletions=[ge],Te.flags|=16):De.push(ge)}}function E(Te,ge){if(!p)return null;for(;ge!==null;)g(Te,ge),ge=ge.sibling;return null}function N(Te,ge){for(Te=new Map;ge!==null;)ge.key!==null?Te.set(ge.key,ge):Te.set(ge.index,ge),ge=ge.sibling;return Te}function F(Te,ge){return Te=Vo(Te,ge),Te.index=0,Te.sibling=null,Te}function z(Te,ge,De){return Te.index=De,p?(De=Te.alternate,De!==null?(De=De.index,De<ge?(Te.flags|=2,ge):De):(Te.flags|=2,ge)):(Te.flags|=1048576,ge)}function te(Te){return p&&Te.alternate===null&&(Te.flags|=2),Te}function pe(Te,ge,De,gt){return ge===null||ge.tag!==6?(ge=bf(De,Te.mode,gt),ge.return=Te,ge):(ge=F(ge,De),ge.return=Te,ge)}function Oe(Te,ge,De,gt){var Ot=De.type;return Ot===f?Tt(Te,ge,De.props.children,gt,De.key):ge!==null&&(ge.elementType===Ot||typeof Ot=="object"&&Ot!==null&&Ot.$$typeof===T&&fc(Ot)===ge.type)?(gt=F(ge,De.props),gt.ref=hc(Te,ge,De),gt.return=Te,gt):(gt=Sf(De.type,De.key,De.props,null,Te.mode,gt),gt.ref=hc(Te,ge,De),gt.return=Te,gt)}function ot(Te,ge,De,gt){return ge===null||ge.tag!==4||ge.stateNode.containerInfo!==De.containerInfo||ge.stateNode.implementation!==De.implementation?(ge=Ef(De,Te.mode,gt),ge.return=Te,ge):(ge=F(ge,De.children||[]),ge.return=Te,ge)}function Tt(Te,ge,De,gt,Ot){return ge===null||ge.tag!==7?(ge=Tl(De,Te.mode,gt,Ot),ge.return=Te,ge):(ge=F(ge,De),ge.return=Te,ge)}function rn(Te,ge,De){if(typeof ge=="string"&&ge!==""||typeof ge=="number")return ge=bf(""+ge,Te.mode,De),ge.return=Te,ge;if(typeof ge=="object"&&ge!==null){switch(ge.$$typeof){case c:return De=Sf(ge.type,ge.key,ge.props,null,Te.mode,De),De.ref=hc(Te,null,ge),De.return=Te,De;case d:return ge=Ef(ge,Te.mode,De),ge.return=Te,ge;case T:var gt=ge._init;return rn(Te,gt(ge._payload),De)}if(oe(ge)||j(ge))return ge=Tl(ge,Te.mode,De,null),ge.return=Te,ge;va(Te,ge)}return null}function Gt(Te,ge,De,gt){var Ot=ge!==null?ge.key:null;if(typeof De=="string"&&De!==""||typeof De=="number")return Ot!==null?null:pe(Te,ge,""+De,gt);if(typeof De=="object"&&De!==null){switch(De.$$typeof){case c:return De.key===Ot?Oe(Te,ge,De,gt):null;case d:return De.key===Ot?ot(Te,ge,De,gt):null;case T:return Ot=De._init,Gt(Te,ge,Ot(De._payload),gt)}if(oe(De)||j(De))return Ot!==null?null:Tt(Te,ge,De,gt,null);va(Te,De)}return null}function hn(Te,ge,De,gt,Ot){if(typeof gt=="string"&&gt!==""||typeof gt=="number")return Te=Te.get(De)||null,pe(ge,Te,""+gt,Ot);if(typeof gt=="object"&&gt!==null){switch(gt.$$typeof){case c:return Te=Te.get(gt.key===null?De:gt.key)||null,Oe(ge,Te,gt,Ot);case d:return Te=Te.get(gt.key===null?De:gt.key)||null,ot(ge,Te,gt,Ot);case T:var on=gt._init;return hn(Te,ge,De,on(gt._payload),Ot)}if(oe(gt)||j(gt))return Te=Te.get(De)||null,Tt(ge,Te,gt,Ot,null);va(ge,gt)}return null}function yt(Te,ge,De,gt){for(var Ot=null,on=null,sn=ge,Rn=ge=0,gr=null;sn!==null&&Rn<De.length;Rn++){sn.index>Rn?(gr=sn,sn=null):gr=sn.sibling;var Tn=Gt(Te,sn,De[Rn],gt);if(Tn===null){sn===null&&(sn=gr);break}p&&sn&&Tn.alternate===null&&g(Te,sn),ge=z(Tn,ge,Rn),on===null?Ot=Tn:on.sibling=Tn,on=Tn,sn=gr}if(Rn===De.length)return E(Te,sn),Zn&&sl(Te,Rn),Ot;if(sn===null){for(;Rn<De.length;Rn++)sn=rn(Te,De[Rn],gt),sn!==null&&(ge=z(sn,ge,Rn),on===null?Ot=sn:on.sibling=sn,on=sn);return Zn&&sl(Te,Rn),Ot}for(sn=N(Te,sn);Rn<De.length;Rn++)gr=hn(sn,Te,Rn,De[Rn],gt),gr!==null&&(p&&gr.alternate!==null&&sn.delete(gr.key===null?Rn:gr.key),ge=z(gr,ge,Rn),on===null?Ot=gr:on.sibling=gr,on=gr);return p&&sn.forEach(function(Ho){return g(Te,Ho)}),Zn&&sl(Te,Rn),Ot}function qr(Te,ge,De,gt){var Ot=j(De);if(typeof Ot!="function")throw Error(o(150));if(De=Ot.call(De),De==null)throw Error(o(151));for(var on=Ot=null,sn=ge,Rn=ge=0,gr=null,Tn=De.next();sn!==null&&!Tn.done;Rn++,Tn=De.next()){sn.index>Rn?(gr=sn,sn=null):gr=sn.sibling;var Ho=Gt(Te,sn,Tn.value,gt);if(Ho===null){sn===null&&(sn=gr);break}p&&sn&&Ho.alternate===null&&g(Te,sn),ge=z(Ho,ge,Rn),on===null?Ot=Ho:on.sibling=Ho,on=Ho,sn=gr}if(Tn.done)return E(Te,sn),Zn&&sl(Te,Rn),Ot;if(sn===null){for(;!Tn.done;Rn++,Tn=De.next())Tn=rn(Te,Tn.value,gt),Tn!==null&&(ge=z(Tn,ge,Rn),on===null?Ot=Tn:on.sibling=Tn,on=Tn);return Zn&&sl(Te,Rn),Ot}for(sn=N(Te,sn);!Tn.done;Rn++,Tn=De.next())Tn=hn(sn,Te,Rn,Tn.value,gt),Tn!==null&&(p&&Tn.alternate!==null&&sn.delete(Tn.key===null?Rn:Tn.key),ge=z(Tn,ge,Rn),on===null?Ot=Tn:on.sibling=Tn,on=Tn);return p&&sn.forEach(function(sg){return g(Te,sg)}),Zn&&sl(Te,Rn),Ot}function ti(Te,ge,De,gt){if(typeof De=="object"&&De!==null&&De.type===f&&De.key===null&&(De=De.props.children),typeof De=="object"&&De!==null){switch(De.$$typeof){case c:e:{for(var Ot=De.key,on=ge;on!==null;){if(on.key===Ot){if(Ot=De.type,Ot===f){if(on.tag===7){E(Te,on.sibling),ge=F(on,De.props.children),ge.return=Te,Te=ge;break e}}else if(on.elementType===Ot||typeof Ot=="object"&&Ot!==null&&Ot.$$typeof===T&&fc(Ot)===on.type){E(Te,on.sibling),ge=F(on,De.props),ge.ref=hc(Te,on,De),ge.return=Te,Te=ge;break e}E(Te,on);break}else g(Te,on);on=on.sibling}De.type===f?(ge=Tl(De.props.children,Te.mode,gt,De.key),ge.return=Te,Te=ge):(gt=Sf(De.type,De.key,De.props,null,Te.mode,gt),gt.ref=hc(Te,ge,De),gt.return=Te,Te=gt)}return te(Te);case d:e:{for(on=De.key;ge!==null;){if(ge.key===on)if(ge.tag===4&&ge.stateNode.containerInfo===De.containerInfo&&ge.stateNode.implementation===De.implementation){E(Te,ge.sibling),ge=F(ge,De.children||[]),ge.return=Te,Te=ge;break e}else{E(Te,ge);break}else g(Te,ge);ge=ge.sibling}ge=Ef(De,Te.mode,gt),ge.return=Te,Te=ge}return te(Te);case T:return on=De._init,ti(Te,ge,on(De._payload),gt)}if(oe(De))return yt(Te,ge,De,gt);if(j(De))return qr(Te,ge,De,gt);va(Te,De)}return typeof De=="string"&&De!==""||typeof De=="number"?(De=""+De,ge!==null&&ge.tag===6?(E(Te,ge.sibling),ge=F(ge,De),ge.return=Te,Te=ge):(E(Te,ge),ge=bf(De,Te.mode,gt),ge.return=Te,Te=ge),te(Te)):E(Te,ge)}return ti}var Ro=uv(!0),dv=uv(!1),pc={},Ns=Ft(pc),il=Ft(pc),ol=Ft(pc);function Ui(p){if(p===pc)throw Error(o(174));return p}function Kh(p,g){Nt(ol,g),Nt(il,p),Nt(Ns,pc),p=ce(g),it(Ns),Nt(Ns,p)}function mc(){it(Ns),it(il),it(ol)}function hv(p){var g=Ui(ol.current),E=Ui(Ns.current);g=V(E,p.type,g),E!==g&&(Nt(il,p),Nt(Ns,g))}function Am(p){il.current===p&&(it(Ns),it(il))}var nr=Ft(0);function Qh(p){for(var g=p;g!==null;){if(g.tag===13){var E=g.memoizedState;if(E!==null&&(E=E.dehydrated,E===null||wr(E)||Oi(E)))return g}else if(g.tag===19&&g.memoizedProps.revealOrder!==void 0){if((g.flags&128)!==0)return g}else if(g.child!==null){g.child.return=g,g=g.child;continue}if(g===p)break;for(;g.sibling===null;){if(g.return===null||g.return===p)return null;g=g.return}g.sibling.return=g.return,g=g.sibling}return null}var Xs=[];function al(){for(var p=0;p<Xs.length;p++){var g=Xs[p];$e?g._workInProgressVersionPrimary=null:g._workInProgressVersionSecondary=null}Xs.length=0}var Ou=a.ReactCurrentDispatcher,Ys=a.ReactCurrentBatchConfig,ll=0,rr=null,Ir=null,kr=null,Jh=!1,oo=!1,cl=0,ju=0;function Dr(){throw Error(o(321))}function Zh(p,g){if(g===null)return!1;for(var E=0;E<g.length&&E<p.length;E++)if(!cs(p[E],g[E]))return!1;return!0}function gc(p,g,E,N,F,z){if(ll=z,rr=g,g.memoizedState=null,g.updateQueue=null,g.lanes=0,Ou.current=p===null||p.memoizedState===null?Dm:Lm,p=E(N,F),oo){z=0;do{if(oo=!1,cl=0,25<=z)throw Error(o(301));z+=1,kr=Ir=null,g.updateQueue=null,Ou.current=Om,p=E(N,F)}while(oo)}if(Ou.current=_c,g=Ir!==null&&Ir.next!==null,ll=0,kr=Ir=rr=null,Jh=!1,g)throw Error(o(300));return p}function xa(){var p=cl!==0;return cl=0,p}function Bi(){var p={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return kr===null?rr.memoizedState=kr=p:kr=kr.next=p,kr}function zi(){if(Ir===null){var p=rr.alternate;p=p!==null?p.memoizedState:null}else p=Ir.next;var g=kr===null?rr.memoizedState:kr.next;if(g!==null)kr=g,Ir=p;else{if(p===null)throw Error(o(310));Ir=p,p={memoizedState:Ir.memoizedState,baseState:Ir.baseState,baseQueue:Ir.baseQueue,queue:Ir.queue,next:null},kr===null?rr.memoizedState=kr=p:kr=kr.next=p}return kr}function ao(p,g){return typeof g=="function"?g(p):g}function Fu(p){var g=zi(),E=g.queue;if(E===null)throw Error(o(311));E.lastRenderedReducer=p;var N=Ir,F=N.baseQueue,z=E.pending;if(z!==null){if(F!==null){var te=F.next;F.next=z.next,z.next=te}N.baseQueue=F=z,E.pending=null}if(F!==null){z=F.next,N=N.baseState;var pe=te=null,Oe=null,ot=z;do{var Tt=ot.lane;if((ll&Tt)===Tt)Oe!==null&&(Oe=Oe.next={lane:0,action:ot.action,hasEagerState:ot.hasEagerState,eagerState:ot.eagerState,next:null}),N=ot.hasEagerState?ot.eagerState:p(N,ot.action);else{var rn={lane:Tt,action:ot.action,hasEagerState:ot.hasEagerState,eagerState:ot.eagerState,next:null};Oe===null?(pe=Oe=rn,te=N):Oe=Oe.next=rn,rr.lanes|=Tt,co|=Tt}ot=ot.next}while(ot!==null&&ot!==z);Oe===null?te=N:Oe.next=pe,cs(N,g.memoizedState)||(Lr=!0),g.memoizedState=N,g.baseState=te,g.baseQueue=Oe,E.lastRenderedState=N}if(p=E.interleaved,p!==null){F=p;do z=F.lane,rr.lanes|=z,co|=z,F=F.next;while(F!==p)}else F===null&&(E.lanes=0);return[g.memoizedState,E.dispatch]}function Uu(p){var g=zi(),E=g.queue;if(E===null)throw Error(o(311));E.lastRenderedReducer=p;var N=E.dispatch,F=E.pending,z=g.memoizedState;if(F!==null){E.pending=null;var te=F=F.next;do z=p(z,te.action),te=te.next;while(te!==F);cs(z,g.memoizedState)||(Lr=!0),g.memoizedState=z,g.baseQueue===null&&(g.baseState=z),E.lastRenderedState=z}return[z,N]}function Rm(){}function Nm(p,g){var E=rr,N=zi(),F=g(),z=!cs(N.memoizedState,F);if(z&&(N.memoizedState=F,Lr=!0),N=N.queue,vc(No.bind(null,E,N,p),[p]),N.getSnapshot!==g||z||kr!==null&&kr.memoizedState.tag&1){if(E.flags|=2048,zu(9,Im.bind(null,E,N,F,g),void 0,null),hr===null)throw Error(o(349));(ll&30)!==0||Pm(E,g,F)}return F}function Pm(p,g,E){p.flags|=16384,p={getSnapshot:g,value:E},g=rr.updateQueue,g===null?(g={lastEffect:null,stores:null},rr.updateQueue=g,g.stores=[p]):(E=g.stores,E===null?g.stores=[p]:E.push(p))}function Im(p,g,E,N){g.value=E,g.getSnapshot=N,ef(g)&&rs(p,1,-1)}function No(p,g,E){return E(function(){ef(g)&&rs(p,1,-1)})}function ef(p){var g=p.getSnapshot;p=p.value;try{var E=g();return!cs(p,E)}catch{return!0}}function Bu(p){var g=Bi();return typeof p=="function"&&(p=p()),g.memoizedState=g.baseState=p,p={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:ao,lastRenderedState:p},g.queue=p,p=p.dispatch=kw.bind(null,rr,p),[g.memoizedState,p]}function zu(p,g,E,N){return p={tag:p,create:g,destroy:E,deps:N,next:null},g=rr.updateQueue,g===null?(g={lastEffect:null,stores:null},rr.updateQueue=g,g.lastEffect=p.next=p):(E=g.lastEffect,E===null?g.lastEffect=p.next=p:(N=E.next,E.next=p,p.next=N,g.lastEffect=p)),p}function fv(){return zi().memoizedState}function ya(p,g,E,N){var F=Bi();rr.flags|=p,F.memoizedState=zu(1|g,E,void 0,N===void 0?null:N)}function tf(p,g,E,N){var F=zi();N=N===void 0?null:N;var z=void 0;if(Ir!==null){var te=Ir.memoizedState;if(z=te.destroy,N!==null&&Zh(N,te.deps)){F.memoizedState=zu(g,E,z,N);return}}rr.flags|=p,F.memoizedState=zu(1|g,E,z,N)}function nf(p,g){return ya(8390656,8,p,g)}function vc(p,g){return tf(2048,8,p,g)}function $n(p,g){return tf(4,2,p,g)}function rf(p,g){return tf(4,4,p,g)}function Vu(p,g){if(typeof g=="function")return p=p(),g(p),function(){g(null)};if(g!=null)return p=p(),g.current=p,function(){g.current=null}}function xc(p,g,E){return E=E!=null?E.concat([p]):null,tf(4,4,Vu.bind(null,g,p),E)}function sf(){}function of(p,g){var E=zi();g=g===void 0?null:g;var N=E.memoizedState;return N!==null&&g!==null&&Zh(g,N[1])?N[0]:(E.memoizedState=[p,g],p)}function yc(p,g){var E=zi();g=g===void 0?null:g;var N=E.memoizedState;return N!==null&&g!==null&&Zh(g,N[1])?N[0]:(p=p(),E.memoizedState=[p,g],p)}function af(p,g){var E=vn;vn=E!==0&&4>E?E:4,p(!0);var N=Ys.transition;Ys.transition={};try{p(!1),g()}finally{vn=E,Ys.transition=N}}function ul(){return zi().memoizedState}function pv(p,g,E){var N=Wi(p);E={lane:N,action:E,hasEagerState:!1,eagerState:null,next:null},mv(p)?km(g,E):(Hu(p,g,E),E=In(),p=rs(p,N,E),p!==null&&Gu(p,g,N))}function kw(p,g,E){var N=Wi(p),F={lane:N,action:E,hasEagerState:!1,eagerState:null,next:null};if(mv(p))km(g,F);else{Hu(p,g,F);var z=p.alternate;if(p.lanes===0&&(z===null||z.lanes===0)&&(z=g.lastRenderedReducer,z!==null))try{var te=g.lastRenderedState,pe=z(te,E);if(F.hasEagerState=!0,F.eagerState=pe,cs(pe,te))return}catch{}finally{}E=In(),p=rs(p,N,E),p!==null&&Gu(p,g,N)}}function mv(p){var g=p.alternate;return p===rr||g!==null&&g===rr}function km(p,g){oo=Jh=!0;var E=p.pending;E===null?g.next=g:(g.next=E.next,E.next=g),p.pending=g}function Hu(p,g,E){hr!==null&&(p.mode&1)!==0&&(ln&2)===0?(p=g.interleaved,p===null?(E.next=E,pi===null?pi=[g]:pi.push(g)):(E.next=p.next,p.next=E),g.interleaved=E):(p=g.pending,p===null?E.next=E:(E.next=p.next,p.next=E),g.pending=E)}function Gu(p,g,E){if((E&4194240)!==0){var N=g.lanes;N&=p.pendingLanes,E|=N,g.lanes=E,so(p,E)}}var _c={readContext:Rs,useCallback:Dr,useContext:Dr,useEffect:Dr,useImperativeHandle:Dr,useInsertionEffect:Dr,useLayoutEffect:Dr,useMemo:Dr,useReducer:Dr,useRef:Dr,useState:Dr,useDebugValue:Dr,useDeferredValue:Dr,useTransition:Dr,useMutableSource:Dr,useSyncExternalStore:Dr,useId:Dr,unstable_isNewReconciler:!1},Dm={readContext:Rs,useCallback:function(p,g){return Bi().memoizedState=[p,g===void 0?null:g],p},useContext:Rs,useEffect:nf,useImperativeHandle:function(p,g,E){return E=E!=null?E.concat([p]):null,ya(4194308,4,Vu.bind(null,g,p),E)},useLayoutEffect:function(p,g){return ya(4194308,4,p,g)},useInsertionEffect:function(p,g){return ya(4,2,p,g)},useMemo:function(p,g){var E=Bi();return g=g===void 0?null:g,p=p(),E.memoizedState=[p,g],p},useReducer:function(p,g,E){var N=Bi();return g=E!==void 0?E(g):g,N.memoizedState=N.baseState=g,p={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:p,lastRenderedState:g},N.queue=p,p=p.dispatch=pv.bind(null,rr,p),[N.memoizedState,p]},useRef:function(p){var g=Bi();return p={current:p},g.memoizedState=p},useState:Bu,useDebugValue:sf,useDeferredValue:function(p){var g=Bu(p),E=g[0],N=g[1];return nf(function(){var F=Ys.transition;Ys.transition={};try{N(p)}finally{Ys.transition=F}},[p]),E},useTransition:function(){var p=Bu(!1),g=p[0];return p=af.bind(null,p[1]),Bi().memoizedState=p,[g,p]},useMutableSource:function(){},useSyncExternalStore:function(p,g,E){var N=rr,F=Bi();if(Zn){if(E===void 0)throw Error(o(407));E=E()}else{if(E=g(),hr===null)throw Error(o(349));(ll&30)!==0||Pm(N,g,E)}F.memoizedState=E;var z={value:E,getSnapshot:g};return F.queue=z,nf(No.bind(null,N,z,p),[p]),N.flags|=2048,zu(9,Im.bind(null,N,z,E,g),void 0,null),E},useId:function(){var p=Bi(),g=hr.identifierPrefix;if(Zn){var E=Ao,N=Co;E=(N&~(1<<32-wn(N)-1)).toString(32)+E,g=":"+g+"R"+E,E=cl++,0<E&&(g+="H"+E.toString(32)),g+=":"}else E=ju++,g=":"+g+"r"+E.toString(32)+":";return p.memoizedState=g},unstable_isNewReconciler:!1},Lm={readContext:Rs,useCallback:of,useContext:Rs,useEffect:vc,useImperativeHandle:xc,useInsertionEffect:$n,useLayoutEffect:rf,useMemo:yc,useReducer:Fu,useRef:fv,useState:function(){return Fu(ao)},useDebugValue:sf,useDeferredValue:function(p){var g=Fu(ao),E=g[0],N=g[1];return vc(function(){var F=Ys.transition;Ys.transition={};try{N(p)}finally{Ys.transition=F}},[p]),E},useTransition:function(){var p=Fu(ao)[0],g=zi().memoizedState;return[p,g]},useMutableSource:Rm,useSyncExternalStore:Nm,useId:ul,unstable_isNewReconciler:!1},Om={readContext:Rs,useCallback:of,useContext:Rs,useEffect:vc,useImperativeHandle:xc,useInsertionEffect:$n,useLayoutEffect:rf,useMemo:yc,useReducer:Uu,useRef:fv,useState:function(){return Uu(ao)},useDebugValue:sf,useDeferredValue:function(p){var g=Uu(ao),E=g[0],N=g[1];return vc(function(){var F=Ys.transition;Ys.transition={};try{N(p)}finally{Ys.transition=F}},[p]),E},useTransition:function(){var p=Uu(ao)[0],g=zi().memoizedState;return[p,g]},useMutableSource:Rm,useSyncExternalStore:Nm,useId:ul,unstable_isNewReconciler:!1};function jm(p,g){try{var E="",N=g;do E+=ym(N),N=N.return;while(N);var F=E}catch(z){F=`
Error generating stack: `+z.message+`
`+z.stack}return{value:p,source:g,stack:F}}function lf(p,g){try{console.error(g.value)}catch(E){setTimeout(function(){throw E})}}var Dw=typeof WeakMap=="function"?WeakMap:Map;function gv(p,g,E){E=To(-1,E),E.tag=3,E.payload={element:null};var N=g.value;return E.callback=function(){Tc||(Tc=!0,Jn=N),lf(p,g)},E}function cf(p,g,E){E=To(-1,E),E.tag=3;var N=p.type.getDerivedStateFromError;if(typeof N=="function"){var F=g.value;E.payload=function(){return N(F)},E.callback=function(){lf(p,g)}}var z=p.stateNode;return z!==null&&typeof z.componentDidCatch=="function"&&(E.callback=function(){lf(p,g),typeof N!="function"&&(Gi===null?Gi=new Set([this]):Gi.add(this));var te=g.stack;this.componentDidCatch(g.value,{componentStack:te!==null?te:""})}),E}function Po(p,g,E){var N=p.pingCache;if(N===null){N=p.pingCache=new Dw;var F=new Set;N.set(g,F)}else F=N.get(g),F===void 0&&(F=new Set,N.set(g,F));F.has(E)||(F.add(E),p=tg.bind(null,p,g,E),g.then(p,p))}function Fm(p){do{var g;if((g=p.tag===13)&&(g=p.memoizedState,g=g!==null?g.dehydrated!==null:!0),g)return p;p=p.return}while(p!==null);return null}function dl(p,g,E,N,F){return(p.mode&1)===0?(p===g?p.flags|=65536:(p.flags|=128,E.flags|=131072,E.flags&=-52805,E.tag===1&&(E.alternate===null?E.tag=17:(g=To(-1,1),g.tag=2,pa(E,g))),E.lanes|=1),p):(p.flags|=65536,p.lanes=F,p)}function br(p){p.flags|=4}function wc(p,g){if(p!==null&&p.child===g.child)return!0;if((g.flags&16)!==0)return!1;for(p=g.child;p!==null;){if((p.flags&12854)!==0||(p.subtreeFlags&12854)!==0)return!1;p=p.sibling}return!0}var Ks,hl,uf,df;if(dt)Ks=function(p,g){for(var E=g.child;E!==null;){if(E.tag===5||E.tag===6)ie(p,E.stateNode);else if(E.tag!==4&&E.child!==null){E.child.return=E,E=E.child;continue}if(E===g)break;for(;E.sibling===null;){if(E.return===null||E.return===g)return;E=E.return}E.sibling.return=E.return,E=E.sibling}},hl=function(){},uf=function(p,g,E,N,F){if(p=p.memoizedProps,p!==N){var z=g.stateNode,te=Ui(Ns.current);E=ue(z,E,p,N,F,te),(g.updateQueue=E)&&br(g)}},df=function(p,g,E,N){E!==N&&br(g)};else if(ht){Ks=function(p,g,E,N){for(var F=g.child;F!==null;){if(F.tag===5){var z=F.stateNode;E&&N&&(z=Ht(z,F.type,F.memoizedProps,F)),ie(p,z)}else if(F.tag===6)z=F.stateNode,E&&N&&(z=An(z,F.memoizedProps,F)),ie(p,z);else if(F.tag!==4){if(F.tag===22&&F.memoizedState!==null)z=F.child,z!==null&&(z.return=F),Ks(p,F,!0,!0);else if(F.child!==null){F.child.return=F,F=F.child;continue}}if(F===g)break;for(;F.sibling===null;){if(F.return===null||F.return===g)return;F=F.return}F.sibling.return=F.return,F=F.sibling}};var _a=function(p,g,E,N){for(var F=g.child;F!==null;){if(F.tag===5){var z=F.stateNode;E&&N&&(z=Ht(z,F.type,F.memoizedProps,F)),Be(p,z)}else if(F.tag===6)z=F.stateNode,E&&N&&(z=An(z,F.memoizedProps,F)),Be(p,z);else if(F.tag!==4){if(F.tag===22&&F.memoizedState!==null)z=F.child,z!==null&&(z.return=F),_a(p,F,!0,!0);else if(F.child!==null){F.child.return=F,F=F.child;continue}}if(F===g)break;for(;F.sibling===null;){if(F.return===null||F.return===g)return;F=F.return}F.sibling.return=F.return,F=F.sibling}};hl=function(p,g){var E=g.stateNode;if(!wc(p,g)){p=E.containerInfo;var N=ze(p);_a(N,g,!1,!1),E.pendingChildren=N,br(g),lt(p,N)}},uf=function(p,g,E,N,F){var z=p.stateNode,te=p.memoizedProps;if((p=wc(p,g))&&te===N)g.stateNode=z;else{var pe=g.stateNode,Oe=Ui(Ns.current),ot=null;te!==N&&(ot=ue(pe,E,te,N,F,Oe)),p&&ot===null?g.stateNode=z:(z=Ye(z,ot,E,te,N,g,p,pe),be(z,E,N,F,Oe)&&br(g),g.stateNode=z,p?br(g):Ks(z,g,!1,!1))}},df=function(p,g,E,N){E!==N?(p=Ui(ol.current),E=Ui(Ns.current),g.stateNode=Fe(N,p,E,g),br(g)):g.stateNode=p.stateNode}}else hl=function(){},uf=function(){},df=function(){};function Io(p,g){if(!Zn)switch(p.tailMode){case"hidden":g=p.tail;for(var E=null;g!==null;)g.alternate!==null&&(E=g),g=g.sibling;E===null?p.tail=null:E.sibling=null;break;case"collapsed":E=p.tail;for(var N=null;E!==null;)E.alternate!==null&&(N=E),E=E.sibling;N===null?g||p.tail===null?p.tail=null:p.tail.sibling=null:N.sibling=null}}function dr(p){var g=p.alternate!==null&&p.alternate.child===p.child,E=0,N=0;if(g)for(var F=p.child;F!==null;)E|=F.lanes|F.childLanes,N|=F.subtreeFlags&14680064,N|=F.flags&14680064,F.return=p,F=F.sibling;else for(F=p.child;F!==null;)E|=F.lanes|F.childLanes,N|=F.subtreeFlags,N|=F.flags,F.return=p,F=F.sibling;return p.subtreeFlags|=N,p.childLanes=E,g}function hf(p,g,E){var N=g.pendingProps;switch(Mm(g),g.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return dr(g),null;case 1:return En(g.type)&&gn(),dr(g),null;case 3:return N=g.stateNode,mc(),it(_n),it(un),al(),N.pendingContext&&(N.context=N.pendingContext,N.pendingContext=null),(p===null||p.child===null)&&(Lu(g)?br(g):p===null||p.memoizedState.isDehydrated&&(g.flags&256)===0||(g.flags|=1024,vi!==null&&(rd(vi),vi=null))),hl(p,g),dr(g),null;case 5:Am(g),E=Ui(ol.current);var F=g.type;if(p!==null&&g.stateNode!=null)uf(p,g,F,N,E),p.ref!==g.ref&&(g.flags|=512,g.flags|=2097152);else{if(!N){if(g.stateNode===null)throw Error(o(166));return dr(g),null}if(p=Ui(Ns.current),Lu(g)){if(!Ie)throw Error(o(175));p=Th(g.stateNode,g.type,g.memoizedProps,E,p,g,!uc),g.updateQueue=p,p!==null&&br(g)}else{var z=X(F,N,E,p,g);Ks(z,g,!1,!1),g.stateNode=z,be(z,F,N,E,p)&&br(g)}g.ref!==null&&(g.flags|=512,g.flags|=2097152)}return dr(g),null;case 6:if(p&&g.stateNode!=null)df(p,g,p.memoizedProps,N);else{if(typeof N!="string"&&g.stateNode===null)throw Error(o(166));if(p=Ui(ol.current),E=Ui(Ns.current),Lu(g)){if(!Ie)throw Error(o(176));if(p=g.stateNode,N=g.memoizedProps,(E=no(p,N,g,!uc))&&(F=ds,F!==null))switch(z=(F.mode&1)!==0,F.tag){case 3:xe(F.stateNode.containerInfo,p,N,z);break;case 5:Ne(F.type,F.memoizedProps,F.stateNode,p,N,z)}E&&br(g)}else g.stateNode=Fe(N,p,E,g)}return dr(g),null;case 13:if(it(nr),N=g.memoizedState,Zn&&Vr!==null&&(g.mode&1)!==0&&(g.flags&128)===0){for(p=Vr;p;)p=ji(p);return dc(),g.flags|=98560,g}if(N!==null&&N.dehydrated!==null){if(N=Lu(g),p===null){if(!N)throw Error(o(318));if(!Ie)throw Error(o(344));if(p=g.memoizedState,p=p!==null?p.dehydrated:null,!p)throw Error(o(317));Ch(p,g)}else dc(),(g.flags&128)===0&&(g.memoizedState=null),g.flags|=4;return dr(g),null}return vi!==null&&(rd(vi),vi=null),(g.flags&128)!==0?(g.lanes=E,g):(N=N!==null,E=!1,p===null?Lu(g):E=p.memoizedState!==null,N&&!E&&(g.child.flags|=8192,(g.mode&1)!==0&&(p===null||(nr.current&1)!==0?lr===0&&(lr=3):yf())),g.updateQueue!==null&&(g.flags|=4),dr(g),null);case 4:return mc(),hl(p,g),p===null&&Ce(g.stateNode.containerInfo),dr(g),null;case 10:return Du(g.type._context),dr(g),null;case 17:return En(g.type)&&gn(),dr(g),null;case 19:if(it(nr),F=g.memoizedState,F===null)return dr(g),null;if(N=(g.flags&128)!==0,z=F.rendering,z===null)if(N)Io(F,!1);else{if(lr!==0||p!==null&&(p.flags&128)!==0)for(p=g.child;p!==null;){if(z=Qh(p),z!==null){for(g.flags|=128,Io(F,!1),p=z.updateQueue,p!==null&&(g.updateQueue=p,g.flags|=4),g.subtreeFlags=0,p=E,N=g.child;N!==null;)E=N,F=p,E.flags&=14680066,z=E.alternate,z===null?(E.childLanes=0,E.lanes=F,E.child=null,E.subtreeFlags=0,E.memoizedProps=null,E.memoizedState=null,E.updateQueue=null,E.dependencies=null,E.stateNode=null):(E.childLanes=z.childLanes,E.lanes=z.lanes,E.child=z.child,E.subtreeFlags=0,E.deletions=null,E.memoizedProps=z.memoizedProps,E.memoizedState=z.memoizedState,E.updateQueue=z.updateQueue,E.type=z.type,F=z.dependencies,E.dependencies=F===null?null:{lanes:F.lanes,firstContext:F.firstContext}),N=N.sibling;return Nt(nr,nr.current&1|2),g.child}p=p.sibling}F.tail!==null&&Sr()>ba&&(g.flags|=128,N=!0,Io(F,!1),g.lanes=4194304)}else{if(!N)if(p=Qh(z),p!==null){if(g.flags|=128,N=!0,p=p.updateQueue,p!==null&&(g.updateQueue=p,g.flags|=4),Io(F,!0),F.tail===null&&F.tailMode==="hidden"&&!z.alternate&&!Zn)return dr(g),null}else 2*Sr()-F.renderingStartTime>ba&&E!==1073741824&&(g.flags|=128,N=!0,Io(F,!1),g.lanes=4194304);F.isBackwards?(z.sibling=g.child,g.child=z):(p=F.last,p!==null?p.sibling=z:g.child=z,F.last=z)}return F.tail!==null?(g=F.tail,F.rendering=g,F.tail=g.sibling,F.renderingStartTime=Sr(),g.sibling=null,p=nr.current,Nt(nr,N?p&1|2:p&1),g):(dr(g),null);case 22:case 23:return sd(),N=g.memoizedState!==null,p!==null&&p.memoizedState!==null!==N&&(g.flags|=8192),N&&(g.mode&1)!==0?(ns&1073741824)!==0&&(dr(g),dt&&g.subtreeFlags&6&&(g.flags|=8192)):dr(g),null;case 24:return null;case 25:return null}throw Error(o(156,g.tag))}var Um=a.ReactCurrentOwner,Lr=!1;function ar(p,g,E,N){g.child=p===null?dv(g,null,E,N):Ro(g,p.child,E,N)}function qn(p,g,E,N,F){E=E.render;var z=g.ref;return ac(g,F),N=gc(p,g,E,N,z,F),E=xa(),p!==null&&!Lr?(g.updateQueue=p.updateQueue,g.flags&=-2053,p.lanes&=~F,Ps(p,g,F)):(Zn&&E&&Em(g),g.flags|=1,ar(p,g,N,F),g.child)}function Gn(p,g,E,N,F){if(p===null){var z=E.type;return typeof z=="function"&&!wf(z)&&z.defaultProps===void 0&&E.compare===null&&E.defaultProps===void 0?(g.tag=15,g.type=z,ko(p,g,z,N,F)):(p=Sf(E.type,null,N,g,g.mode,F),p.ref=g.ref,p.return=g,g.child=p)}if(z=p.child,(p.lanes&F)===0){var te=z.memoizedProps;if(E=E.compare,E=E!==null?E:Fi,E(te,N)&&p.ref===g.ref)return Ps(p,g,F)}return g.flags|=1,p=Vo(z,N),p.ref=g.ref,p.return=g,g.child=p}function ko(p,g,E,N,F){if(p!==null&&Fi(p.memoizedProps,N)&&p.ref===g.ref)if(Lr=!1,(p.lanes&F)!==0)(p.flags&131072)!==0&&(Lr=!0);else return g.lanes=p.lanes,Ps(p,g,F);return Do(p,g,E,N,F)}function Hr(p,g,E){var N=g.pendingProps,F=N.children,z=p!==null?p.memoizedState:null;if(N.mode==="hidden")if((g.mode&1)===0)g.memoizedState={baseLanes:0,cachePool:null},Nt(wl,ns),ns|=E;else if((E&1073741824)!==0)g.memoizedState={baseLanes:0,cachePool:null},N=z!==null?z.baseLanes:E,Nt(wl,ns),ns|=N;else return p=z!==null?z.baseLanes|E:E,g.lanes=g.childLanes=1073741824,g.memoizedState={baseLanes:p,cachePool:null},g.updateQueue=null,Nt(wl,ns),ns|=p,null;else z!==null?(N=z.baseLanes|E,g.memoizedState=null):N=E,Nt(wl,ns),ns|=N;return ar(p,g,F,E),g.child}function hs(p,g){var E=g.ref;(p===null&&E!==null||p!==null&&p.ref!==E)&&(g.flags|=512,g.flags|=2097152)}function Do(p,g,E,N,F){var z=En(E)?dn:un.current;return z=kt(g,z),ac(g,F),E=gc(p,g,E,N,z,F),N=xa(),p!==null&&!Lr?(g.updateQueue=p.updateQueue,g.flags&=-2053,p.lanes&=~F,Ps(p,g,F)):(Zn&&N&&Em(g),g.flags|=1,ar(p,g,E,F),g.child)}function fl(p,g,E,N,F){if(En(E)){var z=!0;Nr(g)}else z=!1;if(ac(g,F),g.stateNode===null)p!==null&&(p.alternate=null,g.alternate=null,g.flags|=2),ov(g,E,N),bm(g,E,N,F),N=!0;else if(p===null){var te=g.stateNode,pe=g.memoizedProps;te.props=pe;var Oe=te.context,ot=E.contextType;typeof ot=="object"&&ot!==null?ot=Rs(ot):(ot=En(E)?dn:un.current,ot=kt(g,ot));var Tt=E.getDerivedStateFromProps,rn=typeof Tt=="function"||typeof te.getSnapshotBeforeUpdate=="function";rn||typeof te.UNSAFE_componentWillReceiveProps!="function"&&typeof te.componentWillReceiveProps!="function"||(pe!==N||Oe!==ot)&&av(g,te,N,ot),mi=!1;var Gt=g.memoizedState;te.state=Gt,Gh(g,N,te,F),Oe=g.memoizedState,pe!==N||Gt!==Oe||_n.current||mi?(typeof Tt=="function"&&(wm(g,E,Tt,N),Oe=g.memoizedState),(pe=mi||Sm(g,E,pe,N,Gt,Oe,ot))?(rn||typeof te.UNSAFE_componentWillMount!="function"&&typeof te.componentWillMount!="function"||(typeof te.componentWillMount=="function"&&te.componentWillMount(),typeof te.UNSAFE_componentWillMount=="function"&&te.UNSAFE_componentWillMount()),typeof te.componentDidMount=="function"&&(g.flags|=4194308)):(typeof te.componentDidMount=="function"&&(g.flags|=4194308),g.memoizedProps=N,g.memoizedState=Oe),te.props=N,te.state=Oe,te.context=ot,N=pe):(typeof te.componentDidMount=="function"&&(g.flags|=4194308),N=!1)}else{te=g.stateNode,_m(p,g),pe=g.memoizedProps,ot=g.type===g.elementType?pe:As(g.type,pe),te.props=ot,rn=g.pendingProps,Gt=te.context,Oe=E.contextType,typeof Oe=="object"&&Oe!==null?Oe=Rs(Oe):(Oe=En(E)?dn:un.current,Oe=kt(g,Oe));var hn=E.getDerivedStateFromProps;(Tt=typeof hn=="function"||typeof te.getSnapshotBeforeUpdate=="function")||typeof te.UNSAFE_componentWillReceiveProps!="function"&&typeof te.componentWillReceiveProps!="function"||(pe!==rn||Gt!==Oe)&&av(g,te,N,Oe),mi=!1,Gt=g.memoizedState,te.state=Gt,Gh(g,N,te,F);var yt=g.memoizedState;pe!==rn||Gt!==yt||_n.current||mi?(typeof hn=="function"&&(wm(g,E,hn,N),yt=g.memoizedState),(ot=mi||Sm(g,E,ot,N,Gt,yt,Oe)||!1)?(Tt||typeof te.UNSAFE_componentWillUpdate!="function"&&typeof te.componentWillUpdate!="function"||(typeof te.componentWillUpdate=="function"&&te.componentWillUpdate(N,yt,Oe),typeof te.UNSAFE_componentWillUpdate=="function"&&te.UNSAFE_componentWillUpdate(N,yt,Oe)),typeof te.componentDidUpdate=="function"&&(g.flags|=4),typeof te.getSnapshotBeforeUpdate=="function"&&(g.flags|=1024)):(typeof te.componentDidUpdate!="function"||pe===p.memoizedProps&&Gt===p.memoizedState||(g.flags|=4),typeof te.getSnapshotBeforeUpdate!="function"||pe===p.memoizedProps&&Gt===p.memoizedState||(g.flags|=1024),g.memoizedProps=N,g.memoizedState=yt),te.props=N,te.state=yt,te.context=Oe,N=ot):(typeof te.componentDidUpdate!="function"||pe===p.memoizedProps&&Gt===p.memoizedState||(g.flags|=4),typeof te.getSnapshotBeforeUpdate!="function"||pe===p.memoizedProps&&Gt===p.memoizedState||(g.flags|=1024),N=!1)}return ts(p,g,E,N,z,F)}function ts(p,g,E,N,F,z){hs(p,g);var te=(g.flags&128)!==0;if(!N&&!te)return F&&ro(g,E,!1),Ps(p,g,z);N=g.stateNode,Um.current=g;var pe=te&&typeof E.getDerivedStateFromError!="function"?null:N.render();return g.flags|=1,p!==null&&te?(g.child=Ro(g,p.child,null,z),g.child=Ro(g,null,pe,z)):ar(p,g,pe,z),g.memoizedState=N.state,F&&ro(g,E,!0),g.child}function Wu(p){var g=p.stateNode;g.pendingContext?Br(p,g.pendingContext,g.pendingContext!==g.context):g.context&&Br(p,g.context,!1),Kh(p,g.containerInfo)}function Bm(p,g,E,N,F){return dc(),Yh(F),g.flags|=256,ar(p,g,E,N),g.child}var $u={dehydrated:null,treeContext:null,retryLane:0};function pl(p){return{baseLanes:p,cachePool:null}}function zm(p,g,E){var N=g.pendingProps,F=nr.current,z=!1,te=(g.flags&128)!==0,pe;if((pe=te)||(pe=p!==null&&p.memoizedState===null?!1:(F&2)!==0),pe?(z=!0,g.flags&=-129):(p===null||p.memoizedState!==null)&&(F|=1),Nt(nr,F&1),p===null)return ga(g),p=g.memoizedState,p!==null&&(p=p.dehydrated,p!==null)?((g.mode&1)===0?g.lanes=1:Oi(p)?g.lanes=8:g.lanes=1073741824,null):(F=N.children,p=N.fallback,z?(N=g.mode,z=g.child,F={mode:"hidden",children:F},(N&1)===0&&z!==null?(z.childLanes=0,z.pendingProps=F):z=ad(F,N,0,null),p=Tl(p,N,E,null),z.return=g,p.return=g,z.sibling=p,g.child=z,g.child.memoizedState=pl(E),g.memoizedState=$u,p):Vi(g,F));if(F=p.memoizedState,F!==null){if(pe=F.dehydrated,pe!==null){if(te)return g.flags&256?(g.flags&=-257,Xu(p,g,E,Error(o(422)))):g.memoizedState!==null?(g.child=p.child,g.flags|=128,null):(z=N.fallback,F=g.mode,N=ad({mode:"visible",children:N.children},F,0,null),z=Tl(z,F,E,null),z.flags|=2,N.return=g,z.return=g,N.sibling=z,g.child=N,(g.mode&1)!==0&&Ro(g,p.child,null,E),g.child.memoizedState=pl(E),g.memoizedState=$u,z);if((g.mode&1)===0)g=Xu(p,g,E,null);else if(Oi(pe))g=Xu(p,g,E,Error(o(419)));else if(N=(E&p.childLanes)!==0,Lr||N){if(N=hr,N!==null){switch(E&-E){case 4:z=2;break;case 16:z=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:z=32;break;case 536870912:z=268435456;break;default:z=0}N=(z&(N.suspendedLanes|E))!==0?0:z,N!==0&&N!==F.retryLane&&(F.retryLane=N,rs(p,N,-1))}yf(),g=Xu(p,g,E,Error(o(421)))}else wr(pe)?(g.flags|=128,g.child=p.child,g=wv.bind(null,p),Ka(pe,g),g=null):(E=F.treeContext,Ie&&(Vr=ic(pe),ds=g,Zn=!0,vi=null,uc=!1,E!==null&&(gi[qs++]=Co,gi[qs++]=Ao,gi[qs++]=rl,Co=E.id,Ao=E.overflow,rl=g)),g=Vi(g,g.pendingProps.children),g.flags|=4096);return g}return z?(N=ff(p,g,N.children,N.fallback,E),z=g.child,F=p.child.memoizedState,z.memoizedState=F===null?pl(E):{baseLanes:F.baseLanes|E,cachePool:null},z.childLanes=p.childLanes&~E,g.memoizedState=$u,N):(E=qu(p,g,N.children,E),g.memoizedState=null,E)}return z?(N=ff(p,g,N.children,N.fallback,E),z=g.child,F=p.child.memoizedState,z.memoizedState=F===null?pl(E):{baseLanes:F.baseLanes|E,cachePool:null},z.childLanes=p.childLanes&~E,g.memoizedState=$u,N):(E=qu(p,g,N.children,E),g.memoizedState=null,E)}function Vi(p,g){return g=ad({mode:"visible",children:g},p.mode,0,null),g.return=p,p.child=g}function qu(p,g,E,N){var F=p.child;return p=F.sibling,E=Vo(F,{mode:"visible",children:E}),(g.mode&1)===0&&(E.lanes=N),E.return=g,E.sibling=null,p!==null&&(N=g.deletions,N===null?(g.deletions=[p],g.flags|=16):N.push(p)),g.child=E}function ff(p,g,E,N,F){var z=g.mode;p=p.child;var te=p.sibling,pe={mode:"hidden",children:E};return(z&1)===0&&g.child!==p?(E=g.child,E.childLanes=0,E.pendingProps=pe,g.deletions=null):(E=Vo(p,pe),E.subtreeFlags=p.subtreeFlags&14680064),te!==null?N=Vo(te,N):(N=Tl(N,z,F,null),N.flags|=2),N.return=g,E.return=g,E.sibling=N,g.child=E,N}function Xu(p,g,E,N){return N!==null&&Yh(N),Ro(g,p.child,null,E),p=Vi(g,g.pendingProps.children),p.flags|=2,g.memoizedState=null,p}function vv(p,g,E){p.lanes|=g;var N=p.alternate;N!==null&&(N.lanes|=g),nl(p.return,g,E)}function lo(p,g,E,N,F){var z=p.memoizedState;z===null?p.memoizedState={isBackwards:g,rendering:null,renderingStartTime:0,last:N,tail:E,tailMode:F}:(z.isBackwards=g,z.rendering=null,z.renderingStartTime=0,z.last=N,z.tail=E,z.tailMode=F)}function ml(p,g,E){var N=g.pendingProps,F=N.revealOrder,z=N.tail;if(ar(p,g,N.children,E),N=nr.current,(N&2)!==0)N=N&1|2,g.flags|=128;else{if(p!==null&&(p.flags&128)!==0)e:for(p=g.child;p!==null;){if(p.tag===13)p.memoizedState!==null&&vv(p,E,g);else if(p.tag===19)vv(p,E,g);else if(p.child!==null){p.child.return=p,p=p.child;continue}if(p===g)break e;for(;p.sibling===null;){if(p.return===null||p.return===g)break e;p=p.return}p.sibling.return=p.return,p=p.sibling}N&=1}if(Nt(nr,N),(g.mode&1)===0)g.memoizedState=null;else switch(F){case"forwards":for(E=g.child,F=null;E!==null;)p=E.alternate,p!==null&&Qh(p)===null&&(F=E),E=E.sibling;E=F,E===null?(F=g.child,g.child=null):(F=E.sibling,E.sibling=null),lo(g,!1,F,E,z);break;case"backwards":for(E=null,F=g.child,g.child=null;F!==null;){if(p=F.alternate,p!==null&&Qh(p)===null){g.child=F;break}p=F.sibling,F.sibling=E,E=F,F=p}lo(g,!0,E,null,z);break;case"together":lo(g,!1,null,null,void 0);break;default:g.memoizedState=null}return g.child}function Ps(p,g,E){if(p!==null&&(g.dependencies=p.dependencies),co|=g.lanes,(E&g.childLanes)===0)return null;if(p!==null&&g.child!==p.child)throw Error(o(153));if(g.child!==null){for(p=g.child,E=Vo(p,p.pendingProps),g.child=E,E.return=g;p.sibling!==null;)p=p.sibling,E=E.sibling=Vo(p,p.pendingProps),E.return=g;E.sibling=null}return g.child}function pf(p,g,E){switch(g.tag){case 3:Wu(g),dc();break;case 5:hv(g);break;case 1:En(g.type)&&Nr(g);break;case 4:Kh(g,g.stateNode.containerInfo);break;case 10:tl(g,g.type._context,g.memoizedProps.value);break;case 13:var N=g.memoizedState;if(N!==null)return N.dehydrated!==null?(Nt(nr,nr.current&1),g.flags|=128,null):(E&g.child.childLanes)!==0?zm(p,g,E):(Nt(nr,nr.current&1),p=Ps(p,g,E),p!==null?p.sibling:null);Nt(nr,nr.current&1);break;case 19:if(N=(E&g.childLanes)!==0,(p.flags&128)!==0){if(N)return ml(p,g,E);g.flags|=128}var F=g.memoizedState;if(F!==null&&(F.rendering=null,F.tail=null,F.lastEffect=null),Nt(nr,nr.current),N)break;return null;case 22:case 23:return g.lanes=0,Hr(p,g,E)}return Ps(p,g,E)}function mf(p,g){switch(Mm(g),g.tag){case 1:return En(g.type)&&gn(),p=g.flags,p&65536?(g.flags=p&-65537|128,g):null;case 3:return mc(),it(_n),it(un),al(),p=g.flags,(p&65536)!==0&&(p&128)===0?(g.flags=p&-65537|128,g):null;case 5:return Am(g),null;case 13:if(it(nr),p=g.memoizedState,p!==null&&p.dehydrated!==null){if(g.alternate===null)throw Error(o(340));dc()}return p=g.flags,p&65536?(g.flags=p&-65537|128,g):null;case 19:return it(nr),null;case 4:return mc(),null;case 10:return Du(g.type._context),null;case 22:case 23:return sd(),null;case 24:return null;default:return null}}var fs=!1,Or=!1,gl=typeof WeakSet=="function"?WeakSet:Set,ut=null;function xi(p,g){var E=p.ref;if(E!==null)if(typeof E=="function")try{E(null)}catch(N){ms(p,g,N)}else E.current=null}function Lo(p,g,E){try{E()}catch(N){ms(p,g,N)}}var Vm=!1;function Hm(p,g){for(q(p.containerInfo),ut=g;ut!==null;)if(p=ut,g=p.child,(p.subtreeFlags&1028)!==0&&g!==null)g.return=p,ut=g;else for(;ut!==null;){p=ut;try{var E=p.alternate;if((p.flags&1024)!==0)switch(p.tag){case 0:case 11:case 15:break;case 1:if(E!==null){var N=E.memoizedProps,F=E.memoizedState,z=p.stateNode,te=z.getSnapshotBeforeUpdate(p.elementType===p.type?N:As(p.type,N),F);z.__reactInternalSnapshotBeforeUpdate=te}break;case 3:dt&&ct(p.stateNode.containerInfo);break;case 5:case 6:case 4:case 17:break;default:throw Error(o(163))}}catch(pe){ms(p,p.return,pe)}if(g=p.sibling,g!==null){g.return=p.return,ut=g;break}ut=p.return}return E=Vm,Vm=!1,E}function Oo(p,g,E){var N=g.updateQueue;if(N=N!==null?N.lastEffect:null,N!==null){var F=N=N.next;do{if((F.tag&p)===p){var z=F.destroy;F.destroy=void 0,z!==void 0&&Lo(g,E,z)}F=F.next}while(F!==N)}}function Gr(p,g){if(g=g.updateQueue,g=g!==null?g.lastEffect:null,g!==null){var E=g=g.next;do{if((E.tag&p)===p){var N=E.create;E.destroy=N()}E=E.next}while(E!==g)}}function ps(p){var g=p.ref;if(g!==null){var E=p.stateNode;switch(p.tag){case 5:p=ne(E);break;default:p=E}typeof g=="function"?g(p):g.current=p}}function Qn(p,g,E){if(io&&typeof io.onCommitFiberUnmount=="function")try{io.onCommitFiberUnmount(Nu,g)}catch{}switch(g.tag){case 0:case 11:case 14:case 15:if(p=g.updateQueue,p!==null&&(p=p.lastEffect,p!==null)){var N=p=p.next;do{var F=N,z=F.destroy;F=F.tag,z!==void 0&&((F&2)!==0||(F&4)!==0)&&Lo(g,E,z),N=N.next}while(N!==p)}break;case 1:if(xi(g,E),p=g.stateNode,typeof p.componentWillUnmount=="function")try{p.props=g.memoizedProps,p.state=g.memoizedState,p.componentWillUnmount()}catch(te){ms(g,E,te)}break;case 5:xi(g,E);break;case 4:dt?$m(p,g,E):ht&&ht&&(g=g.stateNode.containerInfo,E=ze(g),Dt(g,E))}}function yi(p,g,E){for(var N=g;;)if(Qn(p,N,E),N.child===null||dt&&N.tag===4){if(N===g)break;for(;N.sibling===null;){if(N.return===null||N.return===g)return;N=N.return}N.sibling.return=N.return,N=N.sibling}else N.child.return=N,N=N.child}function Gm(p){var g=p.alternate;g!==null&&(p.alternate=null,Gm(g)),p.child=null,p.deletions=null,p.sibling=null,p.tag===5&&(g=p.stateNode,g!==null&&Ge(g)),p.stateNode=null,p.return=null,p.dependencies=null,p.memoizedProps=null,p.memoizedState=null,p.pendingProps=null,p.stateNode=null,p.updateQueue=null}function Wm(p){return p.tag===5||p.tag===3||p.tag===4}function gf(p){e:for(;;){for(;p.sibling===null;){if(p.return===null||Wm(p.return))return null;p=p.return}for(p.sibling.return=p.return,p=p.sibling;p.tag!==5&&p.tag!==6&&p.tag!==18;){if(p.flags&2||p.child===null||p.tag===4)continue e;p.child.return=p,p=p.child}if(!(p.flags&2))return p.stateNode}}function vf(p){if(dt){e:{for(var g=p.return;g!==null;){if(Wm(g))break e;g=g.return}throw Error(o(160))}var E=g;switch(E.tag){case 5:g=E.stateNode,E.flags&32&&(Se(g),E.flags&=-33),E=gf(p),Sc(p,E,g);break;case 3:case 4:g=E.stateNode.containerInfo,E=gf(p),xf(p,E,g);break;default:throw Error(o(161))}}}function xf(p,g,E){var N=p.tag;if(N===5||N===6)p=p.stateNode,g?ft(E,p,g):bt(E,p);else if(N!==4&&(p=p.child,p!==null))for(xf(p,g,E),p=p.sibling;p!==null;)xf(p,g,E),p=p.sibling}function Sc(p,g,E){var N=p.tag;if(N===5||N===6)p=p.stateNode,g?We(E,p,g):Le(E,p);else if(N!==4&&(p=p.child,p!==null))for(Sc(p,g,E),p=p.sibling;p!==null;)Sc(p,g,E),p=p.sibling}function $m(p,g,E){for(var N=g,F=!1,z,te;;){if(!F){F=N.return;e:for(;;){if(F===null)throw Error(o(160));switch(z=F.stateNode,F.tag){case 5:te=!1;break e;case 3:z=z.containerInfo,te=!0;break e;case 4:z=z.containerInfo,te=!0;break e}F=F.return}F=!0}if(N.tag===5||N.tag===6)yi(p,N,E),te?le(z,N.stateNode):Bt(z,N.stateNode);else if(N.tag===18)te?Ih(z,N.stateNode):Ph(z,N.stateNode);else if(N.tag===4){if(N.child!==null){z=N.stateNode.containerInfo,te=!0,N.child.return=N,N=N.child;continue}}else if(Qn(p,N,E),N.child!==null){N.child.return=N,N=N.child;continue}if(N===g)break;for(;N.sibling===null;){if(N.return===null||N.return===g)return;N=N.return,N.tag===4&&(F=!1)}N.sibling.return=N.return,N=N.sibling}}function wa(p,g){if(dt){switch(g.tag){case 0:case 11:case 14:case 15:Oo(3,g,g.return),Gr(3,g),Oo(5,g,g.return);return;case 1:return;case 5:var E=g.stateNode;if(E!=null){var N=g.memoizedProps;p=p!==null?p.memoizedProps:N;var F=g.type,z=g.updateQueue;g.updateQueue=null,z!==null&&Et(E,z,F,p,N,g)}return;case 6:if(g.stateNode===null)throw Error(o(162));E=g.memoizedProps,st(g.stateNode,p!==null?p.memoizedProps:E,E);return;case 3:Ie&&p!==null&&p.memoizedState.isDehydrated&&Rh(g.stateNode.containerInfo);return;case 12:return;case 13:bc(g);return;case 19:bc(g);return;case 17:return}throw Error(o(163))}switch(g.tag){case 0:case 11:case 14:case 15:Oo(3,g,g.return),Gr(3,g),Oo(5,g,g.return);return;case 12:return;case 13:bc(g);return;case 19:bc(g);return;case 3:Ie&&p!==null&&p.memoizedState.isDehydrated&&Rh(g.stateNode.containerInfo);break;case 22:case 23:return}e:if(ht){switch(g.tag){case 1:case 5:case 6:break e;case 3:case 4:g=g.stateNode,Dt(g.containerInfo,g.pendingChildren);break e}throw Error(o(163))}}function bc(p){var g=p.updateQueue;if(g!==null){p.updateQueue=null;var E=p.stateNode;E===null&&(E=p.stateNode=new gl),g.forEach(function(N){var F=Sv.bind(null,p,N);E.has(N)||(E.add(N),N.then(F,F))})}}function Lw(p,g){for(ut=g;ut!==null;){g=ut;var E=g.deletions;if(E!==null)for(var N=0;N<E.length;N++){var F=E[N];try{var z=p;dt?$m(z,F,g):yi(z,F,g);var te=F.alternate;te!==null&&(te.return=null),F.return=null}catch(Ot){ms(F,g,Ot)}}if(E=g.child,(g.subtreeFlags&12854)!==0&&E!==null)E.return=g,ut=E;else for(;ut!==null;){g=ut;try{var pe=g.flags;if(pe&32&&dt&&Se(g.stateNode),pe&512){var Oe=g.alternate;if(Oe!==null){var ot=Oe.ref;ot!==null&&(typeof ot=="function"?ot(null):ot.current=null)}}if(pe&8192)switch(g.tag){case 13:if(g.memoizedState!==null){var Tt=g.alternate;(Tt===null||Tt.memoizedState===null)&&(td=Sr())}break;case 22:var rn=g.memoizedState!==null,Gt=g.alternate,hn=Gt!==null&&Gt.memoizedState!==null;if(E=g,dt){e:if(N=E,F=rn,z=null,dt)for(var yt=N;;){if(yt.tag===5){if(z===null){z=yt;var qr=yt.stateNode;F?Ze(qr):Je(yt.stateNode,yt.memoizedProps)}}else if(yt.tag===6){if(z===null){var ti=yt.stateNode;F?ae(ti):He(ti,yt.memoizedProps)}}else if((yt.tag!==22&&yt.tag!==23||yt.memoizedState===null||yt===N)&&yt.child!==null){yt.child.return=yt,yt=yt.child;continue}if(yt===N)break;for(;yt.sibling===null;){if(yt.return===null||yt.return===N)break e;z===yt&&(z=null),yt=yt.return}z===yt&&(z=null),yt.sibling.return=yt.return,yt=yt.sibling}}if(rn&&!hn&&(E.mode&1)!==0){ut=E;for(var Te=E.child;Te!==null;){for(E=ut=Te;ut!==null;){N=ut;var ge=N.child;switch(N.tag){case 0:case 11:case 14:case 15:Oo(4,N,N.return);break;case 1:xi(N,N.return);var De=N.stateNode;if(typeof De.componentWillUnmount=="function"){var gt=N.return;try{De.props=N.memoizedProps,De.state=N.memoizedState,De.componentWillUnmount()}catch(Ot){ms(N,gt,Ot)}}break;case 5:xi(N,N.return);break;case 22:if(N.memoizedState!==null){Xm(E);continue}}ge!==null?(ge.return=N,ut=ge):Xm(E)}Te=Te.sibling}}}switch(pe&4102){case 2:vf(g),g.flags&=-3;break;case 6:vf(g),g.flags&=-3,wa(g.alternate,g);break;case 4096:g.flags&=-4097;break;case 4100:g.flags&=-4097,wa(g.alternate,g);break;case 4:wa(g.alternate,g)}}catch(Ot){ms(g,g.return,Ot)}if(E=g.sibling,E!==null){E.return=g.return,ut=E;break}ut=g.return}}}function Yu(p,g,E){ut=p,Ku(p)}function Ku(p,g,E){for(var N=(p.mode&1)!==0;ut!==null;){var F=ut,z=F.child;if(F.tag===22&&N){var te=F.memoizedState!==null||fs;if(!te){var pe=F.alternate,Oe=pe!==null&&pe.memoizedState!==null||Or;pe=fs;var ot=Or;if(fs=te,(Or=Oe)&&!ot)for(ut=F;ut!==null;)te=ut,Oe=te.child,te.tag===22&&te.memoizedState!==null?vl(F):Oe!==null?(Oe.return=te,ut=Oe):vl(F);for(;z!==null;)ut=z,Ku(z),z=z.sibling;ut=F,fs=pe,Or=ot}qm(p)}else(F.subtreeFlags&8772)!==0&&z!==null?(z.return=F,ut=z):qm(p)}}function qm(p){for(;ut!==null;){var g=ut;if((g.flags&8772)!==0){var E=g.alternate;try{if((g.flags&8772)!==0)switch(g.tag){case 0:case 11:case 15:Or||Gr(5,g);break;case 1:var N=g.stateNode;if(g.flags&4&&!Or)if(E===null)N.componentDidMount();else{var F=g.elementType===g.type?E.memoizedProps:As(g.type,E.memoizedProps);N.componentDidUpdate(F,E.memoizedState,N.__reactInternalSnapshotBeforeUpdate)}var z=g.updateQueue;z!==null&&sv(g,z,N);break;case 3:var te=g.updateQueue;if(te!==null){if(E=null,g.child!==null)switch(g.child.tag){case 5:E=ne(g.child.stateNode);break;case 1:E=g.child.stateNode}sv(g,te,E)}break;case 5:var pe=g.stateNode;E===null&&g.flags&4&&xt(pe,g.type,g.memoizedProps,g);break;case 6:break;case 4:break;case 12:break;case 13:if(Ie&&g.memoizedState===null){var Oe=g.alternate;if(Oe!==null){var ot=Oe.memoizedState;if(ot!==null){var Tt=ot.dehydrated;Tt!==null&&Nh(Tt)}}}break;case 19:case 17:case 21:case 22:case 23:break;default:throw Error(o(163))}Or||g.flags&512&&ps(g)}catch(rn){ms(g,g.return,rn)}}if(g===p){ut=null;break}if(E=g.sibling,E!==null){E.return=g.return,ut=E;break}ut=g.return}}function Xm(p){for(;ut!==null;){var g=ut;if(g===p){ut=null;break}var E=g.sibling;if(E!==null){E.return=g.return,ut=E;break}ut=g.return}}function vl(p){for(;ut!==null;){var g=ut;try{switch(g.tag){case 0:case 11:case 15:var E=g.return;try{Gr(4,g)}catch(Oe){ms(g,E,Oe)}break;case 1:var N=g.stateNode;if(typeof N.componentDidMount=="function"){var F=g.return;try{N.componentDidMount()}catch(Oe){ms(g,F,Oe)}}var z=g.return;try{ps(g)}catch(Oe){ms(g,z,Oe)}break;case 5:var te=g.return;try{ps(g)}catch(Oe){ms(g,te,Oe)}}}catch(Oe){ms(g,g.return,Oe)}if(g===p){ut=null;break}var pe=g.sibling;if(pe!==null){pe.return=g.return,ut=pe;break}ut=g.return}}var Qu=0,xl=1,yl=2,jo=3,Ec=4;if(typeof Symbol=="function"&&Symbol.for){var _l=Symbol.for;Qu=_l("selector.component"),xl=_l("selector.has_pseudo_class"),yl=_l("selector.role"),jo=_l("selector.test_id"),Ec=_l("selector.text")}function Ju(p){var g=$(p);if(g!=null){if(typeof g.memoizedProps["data-testname"]!="string")throw Error(o(364));return g}if(p=nt(p),p===null)throw Error(o(362));return p.stateNode.current}function Zu(p,g){switch(g.$$typeof){case Qu:if(p.type===g.value)return!0;break;case xl:e:{g=g.value,p=[p,0];for(var E=0;E<p.length;){var N=p[E++],F=p[E++],z=g[F];if(N.tag!==5||!H(N)){for(;z!=null&&Zu(N,z);)F++,z=g[F];if(F===g.length){g=!0;break e}else for(N=N.child;N!==null;)p.push(N,F),N=N.sibling}}g=!1}return g;case yl:if(p.tag===5&&ye(p.stateNode,g.value))return!0;break;case Ec:if((p.tag===5||p.tag===6)&&(p=Q(p),p!==null&&0<=p.indexOf(g.value)))return!0;break;case jo:if(p.tag===5&&(p=p.memoizedProps["data-testname"],typeof p=="string"&&p.toLowerCase()===g.value.toLowerCase()))return!0;break;default:throw Error(o(365))}return!1}function Sa(p){switch(p.$$typeof){case Qu:return"<"+(D(p.value)||"Unknown")+">";case xl:return":has("+(Sa(p)||"")+")";case yl:return'[role="'+p.value+'"]';case Ec:return'"'+p.value+'"';case jo:return'[data-testname="'+p.value+'"]';default:throw Error(o(365))}}function Qs(p,g){var E=[];p=[p,0];for(var N=0;N<p.length;){var F=p[N++],z=p[N++],te=g[z];if(F.tag!==5||!H(F)){for(;te!=null&&Zu(F,te);)z++,te=g[z];if(z===g.length)E.push(F);else for(F=F.child;F!==null;)p.push(F,z),F=F.sibling}}return E}function Fo(p,g){if(!qe)throw Error(o(363));p=Ju(p),p=Qs(p,g),g=[],p=Array.from(p);for(var E=0;E<p.length;){var N=p[E++];if(N.tag===5)H(N)||g.push(N.stateNode);else for(N=N.child;N!==null;)p.push(N),N=N.sibling}return g}var Ym=Math.ceil,ed=a.ReactCurrentDispatcher,Hi=a.ReactCurrentOwner,zn=a.ReactCurrentBatchConfig,ln=0,hr=null,Vn=null,er=0,ns=0,wl=Ft(0),lr=0,Mc=null,co=0,Js=0,Sl=0,Uo=null,mr=null,td=0,ba=1/0;function bl(){ba=Sr()+500}var Tc=!1,Jn=null,Gi=null,Cc=!1,uo=null,El=0,Ml=0,Bo=null,Xn=-1,cr=0;function In(){return(ln&6)!==0?Sr():Xn!==-1?Xn:Xn=Sr()}function Wi(p){return(p.mode&1)===0?1:(ln&2)!==0&&er!==0?er&-er:rv.transition!==null?(cr===0&&(p=ur,ur<<=1,(ur&4194240)===0&&(ur=64),cr=p),cr):(p=vn,p!==0?p:ke())}function rs(p,g,E){if(50<Ml)throw Ml=0,Bo=null,Error(o(185));var N=Ea(p,g);return N===null?null:(Qa(N,g,E),((ln&2)===0||N!==hr)&&(N===hr&&((ln&2)===0&&(Js|=g),lr===4&&$r(N,er)),Is(N,E),g===1&&ln===0&&(p.mode&1)===0&&(bl(),Fh&&fi())),N)}function Ea(p,g){p.lanes|=g;var E=p.alternate;for(E!==null&&(E.lanes|=g),E=p,p=p.return;p!==null;)p.childLanes|=g,E=p.alternate,E!==null&&(E.childLanes|=g),E=p,p=p.return;return E.tag===3?E.stateNode:null}function Is(p,g){var E=p.callbackNode;nv(p,g);var N=Ru(p,p===hr?er:0);if(N===0)E!==null&&oc(E),p.callbackNode=null,p.callbackPriority=0;else if(g=N&-N,p.callbackPriority!==g){if(E!=null&&oc(E),g===1)p.tag===0?Bh(Zs.bind(null,p)):Uh(Zs.bind(null,p)),Ae?rt(function(){ln===0&&fi()}):Ja(Za,fi),E=null;else{switch(Eo(N)){case 1:E=Za;break;case 4:E=Iw;break;case 16:E=Oh;break;case 536870912:E=jh;break;default:E=Oh}E=_f(E,Wr.bind(null,p))}p.callbackPriority=g,p.callbackNode=E}}function Wr(p,g){if(Xn=-1,cr=0,(ln&6)!==0)throw Error(o(327));var E=p.callbackNode;if(ho()&&p.callbackNode!==E)return null;var N=Ru(p,p===hr?er:0);if(N===0)return null;if((N&30)!==0||(N&p.expiredLanes)!==0||g)g=id(p,N);else{g=N;var F=ln;ln|=2;var z=Jm();(hr!==p||er!==g)&&(bl(),zo(p,g));do try{yv();break}catch(pe){Qm(p,pe)}while(!0);us(),ed.current=z,ln=F,Vn!==null?g=0:(hr=null,er=0,g=lr)}if(g!==0){if(g===2&&(F=kh(p),F!==0&&(N=F,g=nd(p,F))),g===1)throw E=Mc,zo(p,0),$r(p,N),Is(p,Sr()),E;if(g===6)$r(p,N);else{if(F=p.current.alternate,(N&30)===0&&!Km(F)&&(g=id(p,N),g===2&&(z=kh(p),z!==0&&(N=z,g=nd(p,z))),g===1))throw E=Mc,zo(p,0),$r(p,N),Is(p,Sr()),E;switch(p.finishedWork=F,p.finishedLanes=N,g){case 0:case 1:throw Error(o(345));case 2:$i(p,mr);break;case 3:if($r(p,N),(N&130023424)===N&&(g=td+500-Sr(),10<g)){if(Ru(p,0)!==0)break;if(F=p.suspendedLanes,(F&N)!==N){In(),p.pingedLanes|=p.suspendedLanes&F;break}p.timeoutHandle=me($i.bind(null,p,mr),g);break}$i(p,mr);break;case 4:if($r(p,N),(N&4194240)===N)break;for(g=p.eventTimes,F=-1;0<N;){var te=31-wn(N);z=1<<te,te=g[te],te>F&&(F=te),N&=~z}if(N=F,N=Sr()-N,N=(120>N?120:480>N?480:1080>N?1080:1920>N?1920:3e3>N?3e3:4320>N?4320:1960*Ym(N/1960))-N,10<N){p.timeoutHandle=me($i.bind(null,p,mr),N);break}$i(p,mr);break;case 5:$i(p,mr);break;default:throw Error(o(329))}}}return Is(p,Sr()),p.callbackNode===E?Wr.bind(null,p):null}function nd(p,g){var E=Uo;return p.current.memoizedState.isDehydrated&&(zo(p,g).flags|=256),p=id(p,g),p!==2&&(g=mr,mr=E,g!==null&&rd(g)),p}function rd(p){mr===null?mr=p:mr.push.apply(mr,p)}function Km(p){for(var g=p;;){if(g.flags&16384){var E=g.updateQueue;if(E!==null&&(E=E.stores,E!==null))for(var N=0;N<E.length;N++){var F=E[N],z=F.getSnapshot;F=F.value;try{if(!cs(z(),F))return!1}catch{return!1}}}if(E=g.child,g.subtreeFlags&16384&&E!==null)E.return=g,g=E;else{if(g===p)break;for(;g.sibling===null;){if(g.return===null||g.return===p)return!0;g=g.return}g.sibling.return=g.return,g=g.sibling}}return!0}function $r(p,g){for(g&=~Sl,g&=~Js,p.suspendedLanes|=g,p.pingedLanes&=~g,p=p.expirationTimes;0<g;){var E=31-wn(g),N=1<<E;p[E]=-1,g&=~N}}function Zs(p){if((ln&6)!==0)throw Error(o(327));ho();var g=Ru(p,0);if((g&1)===0)return Is(p,Sr()),null;var E=id(p,g);if(p.tag!==0&&E===2){var N=kh(p);N!==0&&(g=N,E=nd(p,N))}if(E===1)throw E=Mc,zo(p,0),$r(p,g),Is(p,Sr()),E;if(E===6)throw Error(o(345));return p.finishedWork=p.current.alternate,p.finishedLanes=g,$i(p,mr),Is(p,Sr()),null}function Ac(p){uo!==null&&uo.tag===0&&(ln&6)===0&&ho();var g=ln;ln|=1;var E=zn.transition,N=vn;try{if(zn.transition=null,vn=1,p)return p()}finally{vn=N,zn.transition=E,ln=g,(ln&6)===0&&fi()}}function sd(){ns=wl.current,it(wl)}function zo(p,g){p.finishedWork=null,p.finishedLanes=0;var E=p.timeoutHandle;if(E!==Xe&&(p.timeoutHandle=Xe,je(E)),Vn!==null)for(E=Vn.return;E!==null;){var N=E;switch(Mm(N),N.tag){case 1:N=N.type.childContextTypes,N!=null&&gn();break;case 3:mc(),it(_n),it(un),al();break;case 5:Am(N);break;case 4:mc();break;case 13:it(nr);break;case 19:it(nr);break;case 10:Du(N.type._context);break;case 22:case 23:sd()}E=E.return}if(hr=p,Vn=p=Vo(p.current,null),er=ns=g,lr=0,Mc=null,Sl=Js=co=0,mr=Uo=null,pi!==null){for(g=0;g<pi.length;g++)if(E=pi[g],N=E.interleaved,N!==null){E.interleaved=null;var F=N.next,z=E.pending;if(z!==null){var te=z.next;z.next=F,N.next=te}E.pending=N}pi=null}return p}function Qm(p,g){do{var E=Vn;try{if(us(),Ou.current=_c,Jh){for(var N=rr.memoizedState;N!==null;){var F=N.queue;F!==null&&(F.pending=null),N=N.next}Jh=!1}if(ll=0,kr=Ir=rr=null,oo=!1,cl=0,Hi.current=null,E===null||E.return===null){lr=1,Mc=g,Vn=null;break}e:{var z=p,te=E.return,pe=E,Oe=g;if(g=er,pe.flags|=32768,Oe!==null&&typeof Oe=="object"&&typeof Oe.then=="function"){var ot=Oe,Tt=pe,rn=Tt.tag;if((Tt.mode&1)===0&&(rn===0||rn===11||rn===15)){var Gt=Tt.alternate;Gt?(Tt.updateQueue=Gt.updateQueue,Tt.memoizedState=Gt.memoizedState,Tt.lanes=Gt.lanes):(Tt.updateQueue=null,Tt.memoizedState=null)}var hn=Fm(te);if(hn!==null){hn.flags&=-257,dl(hn,te,pe,z,g),hn.mode&1&&Po(z,ot,g),g=hn,Oe=ot;var yt=g.updateQueue;if(yt===null){var qr=new Set;qr.add(Oe),g.updateQueue=qr}else yt.add(Oe);break e}else{if((g&1)===0){Po(z,ot,g),yf();break e}Oe=Error(o(426))}}else if(Zn&&pe.mode&1){var ti=Fm(te);if(ti!==null){(ti.flags&65536)===0&&(ti.flags|=256),dl(ti,te,pe,z,g),Yh(Oe);break e}}z=Oe,lr!==4&&(lr=2),Uo===null?Uo=[z]:Uo.push(z),Oe=jm(Oe,pe),pe=te;do{switch(pe.tag){case 3:pe.flags|=65536,g&=-g,pe.lanes|=g;var Te=gv(pe,Oe,g);Hh(pe,Te);break e;case 1:z=Oe;var ge=pe.type,De=pe.stateNode;if((pe.flags&128)===0&&(typeof ge.getDerivedStateFromError=="function"||De!==null&&typeof De.componentDidCatch=="function"&&(Gi===null||!Gi.has(De)))){pe.flags|=65536,g&=-g,pe.lanes|=g;var gt=cf(pe,z,g);Hh(pe,gt);break e}}pe=pe.return}while(pe!==null)}eg(E)}catch(Ot){g=Ot,Vn===E&&E!==null&&(Vn=E=E.return);continue}break}while(!0)}function Jm(){var p=ed.current;return ed.current=_c,p===null?_c:p}function yf(){(lr===0||lr===3||lr===2)&&(lr=4),hr===null||(co&268435455)===0&&(Js&268435455)===0||$r(hr,er)}function id(p,g){var E=ln;ln|=2;var N=Jm();hr===p&&er===g||zo(p,g);do try{xv();break}catch(F){Qm(p,F)}while(!0);if(us(),ln=E,ed.current=N,Vn!==null)throw Error(o(261));return hr=null,er=0,lr}function xv(){for(;Vn!==null;)Zm(Vn)}function yv(){for(;Vn!==null&&!fa();)Zm(Vn)}function Zm(p){var g=rg(p.alternate,p,ns);p.memoizedProps=p.pendingProps,g===null?eg(p):Vn=g,Hi.current=null}function eg(p){var g=p;do{var E=g.alternate;if(p=g.return,(g.flags&32768)===0){if(E=hf(E,g,ns),E!==null){Vn=E;return}}else{if(E=mf(E,g),E!==null){E.flags&=32767,Vn=E;return}if(p!==null)p.flags|=32768,p.subtreeFlags=0,p.deletions=null;else{lr=6,Vn=null;return}}if(g=g.sibling,g!==null){Vn=g;return}Vn=g=p}while(g!==null);lr===0&&(lr=5)}function $i(p,g){var E=vn,N=zn.transition;try{zn.transition=null,vn=1,_v(p,g,E)}finally{zn.transition=N,vn=E}return null}function _v(p,g,E){do ho();while(uo!==null);if((ln&6)!==0)throw Error(o(327));var N=p.finishedWork,F=p.finishedLanes;if(N===null)return null;if(p.finishedWork=null,p.finishedLanes=0,N===p.current)throw Error(o(177));p.callbackNode=null,p.callbackPriority=0;var z=N.lanes|N.childLanes;if(Lh(p,z),p===hr&&(Vn=hr=null,er=0),(N.subtreeFlags&2064)===0&&(N.flags&2064)===0||Cc||(Cc=!0,_f(Oh,function(){return ho(),null})),z=(N.flags&15990)!==0,(N.subtreeFlags&15990)!==0||z){z=zn.transition,zn.transition=null;var te=vn;vn=1;var pe=ln;ln|=4,Hi.current=null,Hm(p,N),Lw(p,N),Z(p.containerInfo),p.current=N,Yu(N),Pw(),ln=pe,vn=te,zn.transition=z}else p.current=N;if(Cc&&(Cc=!1,uo=p,El=F),z=p.pendingLanes,z===0&&(Gi=null),Pu(N.stateNode),Is(p,Sr()),g!==null)for(E=p.onRecoverableError,N=0;N<g.length;N++)E(g[N]);if(Tc)throw Tc=!1,p=Jn,Jn=null,p;return(El&1)!==0&&p.tag!==0&&ho(),z=p.pendingLanes,(z&1)!==0?p===Bo?Ml++:(Ml=0,Bo=p):Ml=0,fi(),null}function ho(){if(uo!==null){var p=Eo(El),g=zn.transition,E=vn;try{if(zn.transition=null,vn=16>p?16:p,uo===null)var N=!1;else{if(p=uo,uo=null,El=0,(ln&6)!==0)throw Error(o(331));var F=ln;for(ln|=4,ut=p.current;ut!==null;){var z=ut,te=z.child;if((ut.flags&16)!==0){var pe=z.deletions;if(pe!==null){for(var Oe=0;Oe<pe.length;Oe++){var ot=pe[Oe];for(ut=ot;ut!==null;){var Tt=ut;switch(Tt.tag){case 0:case 11:case 15:Oo(8,Tt,z)}var rn=Tt.child;if(rn!==null)rn.return=Tt,ut=rn;else for(;ut!==null;){Tt=ut;var Gt=Tt.sibling,hn=Tt.return;if(Gm(Tt),Tt===ot){ut=null;break}if(Gt!==null){Gt.return=hn,ut=Gt;break}ut=hn}}}var yt=z.alternate;if(yt!==null){var qr=yt.child;if(qr!==null){yt.child=null;do{var ti=qr.sibling;qr.sibling=null,qr=ti}while(qr!==null)}}ut=z}}if((z.subtreeFlags&2064)!==0&&te!==null)te.return=z,ut=te;else e:for(;ut!==null;){if(z=ut,(z.flags&2048)!==0)switch(z.tag){case 0:case 11:case 15:Oo(9,z,z.return)}var Te=z.sibling;if(Te!==null){Te.return=z.return,ut=Te;break e}ut=z.return}}var ge=p.current;for(ut=ge;ut!==null;){te=ut;var De=te.child;if((te.subtreeFlags&2064)!==0&&De!==null)De.return=te,ut=De;else e:for(te=ge;ut!==null;){if(pe=ut,(pe.flags&2048)!==0)try{switch(pe.tag){case 0:case 11:case 15:Gr(9,pe)}}catch(Ot){ms(pe,pe.return,Ot)}if(pe===te){ut=null;break e}var gt=pe.sibling;if(gt!==null){gt.return=pe.return,ut=gt;break e}ut=pe.return}}if(ln=F,fi(),io&&typeof io.onPostCommitFiberRoot=="function")try{io.onPostCommitFiberRoot(Nu,p)}catch{}N=!0}return N}finally{vn=E,zn.transition=g}}return!1}function od(p,g,E){g=jm(E,g),g=gv(p,g,1),pa(p,g),g=In(),p=Ea(p,1),p!==null&&(Qa(p,1,g),Is(p,g))}function ms(p,g,E){if(p.tag===3)od(p,p,E);else for(;g!==null;){if(g.tag===3){od(g,p,E);break}else if(g.tag===1){var N=g.stateNode;if(typeof g.type.getDerivedStateFromError=="function"||typeof N.componentDidCatch=="function"&&(Gi===null||!Gi.has(N))){p=jm(E,p),p=cf(g,p,1),pa(g,p),p=In(),g=Ea(g,1),g!==null&&(Qa(g,1,p),Is(g,p));break}}g=g.return}}function tg(p,g,E){var N=p.pingCache;N!==null&&N.delete(g),g=In(),p.pingedLanes|=p.suspendedLanes&E,hr===p&&(er&E)===E&&(lr===4||lr===3&&(er&130023424)===er&&500>Sr()-td?zo(p,0):Sl|=E),Is(p,g)}function ng(p,g){g===0&&((p.mode&1)===0?g=1:(g=Sn,Sn<<=1,(Sn&130023424)===0&&(Sn=4194304)));var E=In();p=Ea(p,g),p!==null&&(Qa(p,g,E),Is(p,E))}function wv(p){var g=p.memoizedState,E=0;g!==null&&(E=g.retryLane),ng(p,E)}function Sv(p,g){var E=0;switch(p.tag){case 13:var N=p.stateNode,F=p.memoizedState;F!==null&&(E=F.retryLane);break;case 19:N=p.stateNode;break;default:throw Error(o(314))}N!==null&&N.delete(g),ng(p,E)}var rg;rg=function(p,g,E){if(p!==null)if(p.memoizedProps!==g.pendingProps||_n.current)Lr=!0;else{if((p.lanes&E)===0&&(g.flags&128)===0)return Lr=!1,pf(p,g,E);Lr=(p.flags&131072)!==0}else Lr=!1,Zn&&(g.flags&1048576)!==0&&lv(g,qh,g.index);switch(g.lanes=0,g.tag){case 2:var N=g.type;p!==null&&(p.alternate=null,g.alternate=null,g.flags|=2),p=g.pendingProps;var F=kt(g,un.current);ac(g,E),F=gc(null,g,N,p,F,E);var z=xa();return g.flags|=1,typeof F=="object"&&F!==null&&typeof F.render=="function"&&F.$$typeof===void 0?(g.tag=1,g.memoizedState=null,g.updateQueue=null,En(N)?(z=!0,Nr(g)):z=!1,g.memoizedState=F.state!==null&&F.state!==void 0?F.state:null,lc(g),F.updater=Wh,g.stateNode=F,F._reactInternals=g,bm(g,N,p,E),g=ts(null,g,N,!0,z,E)):(g.tag=0,Zn&&z&&Em(g),ar(null,g,F,E),g=g.child),g;case 16:N=g.elementType;e:{switch(p!==null&&(p.alternate=null,g.alternate=null,g.flags|=2),p=g.pendingProps,F=N._init,N=F(N._payload),g.type=N,F=g.tag=Ow(N),p=As(N,p),F){case 0:g=Do(null,g,N,p,E);break e;case 1:g=fl(null,g,N,p,E);break e;case 11:g=qn(null,g,N,p,E);break e;case 14:g=Gn(null,g,N,As(N.type,p),E);break e}throw Error(o(306,N,""))}return g;case 0:return N=g.type,F=g.pendingProps,F=g.elementType===N?F:As(N,F),Do(p,g,N,F,E);case 1:return N=g.type,F=g.pendingProps,F=g.elementType===N?F:As(N,F),fl(p,g,N,F,E);case 3:e:{if(Wu(g),p===null)throw Error(o(387));N=g.pendingProps,z=g.memoizedState,F=z.element,_m(p,g),Gh(g,N,null,E);var te=g.memoizedState;if(N=te.element,Ie&&z.isDehydrated)if(z={element:N,isDehydrated:!1,cache:te.cache,transitions:te.transitions},g.updateQueue.baseState=z,g.memoizedState=z,g.flags&256){F=Error(o(423)),g=Bm(p,g,N,E,F);break e}else if(N!==F){F=Error(o(424)),g=Bm(p,g,N,E,F);break e}else for(Ie&&(Vr=Mh(g.stateNode.containerInfo),ds=g,Zn=!0,vi=null,uc=!1),E=dv(g,null,N,E),g.child=E;E;)E.flags=E.flags&-3|4096,E=E.sibling;else{if(dc(),N===F){g=Ps(p,g,E);break e}ar(p,g,N,E)}g=g.child}return g;case 5:return hv(g),p===null&&ga(g),N=g.type,F=g.pendingProps,z=p!==null?p.memoizedProps:null,te=F.children,Ee(N,F)?te=null:z!==null&&Ee(N,z)&&(g.flags|=32),hs(p,g),ar(p,g,te,E),g.child;case 6:return p===null&&ga(g),null;case 13:return zm(p,g,E);case 4:return Kh(g,g.stateNode.containerInfo),N=g.pendingProps,p===null?g.child=Ro(g,null,N,E):ar(p,g,N,E),g.child;case 11:return N=g.type,F=g.pendingProps,F=g.elementType===N?F:As(N,F),qn(p,g,N,F,E);case 7:return ar(p,g,g.pendingProps,E),g.child;case 8:return ar(p,g,g.pendingProps.children,E),g.child;case 12:return ar(p,g,g.pendingProps.children,E),g.child;case 10:e:{if(N=g.type._context,F=g.pendingProps,z=g.memoizedProps,te=F.value,tl(g,N,te),z!==null)if(cs(z.value,te)){if(z.children===F.children&&!_n.current){g=Ps(p,g,E);break e}}else for(z=g.child,z!==null&&(z.return=g);z!==null;){var pe=z.dependencies;if(pe!==null){te=z.child;for(var Oe=pe.firstContext;Oe!==null;){if(Oe.context===N){if(z.tag===1){Oe=To(-1,E&-E),Oe.tag=2;var ot=z.updateQueue;if(ot!==null){ot=ot.shared;var Tt=ot.pending;Tt===null?Oe.next=Oe:(Oe.next=Tt.next,Tt.next=Oe),ot.pending=Oe}}z.lanes|=E,Oe=z.alternate,Oe!==null&&(Oe.lanes|=E),nl(z.return,E,g),pe.lanes|=E;break}Oe=Oe.next}}else if(z.tag===10)te=z.type===g.type?null:z.child;else if(z.tag===18){if(te=z.return,te===null)throw Error(o(341));te.lanes|=E,pe=te.alternate,pe!==null&&(pe.lanes|=E),nl(te,E,g),te=z.sibling}else te=z.child;if(te!==null)te.return=z;else for(te=z;te!==null;){if(te===g){te=null;break}if(z=te.sibling,z!==null){z.return=te.return,te=z;break}te=te.return}z=te}ar(p,g,F.children,E),g=g.child}return g;case 9:return F=g.type,N=g.pendingProps.children,ac(g,E),F=Rs(F),N=N(F),g.flags|=1,ar(p,g,N,E),g.child;case 14:return N=g.type,F=As(N,g.pendingProps),F=As(N.type,F),Gn(p,g,N,F,E);case 15:return ko(p,g,g.type,g.pendingProps,E);case 17:return N=g.type,F=g.pendingProps,F=g.elementType===N?F:As(N,F),p!==null&&(p.alternate=null,g.alternate=null,g.flags|=2),g.tag=1,En(N)?(p=!0,Nr(g)):p=!1,ac(g,E),ov(g,N,F),bm(g,N,F,E),ts(null,g,N,!0,p,E);case 19:return ml(p,g,E);case 22:return Hr(p,g,E)}throw Error(o(156,g.tag))};function _f(p,g){return Ja(p,g)}function bv(p,g,E,N){this.tag=p,this.key=E,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=g,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=N,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function ei(p,g,E,N){return new bv(p,g,E,N)}function wf(p){return p=p.prototype,!(!p||!p.isReactComponent)}function Ow(p){if(typeof p=="function")return wf(p)?1:0;if(p!=null){if(p=p.$$typeof,p===b)return 11;if(p===C)return 14}return 2}function Vo(p,g){var E=p.alternate;return E===null?(E=ei(p.tag,g,p.key,p.mode),E.elementType=p.elementType,E.type=p.type,E.stateNode=p.stateNode,E.alternate=p,p.alternate=E):(E.pendingProps=g,E.type=p.type,E.flags=0,E.subtreeFlags=0,E.deletions=null),E.flags=p.flags&14680064,E.childLanes=p.childLanes,E.lanes=p.lanes,E.child=p.child,E.memoizedProps=p.memoizedProps,E.memoizedState=p.memoizedState,E.updateQueue=p.updateQueue,g=p.dependencies,E.dependencies=g===null?null:{lanes:g.lanes,firstContext:g.firstContext},E.sibling=p.sibling,E.index=p.index,E.ref=p.ref,E}function Sf(p,g,E,N,F,z){var te=2;if(N=p,typeof p=="function")wf(p)&&(te=1);else if(typeof p=="string")te=5;else e:switch(p){case f:return Tl(E.children,F,z,g);case m:te=8,F|=8;break;case v:return p=ei(12,E,g,F|2),p.elementType=v,p.lanes=z,p;case w:return p=ei(13,E,g,F),p.elementType=w,p.lanes=z,p;case S:return p=ei(19,E,g,F),p.elementType=S,p.lanes=z,p;case A:return ad(E,F,z,g);default:if(typeof p=="object"&&p!==null)switch(p.$$typeof){case x:te=10;break e;case _:te=9;break e;case b:te=11;break e;case C:te=14;break e;case T:te=16,N=null;break e}throw Error(o(130,p==null?p:typeof p,""))}return g=ei(te,E,g,F),g.elementType=p,g.type=N,g.lanes=z,g}function Tl(p,g,E,N){return p=ei(7,p,N,g),p.lanes=E,p}function ad(p,g,E,N){return p=ei(22,p,N,g),p.elementType=A,p.lanes=E,p.stateNode={},p}function bf(p,g,E){return p=ei(6,p,null,g),p.lanes=E,p}function Ef(p,g,E){return g=ei(4,p.children!==null?p.children:[],p.key,g),g.lanes=E,g.stateNode={containerInfo:p.containerInfo,pendingChildren:null,implementation:p.implementation},g}function Mf(p,g,E,N,F){this.tag=g,this.containerInfo=p,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=Xe,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Dh(0),this.expirationTimes=Dh(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Dh(0),this.identifierPrefix=N,this.onRecoverableError=F,Ie&&(this.mutableSourceEagerHydrationData=null)}function Ev(p,g,E,N,F,z,te,pe,Oe){return p=new Mf(p,g,E,pe,Oe),g===1?(g=1,z===!0&&(g|=8)):g=0,z=ei(3,null,null,g),p.current=z,z.stateNode=p,z.memoizedState={element:N,isDehydrated:E,cache:null,transitions:null},lc(z),p}function Mv(p){if(!p)return Kt;p=p._reactInternals;e:{if(O(p)!==p||p.tag!==1)throw Error(o(170));var g=p;do{switch(g.tag){case 3:g=g.stateNode.context;break e;case 1:if(En(g.type)){g=g.stateNode.__reactInternalMemoizedMergedChildContext;break e}}g=g.return}while(g!==null);throw Error(o(171))}if(p.tag===1){var E=p.type;if(En(E))return bo(p,E,g)}return g}function Tv(p){var g=p._reactInternals;if(g===void 0)throw typeof p.render=="function"?Error(o(188)):(p=Object.keys(p).join(","),Error(o(268,p)));return p=W(g),p===null?null:p.stateNode}function _i(p,g){if(p=p.memoizedState,p!==null&&p.dehydrated!==null){var E=p.retryLane;p.retryLane=E!==0&&E<g?E:g}}function ld(p,g){_i(p,g),(p=p.alternate)&&_i(p,g)}function Tf(p){return p=W(p),p===null?null:p.stateNode}function Cv(){return null}return t.attemptContinuousHydration=function(p){if(p.tag===13){var g=In();rs(p,134217728,g),ld(p,134217728)}},t.attemptHydrationAtCurrentPriority=function(p){if(p.tag===13){var g=In(),E=Wi(p);rs(p,E,g),ld(p,E)}},t.attemptSynchronousHydration=function(p){switch(p.tag){case 3:var g=p.stateNode;if(g.current.memoizedState.isDehydrated){var E=Cs(g.pendingLanes);E!==0&&(so(g,E|1),Is(g,Sr()),(ln&6)===0&&(bl(),fi()))}break;case 13:var N=In();Ac(function(){return rs(p,1,N)}),ld(p,1)}},t.batchedUpdates=function(p,g){var E=ln;ln|=1;try{return p(g)}finally{ln=E,ln===0&&(bl(),Fh&&fi())}},t.createComponentSelector=function(p){return{$$typeof:Qu,value:p}},t.createContainer=function(p,g,E,N,F,z,te){return Ev(p,g,!1,null,E,N,F,z,te)},t.createHasPseudoClassSelector=function(p){return{$$typeof:xl,value:p}},t.createHydrationContainer=function(p,g,E,N,F,z,te,pe,Oe){return p=Ev(E,N,!0,p,F,z,te,pe,Oe),p.context=Mv(null),E=p.current,N=In(),F=Wi(E),z=To(N,F),z.callback=g??null,pa(E,z),p.current.lanes=F,Qa(p,F,N),Is(p,N),p},t.createPortal=function(p,g,E){var N=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:d,key:N==null?null:""+N,children:p,containerInfo:g,implementation:E}},t.createRoleSelector=function(p){return{$$typeof:yl,value:p}},t.createTestNameSelector=function(p){return{$$typeof:jo,value:p}},t.createTextSelector=function(p){return{$$typeof:Ec,value:p}},t.deferredUpdates=function(p){var g=vn,E=zn.transition;try{return zn.transition=null,vn=16,p()}finally{vn=g,zn.transition=E}},t.discreteUpdates=function(p,g,E,N,F){var z=vn,te=zn.transition;try{return zn.transition=null,vn=1,p(g,E,N,F)}finally{vn=z,zn.transition=te,ln===0&&bl()}},t.findAllNodes=Fo,t.findBoundingRects=function(p,g){if(!qe)throw Error(o(363));g=Fo(p,g),p=[];for(var E=0;E<g.length;E++)p.push(jt(g[E]));for(g=p.length-1;0<g;g--){E=p[g];for(var N=E.x,F=N+E.width,z=E.y,te=z+E.height,pe=g-1;0<=pe;pe--)if(g!==pe){var Oe=p[pe],ot=Oe.x,Tt=ot+Oe.width,rn=Oe.y,Gt=rn+Oe.height;if(N>=ot&&z>=rn&&F<=Tt&&te<=Gt){p.splice(g,1);break}else if(N!==ot||E.width!==Oe.width||Gt<z||rn>te){if(!(z!==rn||E.height!==Oe.height||Tt<N||ot>F)){ot>N&&(Oe.width+=ot-N,Oe.x=N),Tt<F&&(Oe.width=F-ot),p.splice(g,1);break}}else{rn>z&&(Oe.height+=rn-z,Oe.y=z),Gt<te&&(Oe.height=te-rn),p.splice(g,1);break}}}return p},t.findHostInstance=Tv,t.findHostInstanceWithNoPortals=function(p){return p=B(p),p=p!==null?ee(p):null,p===null?null:p.stateNode},t.findHostInstanceWithWarning=function(p){return Tv(p)},t.flushControlled=function(p){var g=ln;ln|=1;var E=zn.transition,N=vn;try{zn.transition=null,vn=1,p()}finally{vn=N,zn.transition=E,ln=g,ln===0&&(bl(),fi())}},t.flushPassiveEffects=ho,t.flushSync=Ac,t.focusWithin=function(p,g){if(!qe)throw Error(o(363));for(p=Ju(p),g=Qs(p,g),g=Array.from(g),p=0;p<g.length;){var E=g[p++];if(!H(E)){if(E.tag===5&&Re(E.stateNode))return!0;for(E=E.child;E!==null;)g.push(E),E=E.sibling}}return!1},t.getCurrentUpdatePriority=function(){return vn},t.getFindAllNodesFailureDescription=function(p,g){if(!qe)throw Error(o(363));var E=0,N=[];p=[Ju(p),0];for(var F=0;F<p.length;){var z=p[F++],te=p[F++],pe=g[te];if((z.tag!==5||!H(z))&&(Zu(z,pe)&&(N.push(Sa(pe)),te++,te>E&&(E=te)),te<g.length))for(z=z.child;z!==null;)p.push(z,te),z=z.sibling}if(E<g.length){for(p=[];E<g.length;E++)p.push(Sa(g[E]));return`findAllNodes was able to match part of the selector:
  `+(N.join(" > ")+`

No matching component was found for:
  `)+p.join(" > ")}return null},t.getPublicRootInstance=function(p){if(p=p.current,!p.child)return null;switch(p.child.tag){case 5:return ne(p.child.stateNode);default:return p.child.stateNode}},t.injectIntoDevTools=function(p){if(p={bundleType:p.bundleType,version:p.version,rendererPackageName:p.rendererPackageName,rendererConfig:p.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:a.ReactCurrentDispatcher,findHostInstanceByFiber:Tf,findFiberByHostInstance:p.findFiberByHostInstance||Cv,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.0.0-fc46dba67-20220329"},typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u")p=!1;else{var g=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(g.isDisabled||!g.supportsFiber)p=!0;else{try{Nu=g.inject(p),io=g}catch{}p=!!g.checkDCE}}return p},t.isAlreadyRendering=function(){return!1},t.observeVisibleRects=function(p,g,E,N){if(!qe)throw Error(o(363));p=Fo(p,g);var F=Ue(p,E,N).disconnect;return{disconnect:function(){F()}}},t.registerMutableSourceForHydration=function(p,g){var E=g._getVersion;E=E(g._source),p.mutableSourceEagerHydrationData==null?p.mutableSourceEagerHydrationData=[g,E]:p.mutableSourceEagerHydrationData.push(g,E)},t.runWithPriority=function(p,g){var E=vn;try{return vn=p,g()}finally{vn=E}},t.shouldError=function(){return null},t.shouldSuspend=function(){return!1},t.updateContainer=function(p,g,E,N){var F=g.current,z=In(),te=Wi(F);return E=Mv(E),g.context===null?g.context=E:g.pendingContext=E,g=To(z,te),g.payload={element:p},N=N===void 0?null:N,N!==null&&(g.callback=N),pa(F,g),p=rs(F,te,z),p!==null&&Vh(p,F,te),te},t}),NS}var JA;function SZ(){return JA||(JA=1,CS.exports=wZ()),CS.exports}var bZ=SZ();const EZ=y_(bZ);var ZA=KD();const $M={},MZ=r=>void Object.assign($M,r);function TZ(r,e){function t(f,{args:m=[],attach:v,...x},_){let b=`${f[0].toUpperCase()}${f.slice(1)}`,w;if(f==="primitive"){if(x.object===void 0)throw new Error("R3F: Primitives without 'object' are invalid!");const S=x.object;w=hp(S,{type:f,root:_,attach:v,primitive:!0})}else{const S=$M[b];if(!S)throw new Error(`R3F: ${b} is not part of the THREE namespace! Did you forget to extend? See: https://docs.pmnd.rs/react-three-fiber/api/objects#using-3rd-party-objects-declaratively`);if(!Array.isArray(m))throw new Error("R3F: The args prop must be an array!");w=hp(new S(...m),{type:f,root:_,attach:v,memoizedProps:{args:m}})}return w.__r3f.attach===void 0&&(w.isBufferGeometry?w.__r3f.attach="geometry":w.isMaterial&&(w.__r3f.attach="material")),b!=="inject"&&kS(w,x),w}function n(f,m){let v=!1;if(m){var x,_;(x=m.__r3f)!=null&&x.attach?IS(f,m,m.__r3f.attach):m.isObject3D&&f.isObject3D&&(f.add(m),v=!0),v||(_=f.__r3f)==null||_.objects.push(m),m.__r3f||hp(m,{}),m.__r3f.parent=f,Yb(m),fp(m)}}function s(f,m,v){let x=!1;if(m){var _,b;if((_=m.__r3f)!=null&&_.attach)IS(f,m,m.__r3f.attach);else if(m.isObject3D&&f.isObject3D){m.parent=f,m.dispatchEvent({type:"added"}),f.dispatchEvent({type:"childadded",child:m});const w=f.children.filter(C=>C!==m),S=w.indexOf(v);f.children=[...w.slice(0,S),m,...w.slice(S)],x=!0}x||(b=f.__r3f)==null||b.objects.push(m),m.__r3f||hp(m,{}),m.__r3f.parent=f,Yb(m),fp(m)}}function i(f,m,v=!1){f&&[...f].forEach(x=>o(m,x,v))}function o(f,m,v){if(m){var x,_,b;if(m.__r3f&&(m.__r3f.parent=null),(x=f.__r3f)!=null&&x.objects&&(f.__r3f.objects=f.__r3f.objects.filter(A=>A!==m)),(_=m.__r3f)!=null&&_.attach)sR(f,m,m.__r3f.attach);else if(m.isObject3D&&f.isObject3D){var w;f.remove(m),(w=m.__r3f)!=null&&w.root&&kZ(xy(m),m)}const C=(b=m.__r3f)==null?void 0:b.primitive,T=!C&&(v===void 0?m.dispose!==null:v);if(!C){var S;i((S=m.__r3f)==null?void 0:S.objects,m,T),i(m.children,m,T)}if(delete m.__r3f,T&&m.dispose&&m.type!=="Scene"){const A=()=>{try{m.dispose()}catch{}};typeof IS_REACT_ACT_ENVIRONMENT>"u"?ZA.unstable_scheduleCallback(ZA.unstable_IdlePriority,A):A()}fp(f)}}function a(f,m,v,x){var _;const b=(_=f.__r3f)==null?void 0:_.parent;if(!b)return;const w=t(m,v,f.__r3f.root);if(f.children){for(const S of f.children)S.__r3f&&n(w,S);f.children=f.children.filter(S=>!S.__r3f)}f.__r3f.objects.forEach(S=>n(w,S)),f.__r3f.objects=[],f.__r3f.autoRemovedBeforeAppend||o(b,f),w.parent&&(w.__r3f.autoRemovedBeforeAppend=!0),n(b,w),w.raycast&&w.__r3f.eventCount&&xy(w).getState().internal.interaction.push(w),[x,x.alternate].forEach(S=>{S!==null&&(S.stateNode=w,S.ref&&(typeof S.ref=="function"?S.ref(w):S.ref.current=w))})}const c=()=>{};return{reconciler:EZ({createInstance:t,removeChild:o,appendChild:n,appendInitialChild:n,insertBefore:s,supportsMutation:!0,isPrimaryRenderer:!1,supportsPersistence:!1,supportsHydration:!1,noTimeout:-1,appendChildToContainer:(f,m)=>{if(!m)return;const v=f.getState().scene;v.__r3f&&(v.__r3f.root=f,n(v,m))},removeChildFromContainer:(f,m)=>{m&&o(f.getState().scene,m)},insertInContainerBefore:(f,m,v)=>{if(!m||!v)return;const x=f.getState().scene;x.__r3f&&s(x,m,v)},getRootHostContext:()=>null,getChildHostContext:f=>f,finalizeInitialChildren(f){var m;return!!((m=f==null?void 0:f.__r3f)!=null?m:{}).handlers},prepareUpdate(f,m,v,x){var _;if(((_=f==null?void 0:f.__r3f)!=null?_:{}).primitive&&x.object&&x.object!==f)return[!0];{const{args:w=[],children:S,...C}=x,{args:T=[],children:A,...k}=v;if(!Array.isArray(w))throw new Error("R3F: the args prop must be an array!");if(w.some((D,L)=>D!==T[L]))return[!0];const j=rL(f,C,k,!0);return j.changes.length?[!1,j]:null}},commitUpdate(f,[m,v],x,_,b,w){m?a(f,x,b,w):kS(f,v)},commitMount(f,m,v,x){var _;const b=(_=f.__r3f)!=null?_:{};f.raycast&&b.handlers&&b.eventCount&&xy(f).getState().internal.interaction.push(f)},getPublicInstance:f=>f,prepareForCommit:()=>null,preparePortalMount:f=>hp(f.getState().scene),resetAfterCommit:()=>{},shouldSetTextContent:()=>!1,clearContainer:()=>!1,hideInstance(f){var m;const{attach:v,parent:x}=(m=f.__r3f)!=null?m:{};v&&x&&sR(x,f,v),f.isObject3D&&(f.visible=!1),fp(f)},unhideInstance(f,m){var v;const{attach:x,parent:_}=(v=f.__r3f)!=null?v:{};x&&_&&IS(_,f,x),(f.isObject3D&&m.visible==null||m.visible)&&(f.visible=!0),fp(f)},createTextInstance:c,hideTextInstance:c,unhideTextInstance:c,getCurrentEventPriority:()=>e?e():wp.DefaultEventPriority,beforeActiveInstanceBlur:()=>{},afterActiveInstanceBlur:()=>{},detachDeletedInstance:()=>{},now:typeof performance<"u"&&ir.fun(performance.now)?performance.now:ir.fun(Date.now)?Date.now:()=>0,scheduleTimeout:ir.fun(setTimeout)?setTimeout:void 0,cancelTimeout:ir.fun(clearTimeout)?clearTimeout:void 0}),applyProps:kS}}var eR,tR;const PS=r=>"colorSpace"in r||"outputColorSpace"in r,QD=()=>{var r;return(r=$M.ColorManagement)!=null?r:null},JD=r=>r&&r.isOrthographicCamera,CZ=r=>r&&r.hasOwnProperty("current"),tv=typeof window<"u"&&((eR=window.document)!=null&&eR.createElement||((tR=window.navigator)==null?void 0:tR.product)==="ReactNative")?R.useLayoutEffect:R.useEffect;function ZD(r){const e=R.useRef(r);return tv(()=>void(e.current=r),[r]),e}function AZ({set:r}){return tv(()=>(r(new Promise(()=>null)),()=>r(!1)),[r]),null}class eL extends R.Component{constructor(...e){super(...e),this.state={error:!1}}componentDidCatch(e){this.props.set(e)}render(){return this.state.error?null:this.props.children}}eL.getDerivedStateFromError=()=>({error:!0});const tL="__default",nR=new Map,RZ=r=>r&&!!r.memoized&&!!r.changes;function nL(r){var e;const t=typeof window<"u"?(e=window.devicePixelRatio)!=null?e:2:1;return Array.isArray(r)?Math.min(Math.max(r[0],t),r[1]):r}const Rg=r=>{var e;return(e=r.__r3f)==null?void 0:e.root.getState()};function xy(r){let e=r.__r3f.root;for(;e.getState().previousRoot;)e=e.getState().previousRoot;return e}const ir={obj:r=>r===Object(r)&&!ir.arr(r)&&typeof r!="function",fun:r=>typeof r=="function",str:r=>typeof r=="string",num:r=>typeof r=="number",boo:r=>typeof r=="boolean",und:r=>r===void 0,arr:r=>Array.isArray(r),equ(r,e,{arrays:t="shallow",objects:n="reference",strict:s=!0}={}){if(typeof r!=typeof e||!!r!=!!e)return!1;if(ir.str(r)||ir.num(r)||ir.boo(r))return r===e;const i=ir.obj(r);if(i&&n==="reference")return r===e;const o=ir.arr(r);if(o&&t==="reference")return r===e;if((o||i)&&r===e)return!0;let a;for(a in r)if(!(a in e))return!1;if(i&&t==="shallow"&&n==="shallow"){for(a in s?e:r)if(!ir.equ(r[a],e[a],{strict:s,objects:"reference"}))return!1}else for(a in s?e:r)if(r[a]!==e[a])return!1;if(ir.und(a)){if(o&&r.length===0&&e.length===0||i&&Object.keys(r).length===0&&Object.keys(e).length===0)return!0;if(r!==e)return!1}return!0}};function NZ(r){r.dispose&&r.type!=="Scene"&&r.dispose();for(const e in r)e.dispose==null||e.dispose(),delete r[e]}function hp(r,e){const t=r;return t.__r3f={type:"",root:null,previousAttach:null,memoizedProps:{},eventCount:0,handlers:{},objects:[],parent:null,...e},r}function Xb(r,e){let t=r;if(e.includes("-")){const n=e.split("-"),s=n.pop();return t=n.reduce((i,o)=>i[o],r),{target:t,key:s}}else return{target:t,key:e}}const rR=/-\d+$/;function IS(r,e,t){if(ir.str(t)){if(rR.test(t)){const i=t.replace(rR,""),{target:o,key:a}=Xb(r,i);Array.isArray(o[a])||(o[a]=[])}const{target:n,key:s}=Xb(r,t);e.__r3f.previousAttach=n[s],n[s]=e}else e.__r3f.previousAttach=t(r,e)}function sR(r,e,t){var n,s;if(ir.str(t)){const{target:i,key:o}=Xb(r,t),a=e.__r3f.previousAttach;a===void 0?delete i[o]:i[o]=a}else(n=e.__r3f)==null||n.previousAttach==null||n.previousAttach(r,e);(s=e.__r3f)==null||delete s.previousAttach}function rL(r,{children:e,key:t,ref:n,...s},{children:i,key:o,ref:a,...c}={},d=!1){const f=r.__r3f,m=Object.entries(s),v=[];if(d){const _=Object.keys(c);for(let b=0;b<_.length;b++)s.hasOwnProperty(_[b])||m.unshift([_[b],tL+"remove"])}m.forEach(([_,b])=>{var w;if((w=r.__r3f)!=null&&w.primitive&&_==="object"||ir.equ(b,c[_]))return;if(/^on(Pointer|Click|DoubleClick|ContextMenu|Wheel)/.test(_))return v.push([_,b,!0,[]]);let S=[];_.includes("-")&&(S=_.split("-")),v.push([_,b,!1,S]);for(const C in s){const T=s[C];C.startsWith(`${_}-`)&&v.push([C,T,!1,C.split("-")])}});const x={...s};return f!=null&&f.memoizedProps&&f!=null&&f.memoizedProps.args&&(x.args=f.memoizedProps.args),f!=null&&f.memoizedProps&&f!=null&&f.memoizedProps.attach&&(x.attach=f.memoizedProps.attach),{memoized:x,changes:v}}function kS(r,e){var t;const n=r.__r3f,s=n==null?void 0:n.root,i=s==null||s.getState==null?void 0:s.getState(),{memoized:o,changes:a}=RZ(e)?e:rL(r,e),c=n==null?void 0:n.eventCount;r.__r3f&&(r.__r3f.memoizedProps=o);for(let v=0;v<a.length;v++){let[x,_,b,w]=a[v];if(PS(r)){const A="srgb",k="srgb-linear";x==="encoding"?(x="colorSpace",_=_===3001?A:k):x==="outputEncoding"&&(x="outputColorSpace",_=_===3001?A:k)}let S=r,C=S[x];if(w.length&&(C=w.reduce((T,A)=>T[A],r),!(C&&C.set))){const[T,...A]=w.reverse();S=A.reverse().reduce((k,j)=>k[j],r),x=T}if(_===tL+"remove")if(S.constructor){let T=nR.get(S.constructor);T||(T=new S.constructor,nR.set(S.constructor,T)),_=T[x]}else _=0;if(b&&n)_?n.handlers[x]=_:delete n.handlers[x],n.eventCount=Object.keys(n.handlers).length;else if(C&&C.set&&(C.copy||C instanceof Zd)){if(Array.isArray(_))C.fromArray?C.fromArray(_):C.set(..._);else if(C.copy&&_&&_.constructor&&C.constructor===_.constructor)C.copy(_);else if(_!==void 0){var d;const T=(d=C)==null?void 0:d.isColor;!T&&C.setScalar?C.setScalar(_):C instanceof Zd&&_ instanceof Zd?C.mask=_.mask:C.set(_),!QD()&&i&&!i.linear&&T&&C.convertSRGBToLinear()}}else{var f;if(S[x]=_,(f=S[x])!=null&&f.isTexture&&S[x].format===Vs&&S[x].type===_o&&i){const T=S[x];PS(T)&&PS(i.gl)?T.colorSpace=i.gl.outputColorSpace:T.encoding=i.gl.outputEncoding}}fp(r)}if(n&&n.parent&&r.raycast&&c!==n.eventCount){const v=xy(r).getState().internal,x=v.interaction.indexOf(r);x>-1&&v.interaction.splice(x,1),n.eventCount&&v.interaction.push(r)}return!(a.length===1&&a[0][0]==="onUpdate")&&a.length&&(t=r.__r3f)!=null&&t.parent&&Yb(r),r}function fp(r){var e,t;const n=(e=r.__r3f)==null||(t=e.root)==null||t.getState==null?void 0:t.getState();n&&n.internal.frames===0&&n.invalidate()}function Yb(r){r.onUpdate==null||r.onUpdate(r)}function PZ(r,e){r.manual||(JD(r)?(r.left=e.width/-2,r.right=e.width/2,r.top=e.height/2,r.bottom=e.height/-2):r.aspect=e.width/e.height,r.updateProjectionMatrix(),r.updateMatrixWorld())}function ry(r){return(r.eventObject||r.object).uuid+"/"+r.index+r.instanceId}function IZ(){var r;const e=typeof self<"u"&&self||typeof window<"u"&&window;if(!e)return wp.DefaultEventPriority;switch((r=e.event)==null?void 0:r.type){case"click":case"contextmenu":case"dblclick":case"pointercancel":case"pointerdown":case"pointerup":return wp.DiscreteEventPriority;case"pointermove":case"pointerout":case"pointerover":case"pointerenter":case"pointerleave":case"wheel":return wp.ContinuousEventPriority;default:return wp.DefaultEventPriority}}function sL(r,e,t,n){const s=t.get(e);s&&(t.delete(e),t.size===0&&(r.delete(n),s.target.releasePointerCapture(n)))}function kZ(r,e){const{internal:t}=r.getState();t.interaction=t.interaction.filter(n=>n!==e),t.initialHits=t.initialHits.filter(n=>n!==e),t.hovered.forEach((n,s)=>{(n.eventObject===e||n.object===e)&&t.hovered.delete(s)}),t.capturedMap.forEach((n,s)=>{sL(t.capturedMap,e,n,s)})}function DZ(r){function e(c){const{internal:d}=r.getState(),f=c.offsetX-d.initialClick[0],m=c.offsetY-d.initialClick[1];return Math.round(Math.sqrt(f*f+m*m))}function t(c){return c.filter(d=>["Move","Over","Enter","Out","Leave"].some(f=>{var m;return(m=d.__r3f)==null?void 0:m.handlers["onPointer"+f]}))}function n(c,d){const f=r.getState(),m=new Set,v=[],x=d?d(f.internal.interaction):f.internal.interaction;for(let S=0;S<x.length;S++){const C=Rg(x[S]);C&&(C.raycaster.camera=void 0)}f.previousRoot||f.events.compute==null||f.events.compute(c,f);function _(S){const C=Rg(S);if(!C||!C.events.enabled||C.raycaster.camera===null)return[];if(C.raycaster.camera===void 0){var T;C.events.compute==null||C.events.compute(c,C,(T=C.previousRoot)==null?void 0:T.getState()),C.raycaster.camera===void 0&&(C.raycaster.camera=null)}return C.raycaster.camera?C.raycaster.intersectObject(S,!0):[]}let b=x.flatMap(_).sort((S,C)=>{const T=Rg(S.object),A=Rg(C.object);return!T||!A?S.distance-C.distance:A.events.priority-T.events.priority||S.distance-C.distance}).filter(S=>{const C=ry(S);return m.has(C)?!1:(m.add(C),!0)});f.events.filter&&(b=f.events.filter(b,f));for(const S of b){let C=S.object;for(;C;){var w;(w=C.__r3f)!=null&&w.eventCount&&v.push({...S,eventObject:C}),C=C.parent}}if("pointerId"in c&&f.internal.capturedMap.has(c.pointerId))for(let S of f.internal.capturedMap.get(c.pointerId).values())m.has(ry(S.intersection))||v.push(S.intersection);return v}function s(c,d,f,m){const v=r.getState();if(c.length){const x={stopped:!1};for(const _ of c){const b=Rg(_.object)||v,{raycaster:w,pointer:S,camera:C,internal:T}=b,A=new J(S.x,S.y,0).unproject(C),k=I=>{var B,W;return(B=(W=T.capturedMap.get(I))==null?void 0:W.has(_.eventObject))!=null?B:!1},j=I=>{const B={intersection:_,target:d.target};T.capturedMap.has(I)?T.capturedMap.get(I).set(_.eventObject,B):T.capturedMap.set(I,new Map([[_.eventObject,B]])),d.target.setPointerCapture(I)},D=I=>{const B=T.capturedMap.get(I);B&&sL(T.capturedMap,_.eventObject,B,I)};let L={};for(let I in d){let B=d[I];typeof B!="function"&&(L[I]=B)}let O={..._,...L,pointer:S,intersections:c,stopped:x.stopped,delta:f,unprojectedPoint:A,ray:w.ray,camera:C,stopPropagation(){const I="pointerId"in d&&T.capturedMap.get(d.pointerId);if((!I||I.has(_.eventObject))&&(O.stopped=x.stopped=!0,T.hovered.size&&Array.from(T.hovered.values()).find(B=>B.eventObject===_.eventObject))){const B=c.slice(0,c.indexOf(_));i([...B,_])}},target:{hasPointerCapture:k,setPointerCapture:j,releasePointerCapture:D},currentTarget:{hasPointerCapture:k,setPointerCapture:j,releasePointerCapture:D},nativeEvent:d};if(m(O),x.stopped===!0)break}}return c}function i(c){const{internal:d}=r.getState();for(const f of d.hovered.values())if(!c.length||!c.find(m=>m.object===f.object&&m.index===f.index&&m.instanceId===f.instanceId)){const v=f.eventObject.__r3f,x=v==null?void 0:v.handlers;if(d.hovered.delete(ry(f)),v!=null&&v.eventCount){const _={...f,intersections:c};x.onPointerOut==null||x.onPointerOut(_),x.onPointerLeave==null||x.onPointerLeave(_)}}}function o(c,d){for(let f=0;f<d.length;f++){const m=d[f].__r3f;m==null||m.handlers.onPointerMissed==null||m.handlers.onPointerMissed(c)}}function a(c){switch(c){case"onPointerLeave":case"onPointerCancel":return()=>i([]);case"onLostPointerCapture":return d=>{const{internal:f}=r.getState();"pointerId"in d&&f.capturedMap.has(d.pointerId)&&requestAnimationFrame(()=>{f.capturedMap.has(d.pointerId)&&(f.capturedMap.delete(d.pointerId),i([]))})}}return function(f){const{onPointerMissed:m,internal:v}=r.getState();v.lastEvent.current=f;const x=c==="onPointerMove",_=c==="onClick"||c==="onContextMenu"||c==="onDoubleClick",w=n(f,x?t:void 0),S=_?e(f):0;c==="onPointerDown"&&(v.initialClick=[f.offsetX,f.offsetY],v.initialHits=w.map(T=>T.eventObject)),_&&!w.length&&S<=2&&(o(f,v.interaction),m&&m(f)),x&&i(w);function C(T){const A=T.eventObject,k=A.__r3f,j=k==null?void 0:k.handlers;if(k!=null&&k.eventCount)if(x){if(j.onPointerOver||j.onPointerEnter||j.onPointerOut||j.onPointerLeave){const D=ry(T),L=v.hovered.get(D);L?L.stopped&&T.stopPropagation():(v.hovered.set(D,T),j.onPointerOver==null||j.onPointerOver(T),j.onPointerEnter==null||j.onPointerEnter(T))}j.onPointerMove==null||j.onPointerMove(T)}else{const D=j[c];D?(!_||v.initialHits.includes(A))&&(o(f,v.interaction.filter(L=>!v.initialHits.includes(L))),D(T)):_&&v.initialHits.includes(A)&&o(f,v.interaction.filter(L=>!v.initialHits.includes(L)))}}s(w,f,S,C)}}return{handlePointer:a}}const iL=r=>!!(r!=null&&r.render),oL=R.createContext(null),LZ=(r,e)=>{const t=yZ((a,c)=>{const d=new J,f=new J,m=new J;function v(S=c().camera,C=f,T=c().size){const{width:A,height:k,top:j,left:D}=T,L=A/k;C.isVector3?m.copy(C):m.set(...C);const O=S.getWorldPosition(d).distanceTo(m);if(JD(S))return{width:A/S.zoom,height:k/S.zoom,top:j,left:D,factor:1,distance:O,aspect:L};{const I=S.fov*Math.PI/180,B=2*Math.tan(I/2)*O,W=B*(A/k);return{width:W,height:B,top:j,left:D,factor:A/W,distance:O,aspect:L}}}let x;const _=S=>a(C=>({performance:{...C.performance,current:S}})),b=new Ve;return{set:a,get:c,gl:null,camera:null,raycaster:null,events:{priority:1,enabled:!0,connected:!1},xr:null,scene:null,invalidate:(S=1)=>r(c(),S),advance:(S,C)=>e(S,C,c()),legacy:!1,linear:!1,flat:!1,controls:null,clock:new BM,pointer:b,mouse:b,frameloop:"always",onPointerMissed:void 0,performance:{current:1,min:.5,max:1,debounce:200,regress:()=>{const S=c();x&&clearTimeout(x),S.performance.current!==S.performance.min&&_(S.performance.min),x=setTimeout(()=>_(c().performance.max),S.performance.debounce)}},size:{width:0,height:0,top:0,left:0,updateStyle:!1},viewport:{initialDpr:0,dpr:0,width:0,height:0,top:0,left:0,aspect:0,distance:0,factor:0,getCurrentViewport:v},setEvents:S=>a(C=>({...C,events:{...C.events,...S}})),setSize:(S,C,T,A,k)=>{const j=c().camera,D={width:S,height:C,top:A||0,left:k||0,updateStyle:T};a(L=>({size:D,viewport:{...L.viewport,...v(j,f,D)}}))},setDpr:S=>a(C=>{const T=nL(S);return{viewport:{...C.viewport,dpr:T,initialDpr:C.viewport.initialDpr||T}}}),setFrameloop:(S="always")=>{const C=c().clock;C.stop(),C.elapsedTime=0,S!=="never"&&(C.start(),C.elapsedTime=0),a(()=>({frameloop:S}))},previousRoot:void 0,internal:{active:!1,priority:0,frames:0,lastEvent:R.createRef(),interaction:[],hovered:new Map,subscribers:[],initialClick:[0,0],initialHits:[],capturedMap:new Map,subscribe:(S,C,T)=>{const A=c().internal;return A.priority=A.priority+(C>0?1:0),A.subscribers.push({ref:S,priority:C,store:T}),A.subscribers=A.subscribers.sort((k,j)=>k.priority-j.priority),()=>{const k=c().internal;k!=null&&k.subscribers&&(k.priority=k.priority-(C>0?1:0),k.subscribers=k.subscribers.filter(j=>j.ref!==S))}}}}}),n=t.getState();let s=n.size,i=n.viewport.dpr,o=n.camera;return t.subscribe(()=>{const{camera:a,size:c,viewport:d,gl:f,set:m}=t.getState();if(c.width!==s.width||c.height!==s.height||d.dpr!==i){var v;s=c,i=d.dpr,PZ(a,c),f.setPixelRatio(d.dpr);const x=(v=c.updateStyle)!=null?v:typeof HTMLCanvasElement<"u"&&f.domElement instanceof HTMLCanvasElement;f.setSize(c.width,c.height,x)}a!==o&&(o=a,m(x=>({viewport:{...x.viewport,...x.viewport.getCurrentViewport(a)}})))}),t.subscribe(a=>r(a)),t};let sy,OZ=new Set,jZ=new Set,FZ=new Set;function DS(r,e){if(r.size)for(const{callback:t}of r.values())t(e)}function Ng(r,e){switch(r){case"before":return DS(OZ,e);case"after":return DS(jZ,e);case"tail":return DS(FZ,e)}}let LS,OS;function jS(r,e,t){let n=e.clock.getDelta();for(e.frameloop==="never"&&typeof r=="number"&&(n=r-e.clock.elapsedTime,e.clock.oldTime=e.clock.elapsedTime,e.clock.elapsedTime=r),LS=e.internal.subscribers,sy=0;sy<LS.length;sy++)OS=LS[sy],OS.ref.current(OS.store.getState(),n,t);return!e.internal.priority&&e.gl.render&&e.gl.render(e.scene,e.camera),e.internal.frames=Math.max(0,e.internal.frames-1),e.frameloop==="always"?1:e.internal.frames}function UZ(r){let e=!1,t=!1,n,s,i;function o(d){s=requestAnimationFrame(o),e=!0,n=0,Ng("before",d),t=!0;for(const m of r.values()){var f;i=m.store.getState(),i.internal.active&&(i.frameloop==="always"||i.internal.frames>0)&&!((f=i.gl.xr)!=null&&f.isPresenting)&&(n+=jS(d,i))}if(t=!1,Ng("after",d),n===0)return Ng("tail",d),e=!1,cancelAnimationFrame(s)}function a(d,f=1){var m;if(!d)return r.forEach(v=>a(v.store.getState(),f));(m=d.gl.xr)!=null&&m.isPresenting||!d.internal.active||d.frameloop==="never"||(f>1?d.internal.frames=Math.min(60,d.internal.frames+f):t?d.internal.frames=2:d.internal.frames=1,e||(e=!0,requestAnimationFrame(o)))}function c(d,f=!0,m,v){if(f&&Ng("before",d),m)jS(d,m,v);else for(const x of r.values())jS(d,x.store.getState());f&&Ng("after",d)}return{loop:o,invalidate:a,advance:c}}function aL(){const r=R.useContext(oL);if(!r)throw new Error("R3F: Hooks can only be used within the Canvas component!");return r}function Fl(r=t=>t,e){return aL()(r,e)}function Nw(r,e=0){const t=aL(),n=t.getState().internal.subscribe,s=ZD(r);return tv(()=>n(s,e,t),[e,n,t]),null}const Qp=new Map,{invalidate:iR,advance:oR}=UZ(Qp),{reconciler:x_,applyProps:cp}=TZ(Qp,IZ),up={objects:"shallow",strict:!1},BZ=(r,e)=>{const t=typeof r=="function"?r(e):r;return iL(t)?t:new XD({powerPreference:"high-performance",canvas:e,antialias:!0,alpha:!0,...r})};function zZ(r,e){const t=typeof HTMLCanvasElement<"u"&&r instanceof HTMLCanvasElement;if(e){const{width:n,height:s,top:i,left:o,updateStyle:a=t}=e;return{width:n,height:s,top:i,left:o,updateStyle:a}}else if(typeof HTMLCanvasElement<"u"&&r instanceof HTMLCanvasElement&&r.parentElement){const{width:n,height:s,top:i,left:o}=r.parentElement.getBoundingClientRect();return{width:n,height:s,top:i,left:o,updateStyle:t}}else if(typeof OffscreenCanvas<"u"&&r instanceof OffscreenCanvas)return{width:r.width,height:r.height,top:0,left:0,updateStyle:t};return{width:0,height:0,top:0,left:0}}function VZ(r){const e=Qp.get(r),t=e==null?void 0:e.fiber,n=e==null?void 0:e.store;e&&console.warn("R3F.createRoot should only be called once!");const s=typeof reportError=="function"?reportError:console.error,i=n||LZ(iR,oR),o=t||x_.createContainer(i,wp.ConcurrentRoot,null,!1,null,"",s,null);e||Qp.set(r,{fiber:o,store:i});let a,c=!1,d;return{configure(f={}){let{gl:m,size:v,scene:x,events:_,onCreated:b,shadows:w=!1,linear:S=!1,flat:C=!1,legacy:T=!1,orthographic:A=!1,frameloop:k="always",dpr:j=[1,2],performance:D,raycaster:L,camera:O,onPointerMissed:I}=f,B=i.getState(),W=B.gl;B.gl||B.set({gl:W=BZ(m,r)});let K=B.raycaster;K||B.set({raycaster:K=new BD});const{params:ee,...oe}=L||{};if(ir.equ(oe,K,up)||cp(K,{...oe}),ir.equ(ee,K.params,up)||cp(K,{params:{...K.params,...ee}}),!B.camera||B.camera===d&&!ir.equ(d,O,up)){d=O;const Z=O instanceof q0,X=Z?O:A?new hu(0,0,0,0,.1,1e3):new Cr(75,0,.1,1e3);Z||(X.position.z=5,O&&(cp(X,O),("aspect"in O||"left"in O||"right"in O||"bottom"in O||"top"in O)&&(X.manual=!0,X.updateProjectionMatrix())),!B.camera&&!(O!=null&&O.rotation)&&X.lookAt(0,0,0)),B.set({camera:X}),K.camera=X}if(!B.scene){let Z;x!=null&&x.isScene?Z=x:(Z=new _M,x&&cp(Z,x)),B.set({scene:hp(Z)})}if(!B.xr){var ne;const Z=(be,ue)=>{const Ee=i.getState();Ee.frameloop!=="never"&&oR(be,!0,Ee,ue)},X=()=>{const be=i.getState();be.gl.xr.enabled=be.gl.xr.isPresenting,be.gl.xr.setAnimationLoop(be.gl.xr.isPresenting?Z:null),be.gl.xr.isPresenting||iR(be)},ie={connect(){const be=i.getState().gl;be.xr.addEventListener("sessionstart",X),be.xr.addEventListener("sessionend",X)},disconnect(){const be=i.getState().gl;be.xr.removeEventListener("sessionstart",X),be.xr.removeEventListener("sessionend",X)}};typeof((ne=W.xr)==null?void 0:ne.addEventListener)=="function"&&ie.connect(),B.set({xr:ie})}if(W.shadowMap){const Z=W.shadowMap.enabled,X=W.shadowMap.type;if(W.shadowMap.enabled=!!w,ir.boo(w))W.shadowMap.type=Wg;else if(ir.str(w)){var ce;const ie={basic:Kk,percentage:J_,soft:Wg,variance:Zo};W.shadowMap.type=(ce=ie[w])!=null?ce:Wg}else ir.obj(w)&&Object.assign(W.shadowMap,w);(Z!==W.shadowMap.enabled||X!==W.shadowMap.type)&&(W.shadowMap.needsUpdate=!0)}const V=QD();V&&("enabled"in V?V.enabled=!T:"legacyMode"in V&&(V.legacyMode=T)),c||cp(W,{outputEncoding:S?3e3:3001,toneMapping:C?Ua:iM}),B.legacy!==T&&B.set(()=>({legacy:T})),B.linear!==S&&B.set(()=>({linear:S})),B.flat!==C&&B.set(()=>({flat:C})),m&&!ir.fun(m)&&!iL(m)&&!ir.equ(m,W,up)&&cp(W,m),_&&!B.events.handlers&&B.set({events:_(i)});const q=zZ(r,v);return ir.equ(q,B.size,up)||B.setSize(q.width,q.height,q.updateStyle,q.top,q.left),j&&B.viewport.dpr!==nL(j)&&B.setDpr(j),B.frameloop!==k&&B.setFrameloop(k),B.onPointerMissed||B.set({onPointerMissed:I}),D&&!ir.equ(D,B.performance,up)&&B.set(Z=>({performance:{...Z.performance,...D}})),a=b,c=!0,this},render(f){return c||this.configure(),x_.updateContainer(h.jsx(HZ,{store:i,children:f,onCreated:a,rootElement:r}),o,null,()=>{}),i},unmount(){lL(r)}}}function HZ({store:r,children:e,onCreated:t,rootElement:n}){return tv(()=>{const s=r.getState();s.set(i=>({internal:{...i.internal,active:!0}})),t&&t(s),r.getState().events.connected||s.events.connect==null||s.events.connect(n)},[]),h.jsx(oL.Provider,{value:r,children:e})}function lL(r,e){const t=Qp.get(r),n=t==null?void 0:t.fiber;if(n){const s=t==null?void 0:t.store.getState();s&&(s.internal.active=!1),x_.updateContainer(null,n,null,()=>{s&&setTimeout(()=>{try{var i,o,a,c;s.events.disconnect==null||s.events.disconnect(),(i=s.gl)==null||(o=i.renderLists)==null||o.dispose==null||o.dispose(),(a=s.gl)==null||a.forceContextLoss==null||a.forceContextLoss(),(c=s.gl)!=null&&c.xr&&s.xr.disconnect(),NZ(s),Qp.delete(r)}catch{}},500)})}}x_.injectIntoDevTools({bundleType:0,rendererPackageName:"@react-three/fiber",version:R.version});const FS={onClick:["click",!1],onContextMenu:["contextmenu",!1],onDoubleClick:["dblclick",!1],onWheel:["wheel",!0],onPointerDown:["pointerdown",!0],onPointerUp:["pointerup",!0],onPointerLeave:["pointerleave",!0],onPointerMove:["pointermove",!0],onPointerCancel:["pointercancel",!0],onLostPointerCapture:["lostpointercapture",!0]};function GZ(r){const{handlePointer:e}=DZ(r);return{priority:1,enabled:!0,compute(t,n,s){n.pointer.set(t.offsetX/n.size.width*2-1,-(t.offsetY/n.size.height)*2+1),n.raycaster.setFromCamera(n.pointer,n.camera)},connected:void 0,handlers:Object.keys(FS).reduce((t,n)=>({...t,[n]:e(n)}),{}),update:()=>{var t;const{events:n,internal:s}=r.getState();(t=s.lastEvent)!=null&&t.current&&n.handlers&&n.handlers.onPointerMove(s.lastEvent.current)},connect:t=>{var n;const{set:s,events:i}=r.getState();i.disconnect==null||i.disconnect(),s(o=>({events:{...o.events,connected:t}})),Object.entries((n=i.handlers)!=null?n:[]).forEach(([o,a])=>{const[c,d]=FS[o];t.addEventListener(c,a,{passive:d})})},disconnect:()=>{const{set:t,events:n}=r.getState();if(n.connected){var s;Object.entries((s=n.handlers)!=null?s:[]).forEach(([i,o])=>{if(n&&n.connected instanceof HTMLElement){const[a]=FS[i];n.connected.removeEventListener(a,o)}}),t(i=>({events:{...i.events,connected:void 0}}))}}}}function aR(r,e){let t;return(...n)=>{window.clearTimeout(t),t=window.setTimeout(()=>r(...n),e)}}function WZ({debounce:r,scroll:e,polyfill:t,offsetSize:n}={debounce:0,scroll:!1,offsetSize:!1}){const s=t||(typeof window>"u"?class{}:window.ResizeObserver);if(!s)throw new Error("This browser does not support ResizeObserver out of the box. See: https://github.com/react-spring/react-use-measure/#resize-observer-polyfills");const[i,o]=R.useState({left:0,top:0,width:0,height:0,bottom:0,right:0,x:0,y:0}),a=R.useRef({element:null,scrollContainers:null,resizeObserver:null,lastBounds:i,orientationHandler:null}),c=r?typeof r=="number"?r:r.scroll:null,d=r?typeof r=="number"?r:r.resize:null,f=R.useRef(!1);R.useEffect(()=>(f.current=!0,()=>void(f.current=!1)));const[m,v,x]=R.useMemo(()=>{const S=()=>{if(!a.current.element)return;const{left:C,top:T,width:A,height:k,bottom:j,right:D,x:L,y:O}=a.current.element.getBoundingClientRect(),I={left:C,top:T,width:A,height:k,bottom:j,right:D,x:L,y:O};a.current.element instanceof HTMLElement&&n&&(I.height=a.current.element.offsetHeight,I.width=a.current.element.offsetWidth),Object.freeze(I),f.current&&!YZ(a.current.lastBounds,I)&&o(a.current.lastBounds=I)};return[S,d?aR(S,d):S,c?aR(S,c):S]},[o,n,c,d]);function _(){a.current.scrollContainers&&(a.current.scrollContainers.forEach(S=>S.removeEventListener("scroll",x,!0)),a.current.scrollContainers=null),a.current.resizeObserver&&(a.current.resizeObserver.disconnect(),a.current.resizeObserver=null),a.current.orientationHandler&&("orientation"in screen&&"removeEventListener"in screen.orientation?screen.orientation.removeEventListener("change",a.current.orientationHandler):"onorientationchange"in window&&window.removeEventListener("orientationchange",a.current.orientationHandler))}function b(){a.current.element&&(a.current.resizeObserver=new s(x),a.current.resizeObserver.observe(a.current.element),e&&a.current.scrollContainers&&a.current.scrollContainers.forEach(S=>S.addEventListener("scroll",x,{capture:!0,passive:!0})),a.current.orientationHandler=()=>{x()},"orientation"in screen&&"addEventListener"in screen.orientation?screen.orientation.addEventListener("change",a.current.orientationHandler):"onorientationchange"in window&&window.addEventListener("orientationchange",a.current.orientationHandler))}const w=S=>{!S||S===a.current.element||(_(),a.current.element=S,a.current.scrollContainers=cL(S),b())};return qZ(x,!!e),$Z(v),R.useEffect(()=>{_(),b()},[e,x,v]),R.useEffect(()=>_,[]),[w,i,m]}function $Z(r){R.useEffect(()=>{const e=r;return window.addEventListener("resize",e),()=>void window.removeEventListener("resize",e)},[r])}function qZ(r,e){R.useEffect(()=>{if(e){const t=r;return window.addEventListener("scroll",t,{capture:!0,passive:!0}),()=>void window.removeEventListener("scroll",t,!0)}},[r,e])}function cL(r){const e=[];if(!r||r===document.body)return e;const{overflow:t,overflowX:n,overflowY:s}=window.getComputedStyle(r);return[t,n,s].some(i=>i==="auto"||i==="scroll")&&e.push(r),[...e,...cL(r.parentElement)]}const XZ=["x","y","top","bottom","left","right","width","height"],YZ=(r,e)=>XZ.every(t=>r[t]===e[t]);var KZ=Object.defineProperty,QZ=Object.defineProperties,JZ=Object.getOwnPropertyDescriptors,lR=Object.getOwnPropertySymbols,ZZ=Object.prototype.hasOwnProperty,eee=Object.prototype.propertyIsEnumerable,cR=(r,e,t)=>e in r?KZ(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,uR=(r,e)=>{for(var t in e||(e={}))ZZ.call(e,t)&&cR(r,t,e[t]);if(lR)for(var t of lR(e))eee.call(e,t)&&cR(r,t,e[t]);return r},tee=(r,e)=>QZ(r,JZ(e)),dR,hR;typeof window<"u"&&((dR=window.document)!=null&&dR.createElement||((hR=window.navigator)==null?void 0:hR.product)==="ReactNative")?R.useLayoutEffect:R.useEffect;function uL(r,e,t){if(!r)return;if(t(r)===!0)return r;let n=r.child;for(;n;){const s=uL(n,e,t);if(s)return s;n=n.sibling}}function dL(r){try{return Object.defineProperties(r,{_currentRenderer:{get(){return null},set(){}},_currentRenderer2:{get(){return null},set(){}}})}catch{return r}}const fR=console.error;console.error=function(){const r=[...arguments].join("");if(r!=null&&r.startsWith("Warning:")&&r.includes("useContext")){console.error=fR;return}return fR.apply(this,arguments)};const qM=dL(R.createContext(null));class hL extends R.Component{render(){return R.createElement(qM.Provider,{value:this._reactInternals},this.props.children)}}function nee(){const r=R.useContext(qM);if(r===null)throw new Error("its-fine: useFiber must be called within a <FiberProvider />!");const e=R.useId();return R.useMemo(()=>{for(const n of[r,r==null?void 0:r.alternate]){if(!n)continue;const s=uL(n,!1,i=>{let o=i.memoizedState;for(;o;){if(o.memoizedState===e)return!0;o=o.next}});if(s)return s}},[r,e])}function ree(){const r=nee(),[e]=R.useState(()=>new Map);e.clear();let t=r;for(;t;){if(t.type&&typeof t.type=="object"){const s=t.type._context===void 0&&t.type.Provider===t.type?t.type:t.type._context;s&&s!==qM&&!e.has(s)&&e.set(s,R.useContext(dL(s)))}t=t.return}return e}function see(){const r=ree();return R.useMemo(()=>Array.from(r.keys()).reduce((e,t)=>n=>R.createElement(e,null,R.createElement(t.Provider,tee(uR({},n),{value:r.get(t)}))),e=>R.createElement(hL,uR({},e))),[r])}const iee=R.forwardRef(function({children:e,fallback:t,resize:n,style:s,gl:i,events:o=GZ,eventSource:a,eventPrefix:c,shadows:d,linear:f,flat:m,legacy:v,orthographic:x,frameloop:_,dpr:b,performance:w,raycaster:S,camera:C,scene:T,onPointerMissed:A,onCreated:k,...j},D){R.useMemo(()=>MZ(iZ),[]);const L=see(),[O,I]=WZ({scroll:!0,debounce:{scroll:50,resize:0},...n}),B=R.useRef(null),W=R.useRef(null);R.useImperativeHandle(D,()=>B.current);const K=ZD(A),[ee,oe]=R.useState(!1),[ne,ce]=R.useState(!1);if(ee)throw ee;if(ne)throw ne;const V=R.useRef(null);tv(()=>{const Z=B.current;I.width>0&&I.height>0&&Z&&(V.current||(V.current=VZ(Z)),V.current.configure({gl:i,events:o,shadows:d,linear:f,flat:m,legacy:v,orthographic:x,frameloop:_,dpr:b,performance:w,raycaster:S,camera:C,scene:T,size:I,onPointerMissed:(...X)=>K.current==null?void 0:K.current(...X),onCreated:X=>{X.events.connect==null||X.events.connect(a?CZ(a)?a.current:a:W.current),c&&X.setEvents({compute:(ie,be)=>{const ue=ie[c+"X"],Ee=ie[c+"Y"];be.pointer.set(ue/be.size.width*2-1,-(Ee/be.size.height)*2+1),be.raycaster.setFromCamera(be.pointer,be.camera)}}),k==null||k(X)}}),V.current.render(h.jsx(L,{children:h.jsx(eL,{set:ce,children:h.jsx(R.Suspense,{fallback:h.jsx(AZ,{set:oe}),children:e??null})})})))}),R.useEffect(()=>{const Z=B.current;if(Z)return()=>lL(Z)},[]);const q=a?"none":"auto";return h.jsx("div",{ref:W,style:{position:"relative",width:"100%",height:"100%",overflow:"hidden",pointerEvents:q,...s},...j,children:h.jsx("div",{ref:O,style:{width:"100%",height:"100%"},children:h.jsx("canvas",{ref:B,style:{display:"block"},children:t})})})}),oee=R.forwardRef(function(e,t){return h.jsx(hL,{children:h.jsx(iee,{...e,ref:t})})});function Kb(){return Kb=Object.assign?Object.assign.bind():function(r){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var n in t)({}).hasOwnProperty.call(t,n)&&(r[n]=t[n])}return r},Kb.apply(null,arguments)}var aee=Object.defineProperty,lee=(r,e,t)=>e in r?aee(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,cee=(r,e,t)=>(lee(r,e+"",t),t);class uee{constructor(){cee(this,"_listeners")}addEventListener(e,t){this._listeners===void 0&&(this._listeners={});const n=this._listeners;n[e]===void 0&&(n[e]=[]),n[e].indexOf(t)===-1&&n[e].push(t)}hasEventListener(e,t){if(this._listeners===void 0)return!1;const n=this._listeners;return n[e]!==void 0&&n[e].indexOf(t)!==-1}removeEventListener(e,t){if(this._listeners===void 0)return;const s=this._listeners[e];if(s!==void 0){const i=s.indexOf(t);i!==-1&&s.splice(i,1)}}dispatchEvent(e){if(this._listeners===void 0)return;const n=this._listeners[e.type];if(n!==void 0){e.target=this;const s=n.slice(0);for(let i=0,o=s.length;i<o;i++)s[i].call(this,e);e.target=null}}}var dee=Object.defineProperty,hee=(r,e,t)=>e in r?dee(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,Yt=(r,e,t)=>(hee(r,typeof e!="symbol"?e+"":e,t),t);const iy=new wh,pR=new Bl,fee=Math.cos(70*(Math.PI/180)),mR=(r,e)=>(r%e+e)%e;let pee=class extends uee{constructor(e,t){super(),Yt(this,"object"),Yt(this,"domElement"),Yt(this,"enabled",!0),Yt(this,"target",new J),Yt(this,"minDistance",0),Yt(this,"maxDistance",1/0),Yt(this,"minZoom",0),Yt(this,"maxZoom",1/0),Yt(this,"minPolarAngle",0),Yt(this,"maxPolarAngle",Math.PI),Yt(this,"minAzimuthAngle",-1/0),Yt(this,"maxAzimuthAngle",1/0),Yt(this,"enableDamping",!1),Yt(this,"dampingFactor",.05),Yt(this,"enableZoom",!0),Yt(this,"zoomSpeed",1),Yt(this,"enableRotate",!0),Yt(this,"rotateSpeed",1),Yt(this,"enablePan",!0),Yt(this,"panSpeed",1),Yt(this,"screenSpacePanning",!0),Yt(this,"keyPanSpeed",7),Yt(this,"zoomToCursor",!1),Yt(this,"autoRotate",!1),Yt(this,"autoRotateSpeed",2),Yt(this,"reverseOrbit",!1),Yt(this,"reverseHorizontalOrbit",!1),Yt(this,"reverseVerticalOrbit",!1),Yt(this,"keys",{LEFT:"ArrowLeft",UP:"ArrowUp",RIGHT:"ArrowRight",BOTTOM:"ArrowDown"}),Yt(this,"mouseButtons",{LEFT:Nd.ROTATE,MIDDLE:Nd.DOLLY,RIGHT:Nd.PAN}),Yt(this,"touches",{ONE:Pd.ROTATE,TWO:Pd.DOLLY_PAN}),Yt(this,"target0"),Yt(this,"position0"),Yt(this,"zoom0"),Yt(this,"_domElementKeyEvents",null),Yt(this,"getPolarAngle"),Yt(this,"getAzimuthalAngle"),Yt(this,"setPolarAngle"),Yt(this,"setAzimuthalAngle"),Yt(this,"getDistance"),Yt(this,"getZoomScale"),Yt(this,"listenToKeyEvents"),Yt(this,"stopListenToKeyEvents"),Yt(this,"saveState"),Yt(this,"reset"),Yt(this,"update"),Yt(this,"connect"),Yt(this,"dispose"),Yt(this,"dollyIn"),Yt(this,"dollyOut"),Yt(this,"getScale"),Yt(this,"setScale"),this.object=e,this.domElement=t,this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object.zoom,this.getPolarAngle=()=>f.phi,this.getAzimuthalAngle=()=>f.theta,this.setPolarAngle=le=>{let Se=mR(le,2*Math.PI),Ze=f.phi;Ze<0&&(Ze+=2*Math.PI),Se<0&&(Se+=2*Math.PI);let ae=Math.abs(Se-Ze);2*Math.PI-ae<ae&&(Se<Ze?Se+=2*Math.PI:Ze+=2*Math.PI),m.phi=Se-Ze,n.update()},this.setAzimuthalAngle=le=>{let Se=mR(le,2*Math.PI),Ze=f.theta;Ze<0&&(Ze+=2*Math.PI),Se<0&&(Se+=2*Math.PI);let ae=Math.abs(Se-Ze);2*Math.PI-ae<ae&&(Se<Ze?Se+=2*Math.PI:Ze+=2*Math.PI),m.theta=Se-Ze,n.update()},this.getDistance=()=>n.object.position.distanceTo(n.target),this.listenToKeyEvents=le=>{le.addEventListener("keydown",Le),this._domElementKeyEvents=le},this.stopListenToKeyEvents=()=>{this._domElementKeyEvents.removeEventListener("keydown",Le),this._domElementKeyEvents=null},this.saveState=()=>{n.target0.copy(n.target),n.position0.copy(n.object.position),n.zoom0=n.object.zoom},this.reset=()=>{n.target.copy(n.target0),n.object.position.copy(n.position0),n.object.zoom=n.zoom0,n.object.updateProjectionMatrix(),n.dispatchEvent(s),n.update(),c=a.NONE},this.update=(()=>{const le=new J,Se=new J(0,1,0),Ze=new Gs().setFromUnitVectors(e.up,Se),ae=Ze.clone().invert(),Je=new J,He=new Gs,ct=2*Math.PI;return function(){const ze=n.object.position;Ze.setFromUnitVectors(e.up,Se),ae.copy(Ze).invert(),le.copy(ze).sub(n.target),le.applyQuaternion(Ze),f.setFromVector3(le),n.autoRotate&&c===a.NONE&&ee(W()),n.enableDamping?(f.theta+=m.theta*n.dampingFactor,f.phi+=m.phi*n.dampingFactor):(f.theta+=m.theta,f.phi+=m.phi);let Be=n.minAzimuthAngle,lt=n.maxAzimuthAngle;isFinite(Be)&&isFinite(lt)&&(Be<-Math.PI?Be+=ct:Be>Math.PI&&(Be-=ct),lt<-Math.PI?lt+=ct:lt>Math.PI&&(lt-=ct),Be<=lt?f.theta=Math.max(Be,Math.min(lt,f.theta)):f.theta=f.theta>(Be+lt)/2?Math.max(Be,f.theta):Math.min(lt,f.theta)),f.phi=Math.max(n.minPolarAngle,Math.min(n.maxPolarAngle,f.phi)),f.makeSafe(),n.enableDamping===!0?n.target.addScaledVector(x,n.dampingFactor):n.target.add(x),n.zoomToCursor&&O||n.object.isOrthographicCamera?f.radius=be(f.radius):f.radius=be(f.radius*v),le.setFromSpherical(f),le.applyQuaternion(ae),ze.copy(n.target).add(le),n.object.matrixAutoUpdate||n.object.updateMatrix(),n.object.lookAt(n.target),n.enableDamping===!0?(m.theta*=1-n.dampingFactor,m.phi*=1-n.dampingFactor,x.multiplyScalar(1-n.dampingFactor)):(m.set(0,0,0),x.set(0,0,0));let Dt=!1;if(n.zoomToCursor&&O){let Ht=null;if(n.object instanceof Cr&&n.object.isPerspectiveCamera){const An=le.length();Ht=be(An*v);const Bn=An-Ht;n.object.position.addScaledVector(D,Bn),n.object.updateMatrixWorld()}else if(n.object.isOrthographicCamera){const An=new J(L.x,L.y,0);An.unproject(n.object),n.object.zoom=Math.max(n.minZoom,Math.min(n.maxZoom,n.object.zoom/v)),n.object.updateProjectionMatrix(),Dt=!0;const Bn=new J(L.x,L.y,0);Bn.unproject(n.object),n.object.position.sub(Bn).add(An),n.object.updateMatrixWorld(),Ht=le.length()}else console.warn("WARNING: OrbitControls.js encountered an unknown camera type - zoom to cursor disabled."),n.zoomToCursor=!1;Ht!==null&&(n.screenSpacePanning?n.target.set(0,0,-1).transformDirection(n.object.matrix).multiplyScalar(Ht).add(n.object.position):(iy.origin.copy(n.object.position),iy.direction.set(0,0,-1).transformDirection(n.object.matrix),Math.abs(n.object.up.dot(iy.direction))<fee?e.lookAt(n.target):(pR.setFromNormalAndCoplanarPoint(n.object.up,n.target),iy.intersectPlane(pR,n.target))))}else n.object instanceof hu&&n.object.isOrthographicCamera&&(Dt=v!==1,Dt&&(n.object.zoom=Math.max(n.minZoom,Math.min(n.maxZoom,n.object.zoom/v)),n.object.updateProjectionMatrix()));return v=1,O=!1,Dt||Je.distanceToSquared(n.object.position)>d||8*(1-He.dot(n.object.quaternion))>d?(n.dispatchEvent(s),Je.copy(n.object.position),He.copy(n.object.quaternion),Dt=!1,!0):!1}})(),this.connect=le=>{n.domElement=le,n.domElement.style.touchAction="none",n.domElement.addEventListener("contextmenu",xt),n.domElement.addEventListener("pointerdown",jt),n.domElement.addEventListener("pointercancel",H),n.domElement.addEventListener("wheel",Ue)},this.dispose=()=>{var le,Se,Ze,ae,Je,He;n.domElement&&(n.domElement.style.touchAction="auto"),(le=n.domElement)==null||le.removeEventListener("contextmenu",xt),(Se=n.domElement)==null||Se.removeEventListener("pointerdown",jt),(Ze=n.domElement)==null||Ze.removeEventListener("pointercancel",H),(ae=n.domElement)==null||ae.removeEventListener("wheel",Ue),(Je=n.domElement)==null||Je.ownerDocument.removeEventListener("pointermove",Q),(He=n.domElement)==null||He.ownerDocument.removeEventListener("pointerup",H),n._domElementKeyEvents!==null&&n._domElementKeyEvents.removeEventListener("keydown",Le)};const n=this,s={type:"change"},i={type:"start"},o={type:"end"},a={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_PAN:4,TOUCH_DOLLY_PAN:5,TOUCH_DOLLY_ROTATE:6};let c=a.NONE;const d=1e-6,f=new Gb,m=new Gb;let v=1;const x=new J,_=new Ve,b=new Ve,w=new Ve,S=new Ve,C=new Ve,T=new Ve,A=new Ve,k=new Ve,j=new Ve,D=new J,L=new Ve;let O=!1;const I=[],B={};function W(){return 2*Math.PI/60/60*n.autoRotateSpeed}function K(){return Math.pow(.95,n.zoomSpeed)}function ee(le){n.reverseOrbit||n.reverseHorizontalOrbit?m.theta+=le:m.theta-=le}function oe(le){n.reverseOrbit||n.reverseVerticalOrbit?m.phi+=le:m.phi-=le}const ne=(()=>{const le=new J;return function(Ze,ae){le.setFromMatrixColumn(ae,0),le.multiplyScalar(-Ze),x.add(le)}})(),ce=(()=>{const le=new J;return function(Ze,ae){n.screenSpacePanning===!0?le.setFromMatrixColumn(ae,1):(le.setFromMatrixColumn(ae,0),le.crossVectors(n.object.up,le)),le.multiplyScalar(Ze),x.add(le)}})(),V=(()=>{const le=new J;return function(Ze,ae){const Je=n.domElement;if(Je&&n.object instanceof Cr&&n.object.isPerspectiveCamera){const He=n.object.position;le.copy(He).sub(n.target);let ct=le.length();ct*=Math.tan(n.object.fov/2*Math.PI/180),ne(2*Ze*ct/Je.clientHeight,n.object.matrix),ce(2*ae*ct/Je.clientHeight,n.object.matrix)}else Je&&n.object instanceof hu&&n.object.isOrthographicCamera?(ne(Ze*(n.object.right-n.object.left)/n.object.zoom/Je.clientWidth,n.object.matrix),ce(ae*(n.object.top-n.object.bottom)/n.object.zoom/Je.clientHeight,n.object.matrix)):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled."),n.enablePan=!1)}})();function q(le){n.object instanceof Cr&&n.object.isPerspectiveCamera||n.object instanceof hu&&n.object.isOrthographicCamera?v=le:(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),n.enableZoom=!1)}function Z(le){q(v/le)}function X(le){q(v*le)}function ie(le){if(!n.zoomToCursor||!n.domElement)return;O=!0;const Se=n.domElement.getBoundingClientRect(),Ze=le.clientX-Se.left,ae=le.clientY-Se.top,Je=Se.width,He=Se.height;L.x=Ze/Je*2-1,L.y=-(ae/He)*2+1,D.set(L.x,L.y,1).unproject(n.object).sub(n.object.position).normalize()}function be(le){return Math.max(n.minDistance,Math.min(n.maxDistance,le))}function ue(le){_.set(le.clientX,le.clientY)}function Ee(le){ie(le),A.set(le.clientX,le.clientY)}function Fe(le){S.set(le.clientX,le.clientY)}function me(le){b.set(le.clientX,le.clientY),w.subVectors(b,_).multiplyScalar(n.rotateSpeed);const Se=n.domElement;Se&&(ee(2*Math.PI*w.x/Se.clientHeight),oe(2*Math.PI*w.y/Se.clientHeight)),_.copy(b),n.update()}function je(le){k.set(le.clientX,le.clientY),j.subVectors(k,A),j.y>0?Z(K()):j.y<0&&X(K()),A.copy(k),n.update()}function Xe(le){C.set(le.clientX,le.clientY),T.subVectors(C,S).multiplyScalar(n.panSpeed),V(T.x,T.y),S.copy(C),n.update()}function $e(le){ie(le),le.deltaY<0?X(K()):le.deltaY>0&&Z(K()),n.update()}function dt(le){let Se=!1;switch(le.code){case n.keys.UP:V(0,n.keyPanSpeed),Se=!0;break;case n.keys.BOTTOM:V(0,-n.keyPanSpeed),Se=!0;break;case n.keys.LEFT:V(n.keyPanSpeed,0),Se=!0;break;case n.keys.RIGHT:V(-n.keyPanSpeed,0),Se=!0;break}Se&&(le.preventDefault(),n.update())}function ht(){if(I.length==1)_.set(I[0].pageX,I[0].pageY);else{const le=.5*(I[0].pageX+I[1].pageX),Se=.5*(I[0].pageY+I[1].pageY);_.set(le,Se)}}function Ie(){if(I.length==1)S.set(I[0].pageX,I[0].pageY);else{const le=.5*(I[0].pageX+I[1].pageX),Se=.5*(I[0].pageY+I[1].pageY);S.set(le,Se)}}function $(){const le=I[0].pageX-I[1].pageX,Se=I[0].pageY-I[1].pageY,Ze=Math.sqrt(le*le+Se*Se);A.set(0,Ze)}function Ce(){n.enableZoom&&$(),n.enablePan&&Ie()}function ke(){n.enableZoom&&$(),n.enableRotate&&ht()}function Ge(le){if(I.length==1)b.set(le.pageX,le.pageY);else{const Ze=Bt(le),ae=.5*(le.pageX+Ze.x),Je=.5*(le.pageY+Ze.y);b.set(ae,Je)}w.subVectors(b,_).multiplyScalar(n.rotateSpeed);const Se=n.domElement;Se&&(ee(2*Math.PI*w.x/Se.clientHeight),oe(2*Math.PI*w.y/Se.clientHeight)),_.copy(b)}function Ae(le){if(I.length==1)C.set(le.pageX,le.pageY);else{const Se=Bt(le),Ze=.5*(le.pageX+Se.x),ae=.5*(le.pageY+Se.y);C.set(Ze,ae)}T.subVectors(C,S).multiplyScalar(n.panSpeed),V(T.x,T.y),S.copy(C)}function rt(le){const Se=Bt(le),Ze=le.pageX-Se.x,ae=le.pageY-Se.y,Je=Math.sqrt(Ze*Ze+ae*ae);k.set(0,Je),j.set(0,Math.pow(k.y/A.y,n.zoomSpeed)),Z(j.y),A.copy(k)}function qe(le){n.enableZoom&&rt(le),n.enablePan&&Ae(le)}function nt(le){n.enableZoom&&rt(le),n.enableRotate&&Ge(le)}function jt(le){var Se,Ze;n.enabled!==!1&&(I.length===0&&((Se=n.domElement)==null||Se.ownerDocument.addEventListener("pointermove",Q),(Ze=n.domElement)==null||Ze.ownerDocument.addEventListener("pointerup",H)),Et(le),le.pointerType==="touch"?bt(le):ye(le))}function Q(le){n.enabled!==!1&&(le.pointerType==="touch"?st(le):Re(le))}function H(le){var Se,Ze,ae;We(le),I.length===0&&((Se=n.domElement)==null||Se.releasePointerCapture(le.pointerId),(Ze=n.domElement)==null||Ze.ownerDocument.removeEventListener("pointermove",Q),(ae=n.domElement)==null||ae.ownerDocument.removeEventListener("pointerup",H)),n.dispatchEvent(o),c=a.NONE}function ye(le){let Se;switch(le.button){case 0:Se=n.mouseButtons.LEFT;break;case 1:Se=n.mouseButtons.MIDDLE;break;case 2:Se=n.mouseButtons.RIGHT;break;default:Se=-1}switch(Se){case Nd.DOLLY:if(n.enableZoom===!1)return;Ee(le),c=a.DOLLY;break;case Nd.ROTATE:if(le.ctrlKey||le.metaKey||le.shiftKey){if(n.enablePan===!1)return;Fe(le),c=a.PAN}else{if(n.enableRotate===!1)return;ue(le),c=a.ROTATE}break;case Nd.PAN:if(le.ctrlKey||le.metaKey||le.shiftKey){if(n.enableRotate===!1)return;ue(le),c=a.ROTATE}else{if(n.enablePan===!1)return;Fe(le),c=a.PAN}break;default:c=a.NONE}c!==a.NONE&&n.dispatchEvent(i)}function Re(le){if(n.enabled!==!1)switch(c){case a.ROTATE:if(n.enableRotate===!1)return;me(le);break;case a.DOLLY:if(n.enableZoom===!1)return;je(le);break;case a.PAN:if(n.enablePan===!1)return;Xe(le);break}}function Ue(le){n.enabled===!1||n.enableZoom===!1||c!==a.NONE&&c!==a.ROTATE||(le.preventDefault(),n.dispatchEvent(i),$e(le),n.dispatchEvent(o))}function Le(le){n.enabled===!1||n.enablePan===!1||dt(le)}function bt(le){switch(ft(le),I.length){case 1:switch(n.touches.ONE){case Pd.ROTATE:if(n.enableRotate===!1)return;ht(),c=a.TOUCH_ROTATE;break;case Pd.PAN:if(n.enablePan===!1)return;Ie(),c=a.TOUCH_PAN;break;default:c=a.NONE}break;case 2:switch(n.touches.TWO){case Pd.DOLLY_PAN:if(n.enableZoom===!1&&n.enablePan===!1)return;Ce(),c=a.TOUCH_DOLLY_PAN;break;case Pd.DOLLY_ROTATE:if(n.enableZoom===!1&&n.enableRotate===!1)return;ke(),c=a.TOUCH_DOLLY_ROTATE;break;default:c=a.NONE}break;default:c=a.NONE}c!==a.NONE&&n.dispatchEvent(i)}function st(le){switch(ft(le),c){case a.TOUCH_ROTATE:if(n.enableRotate===!1)return;Ge(le),n.update();break;case a.TOUCH_PAN:if(n.enablePan===!1)return;Ae(le),n.update();break;case a.TOUCH_DOLLY_PAN:if(n.enableZoom===!1&&n.enablePan===!1)return;qe(le),n.update();break;case a.TOUCH_DOLLY_ROTATE:if(n.enableZoom===!1&&n.enableRotate===!1)return;nt(le),n.update();break;default:c=a.NONE}}function xt(le){n.enabled!==!1&&le.preventDefault()}function Et(le){I.push(le)}function We(le){delete B[le.pointerId];for(let Se=0;Se<I.length;Se++)if(I[Se].pointerId==le.pointerId){I.splice(Se,1);return}}function ft(le){let Se=B[le.pointerId];Se===void 0&&(Se=new Ve,B[le.pointerId]=Se),Se.set(le.pageX,le.pageY)}function Bt(le){const Se=le.pointerId===I[0].pointerId?I[1]:I[0];return B[Se.pointerId]}this.dollyIn=(le=K())=>{X(le),n.update()},this.dollyOut=(le=K())=>{Z(le),n.update()},this.getScale=()=>v,this.setScale=le=>{q(le),n.update()},this.getZoomScale=()=>K(),t!==void 0&&this.connect(t),this.update()}};const mee=R.forwardRef(({makeDefault:r,camera:e,regress:t,domElement:n,enableDamping:s=!0,keyEvents:i=!1,onChange:o,onStart:a,onEnd:c,...d},f)=>{const m=Fl(j=>j.invalidate),v=Fl(j=>j.camera),x=Fl(j=>j.gl),_=Fl(j=>j.events),b=Fl(j=>j.setEvents),w=Fl(j=>j.set),S=Fl(j=>j.get),C=Fl(j=>j.performance),T=e||v,A=n||_.connected||x.domElement,k=R.useMemo(()=>new pee(T),[T]);return Nw(()=>{k.enabled&&k.update()},-1),R.useEffect(()=>(i&&k.connect(i===!0?A:i),k.connect(A),()=>void k.dispose()),[i,A,t,k,m]),R.useEffect(()=>{const j=O=>{m(),t&&C.regress(),o&&o(O)},D=O=>{a&&a(O)},L=O=>{c&&c(O)};return k.addEventListener("change",j),k.addEventListener("start",D),k.addEventListener("end",L),()=>{k.removeEventListener("start",D),k.removeEventListener("end",L),k.removeEventListener("change",j)}},[o,a,c,k,m,b]),R.useEffect(()=>{if(r){const j=S().controls;return w({controls:k}),()=>w({controls:j})}},[r,k]),R.createElement("primitive",Kb({ref:f,object:k,enableDamping:s},d))}),gee=(r,e)=>{const t=new J(...r[e]||r[0]);let n;if(e<r.length-1){const s=new J(...r[e+1]);n=new J().subVectors(s,t)}else if(e>0){const s=new J(...r[e-1]);n=new J().subVectors(t,s)}else n=new J(0,0,1);return n.lengthSq()<.001&&n.set(0,0,1),n.normalize(),n},vee=({playerTokenRef:r,worldPoints:e,playerTileIndex:t,isPlayerMoving:n})=>{const{camera:s,controls:i}=Fl();return Nw(()=>{if(!r.current)return;const o=r.current.position,a=gee(e,t);if(n){const c=a.clone().multiplyScalar(-5).add(new J(0,2,0)),d=new J().copy(o).add(c),f=new J().copy(o).add(a.clone().multiplyScalar(5));s.position.lerp(d,.05),i?(i.target.lerp(f,.05),i.update()):s.lookAt(f)}}),null},xee=R.forwardRef(({position:r},e)=>{const t=R.useRef(null);R.useImperativeHandle(e,()=>t.current);const n=R.useMemo(()=>new J(...r),[r]);return R.useEffect(()=>{t.current&&t.current.position.copy(n)},[]),Nw(()=>{t.current&&t.current.position.distanceTo(n)>.01&&t.current.position.lerp(n,.05)}),h.jsxs("mesh",{ref:t,castShadow:!0,children:[h.jsx("sphereGeometry",{args:[.2,32,32]}),h.jsx("meshStandardMaterial",{color:"red"})]})}),yee=({worldPoints:r})=>{if(r.length<2)return null;const e=new J(...r[r.length-1]),t=new J(...r[r.length-2]),n=new J().subVectors(e,t);n.y=0,n.normalize();const s=new J().addVectors(e,n.multiplyScalar(1.5));s.y=e.y+.1;const i=Math.atan2(-n.x,-n.z);return h.jsxs("group",{position:s,rotation:[0,i,0],children:[h.jsxs("mesh",{position:[0,1,0],castShadow:!0,children:[h.jsx("boxGeometry",{args:[2,2,2]}),h.jsx("meshStandardMaterial",{color:"#FFC0CB"})," "]}),h.jsxs("mesh",{position:[-1.2,1.25,-1.2],castShadow:!0,children:[h.jsx("cylinderGeometry",{args:[.4,.4,2.5,16]}),h.jsx("meshStandardMaterial",{color:"#ADD8E6"})," "]}),h.jsxs("mesh",{position:[1.2,1.25,-1.2],castShadow:!0,children:[h.jsx("cylinderGeometry",{args:[.4,.4,2.5,16]}),h.jsx("meshStandardMaterial",{color:"#ADD8E6"})]}),h.jsxs("mesh",{position:[-1.2,1.25,1.2],castShadow:!0,children:[h.jsx("cylinderGeometry",{args:[.4,.4,2.5,16]}),h.jsx("meshStandardMaterial",{color:"#ADD8E6"})]}),h.jsxs("mesh",{position:[1.2,1.25,1.2],castShadow:!0,children:[h.jsx("cylinderGeometry",{args:[.4,.4,2.5,16]}),h.jsx("meshStandardMaterial",{color:"#ADD8E6"})]}),h.jsxs("mesh",{position:[-1.2,2.5,-1.2],castShadow:!0,children:[h.jsx("coneGeometry",{args:[.6,1,16]}),h.jsx("meshStandardMaterial",{color:"#FF69B4"})," "]}),h.jsxs("mesh",{position:[1.2,2.5,-1.2],castShadow:!0,children:[h.jsx("coneGeometry",{args:[.6,1,16]}),h.jsx("meshStandardMaterial",{color:"#FF69B4"})]}),h.jsxs("mesh",{position:[-1.2,2.5,1.2],castShadow:!0,children:[h.jsx("coneGeometry",{args:[.6,1,16]}),h.jsx("meshStandardMaterial",{color:"#FF69B4"})]}),h.jsxs("mesh",{position:[1.2,2.5,1.2],castShadow:!0,children:[h.jsx("coneGeometry",{args:[.6,1,16]}),h.jsx("meshStandardMaterial",{color:"#FF69B4"})]}),h.jsxs("mesh",{position:[0,.5,1.01],children:[h.jsx("boxGeometry",{args:[.8,1,.1]}),h.jsx("meshStandardMaterial",{color:"#A0522D"})," "]})]})},_ee=({playerTokenRef:r,playerTokenPosition:e,isPlayerMoving:t,onPlayerMoveEnd:n})=>{const s=R.useRef(!0);return Nw(()=>{if(!t||s.current||!r.current)return;const i=r.current.position,o=new J(...e);i.distanceTo(o)<.05&&(s.current=!0,n())}),R.useEffect(()=>{t&&(s.current=!1)},[t]),null},wee=({worldPoints:r,tileColors:e,TILE_SIZE:t,RAINBOW_COLOR:n,playerTokenPosition:s,playerTokenRef:i,playerTileIndex:o,isPlayerMoving:a,orbitTarget:c,onPlayerMoveEnd:d})=>h.jsx("div",{className:"absolute inset-0 z-0",children:h.jsx(R.Suspense,{fallback:h.jsx("div",{className:"text-white flex items-center justify-center h-full",children:"Loading 3D Environment..."}),children:h.jsxs(oee,{shadows:!0,children:[h.jsx("ambientLight",{intensity:.8}),h.jsx("spotLight",{position:[10,15,10],angle:.3,penumbra:1,intensity:2,castShadow:!0}),h.jsx("pointLight",{position:[-10,-10,-10],intensity:.5}),r.map((f,m)=>h.jsxs("mesh",{position:f,castShadow:!0,receiveShadow:!0,children:[h.jsx("cylinderGeometry",{args:[t/2,t/2,.2,32]}),h.jsx("meshStandardMaterial",{color:e[m],emissive:e[m],emissiveIntensity:e[m]===n?1:.4})]},m)),h.jsx(xee,{ref:i,position:s}),h.jsx(yee,{worldPoints:r}),h.jsx(vee,{playerTokenRef:i,worldPoints:r,playerTileIndex:o,isPlayerMoving:a}),h.jsx(mee,{makeDefault:!0,target:c}),h.jsx(_ee,{playerTokenRef:i,playerTokenPosition:s,isPlayerMoving:a,onPlayerMoveEnd:d})]})})}),See=({currentLesson:r,tileColors:e,RAINBOW_COLOR:t,navigate:n,studentId:s,lessonNumber:i,pathPoints:o,lessons:a,onGameComplete:c})=>{const[d,f]=R.useState(!0),[m,v]=R.useState(0),[x,_]=R.useState(0),[b,w]=R.useState(!1),[S,C]=R.useState(!1),[T,A]=R.useState(0),k=R.useRef(null);R.useEffect(()=>{if(!o||o.length===0){Yr.info("Please draw a path to begin."),n(`/play/student/${s}/lesson/${i}`);return}Object.keys(a).length>0&&!r&&(Yr.error("No lesson found for this student. Returning to path drawing."),n(`/play/student/${s}/lesson/${i}`))},[o,a,r,n,s,i]);const j=()=>{if(r&&m<r.questions.length-1)v(I=>I+1),C(!1);else if(r&&m>=r.questions.length-1){f(!1);const I=r.questions.length,B=T,W=I>0?Math.round(B/I*100):0;console.log(`Game completed: ${B}/${I} correct (${W}%)`),c==null||c(W,I,B),Yr.success("You finished the quiz!")}};return{gameActive:d,currentQuestionIndex:m,playerTileIndex:x,isPlayerMoving:b,isHudMinimized:S,playerTokenRef:k,handlePlayerMoveEnd:()=>{w(!1),setTimeout(j,500)},handleAnswerSubmit:(I,B)=>{if(I){A(K=>{const ee=K+1;return console.log(`Correct answer! Count: ${ee}`),ee}),Yr.success("Correct!");const W=e.findIndex((K,ee)=>ee>x&&(K===B||K===t));W!==-1?(_(W),w(!0),C(!0)):(Yr.info("You've reached the end of this color path! Moving to the next question."),setTimeout(j,1e3))}else console.log(`Wrong answer! Count stays: ${T}`),Yr.error("Incorrect. Let's try the next question."),setTimeout(j,1e3)},toggleHudMinimized:()=>{C(!S)}}};class bee{constructor(e="http://localhost:3001"){T2(this,"baseUrl");this.baseUrl=e}async sendMessage(e){try{const t=await fetch(`${this.baseUrl}/api/constitutional-ai/chat`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({message:e.message,studentId:e.studentId,conversationHistory:e.conversationHistory.map(s=>({role:s.role,content:s.content})),gameContext:e.gameContext})}),n=await t.json();if(!t.ok)throw new Error(n.error||`HTTP ${t.status}: ${t.statusText}`);if(!n.success)throw new Error(n.error||"Constitutional AI service returned failure");return{success:!0,message:n.message}}catch(t){return console.error("Constitutional AI Service Error:",t),t instanceof Error?{success:!1,message:"Sorry, I had trouble understanding that. Can you try asking differently?",error:t.message}:{success:!1,message:"Sorry, something went wrong. Please try again.",error:"Unknown error occurred"}}}async healthCheck(){try{return(await fetch(`${this.baseUrl}/api/constitutional-ai/health`)).ok}catch{return!1}}}const Eee=new bee,Mee=(r,e={})=>{const[t,n]=R.useState([]),[s,i]=R.useState(!1),[o,a]=R.useState(null),c=R.useCallback(async m=>{if(!m.trim())return;const v={role:"user",content:m.trim(),timestamp:new Date};n(x=>[...x,v]),i(!0),a(null);try{const _={role:"assistant",content:(await Eee.sendMessage({message:m.trim(),studentId:r,conversationHistory:t,gameContext:e})).message,timestamp:new Date};n(b=>[...b,_])}catch(x){console.error("Constitutional AI Error:",x),a(x instanceof Error?x.message:"Failed to get response");const _={role:"assistant",content:"Sorry, I'm having trouble right now. Can you try asking again?",timestamp:new Date};n(b=>[...b,_]),Yr.error("Failed to get AI response")}finally{i(!1)}},[r,t,e]),d=R.useCallback(()=>{n([]),a(null)},[]),f=R.useCallback(()=>t.length>0?t[t.length-1]:null,[t]);return{messages:t,isLoading:s,error:o,sendMessage:c,clearMessages:d,getLastMessage:f}},Tee=({isOpen:r,onClose:e,studentId:t,isMinimized:n,onToggleMinimize:s,gameContext:i={}})=>{var _;const[o,a]=R.useState(""),c=R.useRef(null),{messages:d,isLoading:f,sendMessage:m}=Mee(t,i);R.useEffect(()=>{var b;(b=c.current)==null||b.scrollIntoView({behavior:"smooth"})},[d]);const v=async()=>{if(!o.trim()||f)return;const b=o.trim();a(""),await m(b)},x=b=>{b.key==="Enter"&&!b.shiftKey&&(b.preventDefault(),v())};return r?n?h.jsxs("div",{className:"fixed bottom-6 right-6 z-30",children:[h.jsx(zt,{onClick:s,className:"bg-gradient-to-r from-purple-500 to-pink-500 hover:from-purple-600 hover:to-pink-600 text-white rounded-full w-16 h-16 shadow-lg",size:"lg",children:h.jsx(H2,{className:"h-6 w-6"})}),d.length>0&&((_=d[d.length-1])==null?void 0:_.role)==="assistant"&&h.jsx("div",{className:"absolute -top-2 -right-2 w-4 h-4 bg-red-500 rounded-full animate-pulse"})]}):h.jsx("div",{className:"fixed bottom-6 right-6 z-30 w-96 h-[32rem]",children:h.jsxs(Wt,{className:"h-full bg-gradient-to-br from-blue-50 to-purple-50 border-2 border-purple-200 shadow-2xl",children:[h.jsx(or,{className:"bg-gradient-to-r from-purple-500 to-pink-500 text-white p-3 rounded-t-lg",children:h.jsxs("div",{className:"flex items-center justify-between",children:[h.jsxs("div",{className:"flex items-center gap-2",children:[h.jsx(H2,{className:"h-5 w-5"}),h.jsxs("div",{children:[h.jsx("h3",{className:"font-bold text-sm",children:"Your Study Buddy"}),h.jsx("p",{className:"text-xs opacity-90",children:"Ask me anything!"})]})]}),h.jsxs("div",{className:"flex gap-1",children:[h.jsx(zt,{variant:"ghost",size:"sm",onClick:s,className:"text-white hover:bg-white/20 p-1 h-6 w-6",children:h.jsx(s5,{className:"h-3 w-3"})}),h.jsx(zt,{variant:"ghost",size:"sm",onClick:e,className:"text-white hover:bg-white/20 p-1 h-6 w-6",children:h.jsx(ih,{className:"h-3 w-3"})})]})]})}),h.jsxs(nn,{className:"p-0 flex flex-col h-full",children:[h.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-3 max-h-80",children:[d.length===0&&h.jsxs("div",{className:"text-center text-gray-500 mt-8",children:[h.jsx("p",{className:"text-sm",children:"Hi! I'm your study buddy."}),h.jsx("p",{className:"text-xs",children:"Ask me about your lesson, or just say hi!"})]}),d.map((b,w)=>h.jsx("div",{className:`flex ${b.role==="user"?"justify-end":"justify-start"}`,children:h.jsx("div",{className:`max-w-[80%] p-3 rounded-lg text-sm ${b.role==="user"?"bg-purple-500 text-white rounded-br-sm":"bg-white border border-gray-200 rounded-bl-sm shadow-sm"}`,children:b.content})},w)),f&&h.jsx("div",{className:"flex justify-start",children:h.jsx("div",{className:"bg-white border border-gray-200 rounded-lg rounded-bl-sm shadow-sm p-3 max-w-[80%]",children:h.jsxs("div",{className:"flex space-x-1",children:[h.jsx("div",{className:"w-2 h-2 bg-purple-300 rounded-full animate-bounce"}),h.jsx("div",{className:"w-2 h-2 bg-purple-300 rounded-full animate-bounce",style:{animationDelay:"0.1s"}}),h.jsx("div",{className:"w-2 h-2 bg-purple-300 rounded-full animate-bounce",style:{animationDelay:"0.2s"}})]})})}),h.jsx("div",{ref:c})]}),h.jsx("div",{className:"p-4 border-t border-purple-100",children:h.jsxs("div",{className:"flex gap-2",children:[h.jsx(Jl,{value:o,onChange:b=>a(b.target.value),onKeyPress:x,placeholder:"Type your question...",className:"flex-1 border-purple-200 focus:border-purple-400 rounded-full",disabled:f}),h.jsx(zt,{onClick:v,disabled:!o.trim()||f,className:"bg-purple-500 hover:bg-purple-600 rounded-full px-4",children:h.jsx(a5,{className:"h-4 w-4"})})]})})]})]})}):null},Cee=(r,e,t)=>ki({queryKey:["assignment-questions",r,e,t],queryFn:async()=>{const s=await(await fetch(`http://localhost:3001/api/students/${r}/assignments/${e}/game-questions?pathLength=${t}`)).json();if(!s.success)throw new Error(s.error||"Failed to fetch assignment questions");return s},enabled:!!(r&&e&&t>0)}),US=()=>{var V,q;const r=rc(),e=mh(),{studentId:t,assignmentId:n}=gh(),s=(V=r.state)==null?void 0:V.pathPoints,i=(s==null?void 0:s.length)||0,o=(q=r.state)==null?void 0:q.assignmentData,[a]=R.useState(()=>crypto.randomUUID()),[c,d]=R.useState(!1),[f,m]=R.useState(!1),{data:v,isLoading:x}=Cee(t||"",n||"",i),{worldPoints:_,tileColors:b,TILE_SIZE:w,RAINBOW_COLOR:S}=uZ(s),C=t?parseInt(t,10):void 0,T=R.useMemo(()=>v!=null&&v.questions?{questions:v.questions.map((Z,X)=>({id:Z.id||`assignment_${X}`,question:Z.text,choices:Z.choices,correctAnswerId:Z.correctAnswer,explanation:Z.explanation||"",source:Z.source}))}:null,[v]),A=async(Z,X,ie)=>{if(!(!C||!T||!n))try{await n8({studentId:C,sessionId:a,assignmentId:n,questionsCorrect:ie,questionsTotal:X}),Yr.success(`Assignment completed! Final score: ${Z}% - Results saved`),setTimeout(()=>{e(`/dashboard/student/${t}`)},2e3)}catch(be){console.error("Error saving game result:",be),Yr.error("Game completed, but failed to save results")}},{gameActive:k,currentQuestionIndex:j,playerTileIndex:D,isPlayerMoving:L,isHudMinimized:O,playerTokenRef:I,handlePlayerMoveEnd:B,handleAnswerSubmit:W,toggleHudMinimized:K}=See({currentLesson:T,tileColors:b,RAINBOW_COLOR:S,navigate:e,studentId:t,lessonNumber:void 0,pathPoints:s,lessons:{},onGameComplete:A}),ee=async(Z,X,ie)=>{if(!(T!=null&&T.questions)||j>=T.questions.length)return;const be=T.questions[j];try{await t8({studentId:parseInt(t||"0"),sessionId:a,assignmentId:n,questionSetId:void 0,questionIndex:j,questionText:be.question,correctAnswer:be.correctAnswerId,studentAnswer:Z,isCorrect:X}),console.log("Question attempt saved successfully")}catch(ue){console.error("Error saving question attempt:",ue)}W(X,ie)};R.useEffect(()=>{k&&!c&&(d(!0),m(!1))},[k]);const oe=R.useMemo(()=>{if(!_||_.length===0)return[0,0,0];const Z=_[D];return[Z[0],Z[1]+.1+.2,Z[2]]},[_,D]),ne=R.useMemo(()=>{if(!_||_.length===0)return new J(0,0,0);const Z=_.length>1?_[1]:_[0];return new J(...Z)},[_]);if(x)return h.jsx("div",{className:"text-white flex items-center justify-center h-full",children:"Loading Assignment Questions..."});if(!s||s.length===0)return h.jsx("div",{className:"text-white flex items-center justify-center h-full",children:"Loading Game..."});const ce=k;return h.jsxs("div",{className:"w-full h-screen bg-black relative",children:[h.jsxs("div",{className:"absolute top-4 left-4 z-10 flex items-center gap-4",children:[h.jsxs(qa,{to:`/play/student/${t}/assignment/${n}`,className:"inline-flex items-center gap-2 text-gray-300 hover:text-white mb-4",children:[h.jsx(em,{className:"h-4 w-4"}),"Back to Assignment"]}),o&&h.jsxs("div",{className:"text-white text-sm bg-purple-600 px-3 py-1 rounded-full",children:[" ",o.lessonTitle," Assignment"]})]}),h.jsx(fZ,{shouldShowQuiz:ce,isHudMinimized:O,currentLesson:T,numericLessonNumber:0,currentQuestionIndex:j,onMinimizeToggle:K,onAnswerSubmit:ee}),h.jsx(Tee,{isOpen:c,onClose:()=>d(!1),studentId:t||"",isMinimized:f,onToggleMinimize:()=>m(!f),gameContext:{currentLesson:(o==null?void 0:o.lessonTitle)||"Assignment",currentQuestion:j+1,isInGame:k,assignmentId:n,lessonId:o==null?void 0:o.lessonId,sessionId:a}}),h.jsx(pZ,{isHudMinimized:O,isPlayerMoving:L,shouldShowQuiz:ce,currentLesson:T}),h.jsx(wee,{worldPoints:_,tileColors:b,TILE_SIZE:w,RAINBOW_COLOR:S,playerTokenPosition:oe,playerTokenRef:I,playerTileIndex:D,isPlayerMoving:L,orbitTarget:ne,onPlayerMoveEnd:B})]})},Aee=()=>{var v;const{roomId:r,studentId:e}=gh(),t=mh(),[n,s]=R.useState(!1),i=e?parseInt(e,10):void 0,{data:o}=ki({queryKey:["student",i],queryFn:()=>L_(i),enabled:!!i}),{data:a}=ki({queryKey:["assignedGames",i],queryFn:()=>D3(i),enabled:!!i}),{data:c=[]}=ki({queryKey:["roommates",r,i],queryFn:()=>L3(r,i),enabled:!!r&&!!i}),d=a==null?void 0:a.find(x=>x.room_id===r),f=()=>{s(!0),Yr.success("You're ready! Waiting for teammates...")},m=()=>{const x=Array.from({length:20},(_,b)=>({x:b*40,y:300+Math.sin(b)*50}));t(`/play/student/${e}/lesson/1/game`,{state:{pathPoints:x,isMultiplayer:!0,roomId:r,roomName:d==null?void 0:d.room_name,teammates:c}})};return h.jsxs("div",{className:"p-8 max-w-4xl mx-auto",children:[h.jsxs(qa,{to:`/dashboard/student/${e}`,className:"inline-flex items-center gap-2 text-muted-foreground hover:text-foreground mb-6",children:[h.jsx(em,{className:"h-4 w-4"}),"Back to Dashboard"]}),h.jsx("h1",{className:"text-3xl font-bold mb-6",children:(d==null?void 0:d.room_name)||"Game Room"}),h.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[h.jsxs(Wt,{children:[h.jsx(or,{children:h.jsxs(ws,{className:"flex items-center space-x-2",children:[h.jsx(Qi,{className:"w-5 h-5"}),h.jsx("span",{children:"Your Team"})]})}),h.jsxs(nn,{className:"space-y-3",children:[h.jsxs("div",{className:"flex items-center space-x-3 p-2 bg-green-50 rounded-lg",children:[h.jsx("div",{className:"w-8 h-8 bg-green-600 rounded-full flex items-center justify-center text-white text-sm font-bold",children:(v=o==null?void 0:o.name)==null?void 0:v.charAt(0)}),h.jsxs("span",{className:"font-medium",children:[o==null?void 0:o.name," (You)"]})]}),c.map(x=>h.jsxs("div",{className:"flex items-center space-x-3 p-2 bg-gray-50 rounded-lg",children:[h.jsx("div",{className:"w-8 h-8 bg-gray-600 rounded-full flex items-center justify-center text-white text-sm font-bold",children:x.name.charAt(0)}),h.jsx("span",{className:"font-medium",children:x.name})]},x.id))]})]}),h.jsxs(Wt,{children:[h.jsx(or,{children:h.jsx(ws,{children:"Game Settings"})}),h.jsxs(nn,{className:"space-y-4",children:[h.jsxs("div",{className:"flex items-center space-x-2",children:[(d==null?void 0:d.audio_video_mode)==="off"?h.jsx(nN,{className:"w-4 h-4"}):h.jsx(rN,{className:"w-4 h-4"}),h.jsx("span",{className:"capitalize",children:(d==null?void 0:d.audio_video_mode)==="off"?"Mics Off":"Audio On"})]}),h.jsx("div",{className:"space-y-2",children:n?h.jsx(zt,{onClick:m,className:"w-full",children:"Start Game"}):h.jsx(zt,{onClick:f,className:"w-full",children:"I'm Ready!"})})]})]})]})]})},Ree=new wU,Nee=()=>{const[r,e]=R.useState(null),[t,n]=R.useState(!0);return R.useEffect(()=>{(async()=>{const{data:{session:o}}=await Un.auth.getSession();e(o),n(!1)})();const{data:{subscription:i}}=Un.auth.onAuthStateChange((o,a)=>{e(a)});return()=>i.unsubscribe()},[]),t?h.jsx("div",{className:"min-h-screen flex items-center justify-center bg-background",children:h.jsx("p",{children:"Loading..."})}):h.jsx(TU,{client:Ree,children:h.jsx(nU,{children:h.jsx(_G,{children:h.jsxs(PG,{children:[h.jsx(Q5,{}),h.jsx(Rj,{}),h.jsx(F6,{children:h.jsxs(P6,{children:[h.jsx(xs,{path:"/login",element:r?h.jsx(TE,{to:"/"}):h.jsx(m9,{})}),h.jsx(xs,{path:"/play/student/:studentId/assignment/:assignmentId",element:h.jsx(O1,{})}),h.jsx(xs,{path:"/play/student/:studentId/assignment/:assignmentId/game",element:h.jsx(US,{})}),h.jsx(xs,{path:"/play/student/:studentId/ai-questions/:questionSetId",element:h.jsx(O1,{})}),h.jsx(xs,{path:"/play/student/:studentId/ai-questions/:questionSetId/game",element:h.jsx(US,{})}),h.jsxs(xs,{element:h.jsx(Kz,{session:r}),children:[h.jsx(xs,{path:"/",element:h.jsx(i8,{})}),h.jsx(xs,{path:"/class/:classId",element:h.jsx(xG,{})}),h.jsx(xs,{path:"/class/:classId/assign-rooms",element:h.jsx(GG,{})}),h.jsx(xs,{path:"/student/:studentId",element:h.jsx(NG,{})}),h.jsx(xs,{path:"/dashboard/student/:studentId",element:h.jsx(FG,{})}),h.jsx(xs,{path:"/student-home",element:h.jsx(O3,{})}),h.jsx(xs,{path:"/play/student/:studentId/lesson/:lessonNumber",element:h.jsx(O1,{})}),h.jsx(xs,{path:"/play/student/:studentId/lesson/:lessonNumber/game",element:h.jsx(US,{})}),h.jsx(xs,{path:"/play/multiplayer/:roomId/:studentId",element:h.jsx(Aee,{})})]}),h.jsx(xs,{path:"*",element:h.jsx(gu,{})})]})})]})})})})};XL.createRoot(document.getElementById("root")).render(h.jsx(Nee,{}));
